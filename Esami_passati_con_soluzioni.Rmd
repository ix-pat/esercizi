--- 
title: "Eserciziario di Statistica"
subtitle: "CLEAM AA 23/24"
author: "Patrizio Frederic"
date: "Aggiornato al `r format(Sys.Date(),'%d-%m-%Y')`"
documentclass: book
site: bookdown::bookdown_site
biblio-style: apalike
link-citations: yes
description: "Appunti sparsi"
geometry: "left=2.5cm, right=2.5cm, top=4.5cm, bottom=4.5cm, showframe=false, showcrop=true"
fontsize: 11pt
output:
   bookdown::pdf_book:
     keep_tex: true
     highlight: default
     fig_caption: true
     fig_width:  3.5
     fig_height: 2.5
     number_sections: true
   bookdown::gitbook:
     fig_caption: true
     number_sections: false     
     includes:
      in_header: "script.html" 
     # fig_width: 12
     # fig_height: 8
#documentclass: book
editor_options: 
  chunk_output_type: console
---

```{r index-1,, include=FALSE}

source("intro.R")


```



```{r index-2,,results='asis', echo=FALSE}
if (html) {
  cat("# Eserciziario {-}\n\n")
  include_graphics("img/titolo.png",dpi=30)
}
```


<!--chapter:end:index.Rmd-->

--- 
title: "Eserciziario di Statistica"
subtitle: "CLEAM AA 23/24"
author: "Patrizio Frederic"
date: "Aggiornato al `r format(Sys.Date(),'%d-%m-%Y')`"
documentclass: book
site: bookdown::bookdown_site
biblio-style: apalike
link-citations: yes
description: "Appunti sparsi"
geometry: "left=2.5cm, right=2.5cm, top=4.5cm, bottom=4.5cm, showframe=false, showcrop=true"
fontsize: 11pt
output:
   bookdown::pdf_book:
     keep_tex: true
     highlight: default
     fig_caption: true
     # fig_width: 4
     # fig_height: 3
   bookdown::gitbook:
     fig_caption: true
     # fig_width: 12
     # fig_height: 8
#documentclass: book
editor_options: 
  chunk_output_type: console
---

```{r 00-intro-1,, include=FALSE}

source("intro.R")

```


# Avvertenza {-}

\large

Questo lavoro è un work in progress, questa non è la versione definitiva, sconsiglio di stampare tutto. 




\normalsize


Eserciziario di Statistica © 2024 di Patrizio Frederic è distribuito
sotto licenza CC BY-NC-ND 4.0
https://creativecommons.org/licenses/by-nc-nd/4.0/

You are free to:
Share — copy and redistribute the material in any medium or format
The licensor cannot revoke these freedoms as long as you follow the license terms.
Under the following terms:
Attribution — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use.

NonCommercial — You may not use the material for commercial purposes.

NoDerivatives — If you remix, transform, or build upon the material, you may not distribute the modified material.

No additional restrictions — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits.





# Introduzione {-}

Qui si trovano le esercitazioni e i compiti passati del corso di Statistica 
in formato html fruibili direttamente dal mio server. 
Il pdf e il formato epub sono è scaricabili cliccando in alto.

Nel prossimo futuro, aggiungerò altri esercizi non presenti nei compiti solo a titolo
di esercitazione. 

Patrizio Frederic

Bologna, il `r format(Sys.Date(),"%d/%m/%Y")`.

<!--chapter:end:00-intro.Rmd-->

---
output: html_document
editor_options: 
  chunk_output_type: console
---
```{r , include=FALSE}
source("intro.R")
s2=1
 

```

\part{Esercizi per argomento}


```{r 01-descr-5}
if (html) cat('')
```
  

# Esercizi di Statistica Descrittiva



<div class="button-container"></div>

## Versione senza contesto

### Variante A

```{r 1}
# Basic settings
set.seed(3)   # per ottenere sempre la stessa simulazione
n <- 383      # ampiezza campionaria
a <- 5
b <- 1
k <- 4
L <- 1
samp <- (rgamma(n,a,b))*L
brk  <- round(c(qgamma((0:k)/(k+1),a,b)*L,ceiling( max(samp))),1)
k <- length(brk)-1
br1  <- brk[-(k+1)]
br2  <- brk[-1]
nomex <- "fenomeno-x"
ls2e(stat_base(samp,brk))
```

Sono stati analizzati `r n` individui per investigare su `r nomex`. É riportata qui di seguito la distribuzione in classi espressa in frequenza relativa.

```{r 2}
kable((dat3[1:(k+1),c(1:2,4)]),booktabs=T,escape = F,linesep="")
```

`r item(T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
Ricordando che: 

- $n_j=f_j\cdot n$, 
- $b_j=x_{j+1}-x_{j}$, 
- $h_j=f_j/b_j\times 100$, 

si consiglia di mettere i dati in tabella:

```{r 3}
tabl(dat3[1:(k+1),c(1:7)])
```

```{r 4}
histp()
axis(1,brk)
axis(2)
```
:::

`r p=0.65; X<-dat2`
`r item()`   calcolare il valore approssimato del percentile  $`r p*100`$-esimo, e tracciarlo nell'istogramma.

:::{.sol data-latex=""}
```{r 5,results='asis'}
cat(percentile(p = p))
```

```{r 6}
histp()
axis(1,brk,las=2)
axis(2)
h.int(x1 = 0,x2 = Q.int(p),col=4,density=10)
axis(1,round(Q.int(p),4),las=2,col.axis=2)
text((min(brk)+Q.int(p))/2,2.5,paste(p*100,"%"),cex=3)
text((max(brk)+Q.int(p))/2,2.5,paste((1-p)*100,"%"),cex=3)
```
:::

`r item()` Qual è il numero di individui con `r nomex` superiore a 5.2?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \#(X>5.2) &=&  (f_4+f_5)\times n\\
            &=& (`r dat2$fj[4]`+`r dat2$fj[4]`)\times `r n`\\
            &=& `r sum(dat2$fj[4:5])*n`,\text{ o alternativamente}\\
            &=& (1-F_3)\times n\\
            &=& (1-`r dat2$Fj[3]`)\times `r n`\\
            &=& `r (1-dat2$Fj[3])*n`
\end{eqnarray*}
:::  

`r item()`   Analizzare la relazione tra media, mediana e moda alla luce del istogramma di densità.

:::{.sol data-latex=""}
È presente un'evidente asimmetria positiva (coda lunga a dx) e quindi

\[Moda>x_{0.5}>\bar x\]
:::

### Variante B 

```{r 7}
# Basic settings
set.seed(3)   # per ottenere sempre la stessa simulazione
n <- 250      # ampiezza campionaria
a <- 4
b <- 1
k <- 4
L <- 10
samp <- (rbeta(n,a,b)*L)
brk  <- round(L*qbeta((0:k)/(k),a,b),0)
k <- length(brk)-1
br1  <- brk[-(k+1)]
br2  <- brk[-1]
nomex <- "dati-x"
ls2e(stat_base(samp,brk))
```

Sono stati analizzati `r n` individui per investigare su `r nomex`. È riportata qui di seguito la distribuzione in classi espressa in frequenza assoluta.

```{r 01-descr-6}
tabl((dat3[1:(k+1),c(1:3)]))
```

`r item(T)`   Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
Ricordando che: 

- $f_j=n_j/n$, 
- $b_j=x_{j+1}-x_{j}$, 
- $h_j=f_j/b_j\times 100$, 

si consiglia di mettere i dati in tabella:

```{r 01-descr-7}
tabl((dat3[1:(k+1),c(1:7)]))
```
:::

`r p=0.25; X<-dat2`
`r item()`   calcolare il valore approssimato del percentile  $`r p*100`$-esimo, e tracciarlo nell'istogramma.

:::{.sol data-latex=""}
```{r 01-descr-1,,results='asis'}
cat(percentile(p = p))
```

```{r 01-descr-8}
histp()
axis(1,brk,las=2)
axis(2)
h.int(x1 = 0,x2 = Q.int(p),col=4,density=10)
axis(1,round(Q.int(p),4),las=2,col.axis=2)
text((min(brk)+Q.int(p))/2,2.5,paste(p*100,"%"),cex=3)
text((max(brk)+Q.int(p))/2,2.5,paste((1-p)*100,"%"),cex=3)
```
:::

`r item()`  Calcolare il numero di individui maggiori del 75-esimo percentile, $x_{0.75}$

:::{.sol data-latex=""}
Per definizione
\[
\%(X\le x_{0.75})=75\%
\]
e quindi
\[
\%(X> x_{0.75}) = 25%
\]
calcoliamo il 25% di $n=`r n`$ e otteniamo
\[
\#(X>x_{0.75})=`r n`\times 0.25=`r n*.25`
\]
:::

`r item()`   calcolare il valore approssimato della media aritmetica  $\bar x$ e della varianza $\sigma^2$.

:::{.sol data-latex=""}
Calcoliamo i valori medi delle classi $\bar x_j$, il loro quadrato $\bar x_j^2$ e li pesiamo con gli $n_j$
```{r 8}
tabl((dat3[1:(k+1),c(1:4,8:9)]))
```

e quindi
\[
\bar x= \frac 1n\sum_{j=1}^k\bar x_jn_j=\frac{`r sum(dat2$xn)`}{`r n`}=`r sum(dat2$xn)/n`
\]

e quindi
\[
\sigma^2= \frac 1n\sum_{j=1}^k\bar x_j^2n_j-\bar x^2=\frac{`r sum(dat2$x2n)`}{`r n`}-(`r sum(dat2$xn)/n`)^2=`r sum(dat2$x2n)/n-(sum(dat2$xn)/n)^2`
\]
:::

### Variante C

```{r 01-descr-2,,include=FALSE}
# Basic settings
set.seed(3)   # per ottenere sempre la stessa simulazione
n <- 200      # ampiezza campionaria
a <- 1
b <- 3
k <- 5
L <- 150
nomex <- "dati-x"
samp <- (rbeta(n,a,b)*L)
brk  <- round(L*qbeta((0:k)/(k),a,b),0)
k <- length(brk)-1
br1  <- brk[-(k+1)]
br2  <- brk[-1]
nomex <- "dati-x"
ls2e(stat_base(samp,brk))

sper <- paste("$x_{",round(dat2$Fj[-k],2),"}=",br2[-k],"$",sep="")

```

Sono stati analizzati `r n` individui per investigare su `r nomex`. Sono noti i percentili
`r sper`, il minimo è `r min(brk)`, il massimo è `r max(brk)`.

`r item(T)`   Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
Ricordando che: 

- $f_1=F_1$, $f_2=F_2-F_1$,...,$f_j = F_j-F_{j-1}$, 
- $b_j=x_{j+1}-x_{j}$, 
- $h_j=f_j/b_j\times 100$, 

si consiglia di mettere i dati in tabella:

```{r 01-descr-9}
tabl((dat3[1:(k+1),c(1:2,4:7)]),digits = c(0,0,3,0,4,2))
```

e infine disegnare il grafico

```{r 01-descr-10}
histp()
axis(1,brk,las=2)
axis(2)
```
:::

`r item()`   Calcolare le frequenze assolute

:::{.sol data-latex=""}
Ricordando che: 
\[
n_j=f_j\times n
\]

e mettendo in tabella, otteniamo

```{r 01-descr-11}
tabl((dat3[1:(k+1),c(1:2,4:3)]))
```
:::

`r item()`   Calcolare la percentuale approssimata di individui con `r nomex` inferiore a 45 

:::{.sol data-latex=""}
\begin{eqnarray*}
\%(X<45)   &\approx&  \%(X<39)+(45-39)\times h_4\\
&=& F_3\times 100+(45-39)\times `r dat2$hj[4]`\\
&=& `r dat2$Fj[3]`\times 100 + 6\times `r dat2$hj[4]`\\
&=& `r dat2$Fj[3]*100 + 6*dat2$hj[4]`\%
\end{eqnarray*}

graficamente

```{r 01-descr-12}
histp()
axis(1,brk,las=2)
axis(2)
h.int(x1 = 0,x2 = 45,col=4,density=10)
axis(1,45,las=2,col.axis=2)
text((min(brk)+45)/2,.4,paste(round(F.int(45),2)*100,"%"),cex=3)
text((max(brk)+45)/2,0.1,paste((1-round(F.int(45),2))*100,"%"),cex=3)
```
:::


`r item()`   Calcolare la percentuale approssimata di individui con `r nomex` compresa tra 45 e il 90-esimo percentile, $x_{0.90}$.

:::{.sol data-latex=""}
Per calcolare
\[
\%(45< X < x_{0.90})
\]
non c'è bisogno di calcolare $x_{0.90}$, infatti dal punto precedente sappiamo che

\begin{eqnarray*}
\%(X<45)   &\approx&  \%(X<39)+(45-39)\times h_4\\
&=& F_3+(45-39)\times `r dat2$hj[4]`\\
&=& `r dat2$Fj[3]`\times 100 + 6\times `r dat2$hj[4]`\\
&=& `r dat2$Fj[3]*100 + 6*dat2$hj[4]`\%
\end{eqnarray*}
dalla teoria sappiamo che
\[
\%(X<x_{0.90})=90\%
\]
e quindi
\begin{eqnarray*}
\%(45< X < x_{0.90}) &=& 90\%-`r dat2$Fj[3]*100 + 6*dat2$hj[4]`\%\\
                     &=& `r 90-(dat2$Fj[3]*100 + 6*dat2$hj[4])`\%
\end{eqnarray*}

graficamente

```{r 01-descr-13}
histp()
axis(1,brk,las=2)
axis(2)
h.int(x1 = 0,x2 = Q.int(.9),col="grey")
h.int(x1 = 0,x2 = 45,col=4,density=10)
axis(1,45,las=2,col.axis=2)
axis(1,Q.int(.9),expression(x[0.90]),col.axis=2)
text((min(brk)+45)/2,.1,paste(round(F.int(45),2)*100,"%"),cex=3)
text((Q.int(.9)+45)/2,.1,paste(90-round(F.int(45),2)*100,"%"),cex=3)
text((Q.int(.9)+max(brk))/2,.1,paste(10,"%"),cex=3)
```
:::



<div class="button-container"></div>

## Varianti con contesto (eserciziario)

```{r 01-descr-14}
# Basic settings
set.seed(12)   # per ottenere sempre la stessa simulazione
n <- 200      # ampiezza campionaria
a <- 5
b <- 1

brk  <- c(-.5,9.5,19.5,49.5, 99.5,249.5)
nnn  <- c( 40,60,50, 30,20)
nnn  <- round(nnn/sum(nnn)*n)
k <- length(brk)-1
br1  <- brk[-(k+1)]
br2  <- brk[-1]
vunif <- function(nnn, brk){
  k <- length(brk)-1
  br1  <- brk[-(k+1)]
  br2  <- brk[-1]
  xi   <- runif(nnn[1],br1[1],br2[1])
  for (i in 2:k)
    xi <- c(xi,runif(nnn[i],br1[i],br2[i]))
  return(xi)
}

samp <- round(vunif(nnn,brk),2)
nomex <- "Numero Addetti"

names(samp) <- nomex
ls2e(stat_base(samp,brk))

dat3$`$f_{j\\%}$` <- dat3$`$f_j$`*100
# kable((dat3[1:(k+1),c(1:2,7)])) %>%
# 
n <- length(samp)
```

### Esercizio: Conteggi 

La figura seguente riporta l'istogramma relativo a un campione
di 200 imprese classificate sulla base del numero di addetti
secondo le classi: $0-9$ addetti, $10-19$ addetti, $20-49$ addetti,
$50-99$ addetti, $100-249$ addetti.
Si noti che sull'asse delle ordinate è riportata la densità
percentuale. 

_Si noti che, a causa dell'ampiezza della scala dei valori, i dettagli dell'istogramma **non si leggono** sul grafico e, pertanto, non sono stati riportati gli estremi delle classi sull'asse delle ascisse, $X$, e i dati si evincono dal testo_

```{r 01-descr-15}
 plot(range(brk),range(c(0,dat3$`$h_j$`),na.rm = T),type="n",axes=F,xlab = nomex,ylab = "Denistà percentuale")
 rect(xleft = br1,ybottom = 0,xright = br2,ytop = dat3$`$h_j$`)
  axis(1,brk+.5,las=2)
 axis(2,round(dat3$`$h_j$`,3),las=2)
# kable((dat3[1:(k),c(1:2,6)])) %>%
#  
segments(0,dat2$hj,dat2$xinf,dat2$hj,lty=2)
```

:::{.sol data-latex=""}
Il testo fornisce una rappresentazione grafica.
Per rispondere alle domande successive occorre partire dalla
rappresentazione in una tabella di frequenze (relative o, come
conviene in questo caso, percentuali).
Si devono determinare, quindi, le aree dei rettangoli per ottenere
le percentuali di unità statistiche contenute nelle varie classi.
Si procede come segue:

Area Classi disgiunte | Ampiezza Classi congiunte | $\times$densità| frequenze perc.
-----------------|-------------------|----------------|--------------------
$A(  0- 9)$  |$=[  9,5 -(-0,5)]$ | $\times 2$ | $= 20\%$
$A( 10- 19)$ |$=[ 19,5 -  9,5)]$ | $\times 3$ | $= 30\%$
$A( 20- 49)$ |$=[ 49,5 - 19,5)]$ | $\times 0.833$ | $= 25\%$
$A( 50- 99)$ |$=[ 99,5 - 49,5)]$ | $\times 0.3$ | $= 15\%$
$A(100-249)$ |$=[249,5 - 99,5)]$ | $\times 0.066$ | $= 10\%$

A questo punto è possibile costruire la tabella della
distribuzione delle frequenze percentuali della $X$, numero
di addetti delle imprese.

```{r 01-descr-16}
tabl((dat3[1:(k),c(1:7)]))
```

La funzione di ripartizione è utile quando si devono determinare
la mediana (o la classe che la contiene) e/o la classe che contiene
un determinato percentile.
Un'altra definizione di percentile, infatti, utilizza la
funzione cumulata delle frequenze percentuali, $F_{\%; j}$.
Il percentile $p$-esimo è il "primo" valore della $x$,
indicato con $x_{p}$, nel quale la $F_{\%; j}(x_{p})$ è uguale
o supera il $(100 \times p)$%.
:::

`r item(T)` Qual è l'intervallo con il maggior numero di imprese?

:::{.sol data-latex=""}
L'intervallo $[10;\ 19]$.
:::

`r item()` Qual è il numero di imprese che hanno addetti
nella classe $[0,\, 9]$?

:::{.sol data-latex=""}
$f\left( 0 \vdash 10 \right) = \frac{10 \,\times\, 2} {100}\ 200 = 40$ (circa).
:::

`r item()` In quale classe si trova il 15$^{o}$ percentile?

:::{.sol data-latex=""}
Il 15$^{o}$ percentile si trova nella classe $[0;\, 9]$.
:::

`r item()` Qual è l'intervallo che contiene la mediana?

:::{.sol data-latex=""}
Il 50\% delle imprese è contenuto esattamente nelle prime due classi.
La mediana si trova dunque tra la fine dell'intervallo
$[10;\, 19]$ e l'inizio dell'intervallo $[20;\, 49]$.
Si potrebbe, quindi, dire che la mediana è 20?
No, perché non è noto come sono distribuite le imprese nella classe
$[20;\, 49]$; infatti, ipoteticamente, tutte le imprese della classe
potrebbero avere 49 addetti e, in tal caso la mediana sarebbe 49 o
la media tra 49 e 19.
:::

`r item()` In quale classe si trova il 75$^{o}$ percentile?

:::{.sol data-latex=""}
Il 75$^{o}$ percentile si trova nella classe $[50;\, 99]$.

NB: il 75\% della frequenza cumulata si trova proprio nella terza
classe $[20;\, 49]$; perciò un valore successivo potrebbe essere
il 75$^{o}$ percentile, per esempio 50.
Non si sa, come già detto per la mediana, se tra i dati vi sia
una impresa con 50 addetti e, dunque, si può solo dire che la
classe contenente il 75$^{o}$ percentile è la successiva.
:::


`r item()` Quale relazione ci si deve attendere
fra media e mediana per i dati proposti?

:::{.sol data-latex=""}
L'esame del grafico mostra che vi è una asimmetria a destra
(o positiva); pertanto, risulta (media$>$mediana); infatti, in
base ai dati dell'istogramma, eseguendo i calcoli si trova che
$\bar{x}=43$ e $x_{0,5}=20$.
:::

`r item()` Determinare il valore approssimato della mediana,
assumendo la distribuzione uniforme dei casi contenuti nella classe
che contiene la mediana.

:::{.sol data-latex=""}
`r p=0.5; X<-dat2`

```{r 01-descr-3,,results='asis'}
cat(percentile(p = p))
```
:::

`r item()` Definizione formale di percentile.

:::{.sol data-latex=""}
Il $p$-esimo percentile ($0 \le p\le 1$) del carattere $X$
è quel valore di $X$, indicato con $x_{p}$, tale che


\begin{eqnarray*}
p       &=& F(x_{p}) \\
p       &=& A(X < x_{p})      \qquad \mbox{Area\ totale\ uguale\ 1} \\
p \times 100 &=& \%(X < x_{p}) \qquad \mbox{Area\ totale\ uguale\ 100} 
\end{eqnarray*}
:::

### Esercizio Dati Continui


```{r 01-descr-17}
# Basic settings
set.seed(12)   # per ottenere sempre la stessa simulazione
n <- 3000      # ampiezza campionaria
a <- 5
b <- 1

brk  <- c(400,800,1200,1600,2000,3500)
nnn  <- c( 240,1110,930,600,120)
nnn  <- round(nnn/sum(nnn)*n)
k <- length(brk)-1
br1  <- brk[-(k+1)]
br2  <- brk[-1]
vunif <- function(nnn, brk){
  k <- length(brk)-1
  br1  <- brk[-(k+1)]
  br2  <- brk[-1]
  xi   <- runif(nnn[1],br1[1],br2[1])
  for (i in 2:k)
    xi <- c(xi,runif(nnn[i],br1[i],br2[i]))
  return(xi)
}

samp <- round(vunif(nnn,brk),2)
nomex <- "Numero Addetti"

names(samp) <- nomex

ls2e(stat_base(samp,brk))
dat3$`$f_{j\\%}$` <- dat3$`$f_j$`*100
# kable((dat3[1:(k+1),c(1:2,7)])) %>%
# 
n <- length(samp)
```

L'istogramma seguente mostra la distribuzione per
classi di cilindrata delle autovetture iscritte al Pubblico
Registro Automobilistico (dati aggiornati al 31/12/99;
fonte www.aci.it).
Il numero di autovetture censite è pari a 32027945; ma,
per comodità nei calcoli, il numero totale, $n$, è stato
posto pari a 3000.
Sopra ogni rettangolo è indicato il valore delle
densità di frequenza percentuale.

```{r 01-descr-18}
 plot(c(0,range(brk)[2]),range(c(0,dat3$`$h_j$`),na.rm = T),type="n",axes=F,xlab = nomex,ylab = "Denistà percentuale")
 rect(xleft = br1,ybottom = 0,xright = br2,ytop = dat3$`$h_j$`)
 axis(1,c(0,brk))
 axis(2,round(dat3$`$h_j$`,3),las=2)
# kable((dat3[1:(k),c(1:2,6)])) %>%
#  
segments(0,dat2$hj,dat2$xinf,dat2$hj,lty=2)

```

`r item(T)` Qual è la percentuale di autovetture comprese nella seconda classe?

:::{.sol data-latex=""} 
La seconda classe ha ampiezza pari a $1200 - 800 = 400$.
La densità percentuale è pari a 0.0925 e, quindi, la
percentuale di autoveicoli con cilindrata compresa in tale
intervallo è $0.0925 \times 400 = 37\%$. 
:::

`r item()` In quale classe cade la mediana?

:::{.sol data-latex=""} 
La percentuale di autoveicoli nella prima classe è
$0.02 \,\times\, 400 = 8\%$.
La percentuale di autoveicoli nella seconda classe è $37\%$.
La percentuale di autoveicoli nella terza classe è
$0.0775 \,\times\, 400 = 31\%$.
Dal momento che $8\% +37\% < 50\%$, mentre
$8\% +37\% +31\% > 50\%$, la mediana appartiene
alla terza classe, ovvero è compresa fra 1200cc e 1600cc. 
:::

`r item()` Determinare il valore approssimato della mediana,
assumendo la distribuzione uniforme dei casi contenuti
nella classe che contiene la mediana.

:::{.sol data-latex=""} 
Sia $m$ il numero della classe contenente la mediana: `r X<-dat2;p<-.5`

```{r 01-descr-4,,results='asis'}
cat(percentile(p = p))
```
:::

`r item()` Qual è la "classe modale" ?

:::{.sol data-latex=""} 
La "classe modale" è quella con la massima densità di frequenza
(il rettangolo con l'altezza maggiore) e corrisponde alla classe
800--1200 con una percentuale (seconda classe) pari a $37\%$.
In questo caso è anche la classe con la percentuale di più
alta; infatti, la percentuale di autoveicoli nella terza classe
è $0.0775 \,\times\, 400 = 31\%$.
Le altre classi hanno una percentuale inferiore, come si può
osservare considerando le unità di misura del grafico e i
relativi valori. 
:::

`r item()` Giulio ha una macchina con cilindrata pari a 625cc. Indicare la risposta corretta:

- $\Box \;$ l'auto di Giulio è molto potente, infatti meno del 9\% delle auto ha cilindrata inferiore 
- $\Box \;$ l'auto di Giulio è molto potente, infatti più del 90\% delle auto ha cilindrata inferiore 
- $\Box \;$ l'auto di Giulio è poco potente, infatti meno del 9\% delle auto ha cilindrata inferiore 
- $\Box \;$ l'auto di Giulio è poco potente, infatti più del 9\% delle auto ha cilindrata inferiore 

:::{.sol data-latex=""} 
l'auto di Giulio è poco potente, infatti meno del 9\% delle auto ha cilindrata inferiore 
:::

### Esercizio (variante 1) 


La distribuzione delle frequenze assolute della cilindrata
delle autovetture iscritte al Pubblico Registro Automobilistico
(dati aggiornati al 31/12/99; fonte www.aci.it) è riportata
nella tabella seguente.
Il numero di autovetture censite, per comodità è stato posto
pari a 3000 (decine di migliaia, si veda l'esercizio precedente).

```{r 01-descr-19}
kable((dat3[1:(k),1:3]),booktabs=T,escape = F,linesep="")
```

`r item(T)` Qual è la percentuale di autovetture comprese nella seconda classe?

:::{.sol data-latex=""} 
$f_{\%;\, 2} = 100 \,\times\, 1110/3000 = 37\%$. 
:::

`r item()` In quale classe cade la mediana?

:::{.sol data-latex=""} 
Per individuare la classe che contiene la mediana,
si cumulano le percentuali a partire dalla prima
classe e ci si arresta appena si supera il 50\%.
Per completezza e comodità si riporta la seguente
tabella che contiene le frequenze percentuali e le
frequenze percentuali cumulate, $F_{\%;\, j}$.

```{r 01-descr-20}
kable((dat3[1:(k),c(1:4,7)]),booktabs=T,escape = F,linesep="")
```

La classe che contiene la mediana è 120-160 perché in questa
la frequenza percentuale cumulata ha superato il 50%.

Si noti che un modo diverso di fornire i dati è riportare
nel grafico: le densità percentuali, $h_{\%;\, j}$, oppure
le densità di frequenza relativa, $h_{j}$; si ricordi che:

\begin{displaymath}
h_{j}       = \frac{f_{j}}  {x_{j+1} - x_{j}},  \qquad\qquad
h_{\%;\, j} = 100\ \frac{f_{j}}  {x_{j+1} - x_{j}}
            = \frac{f_{\%;\, j}} {x_{j+1} - x_{j}}\, .
\end{displaymath}

Si noti che in casi come questi, in cui si riportano le
frequenze assolute, $n_{j}$, occorre esaminare con attenzione
la leggenda dell'asse delle ordinate perché può capitare
che le $n_{j}$ si riportino direttamente sull'asse delle
ordinate.
:::

### Esercizio (variante 2)


La distribuzione delle frequenze relative della cilindrata
delle autovetture iscritte al Pubblico Registro Automobilistico
(dati aggiornati al 31/12/99; fonte www.aci.it) è riportata
nella tabella seguente.
Il numero di autovetture censite è pari a 320.27 centinaia
di migliaia ($10^{5}$).

```{r 01-descr-21}
kable((dat3[1:(k),c(1:2,4)]),booktabs=T,escape = F,linesep="")
```

`r item(T)` Disegnare l'istogramma (delle densità relative) della
distribuzione della cilindrata delle auto in circolazione.

:::{.sol data-latex=""} 
Per disegnare l'istogramma occorrono le altezze, $h_{i}$,
dei rettangoli da disegnare per ogni classe: i calcoli sono
riportati di séguito:


\begin{eqnarray*}
h_{j} &=& \frac{f_{j}} {b_{j+1} - b_{j}}                \\
h_{1} &=& \frac{0.08} { 800 -  400} =  0.0002   \\
h_{2} &=& \frac{0.37} {1200 -  800} =  0.000925 \\
h_{3} &=& \frac{0.31} {1600 - 1200} =  0.000775 \\
h_{4} &=& \frac{0.20} {2000 - 1600} =  0.000500 \\
h_{5} &=& \frac{0.04} {3500 - 2000} =  0.00002\bar{6} \, .
\end{eqnarray*}


Queste sono le altezze per disegnare i rettangoli nel grafico
sopra riportato.

Le altre domande possono essere simili alle precedenti.
:::

### Esercizio (variante 3) 


L'esame della distribuzione della cilindrata delle autovetture
iscritte al Pubblico Registro Automobilistico (dati aggiornati
al 31/12/99; fonte www.aci.it) ha fornito i seguenti dati:

-  l'$8^{o}$  percentile è  800cc,
- il $45^{o}$ percentile è 1200cc,
- il $76^{o}$ percentile è 1600cc,
- il $96^{o}$ percentile è 2000cc.

Il valore minino della cilindrata è 400cc e
il valore massimo è 3500cc.
Il numero di autovetture censite è pari a 3000
(dato di comodo, come detto in precedenza). 

Si noti che nel compito di esame i percentili sono spesso
espressi in simboli, come segue, dove, per semplificare,
si sono omesse le unità di misura e altre indicazioni
perché la corrispondenza tra i simboli e le espressioni
verbali sembra ovvia: 

- $x_{0.08}= 800$,
- $x_{0.45}= 1200$,
- $x_{0.76}= 1600$,
- $x_{0.96}= 2000$.

Il minimo e il massimo sono, rispettivamente,
$x_{\min}=$ 400 e $x_{\max}= 3500$.

`r item(T)` Disegnare l'istogramma (delle densità percentuali) della
distribuzione della cilindrata delle auto in circolazione.

:::{.sol data-latex=""} 
Per disegnare l'istogramma occorrono le altezze, $h_{j}$,
dei rettangoli da disegnare per ogni classe.
Per ottenere le altezze occorre determinare le percentuali di
autovetture in circolazione che appartengono alle corrispondenti
classi di cilindrata.
I dati del problema forniscono tutti i percentili, dai quali si
può ricavare le percentuali di ogni classe: perché si possa
procedere compiutamente occorre conoscere il minimo e il massimo
del carattere in oggetto.

- La prima classe va, dal minimo, $x_{(1)}$, all'$8^{o}$ percentile;
ossia, è  400-800cc. 
- La seconda classe va, dall'$8^{o}$ percentile al $45^{o}$ percentile;
ossia, è  800-1200cc. 
- La terza classe va, dal $45^{o}$ percentile al $76^{o}$ percentile;
ossia, è  1200-1600cc. 
- La quarta classe va, dal $76^{o}$ percentile al $96^{o}$ percentile;
ossia, è  1600-2000cc. 
- La quinta classe va, dal $96^{o}$ percentile al massimo, $x_{(n)}$;
- La settima classe va, dal $99^{o}$ percentile al massimo, $x_{(n)}$;
ossia, è  2000-3500cc. 

Per eseguire i calcoli si noti, poi, che il percentile rappresenta
la percentuale cumulata dei soggetti; per conoscere, quindi, la
percentuale di una classe occorre sottrarre al percentile
"corrente" il valore di quello della classe precedente:
\fbox{$f_{\%;\, j} = 100\, (F_{j} - F_{j-1})$}$\,$ oppure
\fbox{$f_{\%;\, j} = F_{\%;\, j} - F_{\%;\, j-1}$}$\,$ oppure ancora
\fbox{$f_{\%;\, j} = 100\, (p_{j} - p_{j-1})$}$\,$.
Le densità sono:

\begin{eqnarray*}
h_{j} &=& \frac{100\ (F_{j} - F_{j-1})} {b_{j+1} - b_{j}}
       =  \frac{f_{\%;\, j}} {b_{j+1} - b_{j}} \\
h_{\%;\, 1} &=& \frac{  8 -  0} { 800 -  400} =  0.0200     \\
h_{\%;\, 2} &=& \frac{ 45 -  8} {1200 -  800} =  0.0925     \\
h_{\%;\, 3} &=& \frac{ 76 - 45} {1600 - 1200} =  0.0775     \\
h_{\%;\, 4} &=& \frac{ 96 - 76} {2000 - 1600} =  0.0500     \\
h_{\%;\, 5} &=& \frac{100 - 96} {3500 - 2000} =  0.002\bar{6} \, .
\end{eqnarray*}

Queste sono le altezze per disegnare i rettangoli nel grafico
sopra riportato.
Si noti che nel calcolo delle percentuali di classe $f_{0}=0$
e $f_{J}=100$, dove $J$ è l'indice dell'ultima classe e,
quindi, il percentile di $x_{(n)}$ (il massimo).
In tabella:

```{r 01-descr-22}
tabl((dat3[1:(k),c(1:2,7,4,5,6)]))
```

e di cosegeunza otteniamo

```{r 01-descr-23}
 plot(c(0,range(brk)[2]),range(c(0,dat3$`$h_j$`),na.rm = T),type="n",axes=F,xlab = nomex,ylab = "Denistà percentuale")
 rect(xleft = br1,ybottom = 0,xright = br2,ytop = dat3$`$h_j$`)
 axis(1,c(0,brk))
 axis(2,round(dat3$`$h_j$`,3),las=2)
# kable((dat3[1:(k),c(1:2,6)])) %>%
#  
segments(0,dat2$hj,dat2$xinf,dat2$hj,lty=2)

```
:::

### Esercizio Dati non ordinati


Con riferimento a molti processi industriali, si usa il
termine "Work-In-Process" (spesso abbreviato con WIP).
Negli impianti di produzione dei libri, il WIP rappresenta
il tempo necessario per piegare, riunire, cucire, e rilegare
i fogli che provengono da una pressa.
I dati che seguono sono relativi ai tempi di lavorazione
(tempo, in giorni, che intercorre tra quando i libri vengono
stampati e quando sono impacchettati nei cartoni) per due
campioni di 20 libri estratti da due impianti di produzione
(D. M. Levine _et al_., 2000, _Business Statistics:
A First Course_, 2.nd Edition, Prentice-Hall. Tr. it. (2002),
_Statistica_, Apogeo, Milano, p. 126).

```{r 01-descr-24}
I1 <- c( 5.62  , 5.29  ,16.25  ,10.92  ,11.46  ,21.62  , 8.45  , 8.58  , 5.41  ,11.42 ,
11.62  , 7.29  , 7.50  , 7.96  , 4.42  ,10.50  , 7.58  , 9.29  , 7.54  , 8.92 )

I2 <- c(9.54  ,11.46  ,16.62  ,12.62  ,25.75  ,15.41  ,14.29  ,13.13  ,13.71  ,10.04,
 5.75  ,12.46  , 9.17  ,13.21  , 6.00  , 2.33  ,14.25  , 5.37  , 6.25  , 9.71)


stp <- (rbind(rbind(I1[1:10],I1[11:20]),rbind(I2[1:10],I2[11:20])))
row.names(stp)<- c("Impianto 1","","Impianto 2","")
kable(stp,booktabs=T,escape = F,linesep="",row.names = T)

```

Determinare:             

`r item(T)`  il campo di variazione,
`r item()` la mediana,
`r item()`  la media sapendo che la somma è pari a 187.64 per l'impianto A e 227.07 per l'impianto B.

:::{.sol data-latex=""} 
Per rispondere alle tre domande conviene ordinare prima i dati, come
riportato nella tabella seguente.

```{r 01-descr-25}
I1 <- sort(I1)

I2 <- sort(I2)

stp <- (rbind(rbind(I1[1:10],I1[11:20]),rbind(I2[1:10],I2[11:20])))
row.names(stp)<- c("Impianto 1","","Impianto 2","")
kable(stp,booktabs=T,escape = F,linesep="",row.names = T)

```

Il campo di variazione è dato dalla differenza tra il massimo osservato
e il minimo.


\begin{eqnarray*}
\mbox{CdV}(A) &=& x_{A;\, (n)} - x_{A;\, (1)} = 21.62 - 4.42 = 17.2 \,. \\
\mbox{CdV}(B) &=& x_{B;\, (n)} - x_{B;\, (1)} = 25.75 - 2.33 = 23.42 \,.
\end{eqnarray*}


a. Il campo di variazione dell'impianto A è più piccolo di quello di B.
Se le distribuzioni dei due insiemi di dati sono simili, allora ciò
comporta un minore variabilità dei dati (o della prestazione)
dell'impianto A.

b. La mediana per un numero di osservazioni pari è data da:


\begin{eqnarray*}
x_{A;\, 0.5} &=& \frac{1} {2}\ \left( x_{A;\, (n/2)} + x_{A;\, (n/2)+1} \right)
              =  \frac{8.45 + 8.58} {2} = 8.515 \,. \\
x_{B;\, 0.5} &=& \frac{1} {2}\ \left( x_{B;\, (n/2)} + x_{B;\, (n/2)+1} \right)
              =  \frac{11.46 + 12.46} {2} = 11.96 \,.
\end{eqnarray*}


La mediana dell'impianto A è inferiore a quella dell'impianto B,
che comporta presumibilmente una diversa dislocazione (o non
sovrapponibilità) dei due istogrammi.

c. La media è data da:


\begin{eqnarray*}
\bar{x}_{A} &=& \frac{187.64} {20} = 9.38 \,. \\
\bar{x}_{B} &=& \frac{227.07} {20} = 11.35 \,.
\end{eqnarray*}


Idem, come sopra: la media dell'impianto A è inferiore a quella
dell'impianto B, che comporta una diversa dislocazione (o non
sovrapponibilità) dei due istogrammi.
Tale esito mostra anche che l'impianto A è pi\'u efficiente
dell'impianto B perché A produce in un tempo medio inferiore
a quello di B. 
:::

`r item()`  $\,$il primo quartile,
`r item()`  $\,$il terzo quartile,
`r item()`  $\,$la differenza interquartile.

:::{.sol data-latex=""} 
Si ragiona sui dati ordinati sopra riportati. 

d.  Il primo quartile è dato dal valore della $X$ relativa
al soggetto nella posizione successiva a $\lfloor n\, p \rfloor =
\lfloor 20 \,\times\, 0.25 \rfloor = 5$, ossia $x_{A;\, 0.25} =
x_{A;\ (\lfloor n\, p \rfloor + 1)} = x_{A;\ (6)} = \textbf{7.50}$
e $x_{B;\, 0.25} = x_{B;\ (\lfloor n\, p \rfloor + 1)} =
x_{B;\ (6)} = \textbf{9.17}$.
Si noti che il simbolo $\lfloor \cdot \rfloor$ indica la parte
intera dell'argomento.
Tale regola è una approssimazione, adottata per semplificare
il procedimento; tuttavia, in questo caso, si può ottenere un
risultato pi\'u preciso.
Si tratta, infatti, di un numero divisibile per 4; pertanto, il
primo quartile sarà dato dalla media dei valori corrispondenti
ai soggetti 5.o e 6.o in graduatoria in modo da avere a sinistra
esattamente 5 soggetti (il 25\%) e a destra 15 soggetti (il 75\%):


\begin{eqnarray*}
x_{A;\, 0.25} &=& \frac{1} {2}\ \left( x_{A;\, (n/4)} + x_{A;\, (n/4)+1} \right)
               =  \frac{7.29 + 7.50} {2} = 7.395 \,. \\
x_{B;\, 0.25} &=& \frac{1} {2}\ \left( x_{B;\, (n/4)} + x_{B;\, (n/4)+1} \right)
               =  \frac{6.25 + 9.17} {2} = 7.71 \,.
\end{eqnarray*}

e.  Il terzo quartile è dato dal valore della $X$ relativa
al soggetto nella posizione successiva a $\lfloor n\, p \rfloor =
\lfloor 20 \,\times\, 0.75 \rfloor = 15$, ossia $x_{A;\, 0.75} =
x_{A;\ (\lfloor n\, p \rfloor + 1)} = x_{A;\ (16)} = \textbf{11.42}$
e $x_{B;\, 0.75} = x_{B;\ (\lfloor n\, p \rfloor + 1)} =
x_{B;\ (16)} = \textbf{14.25}$.
L'approssimazione è stata adottata, come già detto, per semplificare
il procedimento, ma, in questo caso, si può ottenere un risultato pi\'u
preciso perché si tratta di un numero divisibile per 4; pertanto, il terzo
quartile sarà dato dalla media dei valori corrispondenti ai soggetti 15.o
e 16.o in graduatoria in modo da avere a sinistra esattamente 15 soggetti
(il 75\%) e a destra 5 soggetti (il 15\%):


\begin{eqnarray*}
x_{A;\, 0.75} &=& \frac{1} {2}\ \left( x_{A;\, (3n/4)} + x_{A;\, (3n/4)+1} \right)
               =  \frac{10.92 + 11.42} {2} = 11.17 \,. \\
x_{B;\, 0.75} &=& \frac{1} {2}\ \left( x_{B;\, (3n/4)} + x_{B;\, (3n/4)+1} \right)
               =  \frac{13.71 + 14.25} {2} = 13.98 \,.
\end{eqnarray*}

f.  La differenza interquartile è data da:


\begin{eqnarray*}
DI_{A} &=& x_{A;\, 0.75} - x_{A;\, 0.25} = 11.17 - 7.395 = 3.775 \,. \\
DI_{B} &=& x_{B;\, 0.75} - x_{B;\, 0.25} = 13.98 - 7.71  = 6.27 \,.
\end{eqnarray*}
:::

`r item()` Calcolare la varianza, sapendo che
$\sum_{i=1}^{20} x_{A;\, i}^{2} = 2064.08$ e
$\sum_{i=1}^{20} x_{B;\, i}^{2} = 3077.31$. 
`r item()` Calcolare la deviazione standard.

:::{.sol data-latex=""} 

g.  Per determinare la varianza, che è il quadrato della deviazione
standard, si utilizza la formula che consente di ridurre gli errori
di arrotondamento.


\begin{eqnarray*}
\sigma_{A}^{2} &=& \frac{1} {n}\ \sum_{i=1}^{n} x_{i}^{2} - \bar{x}^{2}
                =  \frac{1} {20}\ 2064.08 - (9.38)^{2} = 15.18 \,. \\
\sigma_{B}^{2} &=& \frac{1} {n}\ \sum_{i=1}^{n} x_{i}^{2} - \bar{x}^{2}
                =  \frac{1} {20}\ 3077.31 - (11.35)^{2} = 24.96 \,.
\end{eqnarray*}

h.  Per la deviazione standard si ha:


\begin{eqnarray*}
\sigma_{A} &=& \sqrt{ \frac{1} {n}\ \sum_{i=1}^{n} x_{i}^{2} - \bar{x}^{2} }
            =  \sqrt{ \frac{1} {20}\ 2064.08 - (9.38)^{2} } = 3.90 \,. \\
\sigma_{B} &=& \sqrt{ \frac{1} {n}\ \sum_{i=1}^{n} x_{i}^{2} - \bar{x}^{2} }
            =  \sqrt{ \frac{1} {20}\ 3077.31 - (11.35)^{2} } = 5.00 \,.
\end{eqnarray*}


Idem, come sopra: la variabilità dei dati dell'impianto A è
inferiore a quella dell'impianto B, che comporta una maggiore
concentrazione dell'istogramma rafforzando le differenze (tra i
due impianti) già evidenziate. 
:::

`r item()`   La distribuzione è asimmetrica?
Se sì, di quale tipo di asimmetria si tratta?
`r item()`  Dalle risposte date, emergono differenze tra i due impianti?

:::{.sol data-latex=""} 
i.  La distribuzione dell'impianto A presenta una pronunciata
asimmetria a destra (obliqua a destra o positiva), mentre quella
dell'impianto B una minore asimmetria a sinistra (obliqua a sinistra
o negativa).
Per verificare numericamente questa affermazione si devono
confrontare le media e la mediana:


\begin{eqnarray*}
x_{A;\, 0.5} &=& 8.515\ <\ \bar{x}_{A}= 9.38 \quad\Rightarrow\quad
                 \mbox{obliqua (o asimmetrica) a destra} \\
x_{B;\, 0.5} &=& 11.96\ >\ \bar{x}_{B}= 11.35 \quad\Rightarrow\quad
                 \mbox{obliqua (o asimmetrica) a sinistra}\, .
\end{eqnarray*}


Si noti, tuttavia, che l'asimmetria a sinistra è poco evidente
perché lo scarto tra i due valori è solo di circa mezzo decimo
dell'unità, equivalente a circa il 5\% del valore della media.

j. Dalle risposte date si evincono alcune differenze:             

- la media dell'impianto A è inferiore di circa 2 punti;
- la variabilità dell'impianto A è inferiore di quella di B;
- l'asimmetria dell'impianto A è più pronunciata di quella di B.

Si può concludere che l'impianto A è più efficiente
dell'impianto B di circa due giorni e risulta anche più
"costante" nella produzione perché il tempo di produzione
presenta una variabilità inferiore.  
:::


<!--chapter:end:01-descr.Rmd-->

```{r prob_0, include=FALSE}

source("intro.R")
options(digits=5)

s2=1
n <-1
i1 <- 1


```


```{r 02-prob-1}
if (html) cat('')
```
  

# Esercizi di probabilità




<div class="button-container"></div>

## Due urne

Le scatole $A$ e $B$ contengono biglietti numerati.
La scatola $A$ contiene un biglietto contrassegnato
con il numero 1 e tre biglietti con il numero 0.
La scatola $B$ contiene tre biglietti contrassegnati
con il numero 1 e due con il numero 0.
Si effettua una estrazione da ognuna delle due scatole.

`r item()`  Calcolare la probabilità di ottenere due biglietti
con il numero 1.

:::{.sol data-latex=""}
Indichiamo con

- $A_0$ l'evento: esce 0 dall'urna $A$
- $A_1$ l'evento: esce 1 dall'urna $A$
- $B_0$ l'evento: esce 0 dall'urna $B$
- $B_1$ l'evento: esce 1 dall'urna $B$

Le due estrazioni danno origine a eventi tra loro
indipendenti e quindi

\begin{eqnarray*}
    P(A_1\cap B_1)
&=& P(A_1) P(B_1) \\
&=& \frac{1}{4} \times \frac{3}{5} = \frac{3}{20}.
\end{eqnarray*}
:::


`r item()` La probabilità che almeno uno dei biglietti sia
contrassegnato con il numero 1.

:::{.sol data-latex=""}
Si applica la regola dell'unione per eventi qualunque e si ha

\begin{eqnarray*}
    P(A_1 \cup B_1)
&=& P(A_1)+P(B_1)-P(A_1\cap B_1) \\
&=& \frac{1}{4}+ \frac{3}{5}-\frac{3}{20}
 =  \frac{14}{20}
 =  \frac{7}{10}  .
\end{eqnarray*}


Altro tipo di ragionamento o possibile soluzione: si applica la
regola del complementare all'evento C, _almeno uno dei biglietti sia contrassegnato con il numero 1_; 
infatti, il complementare di
C è _nessuno dei biglietti sia contrassegnato con il numero 1_.


\begin{eqnarray*}
    P(C)
&=& 1 - P(\overline{C}) \\
&=& 1 - \frac{3}{4}\ \frac{2}{5}
 =  \frac{14}{20}
 =  \frac{7}{10}  .
\end{eqnarray*}


Altro tipo di ragionamento (sconsigliato, in generale) è quello
di considerare tutti gli eventi possibili, l'evento _almeno una estrazione con uno_ è data da: 

- $C_{1}=A_1 \cap B_0$, unito a
- $C_{2}=A_0 \cap B_1$, unito a 
- $C_{3}=A_1 \cap B_1$.

L'evento C, _almeno uno dei biglietti sia contrassegnato con il numero 1_ è dato dall'unione dei tre eventi, tra loro
_incompatibili_


\begin{eqnarray*}
    P(C)
&=& P(C_{1} \cup C_{2} \cup C_{3}) \\
&=& P(C_{1}) + P(C_{2}) + P(C_{3}) \\
&=& \frac{1}{4}\ \frac{2}{5} + \frac{3}{4}\ \frac{3}{5} +
    \frac{1}{4}\ \frac{3}{5}
 =  \frac{14}{20}
 =  \frac{7}{10}  .
\end{eqnarray*}
:::

`r item(T)`  La probabilità che la somma dei numeri riportati sui
biglietti estratti sia 1.

:::{.sol data-latex=""}
L'evento \lq\lq la somma dei due biglietti è 1" può
essere scritta come

\begin{eqnarray*}
(A_1 \cup B_0) \cup (A_0 \cap B_1)
\end{eqnarray*}

e si ha

\begin{eqnarray*}
& & P[(A_1\cap B_0)\cup(A_0\cap B_1)] \\
&=& P(A_1\cap B_0) + P(A_0\cap B_1) \\
&=& P(A_1) P(B_0) + P(A_0) P(B_1) \\
&=& \frac{1}{4}\times \frac{2}{5} + \frac{3}{4}\times \frac{3}{5}
 =  \frac{11}{20}.
\end{eqnarray*}
:::



<div class="button-container"></div>

## Valigetta

`r i2 <-0`
La serratura a combinazione di una valigia è composta da tre cifre.
Per aprire la valigia occorre scegliere un numero tra 1 e 9 per
ciascuna cifra.
Si ha a disposizione cinque soli tentativi, verificando l'apertura
a ogni combinazione.


`r item(T)`  Qual è la probabilità di trovare la combinazione giusta
estraendo completamente a caso le tre cifre per un massimo di
cinque volte?

:::{.sol data-latex=""}
Il numero di combinazioni possibili è pari a $9^{3}= 729$
perché la stessa cifra si può ripetere nelle altre posizioni:
_disposizioni con ripetizione_.

$\#$  | tripletta
------|----------
 1    | 1,1,1
 2    | 1,1,2
 $\vdots$ | $\vdots$ 
 9    | 1,1,9
 10   | 1,2,1
 $\vdots$ | $\vdots$ 
 81   | 1,9,9
 82   | 2,1,1
$\vdots$ | $\vdots$ 
729   | 9,9,9

Per rispondere alla domanda si può costituire un'urna con
729 combinazioni e immaginare di estrarre da essa la
combinazione di ogni prova.

La stessa combinazione si può ripetere nella prova successiva
sicché l'esperimento è formato da estrazioni con reimmissione.
Sia $C_{i}$ l'evento "aprire" nell'$i$-esimo tentativo.
Sarà $\bar{C}_{i}$ l'evento complementare _non aprire_
nell'$i$-esimo tentativo.

Sia $B$ l'evento "aprire in almeno cinque prove".

__Soluzione diretta (lunga).__ 
L'evento $B$="aprire in almeno cinque prove" si può riscrivere come

\[
B=C_1\cup (\bar C_1\cap C_2)\cup (\bar C_1\cap \bar C_2\cap C_3) \cup (\bar C_1\cap \bar C_2\cap \bar C_3\cap C_4)\cup (\bar C_1\cap \bar C_2\cap \bar C_3\cap\bar C_4\cap C_5)
\]

che si legge: per aprire in almeno cinque tentativi:

- apro al primo $C_1$, oppure $\cup$
- non apro al primo e apro al secondo $(\bar C_1\cap C_2)$
- ...
- non apro al primo, non apro al secondo, ..., apro al quinto $(\bar C_1\cap \bar C_2\cap \bar C_3\cap\bar C_4\cap C_5)$

e quindi

\[\begin{array}{lll}
P(B)   &=&  P\Big(C_1\cup (\bar C_1\cap C_2) \cup (\bar C_1\cap \bar C_2\cap C_3)\cup \\
&& \qquad\cup(\bar C_1\cap \bar C_2\cap \bar C_3\cap C_4)\cup (\bar C_1\cap \bar C_2\cap \bar C_3\cap\bar C_4\cap C_5)\Big)\\
&=& P(C_1)+P(\bar C_1\cap C_2)+P(\bar C_1\cap \bar C_2\cap C_3)+\\
&&\qquad + P(\bar C_1\cap \bar C_2\cap \bar C_3\cap C_4)+P(\bar C_1\cap \bar C_2\cap \bar C_3\cap\bar C_4\cap C_5)\\
&=& P(C_1)+P(\bar C_1) P( C_2)+P(\bar C_1) P( \bar C_2) P( C_3)+ \\
&&\qquad+P(\bar C_1) P( \bar C_2) P( \bar C_3) P( C_4)+P(\bar C_1) P( \bar C_2) P( \bar C_3) P(\bar C_4) P( C_5)\\
&=& \frac 1{729} + \frac {728}{729}\frac {1}{729} + \left(\frac {728}{729}\right)^2\frac {1}{729}
+ \left(\frac {728}{729}\right)^3\frac {1}{729}+ \left(\frac {728}{729}\right)^4\frac {1}{729}\\
&=& `r sum((1/729)*(728/729)^(0:4))`
\end{array}\]
  
__Soluzione indiretta (corta).__ 
Il calcolo diventa facile se si applica la regola del complementare:
si calcola la probabilità dell'evento $\bar{B}$, "non aprire nei
cinque tentativi".

\begin{eqnarray*}
P(B)&=& 1 - P(\bar{B}) \\
    &=& 1 - P(\bar{C}_{1} \cap \bar{C}_{2} \cap \bar{C}_{3} \cap
              \bar{C}_{4} \cap \bar{C}_{5}) \\
    &=& 1 - P(\bar{C}_{1}) P(\bar{C}_{2}) P(\bar{C}_{3}) 
            P(\bar{C}_{4}) P(\bar{C}_{5}) \\
    &=& 1 - \left( \frac{728} {729} \right)^{5}
     =  1 - 0.99316 = 0.00684  .
\end{eqnarray*}
:::

`r item()`  Qual è la probabilità di trovare la combinazione giusta
estraendo completamente a caso le tre cifre per un massimo di
cinque volte tenendo conto delle combinazioni già provate?

:::{.sol data-latex=""}
Il numero di combinazioni possibili è pari a $9^{3}= 729$ (v. sopra).
Per rispondere alla domanda si costituisce sempre un'urna con 729
combinazioni e si estrae da essa la combinazione di ogni prova,
ma le combinazioni provate non vengono reimmesse nell'urna per
non ripescarle nei tentativi successivi.

Sia $C_{i}$ l'evento "aprire" nell'$i$-esimo tentativo.
Sia $\bar{C}_{i}$ l'evento complementare "non aprire"
nell'$i$-esimo tentativo.

__Soluzione diretta (lunga).__ 
L'evento $B$="aprire in almeno cinque prove" si può riscrivere come

\[
B=C_1\cup (\bar C_1\cap C_2)\cup (\bar C_1\cap \bar C_2\cap C_3)\cup (\bar C_1\cap \bar C_2\cap \bar C_3\cap C_4)\cup (\bar C_1\cap \bar C_2\cap \bar C_3\cap\bar C_4\cap C_5)
\]

che si legge: per aprire in almeno cinque tentativi:

- apro al primo $C_1$, oppure $\cup$
- non apro al primo e apro al secondo $(\bar C_1\cap C_2)$
- ...
- non apro al primo, non apro al secondo, ..., apro al quinto $(\bar C_1\cap \bar C_2\cap \bar C_3\cap\bar C_4\cap C_5)$

e quindi

\[\begin{array}{lll}
P(B)   &=&  P\Big(C_1\cup (\bar C_1\cap C_2) \cup (\bar C_1\cap \bar C_2\cap C_3)\cup \\
&& \qquad\cup(\bar C_1\cap \bar C_2\cap \bar C_3\cap C_4)\cup (\bar C_1\cap \bar C_2\cap \bar C_3\cap\bar C_4\cap C_5)\Big)\\
&=& P(C_1)+P(\bar C_1\cap C_2)+P(\bar C_1\cap \bar C_2\cap C_3)+\\
&&\qquad + P(\bar C_1\cap \bar C_2\cap \bar C_3\cap C_4)+P(\bar C_1\cap \bar C_2\cap \bar C_3\cap\bar C_4\cap C_5)\\
&=& P(C_1)+P(\bar C_1) P( C_2|\bar C_1)+P(\bar C_1) P( \bar C_2|\bar C_1) P( C_3|\bar C_1\cap \bar C_2)+ \\
&&\qquad+P(\bar C_1) P( \bar C_2|\bar C_1) P( C_3|\bar C_1\cap \bar C_2)P( C_4|\bar C_1\cap \bar C_2\cap\bar C_3)+\\
&&\qquad+P(\bar C_1) P( \bar C_2|\bar C_1) P( C_3|\bar C_1\cap \bar C_2)P( C_4|\bar C_1\cap \bar C_2\cap\bar C_3)\cdot\\
&&\qquad\quad\cdot P( C_5|\bar C_1\cap \bar C_2\cap\bar C_3\cap C_4)\\
&=& \frac 1{729} + \frac {728}{729}\frac {1}{728} + \frac {728}{729}\frac {727}{728}\frac {1}{727}+\frac {728}{729}\frac {727}{728}\frac {726}{727}\frac {1}{726}+\\
&&\qquad +\frac {728}{729}\frac {727}{728}\frac {726}{727}\frac {725}{726}\frac{1}{725}\\
&=&\frac 5{729}\\
&=& `r (5/729)`
\end{array}\]

__Soluzione indiretta (corta).__
Sia B l'evento "aprire in almeno cinque prove".
Il calcolo diventa facile se si applica la regola del complementare:
si calcola la probabilità dell'evento $\bar{B}$, "non aprire nei
cinque tentativi".

\begin{eqnarray*}
 P(B) &=& \\
&=& 1 - P(\bar{B})
 =  1 - P(\bar{C}_{1} \cap \bar{C}_{2} \cap \bar{C}_{3} \cap
          \bar{C}_{4} \cap \bar{C}_{5}) \\
&=& 1 - P(\bar{C}_{1}) P(\bar{C}_{2}  |  \bar{C}_{1})  
        P(\bar{C}_{3}  |  \bar{C}_{1}, \bar{C}_{2})  
        P(\bar{C}_{4}  |  \bar{C}_{1}, \bar{C}_{2}, \bar{C}_{3})  
        P(\bar{C}_{5}  |  \bar{C}_{1}, \bar{C}_{2}, \bar{C}_{3}, \bar{C}_{4}) \\
&=& 1 - \frac{728} {729}\ \frac{727} {728}\ \frac{726} {727}\ \frac{725} {726}\ \frac{724} {725}
 =  1 - 0.99314 = 0.00686  .
\end{eqnarray*}
:::



<div class="button-container"></div>

## Urna


Si supponga di estrarre a caso e SENZA reimmissione (ESR) 2 palline
da un'urna contenente 5 palline rosse e 10 palline gialle.
Si considerino gli eventi seguenti: 

- A={pallina rossa alla prima estrazione (colore qualsiasi alla seconda)},
- B={pallina rossa alla seconda estrazione (colore qualsiasi alla prima)},
- C={pallina gialla alla seconda estrazione (colore qualsiasi alla prima)}.

`r item(T)`    Quali sono le coppie di palline che formano l'unione
degli eventi A e B, ovvero $(A \cup B)$?


- $\Box$ Coppie contenenti due palline gialle.
- $\Box$ Coppie contenenti esattamente una pallina rossa.
- $\Box$ Coppie contenenti almeno una pallina rossa.
- $\Box$ Coppie contenenti due palline rosse.


:::{.sol data-latex=""}
Coppie contenenti almeno una pallina rossa
:::

`r item()`    Quali sono le coppie di palline che formano l'intersezione
degli eventi A e B, ovvero (A $\cap$ B)? 

- $\Box$ Coppie contenenti due palline gialle.
- $\Box$ Coppie contenenti al più una pallina rossa.
- $\Box$ Coppie contenenti almeno una pallina rossa.
- $\Box$ Coppie contenenti due palline rosse.

:::{.sol data-latex=""}
Coppie contenenti due palline rosse
:::

`r item()`    Qual è il complementare di C?

:::{.sol data-latex=""}
$\overline{C}=B$
:::

`r item()`    Calcolare la probabilità di C condizionata all'evento A, $P(C|A).$

:::{.sol data-latex=""}
Noto che A si è verificato, nell'urna rimangono 14 palline di cui 4 sono rosse
e 10 sono gialle: $P(C|A)= 10/14 = 0.714.$
:::






<div class="button-container"></div>

## Applicazione regole

La probabilità dell'evento A è 1/3.
La probabilità dell'evento B è 1/2.
I due eventi sono indipendenti.

`r item(T)`    Calcolare P($\overline{B}$).

:::{.sol data-latex=""}
P($\overline{B}$)= 1 - P(B)=1/2
:::

`r item()`    Calcolare  la probabilità che si verifichi B,
dato che A si è verificato.

:::{.sol data-latex=""}
Dal momento che i due eventi sono indipendenti, la probabilità
condizionata coincide con la probabilità semplice.
In alternativa si può procedere al calcolo nel modo seguente: 

\[P({B}|A)= \frac{P(B \cap A)}{P(A)} = \frac{P(B) \times P(A)}{P(A)} = P({B}) =1/2\]
:::

`r item()`    I due eventi sono incompatibili?

:::{.sol data-latex=""}
No, perché ${P(A \cap B)}$ = ${P(A) \times P(B)}$ =1/3 $\times$ 1/2 = 1/6 $\neq$ 0.
:::

 



<div class="button-container"></div>

## Studente

Uno studente arriva a un esame avendo studiato 20 dei 25
argomenti del corso.
L'insegnante gli pone 3 domande su argomenti diversi e
l'esame è superato solo se tutte le risposte sono giuste.

`r item(T)`    Qual è la probabilità che lo studente
superi l'esame al primo appello?

:::{.sol data-latex=""}
Per superare l'esame lo studente deve conoscere tutte e
tre gli argomenti richiesti.
Tale problema equivale a estrarre tre palline da un'urna
che ne contiene 25 (di cui 20 di colore verde -- argomenti noti --
e 5 di colore rosso -- argomenti non studiati).
Dal momento che si specifica che le tre domande sono relative a
argomenti diversi, le estrazioni delle tre palline devono essere
effettuate SENZA reimmissione.
In questo caso lo studente deve estrarre
tre palline verdi in tre estrazioni.
La probabilità cercata è data da

\[
P(\mbox{conoscere tutte e tre le risposte})=
\frac{20}{25} \times \frac{19}{24} \times \frac{18}{23} = 0.49565  .
\]
:::

`r item()`    Qual è la probabilità che lo studente superi
l'esame nella prima sessione (in cui ci sono tre appelli)?
Si assuma che gli eventi "superamento dell'esame" siano
indipendenti, anche se l'assunto non è realistico.

:::{.sol data-latex=""}
__Soluzione diretta (lunga).__
Sia $A_{i}$ la probabilità di superare l'esame nell'$i$-esimo
appello e $\bar{A}_{i}$ è la probabilità di non superarlo.
L'evento $B$, superare entro il terzo appello, si può scomporre come

\[B=A_1\cup(\bar A_1\cap A_2)\cup(\bar A_1\cap\bar A_2\cap A_3)\]

e quindi

\begin{eqnarray*}
  P(B) &=& P(A_1\cup(\bar A_1\cap A_2)\cup(\bar A_1\cap\bar A_2\cap A_3))\\
       &=& P(A_1)+P(\bar A_1\cap A_2)+P(\bar A_1\cap\bar A_2\cap A_3)\\
       &=& P(A_1)+P(\bar A_1)P( A_2)+P(\bar A_1)P(\bar A_2)P( A_3)\\ 
       &=& 0.49565+(1-0.49565)\times 0.49565 + (1-0.49565)^2\times 0.49565\\
       &=& `r 0.49565+(1-0.49565)* 0.49565 + (1-0.49565)^2* 0.49565`
\end{eqnarray*}

__Soluzione indiretta (corta).__
La probabilità di superare l'esame entro la sessione, evento $B$
si calcola facilmente applicando la regola del complementare nel
quale $\bar{B}$ è la probabilità di non superare l'esame nella
sessione:

\begin{eqnarray*}
P(B) &=& 1- P(\bar{B})
      =  1- P(\bar{A}_{1} \cap \bar{A}_{2} \cap \bar{A}_{3}) \\
     &=& 1- P(\bar{A}_{1}) P(\bar{A}_{2}  |  \bar{A}_{1}) 
            P(\bar{A}_{3}  |  \bar{A}_{1}, \bar{A}_{2}) \\
     &=& 1- \left( 1-0.49565 \right)^{3} = 1 - 0.12829= 0.87171  .
\end{eqnarray*}
:::




<div class="button-container"></div>

## Giulio e il treno

Giulio deve prendere il treno, ma non ha molto tempo: per
raggiungere la stazione decide di aspettare l'autobus che
arriverà puntualmente (evento $A$) con probabilità pari a 0.7.
Arrivato in stazione puntualmente, riuscirà a salire sul
treno evitando la multa del controllore se non troverà
coda alla biglietteria (evento $B$).
Questo accade con probabilità pari a 0.5.

`r item(T)`    Calcolare la probabilità che Giulio non debba pagare
la multa (evento $C$).

:::{.sol data-latex=""}
Giulio sale sul treno senza prendere la multa solo se simultaneamente
si verificano due eventi (indipendenti): l'autobus è puntuale
(evento $A$) e non c'è coda in biglietteria (evento $B$).
La probabilità cercata si ottiene allora applicando la regola del
prodotto (per eventi indipendenti):

\begin{eqnarray*}
P(C) &=& P(A \cap B) = P(A) P(B) = 0.7 \times 0.5 = 0.35  .
\end{eqnarray*}
:::

`r item()`    Calcolare la probabilità che Giulio in tre giorni
diversi riesca a evitare almeno una multa (evento $D$).

:::{.sol data-latex=""}
La probabilità di evitare almeno una multa in tre giorni si
può calcolare ricorrendo alla regola del complementare.
L'evento $D$ si ottiene dalle diverse combinazioni dell'evento
$C_{i}$ e $\bar{C}_{i}$ giornalieri.

La probabilità di $C_{i}$ è stata calcolata in precedenza.
Il complementare di $D$, è $\bar{D}$ che indica l'evento
"paga sempre la multa", allora si ha

\begin{eqnarray*}
P(D) &=& 1 - P(\bar{D})
      =  1 - P(\bar{C}_{1} \cap \bar{C}_{2} \cap \bar{C}_{3}) \\
     &=& 1 - P(\bar{C}_{1}) P(\bar{C}_{2}) P(\bar{C}_{3})
      =  1 - (1- 0.35) (1- 0.35) (1- 0.35) \\
     &=& 1-0.274625 = 0.725375  .
\end{eqnarray*}
:::




<div class="button-container"></div>

## Somma di due dadi

Si lancia una coppia di dadi.

`r item(T)`    Costruire il supporto.

:::{.sol data-latex=""}
Il supporto della coppia di VC, si ottiene con una tabella a
doppia entrata, nella quale sulle righe si mettono i risultati
del primo dado ($D1$) e sulle colonne si mettono i risultati
del secondo dado ($D2$).

```{r 02-prob-2}
out <- outer(1:6,1:6,function(x,y) paste("$\\fbox{",x,"},\\fbox{",y,"}$",sep=""))
row.names(out) <- paste("$D_1=",1:6,"$",sep="")
colnames(out) <- paste("$D_2=",1:6,"$",sep="")

# kable(out,booktabs=T,escape = F,linesep="")
# 
# tw <- two_way(1:6,1:6,numeric(6)+1,numeric(6)+1,EV = F)

```


Lo spazio $\Omega$ consiste di 36 _combinazioni equiprobabili_.
:::

`r item()`    Determinare la probabilità di un
punto del supporto.

:::{.sol data-latex=""}
Presa una qualunque coppia ($\fbox{4}$, $\fbox{2}$),
i due eventi sono "fisicamente" _indipendenti_ sicché

\[
    P(\fbox{4}  ,\ \fbox{2})
= P(\fbox{4}) P(\fbox{2}) = \frac{1} {6}  \times  \frac{1} {6}
= \frac{1} {36}
\]


La risposta era anche intuitiva perché gli eventi di $\Omega$
sono equiprobabili: 1/36.
:::

`r item()`    Qual è la probabilità che la somma dei punteggi sia 9?

:::{.sol data-latex=""}
Si può procedere al conteggio degli eventi che danno somma, $S$, pari a 9:

\[
P(S=9) = 4  \times  \frac{1} {36} = \frac{1} {9}
\]

Si noti che la probabilità di avere 3 è

\begin{eqnarray*}
    P(\text{un dado $\fbox{2}$ e un dado $\fbox{1}$})
&=& P\left( (\lbrace \fbox{2}\rbrace \cap \lbrace \fbox{1}\rbrace) \cup
            (\lbrace \fbox{1}\rbrace \cap \lbrace \fbox{2}\rbrace)
    \right) \\
&=& P(\fbox{2}\ \fbox{1}) + P(\fbox{1}\ \fbox{2}) = \frac{2} {36}   .
\end{eqnarray*}

Nell'evento non si è specificato l'ordine con cui devono uscire
i due dadi $\Rightarrow$ bisogna considerare le diverse possibilità.
Si noti, poi, che gli eventi $\{\fbox{2}\ \fbox{1}\}$ e
$\{\fbox{1}\ \fbox{2}\}$ sono tra loro _incompatibili_:
si verifica l'uno _o_ (esclusivo -- XOR) si verifica l'altro.
:::

`r item()`    Qual è la probabilità che la somma ($S$)
dei punteggi di due dadi sia minore di quattro?

:::{.sol data-latex=""}
Si tratta della somma di eventi incompatibili: $\{S=2\}$ _e_ $\{ S=3 \})$:

\begin{eqnarray*}
P(S<4) &=& P(\{S=2\} \cup \{ S=3 \})
        =  P(\{S=2\}) + P(\{ S=3 \}) \\
       &=& \frac{1} {36} + \frac{2} {36} = \frac{1} {12}   .
\end{eqnarray*}
:::

`r item()`    Calcolare la probabilità che la SOMMA ($S$)
dei punteggi di due dadi sia pari a sette oppure
uno dei dadi sia pari a sei ($U6$).

:::{.sol data-latex=""}

\begin{eqnarray*}
P(S=7) &=& P(\{\fbox{1}\ \fbox{6}\} \cup  \cdots \cup \{\fbox{6}\ \fbox{1}\})
        =  \frac{6} {36} \\
P(U=6) &=& P(\{\fbox{1}\ \fbox{6}\} \cup  \cdots \cup \{\fbox{6}\ \fbox{1}\})
        = \frac{11} {36} \\
       &:& \{ S=7 \}\quad e \quad \{ U=6 \}\quad \mbox{non sono incompatibili}
           \quad\rightarrow \\[0.2cm]
           P(\{ S=7 \} \cup \{ U=6 \})
       &=& P(\{ S=7 \}) +  P(\{ U=6 \}) - P(\{ S=7 \} \cap \{ U=6 \}) \\
       &=& \frac{6} {36} + \frac{11} {36} - \frac{2} {36}
        =  \frac{15} {36} \qquad \mbox{infatti} \quad\rightarrow    \\
           P(\{ S=7 \} \cap \{ U=6 \})
       &=& \{ \fbox{1}\ \fbox{6} \} \cup \{ \fbox{6}\ \fbox{1} \}
           \qquad \mbox{tra loro incompatibili}   .
\end{eqnarray*}

Dati DUE eventi $A$ e $B$, la probabilità dell'UNIONE ($A\cup B$)
è uguale alla somma delle probabilità dei singoli eventi, MENO
la probabilità della loro intersezione

\[
P(A \cup B) = P(A) + P(B) - P(A \cap B)  .
\]


Se $A$ e $B$ sono incompatibili, allora
$A \cap B = \emptyset \Rightarrow P(A \cap B)=P(\emptyset)=0$. \\
:::




<div class="button-container"></div>

## Scatola e biglietti

La scatola $A$ contiene 4 biglietti numerati da 1 a 4.
La scatola $B$ contiene 3 biglietti numerati da 2 a 4.
Si estrae un biglietto da ognuna delle scatole e si indica
con $A_{1}$ il valore del biglietto estratto dalla scatola $A$ e
con $B_{1}$ quello della scatola $B$.

`r item(T)`    Ricavare la distribuzione di probabilità di $X=A_{1}+B_{1}$.

:::{.sol data-latex=""}
Lo spazio campionario dell'esperimento considerato è costituito
da $4\times 3=12$ coppie equiprobabili di biglietti:

\begin{eqnarray*}
\{(1,2); (1,3); (1,4); (2,2); (2,3); (2,4); (3,2); (3,3); (3,4); (4,2); (4,3); (4,4)\}.
\end{eqnarray*}

Sommando i due termini di ogni coppia si ricava facilmente
che la distribuzione di probabilità di $X$ è

```{r 02-prob-3}
out <- outer(1:4,2:4,function(x,y) paste("$",x+y,";\\frac 1{12}$",sep=""))
row.names(out) <- paste("$A_1=",1:4,"$",sep="")
colnames(out) <- paste("$B_2=",2:4,"$",sep="")

kable(out,booktabs=T,escape = F,linesep="")
```

da cui la probabilità di $X$

```{r 02-prob-4}
xy <- expand.grid(1:4,2:4)
X <- cbind(rowSums(xy))
X <- table(X)/12

kable(X,booktabs=T,escape = F,linesep="")
```
:::

`r item()`    Calcolare la probabilità dell'evento $\{A_{1}>B_{1}\}$.

:::{.sol data-latex=""}
Dallo spazio campionario presentato nel punto (a)
si vede che il valore del primo biglietto è superiore
a quello del secondo solo in $3$ delle $12$ coppie
e quindi $P(A_{1}>B_{1})=1/4$.

```{r 02-prob-5}
out <- outer(1:4,2:4,function(x,y) paste("$",(x>y)+0,";\\frac 1{12}$",sep=""))
row.names(out) <- paste("$A_1=",1:4,"$",sep="")
colnames(out) <- paste("$B_2=",2:4,"$",sep="")

kable(out,booktabs=T,escape = F,linesep="") 
```
:::

`r item()`    Si ripete l'esperimento 10 volte reinserendo i biglietti
estratti nelle rispettive scatole dopo ogni estrazione.
Calcolare la probabilità che il valore del biglietto della
scatola $A$ sia superiore a quello della scatola $B$ in meno
di 4 delle 10 estrazioni.

:::{.sol data-latex=""}
Ad ogni ripetizione dell'esperimento la probabilità che
il biglietto estratto da $A$ riporti un valore superiore
a quello del biglietto estratto da $B$ è 1/4.
Il numero di volte che questo evento si verifica in 10
replicazioni indipendenti dell'esperimento è un numero
aleatorio $S$, distribuito secondo una binomiale,
$S\sim \mbox{Bin}(10;  1/4)$; quindi, la probabilità
cercata è

\[
P(S<4)
= \sum_{i=0}^{3} \binom{10}{i} (0.25)^{i} (1-0.25)^{10-i}
= 0.776  .
\]
:::




<div class="button-container"></div>

## Urna con colori e lettere diverse

Un'urna contiene 3 palline rosse timbrate con $\color{red}{\mbox{A}}$, 2 palline rosse timbrate con $\color{red}{\mbox{B}}$, 1 palline rossa timbrate con $\color{red}{\mbox{C}}$, 2 palline verdi timbrate con $\color{green}{\mbox{A}}$, una verde con $\color{green}{\mbox{B}}$, una verde con $\color{green}{\mbox{C}}$, una nera con $\color{black}{\mbox{A}}$ e una nera con $\mbox{C}$. 
In tabella

```{r 02-prob-6}
Y <- data.frame(v1 = c("Rosso","Verde","Nero","Tot"),A = c(3,2,1,6),B = c(2,1,0,3),C=c(1,1,1,3),Tot=c(6,4,2,12))


kable(Y,booktabs = T, escape = F,linesep = "", digits = 4,col.names = c("","A","B","C","Tot"))%>%
  column_spec(column = 1,border_right = T,bold = T)%>%
  column_spec(column = 5,border_left =  T,bold = T)%>%
  row_spec(row = 3,hline_after = T)%>%
  row_spec(4,bold = T)

```

`r i2 <- 1;item(T) ` Calcolare la probabilità di estrarre una pallina Rossa

:::{.sol data-latex=""}
Sia 
\[
R = \text{estraggo Rosso}
\]
\[
P(R)=\frac6{12}=0.5
\]
:::

`r item() ` Calcolare la probabilità di estrarre una pallina timbrata con $\mbox{A}$

:::{.sol data-latex=""}
Sia 
\[
A = \text{estraggo una pallina timbrata con $\mbox{A}$}
\]
\[
P(A)=\frac6{12}=0.5
\]
:::

`r item() ` Gli eventi $A$ ed $R$ sono indipendenti?

:::{.sol data-latex=""}
Sì, in quanto
\[
P(A\cap R)=\frac1{4}=\frac12\cdot\frac12=P(A)P(R)
\]
e quindi
\[
P(A|R)=\frac{P(A\cap R)}{P(R)}=\frac{\frac{1}{4}}{\frac12}=\frac 12= P(A)
\]
e viceversa
\[P(R|A)=\frac{P(A\cap R)}{P(A)}=\frac{\frac{1}{4}}{\frac12}=\frac 12= P(R)\]
:::

`r item() ` Calcolare la probabilità di estrarre una pallina verde

:::{.sol data-latex=""}
Sia 
\[
V = \text{estraggo una pallina verde}
\]
\[
P(V)=\frac4{12}=\frac13
\]
:::

`r item() ` Gli eventi $V$ ed $R$ sono indipendenti?

:::{.sol data-latex=""}
__NO__ $V$ e $R$ sono __incompatibili__, se la pallina è uscita verde __non__ può essere rossa

\[
P(V\cap R)=P(\emptyset)=0
\]
:::

`r item() ` Gli eventi $V$ ed $A$ sono indipendenti?

:::{.sol data-latex=""}
Sì, in quanto
\[
P(V\cap A)=\frac2{12}=\frac13\cdot\frac12=P(V)P(A)
\]
e quindi
\[
P(V|A)=\frac{P(V\cap A)}{P(A)}=\frac{\frac{1}{3}}{\frac12}=\frac 12= P(V)
\]


_Interpretazione_ Sapere se la pallina estratta è targata con A non cambia il nostro stato informativo 
sul colore, viceversa, sapere il colore non cambia il nostro stato informativo sul fatto che sia timbrata A.
:::

`r item() ` Calcolare $P(N)$ (probabilità di estrarre nera) e $P(B)$ (probabilità di estrarre una pallina timbrata con B)

:::{.sol data-latex=""}
\begin{eqnarray*}
P(N)   &=&  \frac2{12}=\frac16\\
P(B)   &=& \frac3{12}
\end{eqnarray*}
:::

`r item() ` Gli eventi $B$ ed $N$ sono indipendenti?

:::{.sol data-latex=""}
__NO__ $B$ e $N$ sono __incompatibili__, se la pallina è uscita nera __non__ può essere timbrata con B

\[P(B\cap N)=\frac0{12}=0\]
:::

`r item() ` Gli eventi $C$ (estrarre una pallina con C) ed $N$ sono indipendenti?

:::{.sol data-latex=""}
__No__, in quanto
\[
P(C)=\frac3{12}=\frac14
\]
mentre
\[
P(C\cap N)=\frac1{12}\neq \frac{3}{12}\cdot\frac2{12}=P(C)P(N)
\]
e quindi
\[
P(C|N)=\frac12\neq\frac14=P(C)
\]
:::

`r item() ` Gli eventi $B$ ed $N$ sono incompatibili?

:::{.sol data-latex=""}
__No__, in quanto
\[
P(C\cap N)=\frac1{12}\neq 0
\]
:::



<div class="button-container"></div>

## Urne che portano ad altre urne

Si consideri il seguente gioco: si estrae una dall'urna $U$ che contiene 2 palline Rosse e una pallina Bianca:
\small

- __se__ esce Rossa si estrae da un'urna che ha 3 palline marcate con A e 1 pallina marcata con B
- __se__ esce Bianca si estrae da un'urna che ha 1 pallina marcata con A e 1 pallina marcata con B

\rm

`r i2 <- 1;item()` Qual è la probabilità di osservare una pallina marcata con A?

:::{.sol data-latex=""}
Anzitutto osserviamo che
\begin{eqnarray*}
  P(R) &=&  \frac23\\
  P(B) &=& \frac13
\end{eqnarray*}

e che
  
\begin{eqnarray*}
  P(A|R) &=&  \frac34\\
  P(A|B) &=& \frac12
\end{eqnarray*}

e quindi

\begin{eqnarray*}
  P(A) &=&  P(R)P(A|R)+P(B)P(A|B)\\
   &=& \frac23\frac34+\frac13\frac12\\
   &=& \frac23\\
   &=& `r 2/3*3/4+1/3*1/2`
\end{eqnarray*}
:::

`r item(T)` Sapendo che è uscita una pallina marcata con A, qual è la probabilità che all'inizio del gioco sia stata estratta la pallina Rossa?

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(R|A)  &=&  \frac{P(A\cap R)}{P(A)}\\
          &=&  \frac{P(R)P(A|R)}{P(A)}\\
          &=&  \frac{\frac23\frac34}{\frac23}\\
          &=&  \frac34\\
          &=& `r (2/3*3/4)/(2/3)`
\end{eqnarray*}
:::



<div class="button-container"></div>

## Estrazioni con e senza reintroduzione

Un'urna contiene 3 palline Rosse, 2 Bianche e 5 Verdi, 

`r i2 <- +1;item(T)` si estrae 3 volte __con__ reintroduzione.
Calcolare la probabilità di aver 3 colori diversi

:::{.sol data-latex=""}
Anzitutto notiamo che l'evento
\[
E=\text{“tre colori diversi”}
\]
si scompone come
\begin{eqnarray*}
  E     &=&  (R\cap B\cap V)\cup(R\cap V\cap B)\cup\\
        &=&  (B\cap E\cap V)\cup(B\cap V\cap R)\cup\\
        &=&  (V\cap R\cap B)\cup(V\cap B\cap R)
\end{eqnarray*}
e quindi
\begin{eqnarray*}
  P(E)  &=& P(R\cap B\cap V)+P(R\cap V\cap B)+\\
        &=& P(B\cap E\cap V)+P(B\cap V\cap R)+\\
        &=& P(V\cap R\cap B)+P(V\cap B\cap R)
\end{eqnarray*}

notiamo che le estrazioni sono tra di loro __indipendenti__ e quindi

\begin{eqnarray*}
  P(E)  &=& P(R)P(B)P(V)+P(R)P(V)P(B)+\\
        &=& P(B)P(R)P(V)+P(B)P(V)P(R)+\\
        &=& P(V)P(R)P(B)+P(V)P(B)P(R)\\
        &=& \frac2{10}\frac5{10}\frac3{10}+\frac2{10}\frac3{10}\frac5{10}+...\\
        &=& 6 \cdot \frac2{10}\frac5{10}\frac3{10}\\
        &=& `r 6*2*5*3/1000`
\end{eqnarray*}

:::: {.nota data-latex=""}
$6=3!$ è il numero di modi in cui posso mescolare i tre colori
::::
:::

`r item()` si estrae 3 volte __senza__ reintroduzione.
Calcolare la probabilità di aver 3 colori diversi.

:::{.sol data-latex=""}
in questo caso le estrazioni __non__ sono tra di loro __indipendenti__ e quindi

\begin{eqnarray*}
  P(E)  &=& P(R)P(B|R)P(V|R\cap B)+P(R)P(V|R)P(B|R\cap V)+\\
        &=& P(B)P(R|B)P(V|B\cap R)+P(B)P(V|B)P(R|B\cap V)+\\
        &=& P(V)P(R|V)P(B|R\cap V)+P(V)P(B|V)P(R|V\cap B)\\
        &=& \frac2{10}\frac5{9}\frac3{8}+\frac2{10}\frac3{9}\frac5{8}+...\\
        &=& 6 \cdot \frac2{10}\frac5{9}\frac3{8}\\
        &=& `r 6*2/10*5/9*3/8`
\end{eqnarray*}

:::: {.nota  data-latex=""}
anche se sono tra di loro dipendenti ogni sequenza la stessa probabilità:
::::

\begin{eqnarray*}
 P(R)P(B|R)P(V|R\cap B)&=&P(R)P(V|R)P(B|R\cap V)\\
        &=& P(B)P(R|B)P(V|B\cap R)\\
        &=& P(B)P(V|B)P(R|B\cap V)\\
        &=& ...\\
        &=& \frac2{10}\frac5{9}\frac3{8}\\
        &=& `r 2/10*5/9*3/8`
\end{eqnarray*}
:::



<div class="button-container"></div>

## Urne e palline numerate

L'urna $A$ contiene una pallina col numero $\mbox{-1}$, due palline col numero $\mbox{0}$
e una pallina col numero $\mbox{+1}$. 
L'urna $B$ contiene una pallina col numero $\mbox{0}$, una col numero $\mbox{+1}$
e una col numero $\mbox{+2}$.

`r i2 <- 1;item()` Sia $S$ consideri la somma dei numeri estratti, calcolare la probabilità che
$S=0$.

:::{.sol data-latex=""}
Si consideri la tabella
```{r prob_n}
a <- c(-1,0,1)
pa <- c(1,2,1)/4
b <- 0:2
pb <- c(1,1,1)/3
y <- cbind(paste("$",b,"$",sep=""), outer(a,b,FUN = function(x,y)paste("$",x+y,"$",sep="")))
py <- outer(pa,pb)
Y <- matrix(nrow = 3,ncol = 8)

Y[,c(1,3,5,7)]<- y

Pa <- paste("$\\color{blue}{",c(1,2,1),"/4","}$",sep="")
Pb <- paste("$\\color{blue}{",c(1,1,1),"/3","}$",sep="")

Pab <- matrix(paste("$\\color{red}{",outer(c(1,1,1),c(1,2,1)),"/{12}}$",sep=""),nrow = 3)

Y[,2] <- Pb
Y[,c(4,6,8)]<- Pab
kable(Y,booktabs = T, escape = F,linesep = "", digits = 4,col.names = c("B $\\backslash$ A","","$-1$",Pa[1],"$0$",Pa[2],"$+1$",Pa[3]),align = "r")%>%
  column_spec(column = 2,border_right = T)

```

per colonna leggiamo le possibili numerazioni dell'urna $A$, con le rispettive probabilità in blu,
per riga leggiamo le possibili numerazioni dell'urna $B$, con le rispettive probabilità in blu,
nella tabella leggiamo le possibili somme dell'urna $A$ e $B$, con le rispettive probabilità in rosso.
Gli eventi che portano la somma ad essere zero sono due e quindi:

\[
P(S=0)=\frac 1{12}+\frac 2{12}=\frac 16
\]
:::

`r item(T)` Calcolare la probabilità che dall'urna $A$ sia uscito $\mbox{+1}$, __dato__ che
la somma fa 1

:::{.sol data-latex=""}
Anzitutto notiamo che
\[
P(S=1)=\frac1{12}+\frac2{12}+\frac1{12}=\frac13
\]

poi osserviamo che
\[
P(S=1\cap A=\mbox{+1})=\frac1{12}
\]

e quindi
\[
P(S=1|A=\mbox{+1})=\frac{P(S=1\cap A=\mbox{+1})}{P(S=1)}=\frac{\frac{1}{12}}{\frac13}=\frac14
\]
:::




<!--chapter:end:02-prob.Rmd-->

```{r 03-VC-1,, include=FALSE}

source("intro.R")
```


```{r 03-VC-3}
if (html) cat('')
```
  
# Esercizi Di Probabilità e Variabili Casuali



<div class="button-container"></div>

## Esercizio 1
  
Il numero di veicoli al casello autostradale $C$ è la **somma** del numero di veicoli che provengono dalla strada $S_1$ e dalla strada $S_2$. All'ora di punta di un giorno feriale, il numero di veicoli $X_1$ sulla strada $S_1$ è descritto da un Poisson di parametro 4.3,  $X_1\sim\text{Pois}(4.3)$, mentre il numero di veicoli $X_2$ sulla strada $S_2$ è descritto da un Poisson di parametro 2.1,  $X_2\sim\text{Pois}(2.1)$, $X_1$ e $X_2$ sono assunte indipendenti.

`r item(T)` (**Punti 14**) Calcolare la probabilità di avere al massimo 2 automobili al casello $C$.

:::{.sol data-latex=""} 
$X_1\sim\text{Pois}(4.3)$ e $X_2\sim\text{Pois}(2.1)$ e quindi

\[
X=X_1+X_2\sim\text{Pois}(4.3+2.1)
\]
 
per cui

\begin{eqnarray*}
P(X\le 2) &=& P(X=0\ \cup X=1 \ \cup X=2) \\
          &=& P(X=0)+P(X=1)+P(X=2)\\
          &=& \frac{6.4^0}{0!}e^{-6.4}+\frac{6.4^1}{1!}e^{-6.4}+\frac{6.4^2}{2!}e^{-6.4}\\
          &=& `r paste(round(dpois(0:2,6.4),4),collapse="+")`\\
          &=& `r sum(round(dpois(0:2,6.4),4))`
\end{eqnarray*}
:::

  `r item()` (**Punti 3**) Qual è la varianza della VC che conta il 
  numero di automobili al casello $C$?

:::{.sol data-latex=""} 
Se 
\[X=X_1+X_2\sim\text{Pois}(6.4)\]

Allora
\[
V(X)=6.4
\]
:::

`r item()` (**Punti 3**) Se $X\sim\text{Binom}(15,0.3)$, qual è il supporto di $X$?

:::{.sol data-latex=""} 
Se Se $X\sim\text{Binom}(15,0.3)$, il suo supporto è
\[S_X=\{0,1,2,...,15\}\]
:::

`r item()` (**Punti 2**) Se $X\sim N(0,1)$ e $Y\sim \chi^2_5$, 
  $X$ e $Y$ indipendenti, come si distribuisce 
  \[W=\frac X {\sqrt{Y/5}} ~~~?\]


:::{.sol data-latex=""} 
Se $X\sim N(0,1)$ e $Y\sim \chi^2_5$, 
  $X$ e $Y$ indipendenti, allora
  \[W=\frac X {\sqrt{Y/5}} \sim t_5\]
:::



<div class="button-container"></div>

## Esercizio 2

```{r 03-VC-4}
s1 <- 0.55
s2 <- 0.85

```

Un portafoglio finanziario è composto da due titoli. Il rendimento del titolo $A$ è descritto da una normale $X_A\sim N(0.6,(`r s1`)^2)$, il rendimento del titolo $A$ è descritto da una normale $X_B\sim N(0.8,(`r s2`)^2)$, $X_A$ e $X_B$ sono considerate indipendenti. Il rendimento del portafoglio è dunque la somma dei rendimenti
\[
X=X_A+X_B
\]

`r item(T)` (**Punti 14**) Calcolare la probabilità di avere un rendimento negativo.


:::{.sol data-latex=""} 
$X_A\sim N(0.6,(`r s1`)^2)$ e $X_B\sim N(0.8,(`r s2`)^2)$ sono indipendenti e quindi:

\[
X=X_A+X_B\sim N(0.6+0.8,(`r s1`)^2+(`r s2`)^2)\sim N(`r 0.6+0.8`,`r (s1)^2+(s2)^2`)
\]

per cui

```{r 03-VC-5}
x0 <- 0
mm <- 0.6+0.8
ss <- (s1)^2+(s2)^2
vnam <- "X"
options(digits = 4,nsmall=10)
z <- round((0-mm)/sqrt(ss),2)
p <- pnorm(z)

```

```{r 03-VC-2,, results='asis'}
cat(norm_int(x1 = x0,verso = "<",mm = mm,ss = ss))
```
:::


  `r item()` (**Punti 3**) Sotto ipotesi di indipendenza tra gli anni, qual è la probabilità che il portafoglio abbia rendimento negativo per 3 anni di seguito?


:::{.sol data-latex=""} 
Sia $N_i$ l'evento:
\[
N_i = \text{il portafoglio è negativo nell'anno $i$}, \ i=1,...,3
\]
sia $E$ l'evento
\[
E=\text{rendimento negativo 3 anni di seguito}
\]
è immediato che
\[
E=N_1\cap N_2\cap N_3 
\]
e dunque
\begin{eqnarray*}
P(E)&=&P(N_1\cap N_2\cap N_3 )\\
    &=&P(N_1)P(N_2)P(N_3)\\
    &=& `r p`\times `r p`\times `r p`\\
    &=& `r p`^3\\
    &=& `r p^3`
\end{eqnarray*}
:::




  `r item()` (**Punti 3**) Se $X\sim\text{Pois}(15.3)$, qual è la varianza di $X$?


  
:::{.sol data-latex=""}
Se Se $X\sim\text{Pois}(\lambda=15.3)$, allora
\[V(X)=\lambda=15.3\]
:::


`r item()` (**Punti 2**) Se $X_1\sim N(0,1)$, $X_2\sim N(0,1)$ e $X_2\sim N(0,1)$ 
  $X_1$, $X_2$ e $X_3$ indipendenti, come si distribuisce 
  \[W=X_1^2+X_2^2+X_3^2 ~~~?\]



:::{.sol data-latex=""}
Se $X_1\sim N(0,1)$, $X_2\sim N(0,1)$ e $X_2\sim N(0,1)$ 
  $X_1$, $X_2$ e $X_3$ indipendenti, allora   
  \[W=X_1^2+X_2^2+X_3^2\sim \chi_3^2\]
(si distribuisce come un chi quadro con 3 gradi di libertà)
:::




<div class="button-container"></div>

## Esercizio 3

```{r 03-VC-6}
s1 <- 0.55
s2 <- 0.85

```

 L'urna $A$ contiene 3 bussolotti rossi e 7 blu. Si estrae $n=6$ volte con reintroduzione

`r item(T)` (**Punti 14**) Qual è la probabilità di avere almeno 2 bussolotti rossi su 6 estrazioni?



:::{.sol data-latex=""}
Sia $X$ la VC che conta il numero di bussolotti rossi in 6 estrazioni con reintroduzione,
quindi $n=6$ replicazioni di una Bernoulli $X_i\sim\mbox{Ber}(\pi=3/10)$ e quindi

\[
X=X_1+...+X_n\sim\mbox{Binom}(n=6,\pi=0.3)
\]

la probabilità di avere almeno 2 bussolotti rossi su 6 estrazioni è

\begin{eqnarray*}
P(X\ge 2)&=& 1- P(X<2)\\
&=&1-\left(\binom{6}{0}\left(0.3\right)^0 \left(1-0.3\right)^{6-0}+\binom{6}{1}\left(0.3\right)^1 \left(1-0.3\right)^{6-1}\right)\\
&=&1-\left(1\cdot 1 \cdot `r (0.7)^6`+6\cdot`r 0.3`\cdot `r (0.7)^5`\right)\\
&=&1-(`r dbinom(0,6,0.3)`+`r dbinom(1,6,0.3)`)\\
&=&`r 1-dbinom(0,6,0.3)-dbinom(1,6,0.3)`
\end{eqnarray*}
:::

`r item()` (**Punti 3**) Quali sono valore atteso e varianza della VC che conta il numero di palline Rosse su 6 estrazioni con reintroduzione dall'urna $A$?



:::{.sol data-latex=""}
Sia $X$ la VC che conta il numero di bussolotti rossi in 6 estrazioni con reintroduzione,
quindi $n=6$ replicazioni di una Bernoulli $X_i\sim\mbox{Ber}(\pi=3/10)$ e quindi

\[
X=X_1+...+X_n\sim\mbox{Binom}(n=6,\pi=0.3)
\]

E quindi

\[E(X)=n\pi=6\cdot\frac 3{10}=1.8,\qquad V(X)=n\pi(1-\pi)=6\cdot\frac 3{10}\frac 7{10}=1.26\]
:::

`r item()` (**Punti 3**) Se $X\sim N(\mu_X,\sigma_X^2)$ e $Y\sim N(\mu_Y,\sigma_Y^2)$, come si distribuisce 
  \[W=X-Y ~~~?\]

:::{.sol data-latex=""}
Se $X\sim N(\mu_X,\sigma_X^2)$, $Y\sim N(\mu_Y,\sigma_Y^2)$,  allora

\[X-Y\sim N(\mu_X-\mu_Y,\sigma_X^2+\sigma_Y^2)\]

**se e solo se** $X$ e $Y$ sono indipendenti.
:::

  `r item()` (**Punti 2**) Si lancia una moneta perfetta ($P(T)=P(C)=\frac 12$).
  Se esce Testa di estrae 1 volta con dall'urna $A$ che contiene contiene 3 bussolotti rossi e 7 blu. 
  Se esce Croce di estrae 1 volta con dall'urna $B$ che contiene contiene 2 bussolotti rossi e 8 blu. 
  Qual è la probabilità che alla fine dell'esperimento esca un bussolotto rosso?

:::{.sol data-latex=""}
Se esce Testa
\[
P(\mbox{Rosso}|T)=\frac{3}{7+3}=0.3
\]

Se esce Croce
\[
P(\mbox{Rosso}|C)=\frac{2}{8+2}=0.2
\]
Dato che
\[
P(T)=P(C)=\frac 12
\]
allora
\begin{eqnarray*}
\mbox{Rosso}&=& (T~\cap~\mbox{Rosso})~\cup~ (C~\cap~\mbox{Rosso})\\
P(\mbox{Rosso})&=&P((T~\cap~\mbox{Rosso})~\cup~ (C~\cap~\mbox{Rosso}))\\
&=&P(T~\cap~\mbox{Rosso})~+~ P(C~\cap~\mbox{Rosso})\\
&=&P(T)P(\mbox{Rosso}|T)+P(C)P(\mbox{Rosso}|C)\\
&=&\frac 12\cdot 0.3+\frac 12 \cdot 0.2\\
&=&`r (.3+.2)/2`
\end{eqnarray*}
:::



<div class="button-container"></div>

## Esercizio 4

```{r 03-VC-7}

```


L'urna $U$ contiene tre palline bianche, tre palline rosse e tre palline nere. 

`r i2 <- 1;item(T)` (**Punti 14**) Si estrae $n=2$ volte __senza__ reintroduzione. Qual è la probabilità di ottenere due colori diversi in 2 estrazioni? (esempio: prima bianco poi rosso _oppure_ prima nero poi bianco oppure...)  

:::{.sol data-latex=""}
L'evento 
\[E=\text{due colori diversi in 2 estrazioni}\]

l'evento complementare di $E$ è $\bar E$ due palline di uguale colore, ed è dato da
\begin{eqnarray*}
\bar E&=& (B_1\cap R_2)\cup(R_1\cap B_2)\cup\\
& &(B_1\cap N_2)\cup (B_1\cap R_2)\cup\\
& &(R_1\cap N_2)\cup (N_1\cap R_2)
\end{eqnarray*}
e quindi

\begin{eqnarray*}
P(E)&=& P(B_1\cap R_2)+P(R_1\cap B_2)+\\
& &P(B_1\cap N_2)+ P(N_1\cap B_2)+\\
& &P(R_1\cap N_2)+ P(N_1\cap R_2)\\
&=&P(B_1)P(R_2|B_1)+P(R_1)P(B_2|R_1)+\\
&&P(B_1)P(N_2|B_1)+P(N_1)P(B_2|N_1)+\\
&&P(R_1)P(N_2|R_1)+P(R_1)P(B_2|N_1)\\
&=& \frac 39\frac 28+ \frac 39\frac 28+\\
&&  \frac 39\frac 28+ \frac 39\frac 28+\\
&&  \frac 39\frac 28+ \frac 39\frac 28\\
&=&4\cdot\frac 16=`r 4/6`
\end{eqnarray*}
:::

`r item()` (**Punti 3**) Si ricompone l'urna $U$ e si estrae una volta, si assegna 

- 1 all'evento esce bianca  
- 2 all'evento esce rossa
- 3 all'evento esce nera

Calcolare valore atteso e varianza della Variabile Casuale che registra il numero uscito.

:::{.sol data-latex=""}

\begin{eqnarray*}
P(X=1)&=& \frac 39\\
P(X=2)&=& \frac 39\\
P(X=2)&=& \frac 39
\end{eqnarray*}
e quindi

\begin{eqnarray*}
E(X)&=& 1\cdot\frac 13 +2\cdot\frac 13 +3\cdot\frac 13 =2\\
V(X)&=& 1^2\cdot\frac 13 +2^2\cdot\frac 13 +3^2\cdot\frac 13 - 2^2=`r mean((1:3)^2)-2^2`
\end{eqnarray*}
:::

`r item()` (**Punti 3**) La varianza di una VC $X$ può essere zero?

:::{.sol data-latex=""}
Sì, se e solo se $X$ assume un valore costante $x$ per certo, $P(X=x)=1$
:::

`r item()` (**Punti 2**) Se $X\sim\text{Bin}(10;0.3)$ e $Y\sim\text{Pois}(3.23)$,
$X$ e $Y$ indipendenti, quanto vale $V(X-Y)$?

:::{.sol data-latex=""}
Siccome $X$ e $Y$ sono indipendenti
\[
V(X-Y)=V(X)+V(Y)=n\pi(1-\pi)+\lambda=10\times 0.3(1-0.3)+3.23=`r 10*.3*.7+3.23`
\]
:::


<div class="button-container"></div>

## Esercizio sul Teorema di Bayes

```{r 03-VC-8}

```


Michele esegue la seguente sequenza di estrazioni:

- si estrae da un'urna $U_1$ che contiene 5 palline etichettate da 1 a 5
- Se il numero uscito è
  -  1 allora si fissa $\pi=0$
  -  2 allora si fissa  $\pi=0.25$
  -  3 allora si fissa  $\pi=0.50$
  -  4 allora si fissa  $\pi=0.75$
  -  5 allora si fissa  $\pi=1.00$
- Quindi prepara un'urna $U_2$ che ha come proporzione $\pi$ di palline vincenti ed estrae,
con reintroduzione 3 volte dall'urna.

Quando Sergio arriva Michele ha estratto da $U_2$ e ha ottenuto 2 palline vincenti su 3 estrazioni.

`r item(T)` Qual è la probabilità di Sergio su $X=2$?


:::{.sol data-latex=""}

Sia $X$ la VC che conta il numero di successi in 3 prove dall'urna $U_2$.
Sappiamo che $X\sim\text{Binom}(3,\pi)$, e il parametro $\pi$ dipende dall'estrazione dell'urna $U_1$ e quiindi

\begin{eqnarray*}
  P(X=2|\pi) &=&  \binom{3}{2}\pi^2(1-\pi)^{3-2}\\
                 &=&  3\cdot \pi^2\cdot (1-\pi)^2
\end{eqnarray*}

che possiamo calcolare per ogni valore di $\pi\in\{0,0.25,0.50,0.75,1\}$.
Mentre la probabilità che dall'urna uno abbiamo un 3 è uno su cinque che equivale a dire che
\[
P(\pi=0)=P(\pi=0.25)=P(\pi=0.5)=P(\pi=0.75)=P(\pi=1)=\frac 15
\]

Applichiamo il teorema delle probabilità totali per ricavare
$P(X=2)$

\begin{eqnarray*}
\scriptsize P(X=2)  &=&  \scriptsize P(\pi=0)P(X=2|\pi=0)+P(\pi=0.25)P(X=2|\pi=0.25)+P(\pi=0.5)P(X=2|\pi=0.5)+\\
        &+& \scriptsize P(\pi=0.75)P(X=2|\pi=0.75)+P(\pi=1)P(X=2|\pi=1)\\
 &=&  \scriptsize \frac 15 3\cdot 0^2 (1-0)^{3-2} + \frac 15 3\cdot 0.25^2 (1-0.25)^{3-2} + \frac 15 3\cdot 0.5^2 (1-0.5)^{3-2}+\\
 &+&  \scriptsize \frac 15 3\cdot 0.75^2 (1-0.75)^{3-2} + \frac 15 3\cdot 1^2 (1-1)^{3-2}\\
 &=& \scriptsize `r sum(dbinom(2,3,c(0,.25,.5,.75,1)))/5`
\end{eqnarray*}
:::

`r item()` Qual è la probabilità di Sergio che dall'urna $U_1$ sia stata estratta la palline etichettata con 3?

:::{.sol data-latex=""}

Sia $X$ la VC che conta il numero di successi in 3 prove dall'urna $U_2$.
Condizionato all'ipotesi $\pi=0.50$ abbiamo:
\begin{eqnarray*}
  P(X=2|\pi=0.5) &=&  \binom{3}{2}0.5^2(1-0.5)^{3-2}\\
                 &=&  3\cdot 0.25\cdot 0.5\\
                 &=&  `r dbinom(2,3,.5)`
\end{eqnarray*}
Mentre la probabilità che dall'urna uno abbiamo un 3 è uno su cinque che equivale a dire che
\[
P(\pi=0.5)=\frac 15
\]

In virtù del teorema di Bayes abbiamo che
\begin{eqnarray*}
P(\pi=0.5|X=2)   &=&  \frac{P(\pi=0.5)P(X=2|\pi=0.5)}{P(X=2)}\\
                 &=&  \frac{\frac 15 \cdot `r dbinom(2,3,.5)`}{`r sum(dbinom(2,3,c(0,.25,.5,.75,1)))/5`}\\
                 &=& `r dbinom(2,3,.5)/sum(dbinom(2,3,c(0,.25,.5,.75,1)))`
\end{eqnarray*}
:::

`r item()` Qual è distribuzione aggiornata su $\pi$ in base al fatto che $X=2$?

:::{.sol data-latex=""}

\begin{eqnarray*}
P(\pi=0|X=2)   &=&  \frac{P(\pi=0)P(X=2|\pi=0)}{P(X=2)}\\
                 &=&  \frac{\frac 15 \cdot `r dbinom(2,3,0)`}{`r sum(dbinom(2,3,c(0,.25,.5,.75,1)))/5`}\\
                 &=& `r dbinom(2,3,0)/sum(dbinom(2,3,c(0,.25,.5,.75,1)))`\\
P(\pi=0.25|X=2)   &=&  \frac{P(\pi=0.25)P(X=2|\pi=0.25)}{P(X=2)}\\
                 &=&  \frac{\frac 15 \cdot `r dbinom(2,3,0.25)`}{`r sum(dbinom(2,3,c(0,.25,.5,.75,1)))/5`}\\
                 &=& `r dbinom(2,3,0.25)/sum(dbinom(2,3,c(0,.25,.5,.75,1)))`\\
P(\pi=0.5|X=2)   &=&  \frac{P(\pi=0.5)P(X=2|\pi=0.5)}{P(X=2)}\\
                 &=&  \frac{\frac 15 \cdot `r dbinom(2,3,.5)`}{`r sum(dbinom(2,3,c(0,.25,.5,.75,1)))/5`}\\
                 &=& `r dbinom(2,3,.5)/sum(dbinom(2,3,c(0,.25,.5,.75,1)))`\\
P(\pi=0.75|X=2)   &=&  \frac{P(\pi=0.75)P(X=2|\pi=0.5)}{P(X=2)}\\
                 &=&  \frac{\frac 15 \cdot `r dbinom(2,3,.75)`}{`r sum(dbinom(2,3,c(0,.25,.5,.75,1)))/5`}\\
                 &=& `r dbinom(2,3,.75)/sum(dbinom(2,3,c(0,.25,.5,.75,1)))`\\
P(\pi=1|X=2)   &=&  \frac{P(\pi=1)P(X=2|\pi=1)}{P(X=2)}\\
                 &=&  \frac{\frac 15 \cdot `r dbinom(2,3,1)`}{`r sum(dbinom(2,3,c(0,.25,.5,.75,1)))/5`}\\
                 &=& `r dbinom(2,3,1)/sum(dbinom(2,3,c(0,.25,.5,.75,1)))`
\end{eqnarray*}
:::

`r item()` Costruire le distribuzioni condizionate di $X$ a $\pi$. 

:::{.sol data-latex=""}

Siccome 

\begin{eqnarray*}
  P(X=x|\pi) &=&  \binom{3}{x}\pi^x(1-\pi)^{n-x}
\end{eqnarray*}

è nota per ogni valore di $x\in\{0,1,2,3\}$ e ogni valore di $\pi\in\{0,0.25,0.5,0.75,1\}$ allora è possibile costruire una
tavola doppia entrata dove mettiamo $\pi$ per riga e $x$ per colonna

```{r 03-VC-9}
pig <- (0:4)/4
sn  <- (0:3)
LX  <- round(outer(pig,sn,function(p,x)dbinom(x,3,p)),3)
TX <- LX
RX <- c(rowSums(LX)*0+1)
TTX <- cbind(TX,RX)

dimnames(TTX)[[1]] <- c(paste("$\\pi=",pig,"$",sep=""))
dimnames(TTX)[[2]] <- c(paste("$x=",sn,"$",sep=""),"Tot")

kable(TTX,row.names = T,booktabs = T, escape = F,linesep = "", digits = 3)
```
:::

`r item()` Costruire la distribuzione doppia **congiunta** di tutte le possibili combinazioni e le relative probabilità.

:::{.sol data-latex=""}
Siccome 

\begin{eqnarray*}
  P(X=x|\pi) &=&  \binom{3}{x}\pi^x(1-\pi)^{n-x}\\
  P(\pi)      &=& \frac 15,\qquad \forall \pi\\
  P(X=x\cap\pi) &=& P(\pi)P(X=x|\pi)
\end{eqnarray*}

è nota per ogni valore di $x\in\{0,1,2,3\}$ e ogni valore di $\pi\in\{0,0.25,0.5,0.75,1\}$ allora è possibile costruire una
tavola doppia entrata dove mettiamo $\pi$ per riga e $x$ per colonna

```{r 03-VC-10}
pig <- (0:4)/4
sn  <- (0:3)

LX  <- round(outer(pig,sn,function(p,x)dbinom(x,3,p)),3)
con <- LX/5
TX <- matrix(paste("$\\frac 15\\times",LX,"$ $=",round(con,3),"$",sep=""),5)
RX <- round(c(rowSums(LX)/5),3)
CX <- c(colSums(LX)/5,1)
TTX <- rbind(cbind(TX,RX),CX)

dimnames(TTX)[[1]] <- c(paste("$\\pi=",pig,"$",sep=""),"Tot")
dimnames(TTX)[[2]] <- c(paste("$x=",sn,"$",sep=""),"Tot")

kable(TTX,row.names = T,booktabs = T, escape = F,linesep = "", digits = 4)
```

Sommando per riga abbiamo la distribuzione di $\pi$, sommando per colonna abbiamo
quella di $X$.
:::

`r item()` Costruire le distribuzioni condizionate di $\pi$ ad $X$. 

:::{.sol data-latex=""}

Siccome 

\begin{eqnarray*}
  P(X=x|\pi) &=&  \binom{3}{x}\pi^x(1-\pi)^{n-x}\\
  P(\pi)      &=& \frac 15,\qquad \forall \pi\\
  P(X=x\cap\pi) &=& P(\pi)P(X=x|\pi)\\
  P(\pi|X=x) &=& \frac{P(\pi)P(X=x|\pi)}{P(X=x)}
\end{eqnarray*}

è nota per ogni valore di $x\in\{0,1,2,3\}$ e ogni valore di $\pi\in\{0,0.25,0.5,0.75,1\}$ allora è possibile costruire una
tavola doppia entrata dove mettiamo $\pi$ per riga e $x$ per colonna

```{r 03-VC-11}
pig <- (0:4)/4
sn  <- (0:3)
LX  <- round(outer(pig,sn,function(p,x)dbinom(x,3,p)/5),3)
DX  <- matrix(rep(colSums(LX),each=5),5)

TX <- matrix(paste("$\\frac{",LX,"}{",DX,"}=",round(LX/DX,3),"$",sep=""),5)

CX <- c(colSums(LX/DX))
TTX <- rbind(TX,CX)

dimnames(TTX)[[1]] <- c(paste("$\\pi=",pig,"$",sep=""),"Tot")
dimnames(TTX)[[2]] <- c(paste("$x=",sn,"$",sep=""))

kable(TTX,row.names = T,booktabs = T, escape = F,linesep = "", digits = 4)
```
:::

<!-- `r item()` Ottenuto $X=2$ costruire la probabilità aggiornata di  -->


<!--chapter:end:03-VC.Rmd-->

---
output: html_document
editor_options: 
  chunk_output_type: console
  markdown: 
    wrap: 72
---

```{r setuptlc, include=FALSE}
source("intro.R")
i1 <- NULL; i2 <- NULL 
```


```{r 04-tlc-16}
if (html) cat('')
```
  
# Esercizi sul TLC



<div class="button-container"></div>

## Una VC qualunque: Somma, $S_{n}$

Un collo è composto di 64 confezioni. Ogni confezione ha un peso, $X$,
che si distribuisce secondo una VC che presenta $E(X_{i})= 2$kg e
$V(X_{i})=0.1$. Calcolare la probabilità che il collo superi il peso di
132kg.

:::{.sol data-latex=""}

<!-- # \begin{eqnarray*} -->
<!-- # S_{n}        &=& X_{1} + \cdots + X_{64}                      \\ -->
<!-- # E(S_{n})     &=& n\ E(X_{i}) = 64  \times  2   = 128        \\ -->
<!-- # V(S_{n})     &=& n\ V(X_{i}) = 64  \times  0.1 = 6.4        \\ -->
<!-- # S_{n}        & &\operatorname*{\sim}_{a} N(n\ \mu;\ n\ \sigma^{2}) -->
<!-- #               \sim N(128;\ 6.4)                                  -->
<!-- # \end{eqnarray*} -->

```{r 04-tlc-1,, results='asis'}
x1 <- 132
mm <- 64*2
ss <- 64*0.1
vnam <- "S_n"
tlc(tipo = "somma",x1 = 132,verso = ">",mu = 2,s2 = 0.1,n = 64)
```
:::



<div class="button-container"></div>

## Una VC qualunque: media, $\bar{X}$

Un collo è composto di 64 confezioni. Ogni confezione ha un peso, $X$,
che si distribuisce secondo una VC che presenta $E(X_{i})= 2$kg e
$V(X_{i})=0.1$. Calcolare la probabilità che il peso medio delle
confezioni sia compreso tra $1.9$kg e $2.1$kg.

:::{.sol data-latex=""}
<!-- \begin{eqnarray*} -->
<!-- \bar{X}      &=& \frac{X_{1} + \cdots + X_{64}} {n}          \\ -->
<!-- E(\bar{X})   &=& \mu = E(X_{i}) = 2                          \\ -->
<!-- V(\bar{X})   &=& \frac{\sigma^{2}} {n} = \frac{V(X_{i})} {n} -->
<!--               =  \frac{0.1} {64} = 0.0015625                 \\ -->
<!-- \bar{X}      & &\operatorname*{\sim}_{a} N( \mu;\frac {\sigma^{2}} n) -->
<!--               \sim  N(2;\ 0.0015625)                           -->
<!-- \end{eqnarray*} -->

```{r 04-tlc-2,, results='asis'}
x1 <- 1.9
x2 <- 2.1
mm <- 2
ss <- 0.1/64
vnam <- "S_n"
#cat(norm_int(x1 = x1,x2=x2,verso = NULL,mm = mm,ss = ss,vnam = vnam,mu = "\\mu",sigma = "\\sigma/\\sqrt n"))
tlc(tipo = "media",x1 = x1,x2 = x2,verso = NULL,mu = 2,s2 = 0.1,n = 64)
```
:::




<div class="button-container"></div>

## Un'urna: somma, $S_{n}$

Si abbia l'urna $\fbox{-2}\quad \fbox{2}\quad \fbox{3}\quad \fbox{3}\quad \fbox{4}$

Si effettuano 100 estrazioni con reimmissione (ECR). Calcolare la
probabilità che la somma delle 100 estrazioni sia compresa tra 195 e
210.

:::{.sol data-latex=""}
```{r 04-tlc-3,, results='asis'}
urn <- c(-2,2,3,3,4)
cat(stat_(urn,semp = T))
cat(tlc("somma",x1 = 195,x2 = 210,verso = NULL,mu = mean(urn),s2 = s2c(urn),n = 100))
```
:::



<div class="button-container"></div>

## Un'urna: media, $\bar{X}$

Si abbia l'urna $\fbox{-2}\quad \fbox{2}\quad \fbox{3}\quad \fbox{3}\quad \fbox{4}$

Si effettuano 100 estrazioni con reimmissione (ECR). Calcolare la
probabilità che la media nelle 100 estrazioni sia maggiore di 2.2.

:::{.sol data-latex=""}
```{r 04-tlc-4,, results='asis'}
urn <- c(-2,2,3,3,4)
cat(stat_(urn,semp = T))
cat(tlc("media",x1 = 2.2,verso = ">",mu = mean(urn),s2 = s2c(urn),n = 100))
```
:::



<div class="button-container"></div>

## 2 Urne: Somma, $S_{n}$

Due urne sono così formate:

-   l'urna A ${\fbox{-1} \fbox{1} \fbox{2}}$ e\
-   l'urna B ${\fbox{0} \fbox{0} \fbox{1}}$.

L'esperimento casuale consiste nell'estrarre con reimmissione un
biglietto da ogni urna e sommare gli esiti. Sia $X$ la variabile casuale
\`\`somma dei due esiti",

$$X=X_{A} + X_{B}.$$

Si ripete l'esperimento $n=81$ volte. Qual è la probabilità
(approssimata) che la somma dei risultati degli 81 esperimenti sia
maggiore di 90?

:::{.sol data-latex=""}
```{r 04-tlc-5,,results='asis'}
S_1 <- c(-1,1,2)
S_2 <- c(0,1)
num1 <- c(1,1,1)
num2 <- c(2,1)
res <- two_way(S_1 = S_1,S_2 = S_2,num1 = num1,num2 = num2,EV=T)
urn <- res$urn
cat("E in virtù del TLC\n\n")
cat(tlc("somma",x1 = 90,x2 = 210,verso = ">",mu = mean(urn),s2 = s2c(urn),n = 81))
```
:::




<div class="button-container"></div>

## 2 Urne: Media, $\bar{X}$

Due urne sono così formate:

-   l'urna A ${\fbox{-1} \fbox{1} \fbox{2}}$ e\
-   l'urna B ${\fbox{0} \fbox{0} \fbox{1}}$.

L'esperimento casuale consiste nell'estrarre con reimmissione un
biglietto da ogni urna e sommare gli esiti. Sia $X$ la variabile casuale
"somma dei due esiti",

$$X=X_{A} + X_{B}.$$

Si ripete l'esperimento $n=81$ volte. Siano $A=\{ \bar{X} < 1.2\}$ e
$B=\{ \bar{X} > 0.8 \}$. Qual è la probabilità (approssimata) che che la
media dei risultati degli 81 esperimenti sia $A$ e $B$?

:::{.sol data-latex=""}
\begin{eqnarray*}
   P(A\cap B)&=&  P(0.8<\bar X<1.2)
\end{eqnarray*}
  

```{r 04-tlc-6,,results='asis'}
S_1 <- c(-1,1,2)
S_2 <- c(0,1)
num1 <- c(1,1,1)
num2 <- c(2,1)
res <- two_way(S_1 = S_1,S_2 = S_2,num1 = num1,num2 = num2,EV=T)
urn <- res$urn
cat("E in virtù del TLC\n\n")
cat(tlc("media",x1 = 0.8,x2 = 1.2,verso = NULL,mu = mean(urn),s2 = s2c(urn),n = 81))
```
:::



<div class="button-container"></div>

## 2 Urne: Media, $\bar{X}$

Due urne sono così formate:

-   l'urna A ${\fbox{-1} \fbox{1} \fbox{1} \fbox{2}}$ e
-   l'urna B ${\fbox{0} \fbox{1}}$.\
    L'esperimento casuale consiste nell'estrarre con reimmissione un
    biglietto da ogni urna e sommare gli esiti. Sia $X$ la variabile
    casuale "somma dei due esiti",

$$X=X_{A} + X_{B}.$$

Si ripete l'esperimento $n=92$ volte.

Qual è la probabilità (approssimata) che che la media dei risultati
    dei 92 esperimenti sia compresa tra 1 e 1.4?

:::{.sol data-latex=""}
```{r 04-tlc-7,,results='asis'}
S_1 <- c(-1,1,2)
S_2 <- c(0,1)
num1 <- c(1,2,1)
num2 <- c(1,1)
res <- two_way(S_1 = S_1,S_2 = S_2,num1 = num1,num2 = num2,EV=T)
urn <- res$urn
cat("E in virtù del TLC\n\n")
cat(tlc("media",x1 = 1,x2 = 1.4,verso = NULL,mu = mean(urn),s2 = s2c(urn),n = 92))
```
:::



<div class="button-container"></div>

## Bernoulli: Somma, $S_{n}$

Si abbia l'urna

$$4\text{ biglietti con } \fbox{0}, 6\text{ biglietti con } \fbox{1}$$

Si effettuano 100 estrazioni con reimmissione (ECR). Calcolare la
probabilità che la somma delle 100 estrazioni sia compresa tra 55 e 70.


:::{.sol data-latex=""}
\begin{eqnarray*}
X_{i}         &\sim& \mbox{Ber}(\pi)         \\
              &\sim& \mbox{Ber}(0.6)        \\
\pi           &=& P(X_{i} = 1) = \frac{6} {10} = 0.6       \\
E(X_{i})      &=& \pi = 0.6                                \\
V(X_{i})      &=& \pi (1-\pi) = 0.24                      
\end{eqnarray*}


```{r 04-tlc-8,, results='asis'}
cat(tlc("somma",x1 = 55,x2 = 70,verso = NULL,mu = .6,n = 100))
```
:::



<div class="button-container"></div>

## Bernoulli: Proporzione, $\widehat{\pi}$

Si abbia l'urna

$$4\text{ biglietti con } \fbox{0}, 6\text{ biglietti con } \fbox{1}$$

Si effettuano 81 estrazioni con reimmissione (ECR). Calcolare la
probabilità che la proporzione di $\fbox{1}$, nelle 81 estrazioni, sia
compresa tra 0.6 e 0.65.

:::{.sol data-latex=""}
\begin{eqnarray*}
X_{i}         &\sim& \mbox{Ber}(\pi)         \\
              &\sim& \mbox{Ber}(0.6)        \\
\pi           &=& P(X_{i} = 1) = \frac{6} {10} = 0.6       \\
E(X_{i})      &=& \pi = 0.6                                \\
V(X_{i})      &=& \pi (1-\pi) = 0.24                      
\end{eqnarray*}

```{r 04-tlc-9,, results='asis'}
cat(tlc("prop",x1 = 0.6,x2 = 0.65,verso = NULL,mu = .6,n = 81))
```
:::



<div class="button-container"></div>

## 2 Urne: Proporzione, $\widehat{\pi}$

Siano date due urne:

-   l'urna A ${\fbox{-1} \fbox{1} \fbox{2}}$ e\
-   l'urna B ${\fbox{0} \fbox{0} \fbox{1}}$.

L'esperimento casuale consiste nell'estrarre con reimmissione un
biglietto da ogni urna e sommare gli esiti. Sia $X_{i}$ la variabile
casuale "somma dei due esiti",

$$X_{i}=X_{A;  i} + X_{B;  i}.$$ Sia $Y_{i}$ la variabile casuale
"CONTA gli esiti $X_{i}>0$". Si ripete l'esperimento $n=81$ volte:
$i=1,\ldots, 81$.

Qual è la probabilità (approssimata) che che la proporzione di numeri
maggiori di 0 negli 81 esperimenti sia maggiore di 0.68?

:::{.sol data-latex=""}
```{r 04-tlc-10,,results='asis'}
S_1 <- c(-1,1,2)
S_2 <- c(0,1)
num1 <- c(1,1,1)
num2 <- c(2,1)
res <- two_way(S_1 = S_1,S_2 = S_2,num1 = num1,num2 = num2,EV=F)
urn <- res$urn
```

\begin{displaymath}
P(X_{i}>0) = \frac{2}{9} + \frac{3}{9} + \frac{1}{9}
           = \frac{6} {9} = \frac{2} {3}
           = P(Y_{i}=1) =\pi  .
\end{displaymath}

\begin{eqnarray*}
E(Y) &=& \pi = \frac{2} {3}           \\
V(Y) &=& \pi\ (1-\pi)
      = \frac{2} {3}\ \left( 1- \frac{2} {3} \right)
      = \frac{2} {9}   .
\end{eqnarray*}

Per il TLC si ha

```{r 04-tlc-11,,results='asis'}
cat(tlc("prop",x1 = .68,verso = ">",mu = 2/3,n = 81))
```
:::




<div class="button-container"></div>

## Poisson: Somma, $S_{n}$

In una azienda, che lavora a ciclo continuo, si sono osservati 39
problemi durante l'ultimo semestre. Si supponga che i problemi
settimanali siano indipendenti tra loro e si distribuiscano secondo una
Poisson$(\lambda)$. Calcolare la probabilità che il totale dei problemi
rilevanti del prossimo anno sia compreso tra 75 e 80.

:::{.sol data-latex=""}
\begin{eqnarray*}
X_{i}    &\sim& \mbox{Poisson}(\lambda)                            \\
E(X_{i})    &=& \lambda = \frac{\#\ \mbox{problemi semestre}}
                {\#\ \mbox{settimane semestre}}
             =  \frac{39} {26} = 1.5                               \\
V(X_{i})    &=& \lambda = 1.5                                      
\end{eqnarray*}

```{r 04-tlc-12,, results='asis'}
#cat(norm_int(x1 = 75,x2 = 80,verso = NULL,mm = 78,ss = 78,vnam = "S_n",mu = "n\\lambda",sigma = "\\sqrt{n\\lambda}"))
tlc(tipo = "pois_somma",x1 = 75,x2 = 80,verso = NULL,mu = 1.5,n = 52 )
```
:::



<div class="button-container"></div>

## Poisson: Media, $\bar{X}$

Siano $X_{1}, \ldots, X_{49}$ VC $iid$ secondo una Poisson(1.5).
Calcolare la probabilità che la media delle 49 VC sia compresa tra 1.4 e
2.

:::{.sol data-latex=""}
\begin{eqnarray*}
X_{i}    &\sim& \mbox{Poisson}(\lambda) \sim \mbox{Poisson}(1.5)  \\
E(X_{i})    &=& \lambda = 1.5                                  \\
V(X_{i})    &=& \lambda = 1.5                                  \\
\end{eqnarray*}
```{r 04-tlc-13,, results='asis'}
#cat(norm_int(x1 = 1.4,x2 = 2,verso = NULL,mm = 1.5,ss = 1.5/49,vnam = "\\bar X",mu = "\\lambda",sigma = "\\sqrt{\\lambda/n}"))
tlc(tipo = "pois_somma",x1 = 1.4,x2 = 2,verso = NULL,mu = 1.5,n = 49 )
```
:::



<div class="button-container"></div>

## Poisson: Somma, $S_{n}$

**Esercizio particolare.** In Emilia-Romagna il numero di morti per
incidenti sul lavoro per settimana è una VC $X \sim$ Poisson(2.3). Qual
è la probabilità che il numero di morti in un anno sia minore di 100?

:::{.sol data-latex=""}
\begin{eqnarray*}
n           &=& 52 \quad\mbox{numero settimane in un anno}          \\
S_{n}       &=& X_{1} + \cdots + X_{n}                              \\
X_{i}    &\sim& \mbox{Poisson}(\lambda) \sim\mbox{Poisson}(2.3)       \\
E(X_{i})    &=& \lambda = 2.3                                       \\
V(X_{i})    &=& \lambda = 2.3                                       \\
\end{eqnarray*}

```{r 04-tlc-14,, results='asis'}
#cat(norm_int(x1 = 100,verso = "<",mm = 119.6,ss = 119.6,vnam = "S_n",mu = "n\\lambda",sigma = "\\sqrt{n\\lambda}"))
tlc(tipo = "pois_somma",x1 = 100,verso = "<",mu = 2.3,n = 52)
```
:::



<div class="button-container"></div>

## Proporzione -- Poisson, $\widehat{\pi}$

**ESERCIZIO COMPLESSO**. Il numero di errori per foglio scritto è una
VC, $EF_i$. Sia $EF_i \sim\text{Pois}(1)$ .

In una tesi di 80 pagine, qual è la probabilità (approssimata) che la
proporzione di pagine (facciate) SENZA ERRORI sia maggiore di 0.7?

:::{.sol data-latex=""}
La VC "numero di errori per pagina", $EP_i$, sarà $EP_{i}\ \sim\text{Pois}(0.5)$
 per la proprietà riproduttiva. Sia $X_{i}$ la VC binaria $X_{i}=1$ se $EP_i=0$: $i=1.\ldots, 80$.

\[
P(EP_{i}=0) = \frac{(0.5)^{0}} {0!}\ e^{-0.5} = 0.6065
               = P(X_{i}=1) =\pi  .
\]

\begin{eqnarray*}
E(X_i) &=& \pi = 0.6065                                                            \\
V(X_i) &=& \pi\ (1-\pi) = 0.6065 (1 - 0.6065) = 0.2387               
\end{eqnarray*}

```{r 04-tlc-15,, results='asis'}
#cat(norm_int(x1 = 0.7,verso = ">",mm = 0.6065,ss = 0.6065*(1-0.6065)/80,vnam = "\\hat\\pi",mu = "\\pi",sigma = "\\sqrt{\\pi(1-\\pi)/n}"))
tlc(tipo = "prop",x1 = 0.7,verso = ">",mu = .6065,n = 80)
```
:::

<!--chapter:end:04-tlc.Rmd-->

---
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r test}
source("intro.R")
```



```{r 05-test-19}
if (html) cat('')
```
  
# Test e Intervalli di Confidenza

<div class="button-container"></div>

## Un campione, IdC e test per $\mu$, $\sigma$ nota (z test).

`r item_start()` Un'indagine in 17 aziende, che producono lo stesso prodotto,
ha rilevato che il costo per unità è pari a euro 30.00
in media con una deviazione standard pari a euro 1.50.

Determinare un intervallo di confidenza al 99\%
per il costo medio per unità.

:::{.sol data-latex=""}
```{r 05-test-1,,results='asis'}
idc(xm = 30,sd = 1.50,alpha = 0.01,n = 17,dist_ = "t",mus = "\\hat\\mu",ss = "S")
```
:::

`r item_()` L'indagine dell'anno precedente, condotta
su un campione molto più numeroso, mostrava un costo medio
pari a euro 29.00 con una deviazione standard pari a 2.00 euro.
Verificare l'ipotesi che il costo medio del prodotto osservato
nell'anno corrente sia equivalente a quello osservato nell'anno
precedente contro l'alternativa di un aumento del costo.
Specificare in modo esplicito il tipo di test utilizzato,
l'ipotesi nulla e l'ipotesi alternativa e trarre le opportune
conclusioni.


:::{.sol data-latex=""}
```{r 05-test-2,,results='asis'}
res <- ztest_mu(muh = 30,s = 2,n = 17,mu0 = 29,h1 = ">")
cat(res,sep="\n")
```
:::

------------------------------------------

`r item_next()` Un'indagine in 15 aziende, che producono lo stesso prodotto,
ha rilevato che il costo per unità è pari a euro 25.00
in media con una deviazione standard pari a euro 2.00.

Determinare un intervallo di confidenza al 95\%
per il costo medio per unità.

:::{.sol data-latex=""}
```{r 05-test-3,,results='asis'}
idc(xm = 25,sd = 2.00,alpha = 0.05,n = 15,dist_ = "t",mus = "\\hat\\mu",ss = "S")
```
:::

`r item_()` L'indagine dell'anno precedente, condotta
su un campione molto più numeroso, mostrava un costo medio
pari a euro 26.00 con una deviazione standard pari a 2.50 euro.
Verificare l'ipotesi che il costo medio del prodotto osservato
nell'anno corrente sia equivalente a quello osservato nell'anno
precedente contro l'alternativa di una diminuzione del costo.
Specificare in modo esplicito il tipo di test utilizzato,
l'ipotesi nulla e l'ipotesi alternativa e trarre le opportune
conclusioni.

:::{.sol data-latex=""}
```{r 05-test-4,,results='asis'}
ztest_mu(muh = 25,s = 2.50,n = 15,mu0 = 26,h1 = "<")
```
:::

------------------------------------------

`r item_next()` Un'indagine in 20 aziende, che producono lo stesso prodotto,
ha rilevato che il costo per unità è pari a euro 28.00
in media con una deviazione standard pari a euro 1.80.

Determinare un intervallo di confidenza al 95\%
per il costo medio per unità.

:::{.sol data-latex=""}
```{r 05-test-5,,results='asis'}
idc(xm = 28,sd = 1.80,alpha = 0.05,n = 20,dist_ = "t",mus = "\\hat\\mu",ss = "S")
```
:::

`r item_()` L'indagine dell'anno precedente, condotta
su un campione molto più numeroso, mostrava un costo medio
pari a euro 27.00 con una deviazione standard pari a 2.20 euro.
Verificare l'ipotesi che il costo medio del prodotto osservato
nell'anno corrente sia equivalente a quello osservato nell'anno
precedente contro l'alternativa di un cambiamento del costo.
Specificare in modo esplicito il tipo di test utilizzato,
l'ipotesi nulla e l'ipotesi alternativa e trarre le opportune
conclusioni.

:::{.sol data-latex=""}
```{r 05-test-6,,results='asis'}
res <- ztest_mu(muh = 28,s = 2.20,n = 20,mu0 = 27,h1 = "\\neq")
cat(res,sep="\n")
```
:::



## Un campione, IdC e test per $\mu$, $\sigma$ incognita (t test).


`r item_next()` Sia $X$ l'età dei parlamentari italiani.
Si sceglie un campione di 20 parlamentari italiani e si ottiene una
media di 48.5 anni con una deviazione standard pari a 10.6 anni.

Determinare un intervallo di confidenza al 95\% per
l'età media dei politici italiani.

:::{.sol data-latex=""}
```{r 05-test-7,,results='asis'}
idc(xm = 48.5,sd = 10.6,alpha = 0.05,n = 20,dist_ = "t",mus = "\\hat\\mu",ss = "S")
```
:::

`r item_()` è noto che l'età media dei politici europei
è di 55 anni.
Verificare l'ipotesi
che l'età media dei politici italiani sia uguale a quella
dei politici europei contro l'alternativa che sia minore.
Specificare in modo esplicito il tipo di test utilizzato,
l'ipotesi nulla e l'ipotesi alternativa e trarre le opportune
conclusioni.

:::{.sol data-latex=""}
```{r 05-test-8,,results='asis'}
res <- ttest_mu(muh = 48.5,sh = 10.6,n = 20,mu0 = 55,h1 = "<")
cat(res,sep="\n")
```
:::

------------------------------------------

`r item_next()` Sia \(X\) il reddito annuale dei manager italiani.
Si sceglie un campione di 30 manager italiani e si ottiene una
media di 85 mila euro con una deviazione standard pari a 15 mila euro.

Determinare un intervallo di confidenza al 99\% per
il reddito medio annuale dei manager italiani.

:::{.sol data-latex=""}
```{r 05-test-9,,results='asis'}
idc(xm = 85,sd = 15,alpha = 0.01,n = 30,dist_ = "t",mus = "\\hat\\mu",ss = "S")
```
:::

`r item_()` è noto che il reddito medio annuale dei manager europei
è di 80 mila euro.
Verificare l'ipotesi
che il reddito medio annuale dei manager italiani sia uguale a quello
dei manager europei contro l'alternativa che sia maggiore.
Specificare in modo esplicito il tipo di test utilizzato,
l'ipotesi nulla e l'ipotesi alternativa e trarre le opportune
conclusioni.

:::{.sol data-latex=""}
```{r 05-test-10,,results='asis'}
res <- ttest_mu(muh = 85,sh = 15,n = 30,mu0 = 80,h1 = ">")
cat(res,sep="\n")
```
:::

------------------------------------------

`r item_next()` Per accertare lo stato di preparazione dei dipendenti di una
struttura pubblica si è estratto un campione di 26 impiegati.
A ogni impiegato è stato somministrato un test, con
punteggio da 0 a 100, per accertare il suo grado di competenza, $X$.
Il valore medio ottenuto è pari a 78 con una deviazione
standard pari a 12.

Determinare un intervallo di confidenza
al 95\% per $\mu = E(X)$.

:::{.sol data-latex=""}
```{r 05-test-11,,results='asis'}
idc(xm = 78,sd = 12,alpha = 0.05,n = 26,dist_ = "t",mus = "\\hat\\mu",ss = "S")
```
:::

`r item_()` Si supponga che il punteggio medio del test in un ampio
studio sulla popolazione di impiegati, sia pari a 72.
Con un livello di significatività uguale a 0.01 si può
ritenere che il valore medio osservato nel campione sia
diverso da 72?

:::{.sol data-latex=""}
```{r 05-test-12,,results='asis'}
res <- ttest_mu(muh = 78,sh = 12,n = 26,mu0 = 72,h1 = "\\neq")
cat(res,sep="\n")
```
:::


<div class="button-container"></div>

## Un campione, IdC e test per $\pi$ (z test).


`r item_next()` Su un campione di \( n = 100 \) abitanti del quartiere _R_ è stato chiesto se siano favorevoli o meno all'introduzione di una nuova pista ciclabile. Lo studio ha riportato che 70 persone su 100 (il 70% del campione) è favorevole.


Costruire un intervallo di confidenza al 95% per \(\pi\) la quota di persone del quartiere _R_ favorevole alla nuova pista ciclabile.

:::{.sol data-latex=""}
```{r 05-test-20}
idc(xm = 70,alpha = .05,n = 100,dist_ = "z")
```
:::


`r item_()` Un'indagine molto più ampia condotta su tutta la città ha mostrato che
la percentuale di favorevoli alla pista ciclabile è del 65%. Testare l'ipotesi che nel quartiere _R_ la quota di favorevoli sia uguale a quella cittadina contro l'alternativa che sia minore.

:::{.sol data-latex=""}
```{r 05-test-21}
sn <- 70
n  <- 100
p0 <- 0.65
h1 <- ">"
ztest_pi(sn = sn,n = n,p0 = p0,h1 = h1)
```
:::



------------------------------------------

`r item_next()` Su un campione di \( n = 120 \) startup tecnologiche italiane, è stato chiesto se abbiano implementato misure di cybersecurity avanzate. Lo studio ha riportato che 84 startup su 120 (il 70% del campione) hanno implementato queste misure.

Costruire un intervallo di confidenza al 99% per \(\pi\), la quota di startup italiane che hanno implementato misure di cybersecurity avanzate.

:::{.sol data-latex=""}
```{r 05-test-22}
cat(idc(xm = 84,alpha = .01,n = 120,dist_ = "z"))
```
:::


`r item_()` Un'indagine molto più ampia condotta su startup europee ha mostrato che la percentuale di startup con misure di cybersecurity avanzate è del 75%. Testare l'ipotesi che in Italia la quota di startup con misure di cybersecurity avanzate sia uguale a quella europea contro l'alternativa che sia diversa.

:::{.sol data-latex=""}
```{r 05-test-23}
sn <- 84
n  <- 120
p0 <- 0.75
h1 <- "\\neq"
ztest_pi(sn = sn,n = n,p0 = p0,h1 = h1)
```
:::




## t-Test a due campioni

`r item_next()`  In uno studio sull'efficacia della pubblicità
si è proceduto facendo vedere lo spot $A$ ad un campione di 10
individui (gruppo $A$) e lo spot $B$ ad un secondo campione di 20
individui (gruppo $B$).
Si è quindi misurato il gradimento con opportuna scala.
Il gradimento medio del gruppo $A$ risulta pari a 95 con una
deviazione standard pari a 1.9 mentre il gradimento medio del
gruppo $B$ risulta pari a 92 con una deviazione standard pari
a 3.4.
Verificare l'ipotesi che il gradimento medio dei due spot sia uguale, contro
l'alternativa che lo spot $A$ sia mediamente più gradito
di quello $B$.
Si assuma l'ipotesi di eterogeneità delle varianze dei due
gruppi.

:::{.sol data-latex=""}
```{r 05-test-13,,results='asis'}
ttest_2c_et(mu1 = 95,mu2 = 92,s1h = 3.4,s2h = 1.9,n1 = 10,n2 = 20,h1 = ">",a = "A",b = "B")
```
:::

------------------------------------------

`r item_next()` In uno studio sull'efficacia di due metodi di insegnamento della matematica, si è proceduto facendo seguire il metodo \(A\) ad un campione di 15 studenti (gruppo \(A\)) e il metodo \(B\) ad un secondo campione di 18 studenti (gruppo \(B\)). Si è quindi misurata la prestazione degli studenti con un test finale. La prestazione media del gruppo \(A\) risulta pari a 78 con una deviazione standard pari a 8.3, mentre la prestazione media del gruppo \(B\) risulta pari a 74 con una deviazione standard pari a 7.5. Verificare l'ipotesi che la prestazione media dei due metodi di insegnamento sia uguale, contro l'alternativa che il metodo \(A\) produca prestazioni mediamente migliori di quello \(B\). Si assuma l'ipotesi di eterogeneità delle varianze dei due gruppi, anche se i numeri non sembrano giustificarla.

:::{.sol data-latex=""}
```{r 05-test-14,,results='asis'}
ttest_2c_et(mu1 = 78,mu2 = 74,s1h = 8.3,s2h = 7.5,n1 = 15,n2 = 18,h1 = ">",a = "A",b = "B")
```
:::

------------------------------------------

`r item_next()` In uno studio sulla produttività dei lavoratori, si è proceduto confrontando i lavoratori del Nord e del Sud. Si è quindi misurata la produttività media con un'opportuna scala. La produttività media del gruppo Nord risulta pari a 85 con una deviazione standard pari a 7.2, mentre la produttività media del gruppo Sud risulta pari a 80 con una deviazione standard pari a 6.8. Verificare l'ipotesi che la produttività media dei due gruppi sia uguale, contro l'alternativa che le due produttività medie siano diverse. Si assuma l'ipotesi di omogeneità delle varianze dei due gruppi.

:::{.sol data-latex=""}
```{r 05-test-15,,results='asis'}
ttest_2c_om(mu1 = 85,mu2 = 80,s1h = 7.2,s2h = 6.8,n1 = 15,n2 = 18,h1 = "\\neq",a = "Nord",b = "Sud")
```
:::


## Due campioni: proporzione 

`r item_next()`  Per verificare se ci sia differenza di genere sulla
riforma costituzionale del governo Meloni, si è condotta una
indagine su 120 donne e 120 uomini.
Dalle interviste è emerso che 60 dei 120 uomini si siano
dichiarati favorevoli, mentre 30 delle 120 donne si siano
dichiarate favorevoli (numeri di comodo per avere pochi decimali).
Verificare l'ipotesi
che non ci sia differenza tra uomini e donne, contro l'alternativa
che le donne siano meno favorevoli alla riforma costituzionale.
Specificare l'ipotesi nulla e l'ipotesi alternativa,
il tipo di test da utilizzare, e le conclusioni.

:::{.sol data-latex=""}
```{r 05-test-16,,results='asis'}
ztest_2c_pi(s1 = 60,s2 = 30,n1 = 120,n2 = 120,h1 = ">",a = "U",b = "D")
```
:::

------------------------------------------

`r item_next()` Per verificare se ci sia differenza nella soddisfazione lavorativa tra dipendenti a tempo pieno e part-time, si è condotta un'indagine su 100 dipendenti a tempo pieno e 100 dipendenti part-time. Dalle interviste è emerso che 70 dei 100 dipendenti a tempo pieno si siano dichiarati soddisfatti, mentre 50 dei 100 dipendenti part-time si siano dichiarati soddisfatti. Verificare l'ipotesi che non ci sia differenza nella soddisfazione lavorativa tra dipendenti a tempo pieno e part-time, contro l'alternativa che i dipendenti part-time siano meno soddisfatti. Specificare l'ipotesi nulla e l'ipotesi alternativa, il tipo di test da utilizzare, e le conclusioni.

:::{.sol data-latex=""}
```{r 05-test-17,,results='asis'}
ztest_2c_pi(s1 = 70,s2 = 50,n1 = 100,n2 = 100,h1 = ">",a = "Tempo Pieno",b = "Part-Time")
```
:::

------------------------------------------

`r item_next()` Per verificare se ci sia differenza nella preferenza per il lavoro remoto tra dipendenti di aziende tecnologiche e dipendenti di aziende manifatturiere, si è condotta un'indagine su 90 dipendenti di aziende tecnologiche e 90 dipendenti di aziende manifatturiere. Dalle interviste è emerso che 63 dei 90 dipendenti di aziende tecnologiche preferiscono il lavoro remoto, mentre 45 dei 90 dipendenti di aziende manifatturiere preferiscono il lavoro remoto. Verificare l'ipotesi che non ci sia differenza nella preferenza per il lavoro remoto tra i due gruppi, contro l'alternativa che ci sia una differenza significativa. Specificare l'ipotesi nulla e l'ipotesi alternativa, il tipo di test da utilizzare, e le conclusioni.

:::{.sol data-latex=""}
```{r 05-test-18,,results='asis'}
ztest_2c_pi(s1 = 63,s2 = 45,n1 = 90,n2 = 90,h1 = "\\neq",a = "Tecnologiche",b = "Manifatturiere")
```
:::

<!--chapter:end:05-test.Rmd-->

---
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r chi}
source("intro.R")
```





# Test del Chi-quadro per indipendenza



<div class="button-container"></div>

## Esercizio 1

In uno studio sulle preferenze di gusti di gelato è stato chiesto ad un campione di 200 persone, divise tra 100 uomini e 100 donne, di esprimere la propria preferenza tra quattro gusti di gelato (Cioccolato, Fragola, Vaniglia e Limone).

Qui di seguito è riportata la tavola di contingenza:

```{r 05a-chi2-1}

dat <- matrix(c(25, 20, 15, 10, 30, 40, 40, 30), 2)

nome_y <- c("Uomo", "Donna")
nome_x <- c("Cioccolato", "Fragola", "Vaniglia", "Limone")

dat_print <- chi_print(dat, nome_x = nome_x, nome_y = nome_y)[[2]]
dat <- chi_print(dat, nome_x = nome_x, nome_y = nome_y)[[1]]

tabl(dat_print, digits = 4) %>%
  column_spec(column = 1, bold = T)
```

Testare l'ipotesi che vi sia indipendenza tra genere e preferenza tra le profumazioni.

:::{.sol data-latex=""}
```{r 05a-chi2-2}
cat(chi_test(dat = dat))
```
:::



<div class="button-container"></div>

## Esercizio 2

In uno studio sulle preferenze di bevande è stato chiesto ad un campione di 180 persone di esprimere la propria preferenza tra tre tipi di bevande (Acqua, Succo d'arancia e Bibita gassata). Le persone sono state suddivise in due gruppi, chi mangia regolarmente frutta e chi no.

Qui di seguito è riportata la tavola di contingenza:

```{r 05a-chi2-3}
dat <- matrix(c(40, 30, 30, 25, 20, 35), 2)

nome_y <- c("consuma frutta", "non consuma frutta")
nome_x <- c("Acqua", "Succo d'arancia", "Bibita gassata")

dat_print <- chi_print(dat, nome_x = nome_x, nome_y = nome_y)[[2]]
dat <- chi_print(dat, nome_x = nome_x, nome_y = nome_y)[[1]]

tabl(dat_print, digits = 4) %>%
  column_spec(column = 1, bold = T)
```

Testare l'ipotesi che vi sia indipendenza tra consumo abituale di frutta e preferenza di bevande.

:::{.sol data-latex=""}
```{r 05a-chi2-4}
cat(chi_test(dat = dat))
```
:::



<div class="button-container"></div>

## Esercizio 3

In uno studio sulle opinioni riguardo al tema del "Matrimonio tra persone dello stesso sesso" è stato chiesto ad un campione di 180 persone di esprimere la propria opinione scegliendo tra tre possibilità (Sostenitore, Neutrale, Contrario). Le persone sono state suddivise in due gruppi, "Elettori di Destra" e "Elettori di Sinistra".

Qui di seguito è riportata la tavola di contingenza:

```{r 05a-chi2-5}

dat <- matrix(c(40, 30, 10, 25, 35, 20), 2)

nome_y <- c("Elettori di Destra", "Elettori di Sinistra")
nome_x <- c("Sostenitore", "Neutrale", "Contrario")

dat_print <- chi_print(dat, nome_x = nome_x, nome_y = nome_y)[[2]]
dat <- chi_print(dat, nome_x = nome_x, nome_y = nome_y)[[1]]

tabl(dat_print, digits = 4) %>%
  column_spec(column = 1, bold = T)

```

Testare l'ipotesi che vi sia indipendenza tra l'opinione riguardo al tema "Matrimonio tra persone dello stesso sesso" e l'appartenenza ai gruppi "Elettori di Destra" e "Elettori di Sinistra".

:::{.sol data-latex=""}
```{r 05a-chi2-6}
cat(chi_test(dat = dat))
```
:::




<div class="button-container"></div>

## Esercizio 4

In uno studio sociologico sulle preferenze di attività ricreative è stato chiesto ad un campione di 270 persone di esprimere la propria preferenza tra tre tipi di attività (Sport, Lettura e Arte). Le persone sono state suddivise in tre gruppi, "Giovani", "Adulti" e "Anziani".

Qui di seguito è riportata la tavola di contingenza:


```{r 05a-chi2-7}

dat <- matrix(c(50, 30, 20, 40, 60, 10, 20, 25, 40), 3)

nome_y <- c("Giovani", "Adulti", "Anziani")
nome_x <- c("Sport", "Lettura", "Arte")

dat_print <- chi_print(dat, nome_x = nome_x, nome_y = nome_y)[[2]]
dat <- chi_print(dat, nome_x = nome_x, nome_y = nome_y)[[1]]

tabl(dat_print, digits = 4) %>%
  column_spec(column = 1, bold = T)


```

Testare l'ipotesi che vi sia indipendenza tra la preferenza per le attività ricreative e l'età.

:::{.sol data-latex=""}
```{r 05a-chi2-8}
cat(chi_test(dat = dat))
```
:::

# Test del Chi-quadro per conformità



<div class="button-container"></div>

## Esercizio 1

L'Associazione Bar dell'Emilia Romagna ha condotto un'indagine sulle preferenze delle bevande dei clienti dei bar della regione. Durante una settimana, sono stati intervistati 250 clienti di vari bar della zona. L'associazione è interessata a capire se le preferenze dei clienti per le bevande differiscono dalla media nazionale.

Qui di seguito è riportata la tabella delle preferenze dei clienti dei bar dell'Emilia Romagna:

```{r 05a-chi2-9}
X <- c("Caffè", "Tè", "Altro")
Y <- c("Dati Associazione", "Media Nazionale")
ntot <- 250
Freq_0 <- c(50, 30, 20)
Freq_c <- c(40, 35, 25)
Freq_c <- round(Freq_c/sum(Freq_c)*ntot)

chi_print_conf(Freq_c = Freq_c,Freq_0 = Freq_0,X,Y)
```

Testare l'ipotesi che le preferenze dei clienti dei bar dell'Emilia Romagna per le bevande differiscano dalla media nazionale.

:::{.sol data-latex=""}
```{r 05a-chi2-10}
cat(chi_conf(Freq_c = Freq_c,Freq_0 = Freq_0,X,Y))
```
:::




<div class="button-container"></div>

## Esercizio 2

L'Associazione dei Ristoranti dell'Emilia Romagna ha condotto un'indagine sulle preferenze culinarie dei clienti dei ristoranti della regione. Durante una settimana, sono stati intervistati 300 clienti di vari ristoranti. L'associazione è interessata a capire se le preferenze dei clienti per le tipologie di cucina offerte differiscono dalla media nazionale.

Qui di seguito è riportata la tabella delle preferenze dei clienti dei ristoranti dell'Emilia Romagna e le percentuali nazionali:

```{r 05a-chi2-11}
X <- c("Italiana", "Giapponese", "Messicana", "Mediterranea", "Vegetariana")

Y <- c("Dati Associazione", "Media Nazionale")
X <- c("Italiana", "Giapponese", "Messicana", "Mediterranea", "Vegetariana")

Y <- c("Dati Associazione", "Media Nazionale")
ntot <- 300
Freq_0 <- c(40, 15, 5, 35, 5)
Freq_c <- c(50, 25, 5, 20, 2)
Freq_c <- round(Freq_c/sum(Freq_c)*ntot)

chi_print_conf(Freq_c = Freq_c,Freq_0 = Freq_0,X,Y)
```

Testare l'ipotesi che le preferenze dei clienti dei bar dell'Emilia Romagna per le bevande differiscano dalla media nazionale.

:::{.sol data-latex=""}
```{r 05a-chi2-12}
cat(chi_conf(Freq_c = Freq_c,Freq_0 = Freq_0,X,Y))
```
:::

<!--chapter:end:05a-chi2.Rmd-->

---
output: html_document
editor_options: 
  chunk_output_type: console
---
```{r regr}
rm(list=ls())


source("intro.R")
fig.def(2.5,3.5)

i1 <- 1; i2 <- 0
i2 <- 1

```


```{r 06-regr-43}
if (html) cat('')
```
  
# Esericizi sulla Regressione



<div class="button-container"></div>

## Esercizio (Dati maternità USA)

### I dati

Il dataset di dimensioni $n = 51$ è relativo ai 50 stati e al Distretto di Columbia negli Stati Uniti. Le variabili sono 

- $y =$ _il tasso di natalità dell'anno 2002 per 1000 femmine di età compresa tra 15 e 17 anni_  
- $x =$ _il tasso di povertà, che rappresenta la percentuale della popolazione dello stato che vive in famiglie con redditi al di sotto della soglia di povertà definita dal governo federale._ 

(Fonte dei dati: Mind On Statistics, 3a edizione, Utts and Heckard).

### La matrice dei dati


```{r 06-regr-44}
dat <- read.csv('poverty.txt')

tabl(cbind(1:51,dat[,1:3]),col.names = c("$i$", "Stato","Tasso di povertà","Tasso di natalità 15-17"))
```

### La rappresentazione dei dati

```{r 06-regr-45}

x <- dat$PovPct
y <- dat$Brth15to17

df <- data.frame(state = dat$Location, poverty_rate = dat$PovPct, birth_rate = dat$Brth15to17)
data_poverty <- df

if (html){
library(plotly)

# Crea un grafico di dispersione interattivo
plot_ly(df, x = ~poverty_rate, y = ~birth_rate, text = ~state, type = "scatter", mode = "markers") %>%
  layout(title = "Tasso di povertà e natalità per gli stati degli Stati Uniti (anno 2002)",
         xaxis = list(title = "Tasso di povertà"),
         yaxis = list(title = "Tasso di natalità 15-17"))
} else {
plot(x,y,axes=F,title = "Tasso di povertà e natalità per gli stati degli Stati Uniti (anno 2002)",xlab="Tasso di povertà",ylab="Tasso di natalità 15-17")
  axis(1)
  axis(2)
  }

# plot(x,y,axes=F,title = "Tasso di povertà e natalità per gli stati degli Stati Uniti (anno 2002)",xlab="Tasso di povertà",ylab="Tasso di natalità 15-17") 

n <- length(x)

mx <- mean(x)
vx <- mean(x^2)-mean(x)^2

my <- mean(y)
vy <- mean(y^2)-mean(y)^2

co <- mean(x*y) - mx*my
r  <- co/sqrt(vy*vx)
b1 <- co/vx
b0 <- my - b1*mx

ys <- b0 + b1 * x
es <- y - ys
rg <- ys - my

se2 <- (n/(n-2))*vy*(1-r^2) 
vb0 <- se2 * (1/n+mx^2/(n*vx)) 
vb1 <- se2 / (n*vx) 

ls2e(regr(x,y))
```

 Tutta l'informazione sul modello di regressione lineare semplice è contenuta nelle
seguenti statistiche
\[\sum_{i=1}^n x_i=      `r format(sum(x  ),nsmall = 2,scientific = F,big.mark = "~")`,
~~\sum_{i=1}^n y_i=      `r format(sum(y  ),nsmall = 2,scientific = F,big.mark = "~")`,
~~\sum_{i=1}^n x_i^2=    `r format(sum(x^2),nsmall = 2,scientific = F,big.mark = "~")`,
~~\sum_{i=1}^ny_i^2=     `r format(sum(y^2),nsmall = 2,scientific = F,big.mark = "~")`,
~~ \sum_{i=1}^n x_i y_i= `r format(sum(y*x),nsmall = 2,scientific = F,big.mark = "~")`\]
o, equivalentemente, le medie
\[\frac{1}{51}\sum_{i=1}^n x_i=      `r format(mean(x  ),nsmall = 4,scientific = F,big.mark = "~")`,
~~\frac{1}{51}\sum_{i=1}^n y_i=      `r format(mean(y  ),nsmall = 4,scientific = F,big.mark = "~")`,
~~\frac{1}{51}\sum_{i=1}^n x_i^2=    `r format(mean(x^2),nsmall = 4,scientific = F,big.mark = "~")`,
~~\frac{1}{51}\sum_{i=1}^ny_i^2=     `r format(mean(y^2),nsmall = 4,scientific = F,big.mark = "~")`,
~~ \frac{1}{51}\sum_{i=1}^n x_i y_i= `r format(mean(y*x),nsmall = 4,scientific = F,big.mark = "~")`\]


\begin{alignat*}{3}
 \bar x & =  \frac 1 n \sum_{i=1}^n x_i  = `r mx` &
\hat\sigma_X^2 & =  \frac 1 n \sum_{i=1}^n x_i^2 - \bar x^2  = `r vx` &\\
 \bar y & =  \frac 1 n \sum_{i=1}^n y_i   = `r my` &
\hat\sigma_Y^2 & =  \frac 1 n \sum_{i=1}^n y_i^2 - \bar y^2  = `r vy` &\\
 \text{cov}(x,y) & = \frac 1 n \sum_{i=1}^n x_iy_i -\bar x\bar y  = `r co` & 
r & = \frac{\text{cov}(x,y)}{\hat\sigma_X \hat\sigma_Y }  = `r r` &\\
\hat\beta_1 & = \frac{\text{cov}(x,y)}{\hat\sigma_X^2} = `r b1` & 
\hat\beta_0 & = \bar y  - \hat\beta_1\bar x = `r b0`. &\\
\hat\sigma_\varepsilon^2 & = \hat\sigma_Y^2(1-r^2)=`r vy*(1-r^2)` &
S_\varepsilon^2 & = \frac{n}{n-2}\hat\sigma_\varepsilon^2 = `r se2`\\
\hat\sigma_\varepsilon & = \hat\sigma_Y\sqrt{(1-r^2)}=`r sqrt(vy*(1-r^2))` & \qquad
S_\varepsilon & = \sqrt{\frac{n}{n-2}}\hat\sigma_\varepsilon = `r sqrt(se2)`\\
\end{alignat*}

```{r 06-regr-46}

#reg <- data.frame(pov = df$poverty_rate, est = b0+b1*df$poverty_rate)
# Crea un grafico di dispersione interattivo
# plot_ly(df, x = ~poverty_rate, y = ~birth_rate, text = ~state, type = "scatter", mode = "markers") %>%
#   layout(title = "Tasso di povertà e natalità per gli stati degli Stati Uniti (anno 2002)",
#          xaxis = list(title = "Tasso di povertà"),
#          yaxis = list(title = "Tasso di natalità")) %>%
#   add_lines( x= reg$pov, y= reg$est)
#   

plot(dat[,2],dat[,3],xlab="Tasso di povertà",ylab="Tasso di natalità 15-17",axes=F,xlim=c(0,25),ylim=c(0,40),pch=16,col="blue2")
axis(1,pos = 0)
axis(2,pos = 0)

abline(b0,b1,col="red3",lwd=2)
axis(2,at=b0,labels = expression(beta[0]==4.27),col.axis=2,las=1,pos=0)
segments(0,b0,1,b0,lty=2)
segments(1,b0,1,b0+b1,lty=2)
text(1.1,4.5,expression(beta[1]==1.37),pos=4)
axis(1,1,pos=0)
```

______________________________

Valutare la bontà di adattamento del modello precedente.

:::{.sol data-latex=""}

```{r 06-regr-1,,results='asis',warning=FALSE,message=FALSE}
#detach(regr(x,y))
res <-R2()
cat(res,sep="\n")
```

:::
______________________________


Fornire una interpretazione dei parametri della retta di regressione.

:::{.sol data-latex=""}

```{r 06-regr-47}
x_name <- "tasso di povertà"
y_name <- "tasso di natalità per le under 15"
```

I parametri della retta di regressione sono $\beta_{0}$ e $\beta_{1}$.
Il primo, $\beta_{0},$ rappresenta l'intercetta della retta,
ovvero il punto in cui la retta interseca l'asse delle ordinate.
Il secondo parametro, $\beta_{1}$, rappresenta la pendenza della
retta (chiamato anche coefficiente angolare), ovvero l'incremento
verticale corrispondente a un incremento orizzontale unitario e
coincide, perciò, con la tangente dell'angolo compreso fra la
retta e l'asse delle ascisse.

In questo caso, il `r y_name`,
secondo il modello stimato, è dato da
$$Y= `r b0` + `r b1` X$$

ossia, è composto da un quantitativo fisso di $`r b0`$ di `r y_name` in un ipotetico stato a con `r x_name` zero ($x=0$), a cui si aggiunge un incremento di $`r b1`$ per ogni incremento unitario del `r x_name`.

:::

______________________________

Determinare il residuo per lo stato del Colorado $i=6$
uguale 6, ossia per $x=6$.

:::{.sol data-latex=""}


```{r 06-regr-2,,results='asis',warning=FALSE,message=FALSE}
#detach(regr(x,y))
j <- 6
res <-residuo(x[j],y[j])
cat(res,sep="\n")
```

:::
______________________________

Verificare l'ipotesi che l'intercetta della retta di regressione sia uguale a
zero contro l'alternativa che sia diversa da zero.

:::{.sol data-latex=""}

```{r 06-regr-3,,results='asis',warning=FALSE,message=FALSE}
res <- se_beta0()
cat(res,sep="\n")
res <- ttest_beta(cof = 0,bj0 = 0,h1 = "\\neq")
cat(res,sep="\n")
```

:::
______________________________


Verificare l'ipotesi che la pendenza della retta di regressione sia uguale a 0
contro l'alternativa che sia diversa da 0.

:::{.sol data-latex=""}

```{r 06-regr-4,,results='asis',warning=FALSE,message=FALSE}
res <- se_beta1()
cat(res,sep="\n")
res <- ttest_beta(cof = 1,bj0 = 0,h1 = ">")
cat(res,sep="\n")
```

:::
___________________________________


Un software professionale restituisce un output del genere

```{r 06-regr-5,,echo=TRUE,results='markup'}
head(data_poverty,n = 10)
modello <- lm(formula = birth_rate ~ poverty_rate,data = data_poverty)
summary(modello)
```





<div class="button-container"></div>

## Esercizio 1

Si sono raccolti i seguenti valori per la variabile indipendente
$X$, indice delle importazioni, e la variabile dipendente $Y$,
indice della produzione industriale (dati artificiali).

\small
```{r 06-regr-6,,warning=FALSE,message=FALSE}
dati <- data.frame(
i = c(1    ,2    ,3    ,4    ,5    ,6    ,7    ,8    ,9    ,10   ,11   ,12   ,13   ,14   ,15   ,16),
x = c(102  ,105  ,107  ,108  ,109  ,109  ,110  ,112  ,113  ,115  ,116  ,118  ,119  ,120  ,121  ,122 ),
y = c(107  ,108  ,109  ,110  ,111  ,112  ,112  ,116  ,118  ,121  ,123  ,126  ,128  ,130  ,131  ,133 )
)
x <- dati$x
y <- dati$y

names(dati) <- c("$i$","$x$","$y$")
tabl(t(dati),row.names = T)
ls2e(regr(x,y))

fig.def(width = 5)
```
\normalsize

`r item(T)`  Calcolare i parametri $\beta_{0}$ e $\beta_{1}$ della
retta di regressione in cui $Y$ è spiegata attraverso $X$.

(Suggerimento: $\bar{x} = 112.875~~`r mx`$; $\sigma_{X} = 5.89359~~`r sx`$;
$\bar{y} = 118.4375$;  $\sigma_{Y} = 8.74620$; $\text{cov}(X,Y)= 50.74219$).
NB: ora si danno le somme, le somme dei quadrati e dei prodotti:
$\sum_{i=1}^{n} x_{i}$, $\sum_{i=1}^{n} x_{i}^{2}$,
$\sum_{i=1}^{n} y_{i}$, $\sum_{i=1}^{n} y_{i}^{2}$,
$\sum_{i=1}^{n} x_{i}\, y_{i}$.

:::{.sol data-latex=""}

\begin{eqnarray*}
\widehat{\beta}_{1} &=& r \frac{\sigma_{Y}} {\sigma_{X}}
                     =  \frac{\text{cov}(X,Y)} {\sigma_{X}^{2}}
                     =  \frac{`r co`} {(`r sx`)^{2}} = `r b1`  \\
\widehat{\beta}_{0} &=& \overline{y} - \widehat{\beta}_{1} \overline{x}
                     =  `r my` - `r b1` \times `r mx` = `r b0`.
\end{eqnarray*}
:::


`r item()`   Valutare la bontà di adattamento del modello precedente.
 
:::{.sol data-latex=""}

\begin{eqnarray*}
r     &=& \frac{\text{cov}(X,Y)} {\sigma_{X}\ \sigma_{Y}}
       =  \frac{`r co`} {`r sx` \times `r sy`} = `r r`\\
r^{2} &=& (`r r`)^{2} = `r r^2`
\end{eqnarray*}
 
L'adattamento del modello ai dati è soddisfacente.
:::

`r item()`    Rappresentare nel diagramma di dispersione la retta di regressione.

:::{.sol data-latex=""}
Per disegnare velocemente la retta si individuano nel grafico due punti:
(1)il punto medio $(\bar{x},\, \bar{y})$, che è già noto; e un solo
punto "estremo" nel grafico, che può essere $x=100$ o $x=120$
(i numeri "tondi" facilitano il calcolo e il disegno).
Tramite l'equazione della retta di regressione si stima
la coordinata corrispondente:


```{r 06-regr-48}
plot(x,y,axes=F,xlim=c(100,125),ylim=c(95,135))
axis(2,c(b0+b1*100,b0+b1*120),round(c(b0+b1*100,b0+b1*120),3),las=2)
axis(1)
segments(c(100,120),0,c(100,120),c(b0+b1*100,b0+b1*120),lty = 2)
segments(0,c(b0+b1*100,b0+b1*120),c(100,120),c(b0+b1*100,b0+b1*120),lty = 2)
abline(b0,b1,col=ared)
```
 
\begin{eqnarray*}
\widehat{y} &=& -46.457 + 1.461 \,\times\, 100 = 99.629
                \qquad \mbox{per $x=100$} \qquad OY= 99.629 \\
\widehat{y} &=& -46.457 + 1.461 \,\times\, 120 = 128.846
                \qquad \mbox{per $x=120$} \qquad OY= 128.846\, .
\end{eqnarray*}
 
La "piccola" scala degli assi può portare a disegnare una retta
non appropriata; l'ispezione visiva aiuta, in questi casi, meglio
di quella numerica a disegnare una "buona" retta di regressione.
:::



`r item()`  Fornire una interpretazione dei parametri della retta di regressione.
 
:::{.sol data-latex=""}
I parametri della retta di regressione sono $\beta_{0}$ e $\beta_{1}$.
Il primo, $\beta_{0},$ rappresenta l'intercetta della retta, ovvero il
punto in cui la retta interseca l'asse delle ordinate.
Il secondo parametro, $\beta_{1}$, rappresenta la pendenza della retta
(chiamato anche coefficiente angolare), ovvero l'incremento verticale
corrispondente a un incremento orizzontale unitario e coincide, perciò,
con la tangente dell'angolo compreso fra la retta e l'asse delle ascisse.

Quando si chiede di fornire una interpretazione dei parametri della retta
di regressione, tuttavia, si intende che il candidato interpreti anche
i valori numerici di $\beta_{0}$ e $\beta_{1}$ effettivamente calcolati
in precedenza, alla luce del fenomeno descritto da $X$ e $Y$.
In questo caso, l'indice della produzione industriale, secondo il modello
stimato, è dato da
$$y= `r b0` + `r b1` x$$
ossia, è composto da un quantitativo fisso di $`r b0`$ quando l'indice
delle importazione è zero ($X=0$), un caso molto raro (ma impossibile
nel mondo attuale), a cui si aggiungono `r b1` per ogni unità in più
dell'indice delle importazioni.
:::

`r item()`   Calcolare un indicatore che sintetizzi l'ordine
di grandezza dei residui della retta di regressione.
 
:::{.sol data-latex=""}
La media quadratica dei residui della retta di regressione coincide con
il RMSE e rappresenta una sintesi della dispersione dei residui intorno
alla retta di regressione. Si calcola con la formula:
 
\begin{displaymath}
\hat\sigma_\varepsilon
= \sigma_{Y}\ \sqrt{1- r^2_{XY}} = `r sy`(1-`r r`^2) = `r seh`
\end{displaymath}
::: 

`r item()`   Prevedere il valore dell'indice industriale per un valore
dell'indice delle importazioni pari a 120, ossia $x=120$.
 
:::{.sol data-latex=""}
Si determina il valore previsto tramite la retta di regressione:
 
\begin{eqnarray*}
\widehat{Y}_{i}     &=& `r b0` + `r b1`\times 120 \\
\widehat{y}_{x=120} &=& `r b0+b1*120`
\end{eqnarray*}
:::

`r item()`   Dal diagramma di dispersione sotto riportato,
spiegare se la retta di regressione è adeguata o no a
rappresentare il fenomeno.

```{r 06-regr-49}
fig.def(2.8,4.5)
```
 
```{r 06-regr-50}
plot(x,es,axes=F,ylab=expression(hat(epsilon[i])))
abline(h=0,lty=2,col="grey")
axis(1)
axis(2)
```

:::{.sol data-latex=""}
L'ispezione visiva dei dati potrebbe suggerire anche l'esistenza
di una certa NON linearità.
Non vi sono punti leva; in ogni caso, la non linearità impone
di modellarla prima di cercare i punti leva.
```{r 06-regr-51}
plot(x,es,axes=F,ylab=expression(hat(epsilon[i])))
abline(h=0,lty=2,col="grey")
fit <- smooth.spline(x, es)      # smooth.spline fit
res <- (fit$yin - fit$y)/(1-fit$lev)      # jackknife residuals
sigma <- sqrt(var(res))                     # estimate sd

upper <- fit$y + 2.0*sigma*sqrt(fit$lev)   # upper 95% conf. band
lower <- fit$y - 2.0*sigma*sqrt(fit$lev)   # lower 95% conf. band

lines(predict(fit,seq(min(x),max(x),length=500)),col=ared,lwd=2)
lines(fit$x,upper,lty=2)
lines(fit$x,lower,lty=2)
axis(1)
axis(2)
```
:::

`r item()`   Si consideri il diagramma dei residui sotto riportato.
Tracciare la retta dei residui.
Commentare la loro forma e spiegare se sono indipendenti o presentano
ancora una "struttura", un andamento peculiare.


:::{.sol data-latex=""}
La retta dei residui è parallela all'asse delle $X$, ossia coincide con esso.
Il grafico dei residui evidenzia ancora la supposta la NON linearità;
infatti, i residui mostrano un andamento "V", tipica indicazione di
non linearità.

```{r 06-regr-52}
fig.def(2.8,4.5)
```

```{r 06-regr-53}
plot(x,es,axes=F,ylab=expression(hat(epsilon[i])))
axis(1)
axis(2)
abline(h=0,lty=2)
lines(predict(smooth.spline(x,es,df = 6),seq(min(x),max(x),length=101)),col=ared)
```
:::

`r item()`  
Verificare 
l'ipotesi che la pendenza della retta di regressione sia uguale a
1 contro l'alternativa che sia maggiore di 1

:::{.sol data-latex=""}
```{r 06-regr-7,,results='asis',warning=FALSE,message=FALSE}
se_beta1()

ttest_beta(cof = 1,bj0 = 1,h1 = ">")

```
:::

`r item()`   Verificare l'ipotesi che l'intercetta della retta di
regressione sia uguale a zero contro l'alternativa che sia
minore di zero.
 
:::{.sol data-latex=""}
```{r 06-regr-8,,results='asis',warning=FALSE,message=FALSE}

res <- se_beta0()
cat(res,sep="\n")
res <- ttest_beta(cof = 0,bj0 = 0,h1 = "<")
cat(res,sep="\n")

```
:::




<div class="button-container"></div>

## Esercizio 2

Nella tabella seguente sono riportati i valori del seguente
esperimento: numero di ore dopo l'assunzione di un dato farmaco
($X$) e incremento percentuale della pressione sistolica ($Y$).


```{r 06-regr-9,,warning=FALSE,message=FALSE}
dati <- data.frame(
x = c(0.00  ,1.00  , 2.00  ,3.00  ,4.00  ,5.00  ,6.00  ,7.00  ,8.00  ,9.00  ,10.00 ),
y = c(10.00 ,1.42  ,-0.53  ,2.60  ,4.02  ,4.49  ,5.72  ,6.54  ,8.91  ,8.74  , 0.00 )
)
x <- dati$x
y <- dati$y

names(dati) <- c("$x$","$y$")
tabl(t(dati),row.names = T)
ls2e(regr(x,y))
```

`r item(T)`   Calcolare i parametri $\beta_{0}$ e $\beta_{1}$
della retta di regressione in cui $Y$ è spiegata attraverso $X$.
(Suggerimento $\bar{x} = `r mx`$; $\hat\sigma_{X} = `r sx`$;
$\bar{y} = `r my`$;  $\hat\sigma_{Y} = `r sy`$; $\text{cov}(X,Y)= `r co`$).

:::{.sol data-latex=""}

```{r 06-regr-10,,results='asis',warning=FALSE,message=FALSE}
#
res <-calcolo_beta(semplice = T)
cat(res,sep="\n")
```
:::

`r item()`   Valutare la bontà di adattamento del modello precedente.

:::{.sol data-latex=""}

```{r 06-regr-11,,results='asis',warning=FALSE,message=FALSE}
#
res <-R2()
cat(res,sep="\n")
```
:::

`r item()`   Rappresentare nel diagramma di dispersione la retta di regressione.

:::{.sol data-latex=""}
Per disegnare velocemente la retta si individuano nel grafico
due punti: (1)il punto medio $(\bar{x},\, \bar{y})$, che è già
noto; e un solo punto "estremo" nel grafico, che può essere $x=0$
o $x=10$ (i numeri "tondi" facilitano il calcolo e il disegno).
Qui, però, l'asse delle $X$ presenta l'origine, ossia,
il valore $x=0$ che ha come ordinata il valore di
$\widehat{\beta_{0}}=`r b0`$ già calcolato!
Diversamente, tramite l'equazione della retta di
regressione si stima la coordinata corrispondente:


```{r 06-regr-12,,results='asis',warning=FALSE,message=FALSE}
#
res <-previsione(10)
cat(res,sep="\n")
fig.def(3,5)
```

```{r 06-regr-54}
plot(x,y,axes=F)
axis(2,c(b0,b0+b1*10),round(c(b0,b0+b1*10),3),las=2)
axis(1)
segments(c(0,10),0,c(0,10),c(b0,b0+b1*10),lty = 2)
segments(0,c(b0,b0+b1*10),c(0,10),c(b0,b0+b1*10),lty = 2)
abline(b0,b1,col=ared)
```
:::

`r item()`  Fornire una interpretazione dei parametri della retta di regressione.

:::{.sol data-latex=""} 
I parametri della retta di regressione sono $\beta_{0}$ e $\beta_{1}$.
Il primo, $\beta_{0},$ rappresenta l'intercetta della retta,
ovvero il punto in cui la retta interseca l'asse delle ordinate.
Il secondo parametro, $\beta_{1}$, rappresenta la pendenza della
retta (chiamato anche coefficiente angolare), ovvero l'incremento
verticale corrispondente a un incremento orizzontale unitario e
coincide, perciò, con la tangente dell'angolo compreso fra la
retta e l'asse delle ascisse.

In questo caso, la variazione percentuale della pressione sistolica,
secondo il modello stimato, è dato da
$$Y= `r b0` + `r b1` X$$
ossia, è composta da un quantitativo fisso di $`r b0`$ che si ottiene
immediatamente dopo l'assunzione del farmaco ($X=0$), che non è privo
di significato, a cui si aggiunge un incremento di $`r b1`$ per ogni ora
aggiuntiva.
:::

`r item()`  Prevedere il valore relativo a $x=5$
(notando che $\bar{x}=5$, con opportune giustificazioni, si
può rispondere senza fare necessariamente i conti)

:::{.sol data-latex=""}
Dalle proprietà della retta di regressione si ha che:
$\widehat{y}_{x=\bar{x}}=\bar{y}=`r my`$. 
Ovvero: la retta di regressione passa per il punto $(\bar{x},\bar{y})$
:::

`r item()`  Calcolare l'ordine di grandezza dell'errore di previsione.

:::{.sol data-latex=""}
L'ordine di grandezza dell'errore di previsione commesso è dato
da RMSE che rappresenta una sintesi della dispersione dei residui
intorno alla retta di regressione.
\begin{displaymath}
\sigma_{\epsilon} = \sigma_{Y}\ \sqrt{1-r^2} = `r sy` \sqrt{1-`r r^2`}
= `r sqrt(sh2)`
\end{displaymath}
:::

`r item()`  Verificare 
l'ipotesi che la pendenza della retta di regressione sia uguale a
0 contro l'alternativa che sia diversa da 0

:::{.sol data-latex=""}
```{r 06-regr-13,,results='asis',warning=FALSE,message=FALSE}

res <- se_beta1()
cat(res,sep="\n")
res <- ttest_beta(cof = 1,bj0 = 0,h1 = "\\neq")
cat(res,sep="\n")
```
:::

`r item()` 
Verificare  l'ipotesi che l'intercetta della retta di
regressione sia uguale a zero contro l'alternativa che sia
diversa da zero

:::{.sol data-latex=""}
```{r 06-regr-14,,results='asis',warning=FALSE,message=FALSE}
res <- se_beta0()
cat(res,sep="\n")
res <- ttest_beta(cof = 0,bj0 = 0,h1 = "\\neq")
cat(res,sep="\n")

i2 <- 1
```
:::



<div class="button-container"></div>

## Esercizio 3


L'incasso settimanale di un negozio sia rappresentato dalla
variabile (casuale) $X$ (in migliaia di euro).
L'uscita di cassa settimanale sia rappresentata dalla variabile
(casuale) $Y$ (in migliaia di euro).
I dati rilevati per 4 mesi sono riportati di séguito.

```{r 06-regr-15,,warning=FALSE,message=FALSE}
dati <- data.frame(
x = c(12  , 21  , 25  , 31  , 13  , 15  , 10  , 18  , 19  , 24  , 28  , 32  , 33  , 22  , 24  , 35),
y = c(6   , 11  , 15  , 17  , 7   , 8   , 7   , 9   , 10  , 14  , 16  , 20  , 19  , 11  , 14  , 21
 )
)

x <- dati$x
y <- dati$y

names(dati) <- c("$x$","$y$")
tabl(t(dati),row.names = T)
ls2e(regr(x,y))
```


`r item(T)`   Calcolare i parametri $\beta_{0}$ e $\beta_{1}$
della retta di regressione in cui $Y$ è spiegata attraverso $X$.
(Suggerimento $\bar{x} = `r mx`$; $\hat\sigma_{X} = `r sx`$;
$\bar{y} = `r my`$;  $\hat\sigma_{Y} = `r sy`$; $\text{cov}(X,Y)= `r co`$).

:::{.sol data-latex=""}
```{r 06-regr-16,,results='asis',warning=FALSE,message=FALSE}
#
res <-calcolo_beta(T)
cat(res,sep="\n")
```
:::

`r item()`   Valutare la bontà di adattamento del modello precedente.

:::{.sol data-latex=""}
```{r 06-regr-17,,results='asis',warning=FALSE,message=FALSE}
#
res <-R2()
cat(res,sep="\n")
```
:::

`r item()`   Rappresentare nel diagramma di dispersione la retta di regressione.

:::{.sol data-latex=""}
Per disegnare velocemente la retta si individuano nel grafico
due punti: (1)il punto medio $(\bar{x},\, \bar{y})$, che è già
noto; e un solo punto "estremo" nel grafico, e un solo punto "estremo" nel grafico, che può essere $x=5$ o
$x=35$ (i numeri "tondi" facilitano il calcolo e il disegno, ma
qui $x=0$ non funziona perché la Y diventa negativa). Tramite
l'equazione della retta di regressione si stima la coordinata
corrispondente:


```{r 06-regr-18,,results='asis',warning=FALSE,message=FALSE}
#
res <-previsione(35)
cat(res,sep="\n")
x0 <- mx
x1 <- 35
fig.def(3,5)
```
 

```{r 06-regr-55}
plot(x,y,axes=F,xlim=c(min(x0,min(x)),max(x1,max(x))))
axis(2,c(b0+b1*x0,b0+b1*x1),round(c(b0+b1*x0,b0+b1*x1),3),las=2)
axis(1)
axis(1,mx,round(mx,3),las=2)
segments(c(x0,x1),0,c(x0,x1),c(b0+b1*x0,b0+b1*x1),lty = 2)
segments(0,c(b0+b1*x0,b0+b1*x1),c(x0,x1),c(b0+b1*x0,b0+b1*x1),lty = 2)
abline(b0,b1,col=ared)
```
:::

`r item()`  Fornire una interpretazione dei parametri della retta di regressione.

:::{.sol data-latex=""} 
I parametri della retta di regressione sono $\beta_{0}$ e $\beta_{1}$.
Il primo, $\beta_{0},$ rappresenta l'intercetta della retta,
ovvero il punto in cui la retta interseca l'asse delle ordinate.
Il secondo parametro, $\beta_{1}$, rappresenta la pendenza della
retta (chiamato anche coefficiente angolare), ovvero l'incremento
verticale corrispondente a un incremento orizzontale unitario e
coincide, perciò, con la tangente dell'angolo compreso fra la
retta e l'asse delle ascisse.

In questo caso, la variazione percentuale della pressione sistolica,
secondo il modello stimato, è dato da
$$Y= `r b0` + `r b1` X$$

ossia, è composta da un quantitativo fisso di $`r b0`$ (migliaia
di euro) quando l'uscita di cassa è zero ($X=0$), a cui si
aggiungono $`r b1`$ migliaia di euro per ogni unità (in migliaia di
euro) di incasso aggiunto.
:::

`r item()`  
Prevedere il valore dell'uscita per
un incasso di 30 migliaia di euro, ossia $x=30$ e fornire l'ordine di grandezza dell'errore
di previsione commesso.

:::{.sol data-latex=""}
```{r 06-regr-19,,results='asis',warning=FALSE,message=FALSE}
#
res <-previsione(30)
cat(res,sep="\n")
```

\[
\hat\sigma_{\varepsilon}=\hat\sigma_Y\sqrt{1-r^2}=
`r sy`\sqrt{1-`r r^2`}=`r sqrt(sh2)`
\]
:::

`r item()`  Verificare 
l'ipotesi che la pendenza della retta di regressione sia uguale a
1/2 contro l'alternativa che sia diversa da 1/2.

:::{.sol data-latex=""}
```{r 06-regr-20,,results='asis',warning=FALSE,message=FALSE}

res <- se_beta1()
cat(res,sep="\n")
res <- ttest_beta(cof = 1,bj0 = 1/2,h1 = "\\neq")
cat(res,sep="\n")
```
:::

`r item()` 
Verificare  l'ipotesi che l'intercetta della retta di
regressione sia uguale a zero contro l'alternativa che sia
minore di zero.

:::{.sol data-latex=""}
```{r 06-regr-21,,results='asis',warning=FALSE,message=FALSE}
res <- se_beta0()
cat(res,sep="\n")
res <- ttest_beta(cof = 0,bj0 = 0,h1 = "<")
cat(res,sep="\n")

i2 <- 1
```
:::



<div class="button-container"></div>

## Esercizio 4

Si esaminano 15 aziende e si rileva, per ognuna di esse,
il numero di addetti ($X$) e il fatturato ($Y$ in unità
convenzionali).
I risultati sono riportati nella tabella seguente.



```{r 06-regr-22,,warning=FALSE,message=FALSE}
dati <- data.frame(
x = c(20  , 30  , 40  , 50  , 60  , 70  , 80  , 90  , 100 , 110 , 120 , 130 , 140 , 150 , 160),
y = c(25  , 40  , 50  , 64  , 75  , 85  , 100 , 105 , 120 , 145 , 178 , 210 , 260 , 315 , 380)
)

x <- dati$x
y <- dati$y

names(dati) <- c("$x$","$y$")
tabl(t(dati),row.names = T)
ls2e(regr(x,y))
```


`r item(T)`   Calcolare i parametri $\beta_{0}$ e $\beta_{1}$
della retta di regressione in cui $Y$ è spiegata attraverso $X$.
(Suggerimento $\bar{x} = `r mx`$; $\hat\sigma_{X} = `r sx`$;
$\bar{y} = `r my`$;  $\hat\sigma_{Y} = `r sy`$; $\text{cov}(X,Y)= `r co`$).

:::{.sol data-latex=""}
```{r 06-regr-23,,results='asis',warning=FALSE,message=FALSE}
#
res <-calcolo_beta(T)
cat(res,sep="\n")
```
:::

`r item()`   Valutare la bontà di adattamento del modello precedente.

:::{.sol data-latex=""}
```{r 06-regr-24,,results='asis',warning=FALSE,message=FALSE}
#
res <-R2()
cat(res,sep="\n")
```
:::

`r item()`   Rappresentare nel diagramma di dispersione la retta di regressione.

:::{.sol data-latex=""}
Per disegnare velocemente la retta si individuano nel grafico
due punti: (1)il punto medio $(\bar{x},\, \bar{y})$, che è già
noto; e un solo punto "estremo" nel grafico, e un solo punto "estremo" nel 
 nel grafico, che può essere $x=160$
o $x=40$ (un numero inferiore dà un $y$ negativo).
Quest'ultimo NON conviene perché "esce" dagli assi.
Tramite l'equazione della retta di regressione si stima la coordinata
corrispondente:

```{r 06-regr-25,,results='asis',warning=FALSE,message=FALSE}
#
res <-previsione(40)
cat(res,sep="\n")
x0 <- 40
x1 <- mx
fig.def(3,5)
```

```{r 06-regr-56}
plot(x,y,axes=F,xlim=c(min(x0,min(x)),max(x1,max(x))))
axis(2,c(b0+b1*x0,b0+b1*x1),round(c(b0+b1*x0,b0+b1*x1),3),las=2)
axis(1)
axis(1,mx,round(mx,3),las=2)
segments(c(x0,x1),0,c(x0,x1),c(b0+b1*x0,b0+b1*x1),lty = 2)
segments(0,c(b0+b1*x0,b0+b1*x1),c(x0,x1),c(b0+b1*x0,b0+b1*x1),lty = 2)
abline(b0,b1,col=ared)
```
:::

`r item()`  Fornire una interpretazione dei parametri della retta di regressione.

:::{.sol data-latex=""} 
I parametri della retta di regressione sono $\beta_{0}$ e $\beta_{1}$.
Il primo, $\beta_{0},$ rappresenta l'intercetta della retta,
ovvero il punto in cui la retta interseca l'asse delle ordinate.
Il secondo parametro, $\beta_{1}$, rappresenta la pendenza della
retta (chiamato anche coefficiente angolare), ovvero l'incremento
verticale corrispondente a un incremento orizzontale unitario e
coincide, perciò, con la tangente dell'angolo compreso fra la
retta e l'asse delle ascisse.

In questo caso, il numero di addetti, secondo il modello stimato,
è dato da
$$y= `r b0` + `r b1` x$$
ossia, è composto da un quantitativo fisso di $`r b0`$
di fatturato quando il numero degli addetti è è zero ($X=0$)
che corrisponde al costo di una impresa senza addetti, a cui
si aggiungono `r b1` per ogni unità di lavoro aggiuntiva.
:::

`r item()`  Prevedere il valore del fatturato per un numero
di addetti pari a 75 unità, ossia per $x=75$.

:::{.sol data-latex=""}
```{r 06-regr-26,,results='asis',warning=FALSE,message=FALSE}
res <-previsione(75)
cat(res,sep="\n")
```
:::

`r item()`  Verificare 
l'ipotesi che la pendenza della retta di regressione sia uguale a
2 contro l'alternativa che sia maggiore di 2, sapendo che

:::{.sol data-latex=""}
```{r 06-regr-27,,results='asis',warning=FALSE,message=FALSE}

res <- se_beta1()
cat(res,sep="\n")
res <- ttest_beta(cof = 1,bj0 = 2,h1 = ">")
cat(res,sep="\n")
```
:::

`r item()` 
Verificare l'ipotesi che l'intercetta della retta di
regressione sia uguale a zero contro l'alternativa che sia
minore di zero.

:::{.sol data-latex=""}
```{r 06-regr-28,,results='asis',warning=FALSE,message=FALSE}
res <- se_beta0()
cat(res,sep="\n")
res <- ttest_beta(cof = 0,bj0 = 0,h1 = "<")
cat(res,sep="\n")

i2 <- 1
```
:::



<div class="button-container"></div>

## Esercizio 5

Nel maggio del 1973 per 15 giorni consecutivi si sono osservati i valori
di concentrazione di ozono (espressa in parti per milione) a New York $Y$
e temperatura a terra, $X$ (espressa in gradi Fahrenheit), come espresso
nella seguente tabella.

```{r 06-regr-29,,warning=FALSE,message=FALSE}
dati <- data.frame(
x = c(20  , 30  , 40  , 50  , 60  , 70  , 80  , 90  , 100 , 110 , 120 , 130 , 140 , 150 , 160),
y = c(25  , 40  , 50  , 64  , 75  , 85  , 100 , 105 , 120 , 145 , 178 , 210 , 260 , 315 , 380)
)
x <- dati$x
y <- dati$y

names(dati) <- c("$x$","$y$")
tabl(t(dati),row.names = T)
ls2e(regr(x,y))
```


`r item(T)`   Calcolare i parametri $\beta_{0}$ e $\beta_{1}$
della retta di regressione in cui $Y$ è spiegata attraverso $X$.
(Suggerimento $\bar{x} = `r mx`$; $\hat\sigma_{X} = `r sx`$;
$\bar{y} = `r my`$;  $\hat\sigma_{Y} = `r sy`$; $\text{cov}(X,Y)= `r co`$).

:::{.sol data-latex=""}
```{r 06-regr-30,,results='asis',warning=FALSE,message=FALSE}
#
res <-calcolo_beta(T)
cat(res,sep="\n")
```
:::

`r item()`   Valutare la bontà di adattamento del modello precedente.

:::{.sol data-latex=""}
```{r 06-regr-31,,results='asis',warning=FALSE,message=FALSE}
#
res <-R2()
cat(res,sep="\n")
```
:::

__Nota__ altre domande simili alle precedenti non vengono riportate

`r item()` 
Verificare l'ipotesi che l'intercetta della retta di
regressione sia uguale a zero contro l'alternativa che sia
minore di zero.

:::{.sol data-latex=""}
```{r 06-regr-32,,results='asis',warning=FALSE,message=FALSE}
res <- se_beta0()
cat(res,sep="\n")
res <- ttest_beta(cof = 0,bj0 = 0,h1 = "<")
cat(res,sep="\n")

```
:::



<div class="button-container"></div>

## Esercizio 6

Il reddito pro capite, in migliaia di euro, relativo a 16 aree
amministrative rilevato nell'anno 1989, $X$, e rilevato nell'anno
1999, $Y$, sono riportati nella tabella seguente.

\footnotesize
```{r 06-regr-33,,warning=FALSE,message=FALSE}
dati <- data.frame(
x = c(47.8 , 27.9 , 36.6 , 54.2 , 41.9 , 44.4 , 54.3 , 42.3 , 41.5 , 43.2 , 56.3 , 63.3 , 46.8 , 45.2 , 38.7  , 36.3 ),
y = c(63.0 , 33.4 , 42.0 , 72.8 , 52.0 , 54.0 , 63.4 , 60.7 , 54.4 , 55.5 , 74.0 , 79.2 , 53.1 , 59.6 , 52.00 , 47.2)
)
x <- dati$x
y <- dati$y

names(dati) <- c("$x$","$y$")
tabl(t(dati),row.names = T)
ls2e(regr(x,y))
```
\normalsize

`r item(T)`   Calcolare i parametri $\beta_{0}$ e $\beta_{1}$
della retta di regressione in cui $Y$ è spiegata attraverso $X$.
(Suggerimento $\bar{x} = `r mx`$; $\hat\sigma_{X} = `r sx`$;
$\bar{y} = `r my`$;  $\hat\sigma_{Y} = `r sy`$; $\text{cov}(X,Y)= `r co`$).

:::{.sol data-latex=""}
```{r 06-regr-34,,results='asis',warning=FALSE,message=FALSE}
#
res <-calcolo_beta(T)
cat(res,sep="\n")
```
:::

`r item()`   Valutare la bontà di adattamento del modello precedente.

:::{.sol data-latex=""}
```{r 06-regr-35,,results='asis',warning=FALSE,message=FALSE}
#
res <-R2()
cat(res,sep="\n")
```
:::

`r item()`  Determinare il residuo (o l'errore) derivante
dalla previsione, calcolata con il modello di regressione in $x=54.3$.

:::{.sol data-latex=""}
```{r 06-regr-36,,results='asis',warning=FALSE,message=FALSE}
#
j <- which(x==54.3)
res <-residuo(x[j],y[j])
cat(res,sep="\n")
```
:::

__Nota__ altre domande simili alle precedenti non vengono riportate

`r item()` 
Verificare 
l'ipotesi che la pendenza della retta di regressione sia uguale a 0
contro l'alternativa che sia maggiore di 0.

:::{.sol data-latex=""}
```{r 06-regr-37,,results='asis',warning=FALSE,message=FALSE}
res <- se_beta1()
cat(res,sep="\n")
res <- ttest_beta(cof = 1,bj0 = 0,h1 = ">")
cat(res,sep="\n")

```
:::



<div class="button-container"></div>

## Esercizio 7

Si esaminano 15 aziende e si rileva, per ognuna di esse, il
costo ($X$) e il fatturato ($Y$) (in unità convenzionali).
I risultati sono i seguenti:
$$y_{i} = -17.418 + 4.093 x_{i} + \epsilon_{i}$$
con $r=0.9845$.

`r item()` Qual è l'incremento di fatturato, che
ci si può attendere con un aumento del costo di una unità?
Qual è la quantità di fatturato che ci si può attendere sia
ottenute da una azienda senza costi?

:::{.sol data-latex=""} 
\begin{eqnarray*}
r         &=& \frac{\text{cov}(X,Y)} {\hat\sigma_X\cdot\hat\sigma_Y} = 0.9845 \\
\beta_{1} &=& \frac{\text{cov}(X,Y)} {\hat\sigma_X^{2}}
           =  r \frac{\hat\sigma_Y} {\hat\sigma_X} = 4.093         \\
\beta_{0} &=& \overline{y} - \beta_{1} \cdot \overline{x} = -17.418.
\end{eqnarray*}
:::

`r item(T)` 
Mostrare che la deviazione standard della $Y$ è pari a 44.803 sapendo che 
$\bar{x} = 26$; $\widehat{\sigma}_{X} = 10.7765$.

:::{.sol data-latex=""} 
\begin{eqnarray*}
\beta_{1}  &=& r\ \frac{\widehat{\sigma}_{Y}} {\widehat{\sigma}_{X}}
               \qquad\Rightarrow \\
\sigma_{Y} &=& \frac{\beta_{1} \widehat{\sigma}_{X}} {r}
            =  \frac{4.093 \times 10.7765} {0.9845}  = 44.803.
\end{eqnarray*}
:::

`r item()`
Verificare  l'ipotesi che l'intercetta della retta di
regressione sia uguale a zero contro l'alternativa che sia
diversa da zero

:::{.sol data-latex=""}
```{r 06-regr-38,,results='asis',warning=FALSE,message=FALSE}

stat2 <- list(
  mx = 26,
  bb0 = -17.418,
  bb1 = 4.093,
  my = -17.418+4.093*26,
  vx = 10.7765^2,
  vy = 44.803^2,
  co = 10.7765*44.803*0.9845,
  n = 15
)

rg <- regr(stat2=stat2)
ls2e(rg)
res <- se_beta0()
cat(res,sep="\n")
res <- ttest_beta(cof = 0,bj0 = 0,h1 = "\\neq")
cat(res,sep="\n")
```
:::



<div class="button-container"></div>

## Esercizio 8

Sia $X$ il voto in matematica (in decimi) e sia $Y$ il voto in
statistica (in decimi).
Si sono eseguite 5 osservazioni e i risultati ottenuti sono i seguenti.

```{r regr_end}

x <- c(5, 6, 7, 8, 4)
y <- c(6, 7, 6, 9, 5)

rg <- regr(x,y)
ls2e(rg)

# h <- 1/n + (x-mx)^2/(n*vx)
# ss <- sy*sqrt(1-r^2)*sqrt(1-h)
# 
# Dato <- c(1:n,"Totale","Totale/n")
# prn <- data.frame(Dato,x=c(x,0,0),y=c(y,0,0),x2 = c(x^2,0,0),y2 = c(y^2,0,0),w=c(x*y,0,0))
# prn[n+1,2:6] <- colSums(prn[1:n,2:6])
# prn[n+2,2:6] <- colMeans(prn[1:n,2:6])

# names(prn)<-c("$i$","$x_i$","$y_i$","$x_i^2$","$y_i^2$","$x_i\\cdot y_i$") 

tabl(prn[1:n,1:3],row.names = F)
```



`r item(T)` Calcolare i parametri $\beta_{0}$ e $\beta_{1}$ della retta
di regressione in cui $Y$ è spiegata attraverso $X$.

:::{.sol data-latex=""}
```{r 06-regr-57}
tabl(prn,row.names = F)%>%
  row_spec(n,hline_after = T)
```

```{r 06-regr-39,,results='asis',warning=FALSE,message=FALSE}
#
res <-calcolo_beta()
cat(res,sep="\n")
```
:::

`r item()`   Valutare la bontà di adattamento del modello precedente.

:::{.sol data-latex=""}
```{r 06-regr-40,,results='asis',warning=FALSE,message=FALSE}
#
res <-R2()
cat(res,sep="\n")
```
:::

`r item()`  Fornire una interpretazione dei parametri della retta di regressione.

:::{.sol data-latex=""}
I parametri della retta di regressione sono $\beta_{0}$ e $\beta_{1}$.
Il primo, $\beta_{0},$ rappresenta l'intercetta della retta,
ovvero il punto in cui la retta interseca l'asse delle ordinate.
Il secondo parametro, $\beta_{1}$, rappresenta la pendenza della
retta (chiamato anche coefficiente angolare), ovvero l'incremento
verticale corrispondente a un incremento orizzontale unitario e
coincide, perciò, con la tangente dell'angolo compreso fra la
retta e l'asse delle ascisse.

In questo caso, la variazione percentuale della pressione sistolica,
secondo il modello stimato, è dato da
$$Y= `r b0` + `r b1` X$$

ossia, è composto da un quantitativo fisso di $`r b0`$ di voto
quando il voto di matematica è zero ($X=0$) che in linea
generale non ha molto senso e quindi non è interpretabile
chiaramente, a cui si aggiungono $`r b1`$ punti per ogni unità
di voto di matematica aggiuntivo.
:::

`r item()` Determinare il residuo per un voto di matematica
uguale 6, ossia per $x=6$.

:::{.sol data-latex=""}
```{r 06-regr-41,,results='asis',warning=FALSE,message=FALSE}
#
j <- which(x==6)
res <-residuo(x[j],y[j])
cat(res,sep="\n")
```
:::

`r item()`  
Verificare 
l'ipotesi che la pendenza della retta di regressione sia uguale a
zero contro l'alternativa che sia maggiore di zero.

:::{.sol data-latex=""}
```{r 06-regr-42,,results='asis',warning=FALSE,message=FALSE}
res <- se_beta1()
cat(res,sep="\n")
res <- ttest_beta(cof = 1,bj0 = 0,h1 = "\\neq")
cat(res,sep="\n")
```
:::

<!--chapter:end:06-regr.Rmd-->


```{r 2021-36}
rm(list = rm())
source("intro.R")
if (html) cat('')
```


\part{Compiti degli anni passati}


```{r 2021-37}
if (html) cat('')
```
  

# Anno 2021

```{r 2021-38}
source("punti.R")
punti_list <- punti_2021
compito <- 0
```

<div class="button-container"></div>

## Prova di Statistica 2021/06/11-1

### Esercizio 1

```{r 2021-39}
compito <- compito + 1
punti <- punti_list[[compito]]
```

```{r 2021-40}
set.seed(121)   # per ottenere sempre la stessa simulazione
n <- 350      # ampiezza campionaria

nomex <- "Utile"
brk  <- c(-15,-5,0,8, 10)
nnn <- c( 5,10,20, 10)
samp <- genera_dati(brk = brk,nnn = nnn,n = n)
k <- length(brk)-1
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ aziende è stato rilevato l'utile del 2020, espresso in centinaia di migliaia euro; 
qui di seguito l'istogramma di densità percentuale.

```{r 2021-41}
histp(T)
kable(dat3[1:(k),c(1:2,6)],booktabs=T,escape = F,linesep="") %>%
   kable_styling(full_width = F, latex_options = "HOLD_position")

```

`r punti_p(start=T)` Calcolare il valore approssimato della mediana.

::: {.sol data-latex=""}
Per individuare il 75-esimo percentile dobbiamo:
$$
b_j=x_{j+1}-x_{j}
$$
le frequenze relative,
$$
f_j=h_j\cdot b_j,
$$
le cumulate
$$
F_j=f_1+...+f_j
$$
ricostruire la tabella 

```{r 2021-1,, results='asis'}
options(digits=4,nsmall=4)
kable(dat3[,c(1,2,6,5,4,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
cat(percentile(p = 0.75))
```
:::

`r punti_p()` Qual è il numero di imprese con utile negativo?

::: {.sol data-latex=""}
```{r 2021-2,,results='asis'}
cat(F_print(0,verso=">"))
```
:::

`r punti_p()` L'utile medio è pari a $\bar x=`r mean(samp)`$, e la sua standard deviation
$\sigma_X=`r sc(samp)`$. Se l'utile $X$ viene trasformato in perdita $Y$,
$$
Y=-X,
$$
quanto valgono la media $\bar y$ e la deviazione standard $\sigma_Y$ di $Y$?.

::: {.sol data-latex=""}
$$
\bar y=-\bar x=`r -mean(samp)`
$$
mentre
$$
\sigma_Y=\sigma_X=`r sc(samp)`
$$
:::




### Esercizio 2


Nel supermercato $S$ ci sono 4 casse $C_1$, $C_2$, $C_3$ e $C_4$. A mezzogiorno il numero di persone in fila ogni cassa è descritto da un Poisson di parametro 0.5, $C_i\sim\text{Pois}(0.5),~i=1,...,4$. Si assume l'indipendenza tra le variabili.

`r punti_p(nex = T)` Calcolare la probabilità che le persone **totali** ($C_1+...+C_4$) in fila al supermercato a mezzogiorno, siano almeno due.



::: {.sol data-latex=""}
$$
X=C_1+...+C_4\sim \text{Pois}(2)
$$
e quindi

\begin{eqnarray*}
P(X\ge 2)&=&1-P(X< 2)\\
&=&1-(P(X=0)+P(X=1))\\
&=&1-(`r dpois(0,2)`+`r dpois(1,2)`)\\
&=&`r 1-(dpois(0,2)+ dpois(1,2))`
\end{eqnarray*}
:::

`r punti_p()` Qual è la probabilità di avere esattamente _due_ casse su _quattro_ senza fila?

::: {.sol data-latex=""}
Posto `r pp <- dpois(0,0.5)`
$$
\pi = P(C_i=0)=\frac {0.5}{0!}e^{-0.5}=`r pp`
$$
la VC $X$ che conta il numero di casse con zero persone in fila su 4
$$
X\sim\text{Binom}(4,`r pp`)
$$
e quindi 
$$
P(X=2)=\binom{4}{2}`r pp`^2(1-`r pp`)^{4-2}=`r dbinom(2,4,pp)`
$$
:::

`r punti_p()` Quando due eventi $A$ e $B$ si dicono _indipendenti_ e quando _incompatibili_?

::: {.sol data-latex=""}
Se $A$ e $B$ sono _incompatibili_ allora
$$
P(A\cap B)=0,
$$
mentre se $A$ e $B$ sono _indipendenti_ allora
$$
P(A\cap B)=P(A)P(B),
$$
:::


`r punti_p()` Se $X_1\sim N(2,1)$, $X_2\sim N(1,1)$ e $X_3\sim N(1,1)$, 
  $X_1$, $X_2$ e $X_3$ indipendenti, come si distribuisce 
  
$$
  Y=X_1-(X_2+X_3) ~~~?
$$

::: {.sol data-latex=""}
$$Y\sim N(2-(1+1),1+1+1)\sim N(0,3)$$
:::



### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene $4$ bussolotti Rossi, $3$ bussolotti Blu e $5$ bussolotti Gialli. Si estrae 60 volte con reintroduzione; qual è la probabilità che il numero di rossi in 60 estrazioni sia maggiore di 21?


::: {.sol data-latex=""}
\[\pi=\frac 4{12}=\frac 13\]
```{r 2021-3,,results='asis'}
cat(tlc(tipo = "somma",x1 = 21,verso = ">",mu = 1/3,n = 60))
```
:::



### Esercizio 4

`r punti_p(nex = T)` Sia $h$ uno stimatore per theta, tale che
$$
E(h)=\theta+\frac\theta {\sqrt{ n}}
$$
$h$ è corretto? $h$ è asintoticamente corretto?

::: {.sol data-latex=""}
$h$ **non è corretto**, infatti
$$
E(h)=\theta+\frac\theta {\sqrt{ n}}\neq\theta
$$
$h$ **è asintoticamente corretto**, infatti
$$
\lim_{n\to\infty}E(h)=\lim_{n\to\infty}\left(\theta+\frac\theta {\sqrt{ n}}\right)=\theta+0=\theta
$$
:::

`r punti_p()` Siano $h_1$ e $h_2$ due stimatori per $\theta$, tali che:
\begin{eqnarray*}
MSE(h_1) &=&   \frac\theta n\\
MSE(h_2) &=&   \frac{2\theta} n
\end{eqnarray*}
Quale dei due stimatori è più efficiente? Perché?

::: {.sol data-latex=""}
$h_1$ **è più efficiente** di $h_2$, infatti
\begin{eqnarray*}
MSE(h_1) &=&   \frac\theta n\\
MSE(h_2) &=&   \frac{2\theta} n =2\cdot MSE(h_1)>MSE(h_1)
\end{eqnarray*}
:::

`r punti_p()` Si sono osservati due gruppi di dati quantitativi e si è osservato, $\hat\mu_1=10.2$ e $\hat\mu_2=15.6$. Posto a test
$$
\begin{cases}
H_0:\mu_1=\mu_2\\
H_1:\mu_1\ne \mu_2
\end{cases}
$$
è risultato $p_\text{value}=0.0612$. La differenza tra $\hat\mu_1$ e $\hat\mu_2$ è significativa? Perché?

::: {.sol data-latex=""}
Il $p_\text{value}$ è maggiore di 0.05, la differenza **non è significativa** per ogni livello di significatività.
:::




### Esercizio 5

`r punti_p(nex = T)` In uno studio comparato sui livelli di occupazione femminile, nel comune $A$ sono state intervistate 50 donne e 30 hanno dichiarato di avere un lavoro stabile; nel comune $B$ sono state intervistate 60 donne e 40 hanno dichiarato di avere un lavoro stabile.

Testare l'ipotesi che la proporzione di donne che hanno un lavoro stabile nel comune $A$ sia uguale a quelle del come $B$, contro l'alternativa che siano **diverse**.

::: {.sol data-latex=""}
```{r 2021-4,, results='asis'}
s1 <- 30
n1 <- 50
s2 <- 40
n2 <- 60
h1 <- "\\neq"
alpha <- 0.01

a <- "A"
b <- "B"

cat(ztest_2c_pi(s1 = s1,s2 = s2,n1 = n1,n2 = n2,h1 = h1,a = a,b = b))
```
:::



### Esercizio 6
```{r 2021-42}

set.seed(5)
set.seed(8)
set.seed(11)
n <- 150
x <- round(sort(runif(n,5,10)),2)
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- rnorm(n,0,1)
y <- x+eps
y <- round(y/max(y)*10,2)
#plot(x,y,type="p")

RGX <- regr(x,y,ax=0,semp=T)
ls2e(RGX)
options(digits = 4)
```

In uno studio sulle competenze scolastiche dei quindicenni si sono analizzati $n=`r n`$ ragazzi sui quali sono stati registrati i voti di un test in matematica $X$ e i voti in un test di scienze $Y$. Qui di seguito le statistiche di interesse:

\begin{align*}
\sum_{i=1}^n x_i &= `r sumx`,   &\sum_{i=1}^n x_i^2 &= `r sumx2` \\
\sum_{i=1}^n y_i &= `r sumy`,   &\sum_{i=1}^n y_i^2 &= `r sumy2` \\
\sum_{i=1}^n x_iy_i &= `r sumxy`.    \\
\end{align*}

Si consideri il modello di regressione dove $Y$ viene spiegata da $X$

  `r punti_p(nex = T)` Prevedere il voto nel test di scienze per uno studente che ha ottenuto 6 nel test di matematica.
  
::: {.sol data-latex=""}
```{r 2021-5,,results='asis'}

cat(calcolo_beta())

```
:::
  
  `r punti_p()` Calcolare la percentuale di varianza spiegata dal modello.

::: {.sol data-latex=""}
```{r 2021-6,,results='asis'}
options(digits = 4)
cat(R2())
```
:::


  `r punti_p()` Discutere il qq-plot dei residui
```{r 2021-7,,fig.asp=1}
qqnorm(es/sd(es),asp=1,xlim=c(-3,3),ylim=c(-3,3))
abline(0,1,lty=2)
```

::: {.sol data-latex=""}
I punti sono be allineati sulla bisettrice degli assi, l'ipotesi di normalità dei residui è rispettata.
:::

 `r punti_p()` Cosa vuol dire che $r$ è un numero puro?

::: {.sol data-latex=""}
Significa che è privo di unità di misura.
:::



<div class="button-container"></div>

## Prova di Statistica 2021/06/11-2

```{r 2021-43}



source("intro.R")
fig.def(2.5,3.5)



```

### Esercizio 1

```{r 2021-44}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2021-45}
# Basic settings
set.seed(120)   # per ottenere sempre la stessa simulazione
n <- 300      # ampiezza campionaria
nomex <- "Temperature"

brk  <- c(-15,-5,0,5, 15)
nnn  <- c( 5,10,10, 5)
nnn  <- round(nnn/sum(nnn)*n)

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Sono state registrate le temperature del comune $C$ per $n=200$ giorni. Qui di seguito l'istogramma di densità percentuale.

```{r 2021-46}
histp(axes = T)

kbl((dat3[1:(k),c(1:2,6)]),booktabs=T,escape = F,linesep="") %>%
   kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Calcolare il valore approssimato del 25-esimo percentile.

::: {.sol data-latex=""}
Per individuare il 25-esimo percentile dobbiamo:
$$
b_j=x_{j+1}-x_{j}
$$
le frequenze relative,
$$
f_j=h_j\cdot b_j,
$$
le cumulate
$$
F_j=f_1+...+f_j
$$
ricostruire la tabella 

```{r 2021-8,, results='asis'}
options(digits=4,nsmall=4)
kable(dat3[,c(1,2,6,5,4,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
cat(percentile(p = 0.25))
```
:::
 
`r punti_p()` Analizzando l'istogramma, individuare il valore della media aritmetica e della mediana.


::: {.sol data-latex=""}
L'istogramma è perfettamente simmetrico
$$
\bar x\approx x_{0.5}\approx 0
$$
:::


`r punti_p()` Qual è la percentuale di dati compresa tra il 25-esimo e il 75-esimo percentile?

::: {.sol data-latex=""}
Per definizione
\begin{eqnarray*}
\%(X\le x_{0.25})&=&25\%\\
\%(X\le x_{0.75})&=&75\%, \qquad\text{e quindi}\\
\%(x_{0.25}< X\le x_{0.75})&=&50\%
\end{eqnarray*}
:::




### Esercizio 2
  
```{r 2021-47}
s1 <- 0.55
s2 <- 0.85
```

Il flusso giornaliero d'acqua in entrata nella vasca $V$ è descritto da una variabile casuale normale $X_E\sim N(5.1,1.1)$, il flusso giornaliero in uscita è descritto da una variabile casuale normale $X_U\sim N(6.2,0.5)$.

La variazione di livello nella vasca è dunque data da:
$$
X_L=X_E-X_U.
$$
`r punti_p(nex = T)` Calcolare la probabilità che la variazione di livello sia negativa ($X_L<0$).

::: {.sol data-latex=""}
La variazione di livello nella vasca si distribuisce
$$
X_L=X_E-X_U\sim N(5.1-6.2;1.1+0.5)
$$
E quindi

```{r 2021-48}
vnam<-"X_L"
mm <- 5.1-6.2
ss <- 1.1+0.5
x0 <- 0


```

```{r 2021-9,,results='asis'}
cat(norm_int(x1 = 0,verso = "<",mm = mm,ss = ss,vnam = "X_L"))
```
:::


`r punti_p()` Nell'ipotesi di indipendenza tra i giorni, calcolare la probabilità di avere esattamente _due_ giorni su _cinque_ con livello negativo.  `r pp <- pnorm(0,mm,sqrt(ss))`

::: {.sol data-latex=""}
Posto
$$
\pi = P(X_L=0)=`r pnorm(0,mm,sqrt(ss))`
$$
la VC $X$ che conta il numero di giorni con livello negativo in 5 giorni
$$
X\sim\text{Binom}(5,`r pp`)
$$
e quindi 

```{r 2021-49}
bin_dis(2,5,pp,sing=T)
```

:::


`r punti_p()` Se $P(A)=0.6$ e $P(B)=0.8$, $A$ e $B$ possono essere incompatibili?

::: {.sol data-latex=""}
No, perché se fossero incompatibili allora
$$
P(A\cup B)=P(A)+P(B)=0.6+0.8=1.4>1
$$
che è impossibile.
:::


`r punti_p()` Se $X\sim N(\mu_X,\sigma^2_X)$ come si distribuisce 
  $$Y=\left(\frac{X-\mu_X}{\sigma_X}\right)^2 ~~~?$$
  
::: {.sol data-latex=""}
Anzitutto osserviamo che
$$
Z=\frac{X-\mu_X}{\sigma_X}\sim N(0,1)
$$
Poi che
$$
Y=Z^2\sim\chi_1^2
$$
:::



### Esercizio 3
  
`r punti_p(nex = T)` Un'urna contiene $4$ bussolotti numerati con $\fbox{−1}$, $3$ numerati con $\fbox{0}$ e $4$ numerati con $\fbox{+1}$. Si estrae 60 volte con reintroduzione; qual è la probabilità che la media delle 60 estrazioni sia minore di 0.1?

::: {.sol data-latex=""}
```{r 2021-10,,results='asis'}
urn <- rep(c(-1,0,1),times=c(4,3,4))
cat(stat_(x = urn,semp = T))
cat(tlc(tipo = "media",x1 = .1,verso = "<",mu = mean(urn),s2 = s2c(urn),n = 60))
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Sia $h$ uno stimatore per $\theta$, tale che
$$
MSE(h)=\frac\theta {\sqrt{ n}}+\frac1n
$$
$h$ è consistente? Perché?

::: {.sol data-latex=""}
Sì, è _consistente_, infatti
$$
\lim_{n\to\infty}MSE(h)=\lim_{n\to\infty}\left(\frac\theta {\sqrt{ n}}+\frac1n\right)=0
$$
:::

`r punti_p()` Siano $X_1,...,X_n$ $n$ VC IID, replicazioni di $X\sim \mathscr{L}(\theta)$ e sia $\hat\theta$ lo stimatore di massima verosimiglianza per $\theta$, 
$\hat\theta$ è corretto?

::: {.sol data-latex=""}
No, _in generale_ $\hat\theta$ non è corretto, ad esempio
$$
E(\hat\sigma^2)=\frac{n-1}n\sigma^2\ne\sigma^2
$$
ma lo è sempre asintoticamente
$$
\lim_{n\to\infty}E(\hat\theta)=\theta
$$
ad esempio:
$$
\lim_{n\to\infty}E(\hat\sigma^2)=\lim_{n\to\infty}\frac{n-1}n\sigma^2=\sigma^2
$$
:::

`r punti_p()` Definire la significatività e la potenza di un test.

::: {.sol data-latex=""}
La probabilità di **significatività** è definita con $\alpha$ e rappresenta la probabilità di rifiutare $H_0$ quando è vera
$$\alpha=P(\text{Errore I tipo})=P(\text{Decidere $H_1$};H_0)$$

La **potenza del test** è definita
$$1-\beta =P(\text{Decidere $H_1$}; H_1)$$

Cioè la probabilità di scegliere $H_1$ quando $H_1$ è vera.
:::



### Esercizio 5

```{r 2021-50}
n1 <- 15
n2 <- 18
mu1 <- 23.2
mu2 <- 20.1
s1h <- 2.2
s2h <- 1.8
h1 <- "\\neq"
a <-"A"
b <- "B"
alpha <- 0.01
ac <- alpha*100
```

`r punti_p(nex = T)` In uno studio comparato sul reddito femminile, nel comune $`r a`$ sono state intervistate 15 donne e si è osservato un reddito medio pari a $\bar x_`r a`=`r mu1`$ mila euro lordi annui con una standard deviation pari a $\hat\sigma_`r a`=`r s1h`$; nel comune $`r b`$ sono state intervistate 18 donne e si è osservato un reddito medio pari a $\bar x_`r b`=`r mu2`$ mila euro lordi annui con una standard deviation pari a $\hat\sigma_`r b`=`r s2h`$.

Sotto ipotesi di omogeneità, testare l'ipotesi che il reddito medio femminile nel comune $`r a`$ sia uguale a quello del comune $`r b`$, contro l'alternativa che siano **diversi**.

::: {.sol data-latex=""}
```{r 2021-11,,results='asis'}
cat(ttest_2c_om(mu1 = mu1,mu2 = mu2,s1h = s1h,s2h = s2h,n1 = n1,n2 = n2,h1 = h1,a = a,b = b))
```
:::





### Esercizio 6
```{r 2021-51}

set.seed(8)
n <- 150
x <- sort(runif(n,5,10))
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- rnorm(n,0,1)*(1:n)/n
y <- x+eps
y <- y/max(y)*10
#plot(x,y,type="p")

RGX <- regr(x,y,ax=0,semp=T)
ls2e(RGX)

```

In uno studio sulle competenze scolastiche dei quindicenni si sono analizzati $n=`r n`$ ragazzi sui quali sono stati registrati il numero di libri in casa $X$ (espresso in decine di libri) e i voti in un test di comprensione $Y$. Qui di seguito le statistiche di interesse:

\begin{align*}
\sum_{i=1}^n x_i &= `r sumx`,   &\sum_{i=1}^n x_i^2 &= `r sumx2` \\
\sum_{i=1}^n y_i &= `r sumy`,   &\sum_{i=1}^n y_i^2 &= `r sumy2` \\
\sum_{i=1}^n x_iy_i &= `r sumxy`.    \\
\end{align*}

Si consideri il modello di regressione dove $Y$ viene spiegata da $X$

  `r punti_p(nex = T)` Si osservino le prime 5 coppie di dati
```{r 2021-52}
kable(data.frame(i=1:5,Libri=x[1:5],Voto=y[1:5]),booktabs=T,escape = F,linesep="") %>%
   kable_styling(full_width = F, latex_options = "HOLD_position")
```
Calcolare il residuo per il quarto dato.

::: {.sol data-latex=""}
```{r 2021-12,,results='asis'}

cat(calcolo_beta())
cat(residuo(x[4],y[4]))
```
:::

  `r punti_p()` Il modello si adatta bene ai dati?

::: {.sol data-latex=""}
Il modello spiega il $r^2\times100=(`r r`)^2\times 100=`r r^2*100`\%>75\%$ della viarbilità totale di $Y$. Sì, il modello spiega bene i dati.
:::

  `r punti_p()` Discutere il diagramma dei residui
```{r 2021-53}
plot(x,y-ys,pch=16,axes=F,xlab="Libri",ylab=expression(hat(epsilon)),type="p")
axis(1)
axis(2)
abline(h=0,lty=2)
title("retta dei residui vs x")
```

::: {.sol data-latex=""}
La variabilità dei residui cresce al crescere dalla x, l'ipotesi di omoschedasticità è chiaramente violata.
:::

`r punti_p()` Quando in un modello di regressione lineare un punto è considerato **influente**?

::: {.sol data-latex=""}
La coppia $(x_i,y_i)$ è considerata _punto influente_ se il suo residuo studentizzato è maggiore di un livello soglia deciso sulle tavole della $t$ con $n-2$ gradi di libertà:
$$|\tilde \varepsilon_i|>t_{n-2,0.05} $$
:::



<div class="button-container"></div>

## Prova di Statistica 2021/06/30-1

```{r 2021-54}



source("intro.R")
fig.def(2.5,3.5)



```

### Esercizio 1

```{r 2021-55}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2021-56}
# Basic settings
set.seed(121)   # per ottenere sempre la stessa simulazione
n <- 350      # ampiezza campionaria
nomex<- "Costo"
brk  <- c(0,5,8,13, 20)
nnn  <- c( 5,20,20, 10)
nnn  <- round(nnn/sum(nnn)*n)

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ aziende è stato rilevato il costo in spese legali (espresso in migliaia di euro). Qui di seguito i dati in classi e le frequenze cumulate:
```{r 2021-57}
kable((dat3[1:(k),c(1:2,7)]),booktabs=T,escape = F,linesep="") %>%
   kable_styling(full_width = F, latex_options = "HOLD_position")

```

`r punti_p(start=T)` Individuare la classe modale.

::: {.sol data-latex=""}
La classe modale è per definizione la classe cui compete densità maggiore e dunque dobbiamo calcolare
le frequenze relative,
$$
f_j=F_j-F_{j-1},
$$
calcolare l'ampiezza delle classi,
$$
b_j=x_{j+1}-x_{j}
$$
e la densità di frequenza percentuale
$$
d_j=\frac{f_j}{b_j}\times 100
$$
ricostruire la tabella 
```{r 2021-58}
kable(dat3[,c(1,2,7,4,5,6)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```
e osservare che la classe $[5,8)$ è la classe modale perché è quella con densità maggiore.
:::

`r punti_p()` Calcolare la percentuale approssimata di aziende 
con spese maggiori di 10 mila euro.

::: {.sol data-latex=""}
```{r 2021-13,,results='asis'}
cat(F_print(10,">"))
```
:::

`r punti_p()` Calcolare la percentuale approssimata di aziende 
con spese maggiori di 10 mila euro.

::: {.sol data-latex=""}
La mediana $x_{0.5}$ è il minimante

$$
\sum_{i=1}^n|x_i-x_{0.5}|<\sum_{i=1}^n|x_i-x^*|, ~~\forall x^*\neq x_{0.5}
$$
:::



### Esercizio 2
  
L'urna $A$ contiene 4 palline numerate: $\fbox{-1},\fbox{0},\fbox{0},\fbox{+1}$. 

L'urna $B$ contiene 3 palline numerate: $\fbox{0},\fbox{1},\fbox{2}$. 

Si estrae dall'urna $A$ e dall'urna $B$ e si *sommano* i due numeri

`r punti_p(nex = T)` Calcolare la probabilità che la somma dei numeri sia maggiore uguale a 2.

::: {.sol data-latex=""}
```{r 2021-14,,results='asis'}
a <- (two_way(S_1 = c(-1,0,1),S_2 = 1:2,num1 = c(1,2,1),num2 = c(1,1,1)))
```
$$
P(S\ge 2)=3/12+1/12=4/12=1/3
$$
:::

`r punti_p()` Calcolare la probabilità che la somma sia maggiore uguale a 1 dato che dall'urna $A$ è uscito $\fbox{0}$.

::: {.sol data-latex=""}
Dalla definizione stessa di probabilità condizionata
\begin{eqnarray*}
P(X\geq 1|X_A=0)&=&\frac{P(\{X\geq 1\}\cap\{X_A=0\})}{P(\{X_A=0\})}\\
                &=&\frac{2/12+2/12}{2/4}\\
                &=&4/12\cdot4/2\\
                &=&`r 4/12*4/2`
\end{eqnarray*}
:::

`r punti_p()` Sia $X\sim \text{Pois}(10)$ e $Y\sim\text{Binom}(n,0.5)$.
Sia
$$
W=X-Y
$$
Calcolare il valore atteso $E(W)$ e la varianza $V(W)$ di $W$.

::: {.sol data-latex=""}
Osserviamo
\begin{align*}
E(X)&=10 &E(Y)&=n\cdot 0.5\\
V(X)&=10 &V(Y)&=n\cdot0.5(1-0.5)
\end{align*}
e quindi
\begin{eqnarray*}
E(W)&=&E(X)-E(Y)\\
&=&10-n\cdot 0.5\\
V(W)&=&V(X)+V(Y),\qquad\text{se e solo se $X$ e $Y$ sono indipendenti}\\
&=&10+n\cdot 0.25
\end{eqnarray*}
:::

`r punti_p()` Siano $X_1,...,X_6$, $6$ variabili casuali IID,
tali che
$$
X_i\sim N\left(2.5,3^2\right).
$$
Come si distribuisce
$$
Y=\sum_{i=1}^6\left(\frac{X_i-2.5}{3}\right)^2~~?
$$

::: {.sol data-latex=""}
Si osserva
$$
Z_i=\frac{X_i-2.5}{3}\sim N(0,1)
$$
e quindi
$$
Y=(Z_1^2+...+Z_6^2)\sim\chi_6^2
$$
:::




### Esercizio 3
  
`r punti_p(nex = T)` Si lancia un dado perfetto, si vince se esce un numero maggiore o uguale a 5.
Si gioca $n=64$ volte, qual è la probabilità di vincere più di 23 volte su 64 giocate?


::: {.sol data-latex=""}
$$
\pi=\frac 2 6=\frac 13
$$
la probabilità di vincere all'estrazione $i$, e quindi $X_i\sim\text{Ber}(\pi)$

\begin{eqnarray*}
E(X_i)&=&\pi\\
V(X_i)&=&\pi(1-\pi)
\end{eqnarray*}

In virtù del TCL della somma di n VC IID

```{r 2021-15,,results='asis'}
vnam<-"S_n"
mm <- 1/3*64
ss <- 1/3*2/3*64
x0 <- 23
options(digits = 4)
cat(tlc("somma",x1 = 23,verso = ">",mu = 1/3,n = 64))
```
:::




### Esercizio 4
  
`r punti_p(nex = T)` Sia $h$ uno stimatore per $\theta$, tale che
\begin{eqnarray*}
E(h)&=&\theta+\frac\theta {\sqrt{ n}}\\
V(h)&=&\frac{\theta^2}{\sqrt n}
\end{eqnarray*}
$h$ è consistente?

::: {.sol data-latex=""}
Uno stimatore è consistente se
$$
\lim_{n\to\infty} MSE(h)=0
$$
Essendo
\begin{eqnarray*}
MSE(h)&=&V(h)+B^2(h)\\
&=&V(h)+|E(h)-\theta|^2\\
&=&\frac{\theta^2}{\sqrt n}+\left|\theta+\frac\theta {\sqrt{ n}}-\theta\right|^2\\
&=&\frac{\theta^2}{\sqrt n}+\frac{\theta^2} { n}\\
\lim_{n\to\infty} \left(\frac{\theta^2}{\sqrt n}+\frac{\theta^2} { n}\right)&=&0
\end{eqnarray*}
Quindi sì, $h$ è consistente.
:::

`r punti_p()` Definire la funzione di verosimiglianza.

::: {.sol data-latex=""}
Siano $x_1,...,x_n$ $n$ osservazioni di $X\sim \mathscr{L}(\theta)$, $\theta\in\Theta$, si definisce la verosimiglianza $L$ di $\theta$ la funzione:
$$L(\theta;x_1,...,x_n)=L(\theta)\propto P(X_1=x_1,...,X_n=x_n;\theta)$$

Se $x_1,..,x_n$ sono osservazioni $IID$ otteniamo
\begin{eqnarray*}
L(\theta) &\propto& P(X_1=x_1;\theta)\cdot...\cdot P(X_n=x_n;\theta) \\
          &\propto& \prod_{i=1}^n f(x_i;\theta)
\end{eqnarray*}
:::

`r punti_p()` Si sono osservati due gruppi di dati quantitativi e si è osservato, $\hat\mu_1=10.2$, $\hat\sigma_1=1.12$ e $\hat\mu_2=15.6$, $\hat\sigma_2=3.72$. Posto a test
$$
\begin{cases}
H_0:\sigma_1=\sigma_2\\
H_1:\sigma_1\ne \sigma_2
\end{cases}
$$
è risultato $p_\text{value}=0.0012$. I due gruppi sono da considerare omogenei o eterogenei? Perché?

::: {.sol data-latex=""}
Il $p_\text{value}=0.0012$ ci indica che i dati supportano $H_1$, quindi i due gruppi
sono da considerarsi eterogenei.
:::



### Esercizio 5

`r punti_p(nex = T)` In uno studio sui consumi sono stati intervistati $n=25$ individui 
sui quali è stato rilevato il reddito mensile $X$ (in migliaia di euro), e il consumo $Y$ (in migliaia di euro). Il modello di regressione
$$
Y_i=\beta_0+\beta_1 x_i+\varepsilon_i
$$
ha fornito i seguenti risultati

\begin{align*}
\hat\beta_0&=0.60, &\hat\beta_1&=0.75, &r&=0.87\\
\bar x&=1.61 &\hat \sigma_X&=0.90\\
\bar y&=1.81 &\hat \sigma_Y&=0.78\\
\end{align*}


Testare l'ipotesi che il consumo di sussistenza $\beta_0$ sia uguale 0.5 contro l'alternativa 
che sia maggiore.

::: {.sol data-latex=""}
```{r 2021-16,,results='asis'}
b00 <- 0.5
mx <- 1.61
my <- 1.81
vy <- 0.78^2
r <- 0.87
vx <- 0.90^2
b0 <- 0.6
n <- 25
sh2 <- vy*(1-r^2)
se2 <- (n/(n-2))*sh2 
vb1 <- se2 / (n*vx) 
vb0 <- se2*(1/n+mx^2/(n*vx))
h1 <- ">"
stat2 <- list(n=n,mx=mx,vx=vx,my=my,vy=vy,co=r*sqrt(vx*vy))
ls2e(regr(stat2=stat2))
cat(se_beta0())
cat(ttest_beta(0,bj0 = .5,h1 = h1))
```
:::




### Esercizio 6
```{r 2021-59}
set.seed(11)
n <- 75
x <- sort(runif(n,0,10))

eps <- rnorm(n,0,1.8)
y <- 0.5 + x*.7 +eps
y[y<0] <- -y[y<0]

RGX <- regr(x,y,ax=0,semp=T)
ls2e(RGX)
options(digits = 4)

# a <- regr(x,y)
# cat("note compito\n")
# mean(x)
# a$mx
# a$my
# a$vx
# a$vy
# a$b0
# a$b1
# n
# mx

```

In uno studio sui consumi sono stati intervistati $n=75$ individui 
sui quali è stato rilevato il reddito mensile $X$ (in migliaia di euro), e il consumo $Y$ (in migliaia di euro). Il modello di regressione. Qui di seguito le statistiche di interesse:

\begin{align*}
\bar x&=`r mean(x)` &\hat \sigma_X&=`r sc(x)`, &x_{(0)}&=`r min(x)`,  &x_{(n)}&=`r max(x)`,\\
\bar y&=`r mean(y)` &\hat \sigma_Y&=`r sc(y)`, &y_{(0)}&=`r min(y)`,  &y_{(n)}&=`r max(y)`,\\
\text{cov}(X,Y)&=`r co`.
\end{align*}


Si consideri il modello di regressione dove $Y$ viene spiegata da $X$

  `r punti_p(nex = T)` Prevedere il consumo per un individuo che guadagna $x=`r mean(x)`$ e
  per un individuo che guadagna $x=12.3$.
  
::: {.sol data-latex=""}
```{r 2021-17,,results='asis'}
cat(calcolo_beta(semplice = T))
cat(previsione(12.3))
```
:::

  `r punti_p()` Quale delle due previsioni, per $x=`r mean(x)`$ e per $x=12.3$,
  è più affidabile? Perché?

::: {.sol data-latex=""}
L'errore di previsione per $x$ dipende dalla sua distanza quadratica dalla media 
$$
\text{err prev}(x)=V(\hat Y_{(X=x)})=\sigma_{\varepsilon}^{2}\left(\frac 1n+\frac{(x-\bar x)^2} {n \hat{\sigma}^{2}_{X}} \right)
$$
quindi l'errore di previsione è minimo per $x=`r mean(x)`$, mentre $x=12.3>x_{(n)}=`r max(x)`$
e si tratta di estrapolazione.

La previsione per $x=`r mean(x)`$ è molto più affidabile che quella per $x=12.3$.
:::

  `r punti_p()` Calcolare le quantità $TSS$, $RSS$ e $ESS$.

::: {.sol data-latex=""}
Ricaviamo $R^2$
$$R^2=\left(\frac{`r cv`}{`r sc(x)`\cdot `r sc(y)`}\right)^2=`r r`^2=`r r^2`$$
quindi
```{r 2021-18,,results='asis'}
cat(TSS())
```
:::

 `r punti_p()` Cosa vuol dire che $r$ è invariante ai cambiamenti di scala?

::: {.sol data-latex=""}
$$\text{se }W=a+bY,\text{allora }r_{X,W}=\text{sign}(b) r_{XY},\text{ dove la funzione sign}(b)=
\begin{cases}+1, &\text{se $b>0$}\\
             -1, &\text{se $b<0$}
\end{cases}$$
:::




<div class="button-container"></div>

## Prova di Statistica 2021/06/30-2

```{r 2021-60}



source("intro.R")
fig.def(2.5,3.5)



```

### Esercizio 1

```{r 2021-61}
compito <- compito + 1
punti <- punti_list[[compito]]
```
Su un campione di $12$ famiglie della provincia $Q$ è stato rilevato il reddito mensile, qui di seguito i dati **non ordinati** espressi in migliaia di euro al mese.

```{r 2021-62}
# Basic settings
par(cex=0.5)
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 12      # ampiezza campionaria
nomex <- "Consumo"
samp <- round(sample(c(runif(4,0,1),runif(4,1.01,4),runif(4,4.01,8),runif(4,8.01,20))),1)[1:12]

brk <- c(0,1,4,8,20)
n <- length(samp)

c1 <- paste("$", 1:4 ,"$",sep="")
c2 <- paste("$", 5:8,"$",sep="")
c3 <- paste("$",9:12,"$",sep="")

out <- data.frame(c1,s1=samp[1:4],c2,s2=samp[5:8],c3,s2=samp[9:12])

names(samp) <- nomex
#source("T1/stat-base.R")

kable(out,col.names = c("$i$","$x_{i}$","$i$","$x_{i}$","$i$","$x_{i}$"),booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position") %>%
  column_spec(c(1,3,5),background = "#E6E6E6",width = "3em")

i25 <- ceiling(n*.25)
x25 <- samp[i25]

i50 <- ceiling(n*.50)
x50 <- samp[i50]

i75 <- ceiling(n*.75)
x75 <- samp[i75]


```

`r punti_p(start=T)` Individuare il 25-esimo, 50-esimo e l'75-esimo percentile

::: {.sol data-latex=""}
Dobbiamo prima riordinare i dati
```{r 2021-63}

c1 <- paste("$(", 1:4 ,")$",sep="")
c2 <- paste("$(", 5:8,")$",sep="")
c3 <- paste("$(",9:12,")$",sep="")

samp <- sort(samp)
out <- data.frame(c1,s1=samp[1:4],c2,s2=samp[5:8],c3,s2=samp[9:12])

kable(out,col.names = c("$i$","$x_{i}$","$i$","$x_{i}$","$i$","$x_{i}$"),booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position") %>%
  column_spec(c(1,3,5),background = "#E6E6E6",width = "3em")

i25 <- ceiling(n*.25)
x25 <- samp[i25]

i50 <- ceiling(n*.50)
x50 <- samp[i50]

i75 <- ceiling(n*.75)
x75 <- samp[i75]

x <- samp

n <-12
set.seed(1)   # per ottenere sempre la stessa simulazione
nomex <- "Consumo"
samp <- round(sample(c(runif(4,0,1),runif(4,1.01,4),runif(4,4.01,8),runif(4,8.01,20))),1)
```

e quindi

\begin{eqnarray*}
x_{0.25} &=& x_{(\lceil n\times0.25\rceil)}=x_{(`r i25`)}=`r x25`\\
x_{0.50} &=& \frac{x_{(n/2)}+x_{(n/2+1)}}{2}=\frac{`r x[n/2]`+`r x[n/2+1]`}{2}
=`r (x[n/2]+x[n/2+1])/2`\\
x_{0.75} &=& x_{(\lceil n\times0.75\rceil)}=x_{(`r i75`)}=`r x75`
\end{eqnarray*}
:::

`r punti_p()` La somma dei dati è `r sum(samp)`. Come dobbiamo aspettarci l'istogramma di densità?

::: {.sol data-latex=""}
La somma dei dati è `r sum(samp)` e quindi la media viene
$$
\bar x=\frac 1{12}`r sum(samp)`=`r sum(samp)/12`
$$

siccome $\bar x>x_{0.5}$ allora l'istogramma avrà una coda lunga a dx.
:::

`r punti_p()` Cosa significa che la media aritmetica gode della proprietà di linearità?



### Esercizio 2

Si consideri un'urna così formata,
$$
\left\{\fbox{1},\fbox{2},\fbox{3},\fbox{4},\fbox{5},\fbox{6},\fbox{7},\fbox{8}\right\}.
$$
Si vince se si estrae un numero maggiore o uguale a 6. 

Si estrae _con_ reintroduzione.

`r punti_p(nex = T)` Qual è la probabilità di vincere almeno 5 volte su 6 estrazioni?

::: {.sol data-latex=""}
Sia $X$ la VC che conta il numero di di vittorie in 6 giocate,
quindi $n=6$ replicazioni di una Bernoulli $X_i\sim\mbox{Ber}(\pi=3/8)$ e quindi

$$
X=X_1+...+X_n\sim\mbox{Binom}(n=6,\pi=`r 3/8`)
$$

la probabilità di avere almeno 5 bussolotti rossi su 6 estrazioni è


```{r 2021-19,,results='asis'}
pp <- .38
cat(bin_dis(5,6,pp = 3/8,verso = ">"))
```
:::

`r punti_p()` Calcolare la probabilità di vincere la prima volta alla quarta estrazione.

::: {.sol data-latex=""}
Ogni singola giocata $X_i$ è una Bernoulli $X_i\sim\mbox{Ber}(\pi=3/8)$ e quindi 
\begin{eqnarray*}
E&=&\text{Vincere la prima volta alla quarta estrazione}\\
 &=& X_1=0~\cap~X_2=0~\cap~X_3=0~\cap~X_4=1\\
P(E)&=&P(X_1=0~\cap~X_2=0~\cap~X_3=0~\cap~X_4=1)\\
&=&P(X_1=0)P(X_2=0)P(X_3=0)P(X_4=1)\\
&=&\left(1-\frac 38\right)\left(1-\frac 38\right)\left(1-\frac 38\right)\frac 38\\
&=&\left(\frac 58\right)^3\frac 38\\
&=&`r (5/8)^3*3/8 `
\end{eqnarray*}
:::

`r punti_p()` Se $A$ e $B$ sono due eventi tali che, $P(A)>0$, $P(B)>0$, $P(A\cap B)=0$. 
$A$ e $B$ possono essere indipendenti?

::: {.sol data-latex=""}
No, in quanto, se $A$ e $B$ sono indipendenti
$$P(A\cap B)=P(A)P(B)\neq0$$
:::

`r punti_p()` Sia $X\sim N(3.2,(1.1)^2)$ e sia $Y\sim\chi_{n-1}^2$, posto
$$
T=\frac{\left(\frac{X-3.2}{1.1}\right)}{\sqrt{\frac{Y}{n-1}}},
$$
come si distribuisce $T$?

::: {.sol data-latex=""}
Si noti che
$$
Z=\left(\frac{X-3.2}{1.1}\right)\sim N(0,1)
$$
e che
$$
T=\frac{Z}{\sqrt{\frac{Y}{n-1}}}\sim t_{n-1}
$$
:::



### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene un numero imprecisato di palline numerate. Si conoscono solo
la media $\mu=12.3$ e la standard deviation $\sigma=1.1$ dei numeri delle sfere.

Si estrae $n=81$ volte con reintroduzione, qual è la probabilità che la media delle 81 estrazioni sia compresa tra
12.06 e 12.54?

::: {.sol data-latex=""}
Il valore atteso di della $i$-esima estrazione è
$$
E(X_i)=12.3
$$
e la varianza
$$
V(X_i)=1.1^2
$$

In virtù del TCL per la media: la media di  $n$ VC IID, tali che
$E(X_i)=\mu$, $V(X_i)=\sigma^2$

```{r 2021-20,,results='asis'}
vnam<-"\\bar X"
mm <- 12.3
ss <- 1.1^2/81
x1 <- 12.06
x2 <- 12.54
options(digits = 4)
cat(tlc(tipo = "media",x1 = x1,x2 = x2,verso = NULL,n = 81,mu = mm,s2 = 1.1^2))
```
:::




### Esercizio 4
  
`r punti_p(nex = T)` Sia $h$ uno stimatore per $\theta$, tale che
\begin{eqnarray*}
E(h)&=&\theta+\frac\theta {n^2},\\
V(h)&=&\frac{\sqrt\theta}{ n}.
\end{eqnarray*}
Ricavare $MSE(h)$, il Mean Squared Error di $h$. 

::: {.sol data-latex=""}
\begin{eqnarray*}
MSE(h)&=&V(h)+B^2(h)\\
&=&V(h)+|E(h)-\theta|^2\\
&=&\frac{\sqrt\theta}{ n}+\left|\theta+\frac\theta {n^2}-\theta\right|^2\\
&=&\frac{\sqrt\theta}{ n}+\frac{\theta^2} { n^4}\\
\end{eqnarray*}
:::

`r punti_p()` Scrivere la funzione di verosimiglianza di una Poisson.

::: {.sol data-latex=""}
Siano $X_1,...,X_n$, $n$ VC IID, tali che, $X_i\sim\text{Pois}(\lambda)$
La verosimiglianza è
\begin{eqnarray*}
  L(\lambda) &=& \prod_{i=1}^n\frac{\lambda^{x_i}}{x_i!}e^{-\lambda}\\
             &\propto& \lambda^{s_n} e^{-n\lambda},\qquad s_n=\sum_{i=1}^n x_i
\end{eqnarray*}
:::

`r punti_p()` Definire il $p_{\text{value}}$, la probabilità di significatività osservata.

::: {.sol data-latex=""}
La probabilità di significatività $p_{\text{value}}$ è

$$p_{\text{value}}=P(|T|>|t_{\text{obs}}|;H_0)$$

La probabilità di significatività osservata $p_\text{value}$ esprime la probabilità, _se fosse vera_ $H_0$, 
di trovare un campione ancora più in favore di $H_1$ di quello disponile
:::



### Esercizio 5

`r punti_p(nex = T)` In uno studio sulle preferenze tra canali televisivi, vengono analizzati `r n<-92; n`
individui, classificati canale preferito (RAI, Mediaset, La7) e per titolo di studio superiore (Laureato, Non Laureato)

Qui di seguito i dati dello studio,
$$
\begin{array}{l|rrr|r}
 & \text{Rai} &\text{Mediaset} &\text{La7}& \\ \hline
 \text{Laureato}     &15 &5 &12  &32\\ 
 \text{Non Laureato} &10 &35  &15 &60\\ \hline
                     &25 &40  &27 &92 
\end{array}
$$

Titolo di studio superiore e canale preferito sono indipendenti?

::: {.sol data-latex=""}
È un test sull'indipendenza tra due VC

```{r 2021-21,,results='asis'}
dat <- matrix(c(15,5,12,10,35,15),2,byrow = T)

nome_x<- c("Rai","Mediaset","La7")
nome_y <- c("Laureato","Non Laureato")

dat_print <- chi_print(dat,nome_x = nome_x,nome_y = nome_y)[[1]]
dat       <- chi_print(dat,nome_x = nome_x,nome_y = nome_y)[[2]]

kable(dat,digits = 4,row.names = T,linesep="",booktabs=T,escape = F) %>%
  kable_styling(full_width = F, latex_options = "HOLD_position") %>%
  column_spec(column = 1,bold = T)

cat(chi_test(dat = dat))
```
:::




### Esercizio 6
```{r 2021-64}


set.seed(4)

x <- c(1.0,2.1,3.9,5.2)
y <- c(4.2,5.6,5.4,7.5)

RGX <- regr(x,y,ax=0,semp=T)
ls2e(RGX)

options(digits = 4)
```


In uno studio sulla qualità della vita si è osservato su 4 provincie l'ammontare degli investimenti provinciali pro capite per attività culturali ($X$), in centinaia di euro, e un indice di qualità della vita ($Y$), espresso in opportuna scala. Qui di seguito i dati
```{r 2021-65}
kable(prn[1:4,1:3],booktabs=T,escape = F,linesep="")%>%
  kable_styling(full_width = F, latex_options = "HOLD_position")%>%
  column_spec(1,background = "#E6E6E6",width = "3em")
```

`r punti_p(nex = T)` Stimare il modello di regressione dove la qualità della vita è spiegata dagli investimenti provinciali.

::: {.sol data-latex=""}
Costruiamo le statistiche
```{r 2021-22,,results='asis'}
kable(prn,booktabs=T,escape = F,linesep="")%>%
  kable_styling(full_width = F, latex_options = "HOLD_position")%>%
  column_spec(1,background = "#E6E6E6",width = "3em")

cat(calcolo_beta())
```
:::

`r punti_p()` Calcolare la percentuale di varianza spiegata dal modello.

::: {.sol data-latex=""}
Ricaviamo $R^2$
$$
R^2=\left(\frac{`r cv`}{`r sc(x)`\cdot `r sc(y)`}\right)^2=`r r`^2=`r r^2`
$$
Il modello si adatta molto bene ai dati, spiegando il `r r^2*100`% (>75%) della variabilità totale della Y. 
:::


`r punti_p()` Ricavare le quantità $TSS$, $RSS$ e $ESS$.

::: {.sol data-latex=""}
```{r 2021-23,,results='asis'}
cat(TSS())
```
:::

`r punti_p()` Cosa significa che gli stimatori di massima dei minimi quadrati $\hat\beta_0$ e $\hat\beta_1$ sono _BLUE_?

::: {.sol data-latex=""}
Gli stimatori $\hat\beta_{0}$ e $\hat\beta_{1}$ di $\beta_{0}$ e $\beta_{1}$
sono, tra tutti gli stimatori lineari corretti per $\beta_0$ e $\beta_1$, _BLUE_ 
( _Best Linear Unbiased Estimators_ Best: i più efficienti; Unbiased: corretti; 
Linear Estimators: stimatori lineari).
:::



<div class="button-container"></div>

## Prova di Statistica 2021/07/22-1

```{r 2021-66}



source("intro.R")
fig.def(2.5,3.5)



```

### Esercizio 1

```{r 2021-67}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2021-68}
# Basic settings
set.seed(12)   # per ottenere sempre la stessa simulazione
n <- 350      # ampiezza campionaria

brk  <- c(0,5,8,13, 20)/2
nnn  <- c( 5,20,20, 10)
nnn  <- round(nnn/sum(nnn)*n)

nomex <- "Spese per Metano"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ aziende è stato rilevato il costo annuo in gas metano (espresso in migliaia di euro). Qui di seguito l'istogramma di densità:

```{r 2021-69}

histp(axes = T)
kable((dat3[1:(k),c(1:2,6)]),booktabs=T,escape = F,linesep="") %>%
   kable_styling(full_width = F, latex_options = "HOLD_position")

```

`r punti_p(start=T)` Calcolare il valore approssimato della mediana.

::: {.sol data-latex=""}
Per individuare la mediana dobbiamo costruire le basi:
$$
b_j=x_{j+1}-x_{j}
$$
le frequenze relative,
$$
f_j=h_j\cdot b_j,
$$
le cumulate
$$
F_j=f_1+...+f_j
$$
ricostruire la tabella 
```{r 2021-70}
kable(dat3[,c(1,2,6,5,4,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```
e quindi:
```{r 2021-24,,results='asis'}
cat(percentile())
```
:::

`r punti_p()` Che relazione dobbiamo aspettarci tra media e mediana?

::: {.sol data-latex=""}
L'istogramma presenta una coda lunga a sinistra e quindi
$$
\bar x > x_{0.5}
$$
:::

`r punti_p()` La varianza dei dati è pari a $\sigma^2=`r s2c(samp)`$. Nell'ipotesi che i costi per metano aumentassero del 10%, quanto varrebbe la varianza?

::: {.sol data-latex=""}
Si tratta di una trasformazione lineare
$$
Y = 1.1\cdot X
$$
e quindi
$$
\sigma_Y^2=(1.1)^2\sigma_X^2=`r 1.1^2*s2c(samp)`.
$$
:::



### Esercizio 2
  
In una stazione ci sono 3 binari. Ogni ora il numero di persone che transita su ogni
binario è descritto da una Poisson. In particolare

- $X_1\sim\text{Pois}(1.1)$, il binario uno;
- $X_2\sim\text{Pois}(1.1)$, il binario due;
- $X_3\sim\text{Pois}(0.5)$, il binario tre.

Il numero di persone in transito su un binario è indipendente dal numero di persone in transito sugli altri binari.

`r punti_p(nex = T)` Calcolare la probabilità che il *totale* delle persone in transito nella stazione, in una data ora, sia maggiore o uguale a due.

::: {.sol data-latex=""}
Il totale di persone in transito è la somma delle tre Poisson
$$
X=X_1+X_2+X_3\sim \text{Pois}(\lambda=1.1+1.1+0.3)
$$
```{r 2021-25,,results='asis'}
cat(pois_dis(2,1.1*2+.3,verso = "\\geq"))
```
:::


`r punti_p()` Calcolare la probabilità di osservare una persona su un binario, una persona su un altro binario e nessuna persona sul rimanetene.

::: {.sol data-latex=""}
```{r 2021-71}
p10<-dpois(0,1.1)
p11<-dpois(1,1.1)
p30<-dpois(0,0.5)
p31<-dpois(1,0.5)
```

Anzitutto osserviamo:

\begin{eqnarray*}
P(X_1= 0) &=& P(X_2=0)\\
          &=& \frac{1.1^0}{0!}e^{-1.1}\\
          &=& `r dpois(0,1.1)`\\
P(X_1= 1) &=& P(X_2=1)\\
          &=& \frac{1.1^1}{1!}e^{-1.1}\\
          &=& `r dpois(1,1.1)`\\
P(X_3= 0) &=& \frac{0.5^0}{0!}e^{-0.5}\\
          &=& `r dpois(0,0.5)`\\
P(X_3= 1) &=& \frac{0.5^1}{1!}e^{-0.5}\\
          &=& `r dpois(1,0.5)`\\
\end{eqnarray*}

L'evento _una persona su un binario, una persona su un altro binario e nessuna persona sul rimanetene_
si scompone:

\begin{eqnarray*}
E &=& \big\{(X_1=1\cap X_2=1\cap X_3=0)\cup\\
   &&\cup(X_1=1\cap X_2=0\cap X_3=1)\cup\\
   &&\cup(X_1=0\cap X_2=1\cap X_3=1)\big\}\\
P(E) &=& \phantom{+} P(X_1=1\cap X_2=1\cap X_3=0)+\\
     && + P(X_1=1\cap X_2=0\cap X_3=1)+\\
     && + P(X_1=0\cap X_2=1\cap X_3=1)\\
     &=& \phantom{+} P(X_1=1)P(X_2=1)P(X_3=0)+\\
     && + P(X_1=1)P(X_2=0)P(X_3=1)+\\
     && + P(X_1=0)P(X_2=1)P(X_3=1)\\
     &=& \phantom{+} `r p11`\cdot`r p11`\cdot`r p30`+\\
     && +`r p11`\cdot`r p10`\cdot`r p31`+\\
     && +`r p10`\cdot`r p11`\cdot`r p31`\\
     &=& `r p11*p11*p30+2*p11*p10*p31`
\end{eqnarray*}
:::

`r punti_p()` Siano $X_1,...,X_n$, $n$ VC IID, tali che
$$
X_i\sim N(0,1).
$$
Posto
$$
\bar X = \frac{X_1+...+X_n}{n},
$$
come si distribuisce $\bar X$?

::: {.sol data-latex=""}
$$
\bar X = \frac{X_1+...+X_n}{n}\sim N\left(0,\frac 1n\right),
$$
:::

`r punti_p()` Siano $X_1\sim \text{Binom}(5,0.3)$ e $X_2\sim \text{Binom}(3,0.3)$.
Come si distribuisce,
$$X_1+X_2\sim ~~?$$

::: {.sol data-latex=""}
$$X_1+X_2\sim \text{Binom}(8,0.3)$$

**se e solo se** $X_1$ e $X_2$ sono indipendenti.
:::



### Esercizio 3
  
`r punti_p(nex = T)` Un'urna contiene 4 palline numerate
$$\fbox{-1},\fbox{0},\fbox{2},\fbox{3}$$
Si estrae $n=64$ volte con reintroduzione.

Calcolare la probabilità che la media delle 64 estrazioni sia compresa tra
0.92 e 4.08.

::: {.sol data-latex=""}
```{r 2021-26,,results='asis'}
urn <- c(-1,0,2,3)
mu <- mean(c(-1,0,2,3))
s2 <- s2c(c(-1,0,2,3))
cat(stat_(urn,semp = T))
```

In virtù del TLC per la media otteniamo

```{r 2021-27,,results='asis'}
mm <-  mu
ss <- s2/64
sd <- sqrt(ss)
x1 <- 0.92
x2 <- 4.08
cat(tlc(tipo = "media",x1 = x1,x2 = x2,verso = NULL,mu = mu,s2 = s2,n = 64))
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Se $h$ è uno stimatore tale che la sua distorsione va a zero per $n$ che tende all'infinito:
$$
\lim_{n\to \infty}B(h)=0
$$
di quale proprietà gode $h$?

::: {.sol data-latex=""}
Osserviamo che
\begin{align*}
B(h) &= E(h)-\theta&\text{e quindi}\\
\lim_{n\to\infty}B(h)&=0\\
\lim_{n\to\infty}(E(h)-\theta)&=0 &\text{se e solo se}\\
\lim_{n\to\infty}E(h)&=\theta &\text{cioè $h$ è asintoticamente corretto}
\end{align*}
:::

`r punti_p()` Definire la funzione di verosimiglianza della Bernoulli.

::: {.sol data-latex=""}
La verosimiglianza è
\begin{eqnarray*}
L(\pi)     &\propto& \prod_{i=1}^n \pi^{x_i}(1-\pi)^{1-x_i}\\
           &=& \pi^{s_n}(1-\pi)^{n-s_n}, \qquad s_n=\sum_{i=1}^n x_i
\end{eqnarray*}
:::

`r punti_p()` Un dado, che non sappiamo se è perfetto oppure no, viene lanciato 40 volte.
Posto $\pi_i$ la probabilità che il dado mostri la faccia $i$, $i=1,...,6$, si è testato
$$
\begin{cases}
H_0:\pi_1=\pi_2=...=\pi_6=\frac 16
\end{cases}
$$
ed è risultato $p_\text{value}=0.21$. Possiamo concludere che il dado sia truccato?

::: {.sol data-latex=""}
Il $p_\text{value}=0.21>0.05$ non c'è motivo per rifiutare $H_0$, quindi il dado non è truccato.
:::



### Esercizio 5

Una casa farmaceutica sta sperimentando un farmaco che lenisce il mal di testa in modo rapido. Osservati $n=15$ individui, si è registrato che il farmaco agisce in media $\bar x=26.2$ minuti, con  una sd corretta pari a
$S=0.9$. 

`r punti_p(nex = T)` Costruire un intervallo di confidenza al 99% per il tempo medio di azione.

::: {.sol data-latex=""}
```{r 2021-28,,results='asis'}
cat(idc(xm = 26.2,sd = 0.9,alpha = .01,n = 15,dist_ = "t"))
```
:::

`r punti_p()` È ben noto, da studi pregressi, che quella tipologia di farmaci ha un tempo medio 
di azione pari a 29.3. Testare che il farmaco in sperimentazione agisca in modo uguale agli altri contro l'alternativa che abbia tempi di azione inferiori.

::: {.sol data-latex=""}
```{r 2021-29,,results='asis'}
n <- 15
s <- 0.9
muh <- 26.2
mu0 <- 29.3
h1 <- "<"
alpha <- 0.01
cat(ttest_mu(muh = muh,sh = s,n = n,mu0 = mu0,h1 = h1))
```
:::



### Esercizio 6

```{r 2021-72}


set.seed(34)
n <- 15
x <- sort(runif(n,0,10))

eps <- rchisq(n,df = 1)
y <- (x/10)^2*.7 +eps*.05

x <- round(x,2)
y <- round(y,2)

RGX <- regr(x,y,ax = 2,semp = T)
ls2e(RGX)
```

In uno studio sul risparmio gestito sono stati intervistati $n=`r n`$ individui 
sui quali è stato rilevato il reddito mensile $X$ (in migliaia di euro), e il risparmio gestito $Y$ (in migliaia di euro). Il modello di regressione. Qui di seguito i dati e le statistiche di interesse:

```{r 2021-73}
kable(prn[],format.args = list(big.mark = " "),digits = 4,booktabs=T,escape = F,linesep="")%>%
  kable_styling(full_width = F, latex_options = "HOLD_position")%>%
  column_spec(1,background = "#E6E6E6",width = "3em")
```


  `r punti_p(nex = T)` Stimare il modello di regressione dove il risparmio è funzione del reddito e quello in cui il reddito è funzione del risparmio.
  
::: {.sol data-latex=""}
```{r 2021-30,,results='asis'}
cat(calcolo_beta())
cat(calcolo_beta(inv = T))
```
:::


  `r punti_p()` I due modelli si adattano bene ai dati?

::: {.sol data-latex=""}
$$
r^2=(`r r`)^2=`r r^2`>0.75
$$

Sì, i modelli si adattano bene
:::

  `r punti_p()` Discutere il diagramma dei residui del modello di regressione dove $Y$ viene spiegata da $X$.
```{r 2021-74}
plot(x,ml$residuals,xlab="Reddito",ylab = "residui",type = "p",pch=16)
abline(h=0,lty=2)

```

::: {.sol data-latex=""}
C'è una non linearità evidente, l'assunto zero non è rispettato
:::

 `r punti_p()` Se ogni individuo risparmiasse 10€ in più al mese, quanto varrebbe $r$?
 
::: {.sol data-latex=""}
Se ogni individuo risparmiasse 10€ in più al mese allora
$$
W=Y+10
$$
e in virtù dell'invarianza del coefficiente di correlazione alle trasformazioni lineari otterremmo:
$$
r_{XW}=r_{XY}=`r r`
$$
:::



<div class="button-container"></div>

## Prova di Statistica 2021/07/22-2

```{r 2021-75}



source("intro.R")
fig.def(2.5,3.5)



```

### Esercizio 1

```{r 2021-76}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2021-77}
# Basic settings
set.seed(12)   # per ottenere sempre la stessa simulazione
n <- 350      # ampiezza campionaria

brk  <- c(0,5,8,13, 20)/2
nnn  <- c( 5,20,20, 10)
nnn  <- round(nnn/sum(nnn)*n)

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ aziende è stato rilevato il costo annuo in gas metano (espresso in migliaia di euro). Qui di seguito i dati e le frequenze percentuali

```{r 2021-78}
kable((dat3[1:(k),c(1:2,12)]),booktabs=T,escape = F,linesep="") %>%
   kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Calcolare la colonna delle densità percentuali.

::: {.sol data-latex=""}
```{r 2021-79}
kable((dat3[1:(k),c(1:6)]),booktabs=T,escape = F,linesep="") %>%
   kable_styling(full_width = F, latex_options = "HOLD_position")
histp(T)
```
:::

 `r punti_p()` Calcolare il numero approssimato di aziende con consumo di gas inferiore al 25-esimo percentile $x_{0.25}$. 

::: {.sol data-latex=""}
Per definizione
$$
\%(X\le x_{0.25})=25\%
$$
$n=`r n`$ e quindi il 25% di `r n` è
$$
`r n`\times0.25=`r n*.25`
$$
:::

`r punti_p()` È vero che la media aritmetica minimizza la somma dei valori assoluti degli scarti? Perché?

::: {.sol data-latex=""}
È la mediana che minimizza la somma dei valori assoluti degli scarti. Siccome media e mediana, in generale non coincidono allora no, la media non minimizza la somma dei valori assoluti degli scarti.
:::




### Esercizio 2

Ci sono due urne: 

- l'urna $A$: $\left\{\fbox{0},\fbox{0},\fbox{1}\right\}$ e 
- l'urna $B$: $\left\{\fbox{0},\fbox{1},\fbox{1}\right\}$.

Si estrae dalle due urne e si somma, 

- se la somma fa 2 si vince, 
- altrimenti si perde,

poi si rimettono le palline nelle urne e si ripete il gioco per $n=5$ volte.

`r punti_p(nex = T)` Qual è la probabilità di vincere almeno 1 volta su 5 giocate?

::: {.sol data-latex=""}
$$
\pi=P(X_A+X_B=2)=P(X_A=1)P(X_B=1)=\frac 13\times\frac23=\frac29=`r 2/9`
$$

$X\sim\text{Binom}(n=5,\pi=`r 2/9`)$ e quindi

```{r 2021-31,,results='asis'}
cat(bin_dis(1,n = 5,pp = 2/9,verso = "\\geq",comp = T))
```
:::

`r punti_p()` Per giocare si devono puntare due euro ad ogni giocata. Se vinciamo ci vengono dati 9€, i 2€ giocati più 7€ di vincita. Quindi:

- se la somma non fa 2 perdiamo 2€ 
- se la somma fa 2 riceviamo 9€ (7€ vinti + 2€ giocati)

Quale è il valore atteso della variabile causale che conta il totale di euro ottenuti dopo 5 partite?

::: {.sol data-latex=""}
Sia $X_i$ la VC che dice se alla giocata $i$ si è vinto o perso
$$
X_i\sim\text{Ber}\left(\pi=\frac 29\right)
$$
sia $Y$ il guadagno/perdita della giocata $i$
$$
Y_i=-2+9X_i
$$
e quindi
$$
E(Y_i)=E(-2+9X)=-2+9E(X)=-2+9~\frac29=0
$$
Sia $Y$ la vincita totale dopo 5 partite

\begin{eqnarray*}
  Y  &=&Y_1+...+Y_5\\
E(Y) &=&E(Y_1+...+Y_5)\\
     &=&E(Y_1)+...+E(Y_n)\\
     &=& 0+...+0\\
     &=& 0
\end{eqnarray*}
:::


`r punti_p()` Se $A$ e $B$ sono due eventi tali che, $P(A)=0.5$, $P(B)=0.4$ e $P(A\cup B)=0.58$. $A$ e $B$ sono indipendenti? Perché?

::: {.sol data-latex=""}
No, perché se lo fossero
$$
P(A\cap B)=0.5\times 0.4=0.2
$$
e quindi
\begin{eqnarray*}
  P(A\cup B) &=& P(A)+P(B)-P(A\cap B)\\
             &=& 0.5+0.4-0.2\\
             &=& 0.7\ne 0.58
\end{eqnarray*}
:::


`r punti_p()` Siano $Y_1,...,Y_n$, $n$ VA IID, tali che, $Y_i\sim\chi_{1}^2$, posto
$$
X=\sum_{i=1}^n Y_i
$$
come si distribuisce $X$?




### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene 150 di palline numerate. 

- 40 palline numerate con -1
- 70 palline numerate con  0
- 40 palline numerate con +1

Si estrae $n=81$ volte con reintroduzione, qual è la probabilità che la somma delle 81 estrazioni sia compresa tra
$-6.6$ e $+6.6$?

::: {.sol data-latex=""}
```{r 2021-32,,results='asis'}
urn <- rep(-1:1,times = c(40,70,40))
mm <-  0
ss <- s2c(urn)
sd <- sqrt(ss)
x1 <- -6.6
x2 <-  6.6
vnam <- "S_n"
cat(stat_(urn,semp = T))
cat(tlc(tipo = "somma",x1 = x1,x2 = x2,verso = NULL,mu = 0,s2 = ss,n = 81))
```
:::




### Esercizio 4
  
`r punti_p(nex = T)` Sia $\hat\sigma^2$ lo stimatore di massima verosimiglianza per il parametro $\sigma^2$ della normale. $\hat\sigma^2$ è corretto? Quanto vale la sua distorsione?

::: {.sol data-latex=""}
No, $\hat\sigma^2$ non è corretto
$$
E(\hat\sigma^2)=\frac{n-1}n\sigma^2
$$
e quindi
$$
B(\hat\sigma^2)=|E(\hat\sigma^2)-\sigma^2|=\frac {\sigma^2}n
$$
:::

`r punti_p()` Descrivere la tavola della verità di un test.

`r punti_p()` In uno studio clinico si è osservato l'effeto sul numero di anticorpi su due gruppi trattati con un farmaco differente. Si è osservato $\hat\mu_1=10.2$, $\hat\sigma_1=1.12$ e $\hat\mu_2=15.6$, $\hat\sigma_2=3.72$. Posto a test
$$
\begin{cases}
H_0:\sigma_1=\sigma_2\\
H_1:\sigma_1\ne \sigma_2
\end{cases}
$$
è risultato $p_\text{value}=0.21$. Quale test dovremmo usare per testare la differenza tra le medie?




### Esercizio 5

Un'azienda automobilistica sta sperimentando un nuovo tipo di motore per ridurre i consumi di carburante. Il motore montato su un'auto prototipo che è stata fatta guidare a $n=15$ giornalisti. Si è osservato un consumo medio pari $\bar x=24.5~\text{Km/litro}$ con una deviazione standard $\hat\sigma=2.25~\text{Km/litro}$. `r m <- 24.5; s<-15/14*2.25`

`r punti_p(nex = T)` Costruire un intervallo di confidenza al 95% per il consumo medio.

::: {.sol data-latex=""}
```{r 2021-33,,results='asis'}
cat(idc(xm = m,sd = 2.25,alpha = .05,n = 15,dist_ = "t"))
```
:::


`r punti_p()` È noto che quella fascia di motori ha un consuo medio pari $23.9~\text{Km/litro}$. Testare che il nuovo motore consumi come gli altri contro l'alternativa che abbia consumi _diversi_.

::: {.sol data-latex=""}
$$
\begin{cases}
H_0:\mu=23.9\\
H_1:\mu\ne23.9
\end{cases}
$$

Siccome $23.9\notin IdC_{95\%}$ allora rifiuto $H_0$ al lds del $5\%$.
:::



### Esercizio 6

```{r 2021-80}
xm <- 1.1
ym <- 12.1
wm <- 0.9
sx <- 0.23
sy <- 1.17
sw <- 0.12

cxy <- sx*sy*.81
cwy <- -sy*sw*0.23

b1 <- cxy/(sx^2)
b0 <- ym - b1*xm

g1 <- cwy/(sw^2)
g0 <- ym - g1*wm

rxy <- cxy/(sx*sy)
rwy <- cwy/(sw*sy)

```

In uno studio sugli effetti dell'attività sportiva sul benessere delle persone su $n=25$ atleti si è misurato:

- il numero medio di ore giornaliere passate a correre ($X$), 
- il numero medio di ore giornaliere passate a fare palestra ($W$),
- un indice di stress misurato misurato su opportuna scala ($Y$).

qui di seguito le statistiche di interesse


\begin{align*}
\bar x&=1.1   &\hat \sigma_X&=0.23, \\
\bar w&=0.9   &\hat \sigma_W&=0.12,\\
\bar y&=12.1  &\hat \sigma_Y&=1.17,\\
\text{cov}(X,W)&=`r -0.12*0.23*.76` &\text{cov}(X,Y)&=`r 1.17*0.23*.81` \\
&&\text{cov}(W,Y)&=`r -1.17*0.12*.14`
\end{align*}


`r punti_p(nex = T)` Stimare il modello di regressione dove l'indice di stress ($Y$) è spiegato da $X$ e quello dove $Y$ è spiegato da $W$.

::: {.sol data-latex=""}
\begin{align*}
  Y_i &= \beta_0+\beta_1 x_i +\varepsilon_i&Y_i &=\gamma_0+\gamma_1W_i\\
  \hat\beta_1&=\frac{`r cxy`}{`r sx`^2} &\hat\gamma_1&=\frac{`r cwy`}{`r sw`^2}\\
  &=`r b1` &&=`r g1`\\
  \hat\beta_0&=`r ym`-`r b1`\cdot`r xm` &\hat\beta_0&=`r ym`-(`r g1`\cdot`r wm`)\\
  &=`r b0` &&=`r g0`\\
r_{XY}&=\frac{`r cxy`}{`r sx`\cdot`r sy`} &r_{WY}&=\frac{`r cwy`}{`r sw`\cdot`r sy`}\\
  &=`r rxy` &&=`r rwy`\\
\end{align*}
:::

`r punti_p()` Quale dei due modelli è più affidabile?

::: {.sol data-latex=""}
\begin{align*}
  R_{XY}^2 &= `r rxy`^2 &R_{WY}^2 &= `r rwy`^2 \\
  &=`r rxy^2` &&=`r rwy^2`
\end{align*}


quindi $X$ spiega $Y$ meglio di $W$.
:::

`r punti_p()` Considerata la scomposizine della TSS di $X$ rispetto ad $Y$.
$$
TSS = ESS + RSS
$$
quanto vale il rapporto
$$
\frac{ESS}{TSS}=~?
$$

::: {.sol data-latex=""}
$$
\frac{ESS}{TSS}=~R_{XY}^2=`r rxy^2`
$$
:::

`r punti_p()` Sotto ipotesi di normalità dei residui, come sono distribuiti gli stimatori dei mini quadrati $\hat\beta_0$ e $\hat\beta_1$?

::: {.sol data-latex=""}
\begin{eqnarray*}
\hat\beta_1&\sim& N\left(\beta_1, \frac{\sigma_{\varepsilon}^{2}} {n \hat{\sigma}^{2}_{X}} \right)\\
\hat\beta_0&\sim& N\left(\beta_0, \sigma_{\varepsilon}^{2} \left( \frac{1} {n}  +  \frac{\bar{x}^{2}} {n \hat{\sigma}^{2}_{X}} \right) \right)
\end{eqnarray*}
:::



<div class="button-container"></div>

## Prova di Statistica 2021/09/06-1

```{r 2021-81}
#


source("intro.R")
fig.def(2.5,3.5)



```

### Esercizio 1

```{r 2021-82}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2021-83}
# Basic settings
set.seed(12)   # per ottenere sempre la stessa simulazione
n <- 155      # ampiezza campionaria
nomex<- "Bilancio x 1000 euro"

brk  <- c(-10,-5,0,3, 20)
nnn  <- c( 10,110,100, 50)
nnn  <- round(nnn/sum(nnn)*n)

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```


Su un campione di $`r n`$ aziende è bilancio annuo (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze percentuali:
```{r 2021-84}
kable(dat3[,c(1,2,12)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Individuare la classe modale.

::: {.sol data-latex=""}
```{r 2021-85}
kable(dat3[,c(1:2,12,3:7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```
:::

`r punti_p()` Quante aziende, approssimativamente, hanno un bilancio inferiore a 1.5?

::: {.sol data-latex=""}
```{r 2021-34,,results='asis'}
histp(T)
h.int(-10,1.5,density=20)
axis(1,1.5,las=2,col.axis=2)
cat(F_print(1.5))
```
:::

`r punti_p()` Che relazione dobbiamo aspettarci tra media e mediana? 

`r punti_p()` La varianza dei dati è pari a $\sigma^2=`r s2c(samp)`$. Nell'ipotesi che tutte le aziende aumentassero il loro bilancio di 10 mila ero, quanto varrebbe la varianza dei così trasformati?




### Esercizio 2
  
Siano $X_1\sim N(10,2)$ e sia $X_2\sim N(10,3)$. Posto $A=\{X_1<11\}$, $B=\{X_1>9\}$, e $C=\{9<X_2<10\}$

`r punti_p(nex = T)` Quanto vale $P\Big((A\cap B)\cap C\Big)$? 

::: {.sol data-latex=""}
\[
(A\cap B)\cap C = \{9<X_1<11\}\cap\{9<X_2<10\}
\]
e quindi 
```{r 2021-35,,results='asis'}
x1 <- 9
x2 <- 11
mm <- 10
ss <- 2
vnam <- "X_1"
cat(norm_int(x1 = x1,x2 = x2,verso = NULL,mm = mm,ss = ss,vnam = "X_1",mu = "\\mu_1",sigma = "\\sigma_1"))
```
inoltre
```{r 2021-86}
x1 <- 9
x2 <- 10
mm <- 10
ss <- 3
vnam <- "X_2"
cat(norm_int(x1 = x1,x2 = x2,verso = NULL,mm = mm,ss = ss,vnam = "X_2",mu = "\\mu_2",sigma = "\\sigma_2"))
```
e infine
\[
P\Big(\{9<X_1<11\}\cap\{9<X_2<10\}\Big)=P\Big(\{9<X_1<11\}\Big)P\Big(\{9<X_2<10\}\Big)=
`r (pnorm(11,10,sqrt(2))-pnorm(9,10,sqrt(2)))*(pnorm(10,10,sqrt(3))-pnorm(9,10,sqrt(3)))`
\]
:::

`r punti_p()` Posto $Y=X_1-X_2$, calcolare $P(Y<-1)$.

::: {.sol data-latex=""}
$$Y=X_1-X_2\sim N(10-10,2+3)$$

```{r 2021-87}
x0 <- -1
x2 <- 10
mm <- 0
ss <- 5
vnam <- "Y"
cat(norm_int(x1 = x0,mm = mm,ss = ss,vnam = "Y",mu = "\\mu_Y",sigma = "\\sigma_Y"))
```
:::

`r punti_p()` Siano $X_1,...,X_n$, $n$ VC IID, tali che $X_i\sim \text{Ber}(\pi)$, posto
\[
 X = X_1+...+X_n
\]
come si distribuisce $X$? 

`r punti_p()` Sia $X\sim \text{Pois}(1.5)$, per quali valori $x$, $F(x)$, la funzione di ripartizione di $X$ è minore o uguale a 0.5? Ovvero, per quali $x$ la seguente è rispettata $F(x)\le 0.5$?

::: {.sol data-latex=""}
Per definizione
\begin{eqnarray*}
F(x)   &=&  P(X\le x)\\
       &=&\sum_{t=0}^x f(t)\\
       &=&\sum_{t=0}^x \frac{\lambda^t}{t!}e^{-\lambda}\\
\end{eqnarray*}

\begin{eqnarray*}
  F(0) &=&  \frac{1.5^0}{0!}e^{-1.5}=`r ppois(0,1.5)`\\
  F(1) &=&  \frac{1.5^0}{0!}e^{-1.5}+  \frac{1.5^1}{1!}e^{-1.5}=`r ppois(1,1.5)`
\end{eqnarray*}
:::



### Esercizio 3
  
`r punti_p(nex = T)` Enunciare il teorema centrale del limite per la somma. 

`r punti_p()` Il numero di incidenti giornalieri sul lavoro del comparto $A$ è distribuito come una
Poisson di parametro $\lambda = 0.1$. In un anno $n=365$ quale è la probabilità che il numero totale di
incidenti sia minore di 40?

::: {.sol data-latex=""}
$E(X_i)=0.1$, $V(X_i)=0.1$ e quindi
```{r 2021-88}
x0 <- 40
x2 <- 40
mm <- 36.5
ss <- 36.5
vnam <- "S_n"
cat(tlc(tipo = "somma",x1 = x0,mu = mm,s2 = ss,n = 365,verso = "<"))
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Siano $h_1$ e $h_2$ due stimatori corretti per $\theta$, cosa significa che $h_1$ è più efficiente di $h_2$? 

`r punti_p()` Definire la funzione di verosimiglianza della Poisson. 

`r punti_p()` Una moneta, che non sappiamo se è perfetta oppure no, viene lanciata 40 volte.
Posto $\pi$ la probabilità che la moneta mostri testa, si è testato
\[
\begin{cases}
H_0:\pi=\frac 12\\
H_1:\pi\ne\frac 12
\end{cases}
\]
ed è risultato $p_\text{value}=0.021$. Possiamo concludere che la moneta sia truccata? 

`r punti_p()` In caso di campionamento casuale semplice **senza reintroduzione**
quanto vale la varianza della media aritmetica campionaria?

::: {.sol data-latex=""}
Siano $X_1,...,X_m$ $n$ VC estratte **senza reintroduzione** allora
\begin{eqnarray*}
  E(\bar X) &=&  \mu\\
  V(\bar X) &=& \frac{N-n}{N-1}\frac{\sigma^2}{n}
\end{eqnarray*}
:::



### Esercizio 5

Si sono intervistate 16 piccole imprese modenesi.
L'analisi ha mostrato che sentono una forte necessità
di investimenti nell'ambito della ricerca industriale;
tuttavia, l'importo medio annuale speso per la ricerca industriale
è risultato pari a 2750.00€ con una deviazione standard pari
a 1300.00€.

`r punti_p(nex = T)` Determinare un intervallo di confidenza al 95%
per l'importo medio annuale speso per la ricerca industriale. 

```{r 2021-89}
cat(idc(sd = 1300,xm = 2750,alpha = .05,n = 16,dist_ = "t"))
```

`r punti_p()` Una indagine più vasta dell'anno precedente
ha fornito una spesa media per la ricerca industriale pari a
3250.00€ con una deviazione standard pari a 1200.00€.
Verificare l'ipotesi
che l'importo medio nell'ultimo anno sia stato equivalente a
quello dell'anno precedente contro l'alternativa di una
diminuzione dell'investimento in ricerca industriale.

::: {.sol data-latex=""}
```{r 2021-90}
s <- 1200
n <- 16
muh <- 2750
mu0 <- 3250
alpha <- 0.05
h1 <- "<"
cat(ztest_mu(muh = muh,s = s,n = n,mu0 = mu0,h1 = h1))
```
:::



### Esercizio 6

```{r 2021-91}

set.seed(5)
set.seed(34)
n <- 15
x <- sort(runif(n,0,10))
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- rchisq(n,df = 1)
y <- (x/10)^2*.7 +eps*.05
#y[y<0] <- -y[y<0]

x <- round(x,2)
y <- round(y,2)

RGX <- regr(x,y,ax = 0,semp = T)
ls2e(RGX)
```

Si esaminano $n=15$ aziende e si rileva, per ognuna di esse, il
fatturato ($X$) e il profitto ($Y$) (in unità convenzionali).
Si osservano le seguenti statistiche, $\sum_{i=1}^{15}x_i=`r sum(x)`$, $\sum_{i=1}^{15}y_i=`r sum(y)`$,
 $\sum_{i=1}^{15}x_i^2=`r sum(x^2)`$, $\sum_{i=1}^{15}y_i^2=`r sum(y^2)`$ e $\sum_{i=1}^{15}x_iy_i=`r sum(x*y)`$.

`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$

::: {.sol data-latex=""}
```{r 2021-92}
cat(calcolo_beta())
```
:::


`r punti_p()` Qual è la percentuale di varianza spiegata dal modello?

::: {.sol data-latex=""}
```{r 2021-93}
cat(R2())
```
:::


`r punti_p()` Se in un modello di regressione si conoscono $\hat\beta_1$, $r^2$ e $\hat\sigma_X$ è possibile ricavare $\hat\sigma_Y$? In che modo?

::: {.sol data-latex=""}
\begin{eqnarray*}
   \hat\beta_1 &=& \frac{\text{cov}(x,y)}{\hat\sigma_X^2}\\
   \text{cov}(x,y)&=&\hat\beta_1\hat\sigma_X^2\\
   r&=&\frac{\text{cov}(x,y)}{\hat\sigma_X\hat\sigma_Y}\\
   \hat\sigma_Y&=&\frac{\text{cov}(x,y)}{r\hat\sigma_X}\\
   &=&\frac{\hat\beta_1\hat\sigma_X^2}{r\hat\sigma_X}\\
   &=&\frac{\hat\beta_1}{r}\hat\sigma_X
\end{eqnarray*}
:::

`r punti_p()` Cosa significa che il coefficiente di correlazione è invariante alle trasformazioni lineari?


<!--chapter:end:2021.Rmd-->

---
output: html_document
editor_options: 
  chunk_output_type: console
---


```{r 2022-2}
rm(list = rm())
source("intro.R")
if (html) cat('')
```
  

# Anno 2022

```{r 2022-3}
source("punti.R")
punti_list <- punti_2022
compito <- 0
```




<div class="button-container"></div>

## Prova di Statistica 2022/06/16-1

```{r 2022-1,, echo=FALSE}
#


source("intro.R")
fig.def(2.5,3.5)



```

### Esercizio 1

```{r 2022-4}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2022-5}
# Basic settings
set.seed(11)   # per ottenere sempre la stessa simulazione
n <- 250      # ampiezza campionaria
nomex <- "Spesa"

brk  <- c(0,3, 5,10,20)
nnn  <- c( 20,110,100, 50)
nnn  <- round(nnn/sum(nnn)*n)

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Ferrara è stato rilevata la spesa in generi alimentari (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze cumulate:

:::{.sol data-latex=""}
```{r 2022-6}
kable(dat3[,c(1,2,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```
:::

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
```{r 2022-7}
kable(dat3[,c(1:2,12,3:7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r punti_p()` Quante famiglie hanno una spesa superiore al 75-esimo percentile?

:::{.sol data-latex=""}
$$\%(X>x_{0.75})=25\% , \rightarrow `r n`\times 0.25=`r n*.25` $$
:::

`r punti_p()` Che relazione dobbiamo aspettarci tra media e mediana?

:::{.sol data-latex=""}
$$
\bar x > x_{0.5}
$$
:::

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$, mentre la SD è pari a $SD=`r sd(samp)`$.
Se ogni famiglia aumentasse la spesa di 0.5, quanto varrebbero la media e la SD dei dati?

:::{.sol data-latex=""}
Invariata
:::




### Esercizio 2
  
Siano $X\sim N(102,1.5)$ e sia $Y\sim N(50,3.5)$, $X$ e $Y$ indipendenti. Posto $A=\{X>100\}$, $B=\{X<102\}$, e $C=\{47<Y\le 53\}$.

`r punti_p(nex = T)` Quanto vale $P\Big((A\cap B)\cup C\Big)$?

:::{.sol data-latex=""}
```{r 2022-8}
x1 <- 100
x2 <- 102
mm <- 102
ss <- 1.5
vnam <- "X"
mu <- "\\mu_X"
sigma <- "\\sigma_X"
cat(norm_int(x1 = x1,x2 = x2,verso = NULL,mm = mm,ss = ss,vnam = vnam,mu = mu,sigma = sigma))
pab <- pnorm(x2,mm,sqrt(ss))-pnorm(x1,mm,sqrt(ss))
```

```{r 2022-9}
x1 <- 47
x2 <- 53
mm <- 50
ss <- 3.5
vnam <- "Y"
mu <- "\\mu_Y"
sigma <- "\\sigma_Y"
cat(norm_int(x1 = x1,x2 = x2,verso = NULL,mm = mm,ss = ss,vnam = vnam,mu = mu,sigma = sigma))
pc <- pnorm(x2,mm,sqrt(ss))-pnorm(x1,mm,sqrt(ss))
```

\begin{eqnarray*}
  P(A\cap B\cup C) &=&  P(A\cap B)+P(C)-P(A\cap B\cap C)\\
  &=& P(A\cap B)+P(C)-P(A\cap B)P(C)\\
  &=& `r pab`+`r pc`-`r pab`\times`r pc`\\
  &=& `r pab+pc-pab*pc`
\end{eqnarray*}
:::

`r punti_p()` Si estrae 5 volte da $X\sim N(102,1.5)$, posto $A=\{X>100\}$, quale è la probabilità che $A$ si avveri 3 volte su 5?

:::{.sol data-latex=""}
$$
\pi=P(A)=`r 1-pnorm(100,102,1.5)`
$$

$$
P(3\text{ su }5)=\binom{5}{3}`r 1-pnorm(100,102,1.5)`^3(1-`r 1-pnorm(100,102,1.5)`)^5=`r dbinom(3,5,1-pnorm(100,102,1.5))`
$$
:::

`r punti_p()` Se $F$ è la funzione di ripartizione della VA $X$, posto $a < b$ due numeri qualunque, a cosa equivale
$$
F(b)-F(a) \qquad?
$$

:::{.sol data-latex=""}
$$
F(b)-F(a) = P(a<X\le b)
$$
:::



### Esercizio 3

```{r 2022-10}
n <- 300
ex <- 10
vx <- 0.3^2
es <- mm <- n*ex
vs <- ss <- n*vx
```

`r punti_p(nex = T)` Ogni giorno un impianto di produzione confeziona 1000 lotti. In media il 10 di questi lotti sono fallati, con una deviazione standard pari a 0.3. Dopo 300 giorni di produzione qual è la probabilità che il numero di lotti fallati sia maggiore di 3100?

:::{.sol data-latex=""}
$E(X_i)=`r ex`$, $V(X_i)=`r vx`$ e quindi

```{r 2022-11}
x1 <- 3100
verso <- ">"
mm <- 10
ss <- (0.3)^2
vnam <- "S_n"
mu <- "E(S_n)"
sigma <- "SD(S_n)"
cat(tlc("somma",x1 = 3100,verso = verso,mu = mm,s2 = ss,n = 300))
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Sia $\hat \lambda$ lo stimatore di massima verosimiglianza di $\lambda$ del modello di Poisson.
\begin{eqnarray*}
  \hat\lambda &=&  \frac 1n\sum_{i=1}^nx_i\\
\end{eqnarray*}
Dimostrare le correttezza di $\hat\lambda$ in almeno tre passaggi.


`r punti_p()` Definire lo _Standard Error_ di uno stimatore.

`r punti_p()` Definire gli errori di primo e di secondo tipo di un test statistico.

`r punti_p()` In un test statistico, per quali valori di $p_\text{value}$ si tende a rifiutare $H_0$?




### Esercizio 5

`r punti_p(nex = T)` Il Supermercato $S$, della catena $C$, ha monitorato gli accessi al suo interno per una settimana.
Qui di seguito il numero di accessi per giorno della settimana di $S$ e la percentuale di accessi nella catena $C$.


```{r 2022-12}

g <- c( "Lun" , "Mart" , "Merc" , "Giov" , "Ven")
Y <- c("Supermercato S","Catena C")

ntot <- 250
 n <- c(25,10,10,10,45)
s <- c(60 ,  20  , 31   , 25   , 120 )
s <- round(s/sum(s)*ntot)
 
chi_print_conf(Freq_c = s,Freq_0 = n,X = g,Y = Y)
 
```

Testare l'ipotesi che nel supermercato $S$ la distribuzione degli accessi nei giorni della settimana sia uguale a quella della catena.

:::{.sol data-latex=""}
```{r 2022-13}

chi_conf(Freq_c = s,Freq_0 = n,X = g,Y = Y)

```
:::





### Esercizio 6

```{r 2022-14}

set.seed(36)
n <- 150
x <- sort(abs(rnorm(n)))

eps <- rnorm(n,0,3)
y <- 900-200*x + rnorm(n,0,40)
y <- y/1000

RGX <- regr(x,y,semp = T)
ls2e(RGX)
```

In uno studio sul potere d'acquisto delle famiglie è stato selezionato un campione di 150 nuclei familiari 
a cui è stato chiesto il reddito ($X$) e la percezione della perdita del potere d'acquisto espresso su una scala che va da zero a 1 ($Y$).
Qui di seguito le statistiche bivariate


\begin{align*}
\sum_{i=1}^n x_i &= `r sumx`,   &\sum_{i=1}^n x_i^2 &= `r sumx2` \\
\sum_{i=1}^n y_i &= `r sumy`,   &\sum_{i=1}^n y_i^2 &= `r sumy2` \\
\sum_{i=1}^n x_iy_i &= `r sumxy`.    
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=1.5$ nel modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2022-15}
cat(calcolo_beta())
cat(previsione(1.5))
```
:::

`r punti_p()` Qual è la percentuale di varianza spiegata dal modello?

:::{.sol data-latex=""}
```{r 2022-16}
cat(R2())
```
:::

`r punti_p()` Interpretare i parametri di regressione $\hat\beta_0$ e $\hat\beta_1$.

`r punti_p()` Se $W=-10\times Y$, quanto varrà $r_{XW}$, coefficiente di correlazione tra $X$ e $W$?

:::{.sol data-latex=""}
$$r_{WX}=-r_{XY}=`r -r`$$
:::



<div class="button-container"></div>

## Prova di Statistica 2022/06/16-2

### Esercizio 1

```{r 2022-17}
compito <- compito + 1
punti <- punti_list[[compito]]
```

```{r 2022-17a}


# Basic settings
set.seed(12)   # per ottenere sempre la stessa simulazione
n <- 250      # ampiezza campionaria
nomex <- "Spesa"

brk  <- c(0,3, 5,10,20)
nnn  <- c( 20,110,100, 50)
nnn  <- round(nnn/sum(nnn)*n)

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Ferrara è stato rilevata la spesa in generi alimentari (espresso in migliaia di euro). Qui di seguito i dati raccolti in classe e le densità di frequenza percentuali

```{r 2022-18}
kable(dat3[,c(1,2,6)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Calcolare il valore approssimato della mediana.

:::{.sol data-latex=""}
```{r 2022-19}
kable(dat3[,c(1:2,12,3:7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

cat(percentile())
```
:::

`r punti_p()` Quante famiglie hanno una spesa inferiore al 25-esimo percentile?

:::{.sol data-latex=""}
$$
`r n`\times 0.25=`r n*.25`
$$
:::

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$, che forma ci dobbiamo aspettare dell'istogramma di densità?

`r punti_p()` La varianza della spesa è pari a $Var=`r var(samp)`$.
Se ogni famiglia aumentasse la sua spesa del 5%, quanto varrebbe varianza dei dati così trasformati?

:::{.sol data-latex=""}
$$`r 1.05^2*var(samp)`$$
:::



### Esercizio 2
  
Siano $X\sim \text{Pois}(1.5)$ e sia $Y\sim \text{Pois}(1.5)$, $X$ e $Y$ indipendenti. Posto $A=\{X<2\}$ e $B=\{Y\ge 2\}$

`r punti_p(nex = T)` Quanto vale $P(A\cup B)$?

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(A) &=&  P(X=0)+P(X=1)\\
  &=& \frac{1.5^0}{0!}e^{-1.5}+\frac{1.5^1}{1!}e^{-1.5}\\
  &=& `r dpois(0,1.5)+dpois(1,1.5)`\\
  P(B) &=& 1-P(A)\\
  &=&`r 1-dpois(0,1.5)-dpois(1,1.5)`\\
  P(A\cup B) &=& P(A)+P(B)-P(A\cap B)\\
  &=& `r 1 - (1-dpois(0,1.5)-dpois(1,1.5))*(dpois(0,1.5)+dpois(1,1.5))`
\end{eqnarray*}
:::

`r punti_p()` Si estrae 6 volte da $X\sim \text{Pois}(1.5)$, posto $A=\{X<2\}$, quale è la probabilità che $A$ si avveri 3 volte su 6?

:::{.sol data-latex=""}
`r pa <- dpois(0,1.5)+dpois(1,1.5) `
\begin{eqnarray*}
  P(A) &=&  P(X=0)+P(X=1)\\
  &=& \frac{1.5^0}{0!}e^{-1.5}+\frac{1.5^1}{1!}e^{-1.5}\\
  &=& `r dpois(0,1.5)`+`r dpois(1,1.5)`\\
  &=& `r dpois(0,1.5)+dpois(1,1.5)`\\
  P(\text{3 successi su 6}) &=& \binom{6}{3}`r pa`^3(1-`r pa`)^{6-3}\\
  &=&`r dbinom(3,6,pa)`
\end{eqnarray*}
:::

`r punti_p()` Se $X$ è una VC con valore atteso $E(X)=0.5$ e $V(X)=1.2$, posto $Y=X^2$ è vero che $E(Y)=E^2(X)$?




### Esercizio 3

```{r 2022-20}
n <- 100
ex <- 1/6
vx <- 1/6*5/6
es <- mm <- ex
vs <- ss <- vx/n
```

`r punti_p(nex = T)` Si lancia un dado perfetto 100 volte. Qual è la probabilità che la proporzione di volte che si osserva la faccia sei (⚅) sia maggiore di 0.2?

__Soluzione__

$E(X_i)=`r ex`$, $V(X_i)=`r vx`$ e quindi
```{r 2022-21}
tlc("prop",x1 = 0.2,verso = ">",mu = 1/6,n = 100)
```



### Esercizio 4
  
`r punti_p(nex = T)` Sia $\hat \mu$ lo stimatore di massima verosimiglianza di $\mu$ del modello Normale.
\begin{eqnarray*}
  \hat\mu &=&  \frac 1n\sum_{i=1}^nx_i\\
\end{eqnarray*}
Dimostrare le consistenza di $\hat\mu$ in almeno tre passaggi.


`r punti_p()` Siano $h_1$ e $h_2$ due stimatori per $\theta$, cosa significa dire che $h_1$ è più efficiente di $h_2$?

`r punti_p()` Definire la significatività e la potenza di un test statistico.

`r punti_p()` Se in un test statistico il $p_\text{value}>0.1$ possiamo rifiutare $H_0$?




### Esercizio 5

`r punti_p(nex = T)` In un'indagine sull'opinione sul reddito di cittadinanza sono stati intervistate 140 persone che vivono al nord e 170 che vivono al sud: 60 su 140 che vivono al nord sono favorevoli al reddito di cittadinanza mentre 95 su 170 che vivono al sud sono favorevoli. 

Testare, usando il p-value, che la proporzione di persone favorevoli al reddito di cittadinanza che vivono al sud sia uguale a quelle di quelli che vivono al nord, contro l'alternativa che siano diverse.

:::{.sol data-latex=""}
```{r 2022-22}
s1 <- 60
n1 <- 140
s2 <- 95
n2 <- 170
h1 <- "\\neq"
alpha <- 0.01
a <- "N"
b<- "S"
um <- ""
ztest_2c_pi(s1 = s1,s2 = s2,n1 = n1,n2 = n2,h1 = h1,a = a,b = b)
```
:::



### Esercizio 6

```{r 2022-23}
set.seed(34)
n <- 150
x <- sort(abs(rnorm(n)))

eps <- rnorm(n,0,3)
y <- 900-200*x + rnorm(n,0,40)
y <- y/1000

RGX <- regr(x,y)
ls2e(RGX)

```

In uno studio sul potere d'acquisto delle famiglie è stato selezionato un campione di 150 nuclei familiari 
a cui è stato chiesto il reddito ($X$) e la percezione della perdita del potere d'acquisto espresso su una scala che va da zero a 1.
Qui di seguito le statistiche bivariate

\begin{align*}
  \sum_{i=1}^n x_i &= `r sum(x)` &\sum_{i=1}^n x_i^2 &= `r sum(x^2)` &\sum_{i=1}^n x_i y_i &= `r sum(x*y)`\\
  \sum_{i=1}^n y_i &= `r sum(y)` & \sum_{i=1}^n y_i^2 &= `r sum(y^2)` &
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=1.0$ nel modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2022-24}
cat(calcolo_beta())
cat(previsione(1.0))
```
:::

`r punti_p()` Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r 2022-25}
cat(R2())
```
:::

`r punti_p()` Cosa sono i _punti di leva_ e cosa gli _outliers_?

`r punti_p()` Se $W=10\times Y$, posto
$$w_i=\beta_0'+\beta_1'x_ì +\epsilon_i'$$
il modello in cui $W$ viene spiegata da $X$, quanto varranno $\beta_0'$ e $\beta_1'$?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \bar w &=& 10\times \bar y\\
  &=& `r 10*mean(y)`\\
  \sum x_iw_i&=&\sum x_i\cdot 10\cdot y_i\\
  &=& 10\sum x_i y_i\\
  &=& `r 10*sum(x*y)`\\
  cov(x,w)&=&\sum x_iw_i-\bar w\cdot\bar x\\
  &=&10\sum x_i y_i - 10 \cdot\bar y\cdot\bar x\\
  &=&10 cov(x,y)\\
  &=& `r 10*(mean(x*y)-mean(x)*mean(y))`\\
  \hat\beta'_1&=&\frac{10\cdot cov(x,y)}{\hat\sigma_X^2}\\
  &=&`r 10*b1`\\
  \hat\beta_0'&=& \bar w -\hat\beta'_1\bar x\\
  &=&10\bar y - 10 \hat \beta_1\bar x\\
  &=&`r 10*b0`
\end{eqnarray*}
:::  



<div class="button-container"></div>

## Prova di Statistica 2022/06/16-3

```{r 2022-26}


library(pat.book)



```



### Esercizio 1

```{r 2022-27}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2022-28}


# Basic settings
set.seed(23)   # per ottenere sempre la stessa simulazione
n <- 250      # ampiezza campionaria
a <- 5
b <- 1

brk  <- c(0,3, 5,10,20)
nnn  <- c( 20,110,100, 50)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Spesa"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Ferrara è stato rilevata la spesa in generi alimentari (espresso in migliaia di euro). Qui di seguito i dati raccolti in classe e le frequenze assolute

```{r 2022-29}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Individuare la classe modale.


:::{.sol data-latex=""}
```{r 2022-30}
kable(dat3[,c(1:2,12,3:7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
options(digits = 4)
```
:::

`r punti_p()` Qual è la percentuale di famiglie con spesa superiore al 25-esimo percentile?

:::{.sol data-latex=""}
$$n\cdot 0.75=`r 0.75*n`$$
:::
`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$, che forma ci dobbiamo aspettare dell'istogramma di densità?

`r punti_p()` La varianza della spesa è pari a $Var=`r var(samp)`$.
Se ogni famiglia aumentasse la sua spesa del 10%, quanto varrebbe _standard deviation_ dei dati così trasformati?

:::{.sol data-latex=""}
$$\sigma_{new}=\sqrt{1.1^2\times \sigma^2}=`r sqrt(1.1*var(samp)) `$$
:::



### Esercizio 2
  
Siano $X\sim \text{Binom}(5,0.4)$ e sia $Y\sim \text{Binom}(2,0.4)$, $X$ e $Y$ indipendenti. Posto $W=X+Y$

`r punti_p(nex = T)` Calcolare $P(W< 2)$.

:::{.sol data-latex=""}
\begin{eqnarray*}
  W &\sim& \text{Binom}(2+5,0.4)\\
  P(W<2) &=& P(W=0)+P(W=1)\\
  &=& \binom{7}{0}0.4^00.6^7+\binom{7}{1}0.4^10.6^6\\
  &=& `r dbinom(0,7,.4)`+`r dbinom(1,7,.4)`\\
  &=&`r dbinom(0,7,.4)+dbinom(1,7,.4)`
\end{eqnarray*}
:::

`r punti_p()` Posto $V=2+5\cdot W$, ricavare valore atteso e varianza di $V$.

:::{.sol data-latex=""}
\begin{eqnarray*}
  E(V) &=& 2+5E(X)  \\
  &=& 2+5\times 7 \times 0.4\\
  &=& `r 2+5 *7*0.4`\\
  V(V) &=& 5^2V(X)  \\
  &=& 25\times 7\times 0.4\times (1-.04)\\
  &=& `r 5^2*7 *0.4 * (1-.4)`\\
\end{eqnarray*}
:::  

`r punti_p()` Se $A$ e $B$ sono due eventi diversi dal vuoto, è possibile che $P(A)+P(B)>1$?




### Esercizio 3

```{r 2022-31}
n <- 200
ex <- 0.2
vx <- 0.2*0.8
es <- mm <- n*ex
vs <- ss <- n*vx
```

`r punti_p(nex = T)` Un'urna contiene 3 palline bianche, 2 nere e 5 blu. Si estrae 200 volte con reimmissione.
Calcolare la probabilità che il numero di palline nere sia maggiore di 50.

$E(X_i)=`r ex`$, $V(X_i)=`r vx`$ e quindi

```{r 2022-32}
cat(tlc("somma",x1 = 50,verso = ">",mu = .2,n = 200))
```



### Esercizio 4
  
`r punti_p(nex = T)` Sia $\hat \lambda$ lo stimatore di massima verosimiglianza di $\lambda$ del modello Poisson.
\begin{eqnarray*}
  \hat\lambda &=&  \frac 1n\sum_{i=1}^nx_i\\
\end{eqnarray*}
Dimostrare le consistenza di $\hat\lambda$ in almeno tre passaggi.


`r punti_p()` Siano $h$ uno stimatore per $\theta$, cosa significa dire che $h$ è asintoticamente corretto?

`r punti_p()` Definire la probabilità di significatività.

`r punti_p()` Se in un test statistico $0.01 < p_\text{value} <0.05$ cosa possiamo concludere?




### Esercizio 5

`r punti_p(nex = T)` In un'indagine sull'opinione sul reddito sono stati rilevati i redditi di 140 persone che vivono al nord e quelli di 170 che vivono al sud: il reddito medio di chi vive al nord è di 32.2 mila euro annui con una SD pari a 2.4 mila euro annui, mentre il
reddito medio di chi vive al sud è di 27.5 con una SD pari a 1.7.

Sotto ipotesi di eterogeneità testare l'ipotesi che il reddito medio sia uguale al nord come al sud, contro l'alternativa che sia diverso.

:::{.sol data-latex=""}
```{r 2022-33}
s1h <- 2.4
s2h <- 1.7
n1 <- 140
n2 <- 170
mu1 <- 32.2
mu2 <- 27.5
h1 <-"\\neq"
alpha <- 0.05
um <- ""
a <- "N"
b <- "S"
cat(ttest_2c_et(mu1 = mu1,mu2 = mu2,s1h = s1h,s2h=s2h,n1 = n1,n2 = n2,h1 = h1,a = a,b = b))
```
:::



### Esercizio 6

```{r 2022-34}
set.seed(38)
n <- 150
x <- sort(abs(rnorm(n)))

eps <- rnorm(n,0,3)
y <- 900-200*x + rnorm(n,0,40)
y <- y/1000

RGX <- regr(x,y)
ls2e(RGX)
```

In uno studio sul potere d'acquisto delle famiglie è stato selezionato un campione di 150 nuclei familiari 
a cui è stato chiesto il reddito ($X$) e la percezione della perdita del potere d'acquisto espresso su una scala che va da zero a 1.
Qui di seguito le statistiche bivariate

\begin{align*}
  \sum_{i=1}^n x_i &= `r sum(x)` &\sum_{i=1}^n x_i^2 &= `r sum(x^2)` &\sum_{i=1}^n x_i y_i &= `r sum(x*y)`\\
  \sum_{i=1}^n y_i &= `r sum(y)` & \sum_{i=1}^n y_i^2 &= `r sum(y^2)` &
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=1.4$ nel modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2022-35}
cat(calcolo_beta())
cat(previsione(1.0))
```
:::

`r punti_p()` Calcolare e discutere $R^2$.

:::{.sol data-latex=""}
```{r 2022-36}
cat(R2())
```
:::

`r punti_p()` Cos'è un _punto influente_?

`r punti_p()` Se $W=10+ Y$, posto
$$w_i=\beta_0'+\beta_1'x_ì +\epsilon_i'$$
il modello in cui $W$ viene spiegata da $X$, 
quanto varranno $\beta_0'$ e $\beta_1'$?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \bar w &=& 10+ \bar y\\
  &=& `r 10+mean(y)`\\
  \sum x_iw_i&=&\sum x_i\cdot (10+y_i)\\
  &=& 10\sum x_i +\sum x_i y_i\\
  &=& 10n\bar x +\sum x_i y_i\\
  cov(x,w)&=&\frac 1n\sum x_iw_i-\bar w\cdot\bar x\\
  &=&10\bar x +\frac 1n\sum x_i y_i-\bar x(10+\bar y)\\
  &=&10 \bar x - 10 \bar x +cov(x,y) \\
  &=& `r (mean(x*y)-mean(x)*mean(y))`\\
  \hat\beta'_1&=&\hat\beta_1\\
  &=&`r b1`\\
  \hat\beta_0'&=& \bar w -\hat\beta'_1\bar x\\
  &=& 10+\bar y-\hat\beta_1\bar x\\
  &=&10+\hat\beta_0\\
  &=&`r 10+b0`
\end{eqnarray*}
:::



<div class="button-container"></div>

## Prova di Statistica 2022/07/01-1

```{r 2022-37}






```

### Esercizio 1

```{r 2022-38}
compito <- compito + 1
punti <- punti_list[[compito]]
```

```{r 2022-39}
# Basic settings
set.seed(2)   # per ottenere sempre la stessa simulazione
n <- 220      # ampiezza campionaria
nomex <- "Spesa in investimenti Green"

brk  <- sort(20-c(0,3, 5,13,20))
nnn  <- rev(c( 20,110,120, 50))
nnn  <- round(nnn/sum(nnn)*n)

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ imprese energivore della provincia di Bologna è stato 
rilevata la spesa in investimenti green, espressa in migliaia di euro. Qui di seguito i dati raccolti in classi
e le frequenze percentuali.


```{r 2022-40}
kable(dat3[,c(1,2,12)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Individuare la classe modale.

:::{.sol data-latex=""}
```{r 2022-41}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
pmod <- which(dat2$hj==max(dat2$hj))
cmod <- paste("[",dat2$xinf[pmod],",",dat2$xsup[pmod],")")
hj <- dat2$hj
```
la classe modale è la classe $3$ essendo la classe con densità $h_{`r pmod`}=`r hj[pmod]`$ maggiore.
:::


`r punti_p()` Quante imprese hanno una spesa compresa tra 15 mila euro e il 75-esimo percentile?

:::{.sol data-latex=""}

\begin{eqnarray*}
F(15)&=&`r F.int(15)`\\
F(x_{0.75})&=&.75\\
\%(15<X<x_{0.75})&=&`r .75-F.int(15)`\\
n(15<X<x_{0.75})&=&`r (.75-F.int(15))*n`
\end{eqnarray*}

:::

`r punti_p()`  La spesa media è pari a $\bar x=`r mean(samp)`$ mila euro, 
considerato la classe modale ricavata al punto 1.a, quale relazione ci dobbiamo attendere tra media e mediana?

:::{.sol data-latex=""}
```{r 2022-42}
histp(T)
```
:::

`r punti_p()` La spesa media in investimenti green su `r n` aziende modenesi è pari a $\bar x=`r mean(samp)`$ mila euro, mentre la spesa media  in investimenti green della provincia di Reggio, su un campione di 150 aziende è pari a $12.22$ mila euro.
Calcolare la media globale delle $`r n` + 150 = `r n+150`$ aziende delle due province.

:::{,sol}

\begin{eqnarray*}
\bar x_T&=&\frac{`r n`\times`r mean(samp)`+150\times12.22}{`r n`+150}\\
&=& `r (n*mean(samp)+150*12.22)/(n+150)`
\end{eqnarray*}

:::



### Esercizio 2
  
Siano $X\sim N(10,1)$ e sia $Y\sim N(10,1)$, $X$ e $Y$ indipendenti. Posto $A=\{X>8\}$, $B=\{X>11\}$, e $C=\{9<Y\le 10\}$.

`r punti_p(nex = T)` Quanto vale $P\Big((A\cup B)\cup C\Big)$?

:::{.sol data-latex=""}
\begin{eqnarray*}
P(A\cup B)&=&P(A)
\end{eqnarray*}

```{r 2022-43}
x1 = 8
verso=">"
vnam ="X"
mm = 10
ss = 1
sigma = "\\sigma_X"
mu = "\\mu_X"
cat(norm_int(x1 = x1,x2=NULL,verso = verso,mm = mm,ss = ss,mu = mu,sigma = sigma))
pa <- 1-norm_semp(x1,mm,ss)

x1 = 9
x2 = 10
vnam ="Y"
mm = 10
ss = 1
sigma = "\\sigma"
mu = "\\mu"
cat(norm_int(x1 = x1,x2 = x2,verso = NULL,mm = mm,ss = ss,mu = mu,sigma = sigma))
pc <- norm_semp(x2,mm,ss)-norm_semp(x1,mm,ss)
```

\begin{eqnarray*}
P(A\cup B\cup C)&=&P(A\cup C)\\
&=&P(A)+P(C)-P(A\cap C)\\
&=& `r pa` +`r pc`-`r pa`\times `r pc`\\
&=& `r pa+pc-pa*pc`
\end{eqnarray*}
:::

`r punti_p()` Sia $X\sim N(10,1)$, posto $A=\{X>8\}$. Si estrae ripetutamente da $X$  e si finisce quando $A$ si avvera **2** volte. Calcolare la probabilità di finire dopo 6 estrazioni.

:::{.sol data-latex=""}
\begin{eqnarray*}
P(A)&=&`r pa`\\
P(\text{vincere alla sesta})&=&5\times`r pa`\times (`r 1-pa`)^4\times `r pa`\\
&=& `r pa*(1-pa)^4*5*pa`
\end{eqnarray*}
:::

`r punti_p()` Siano $A$ e $B$ due eventi diversi dal vuoto. È vero che se $A$ e $B$ sono 
**non** indipendenti, allora sono necessariamente incompatibili?

:::{.sol data-latex=""}
No, se sono incompatibili allora sono certamente non indipendenti, in quato
\[
P(A\cap B)=P(\emptyset)=0\ne P(A)P(B)
\]
mentre se *non* sono indipendenti
\[
P(A\cap B)\ne P(A)P(B)
\]
:::

`r punti_p()` Se $F$ è la funzione di ripartizione della VA $X$, 
quali sono il valore massimo e quello minimo che $F$ può assumere?




### Esercizio 3

```{r 2022-44}
n <- 365
ex <- 26.34
vx <- 1.3^2
x1 <- 9550
x2 <- 9600
```

`r punti_p(nex = T)` Ogni giorno il centralino di un servizio di assistenza riceve in media 26.34 telefonate con una deviazione standard pari a 1.3 telefonate.

Dopo un anno ($n=365$), qual è la probabilità che il numero totale di telefonate sia compresa tra 9550 e 9600?

:::{.sol data-latex=""}
```{r 2022-45}
cat(tlc("somma",x1 = x1,x2 = x2,verso = NULL,mu = ex,s2 = vx,n = n))
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Sia $\hat \lambda$ lo stimatore di massima verosimiglianza di $\lambda$ del modello di Poisson: $\hat\lambda =  \frac 1n\sum_{i=1}^nx_i$
Scrivere lo Standard Error di $\hat \lambda$.

`r punti_p()` Se $h$ è uno stimatore per $\theta$ tale che
$E(h)\ne \theta$ e che $\lim_ {n\to +\infty}E(h)=\theta$ di quale proprietà gode $h$?

`r punti_p()` Definire gli errori di primo e di secondo tipo di un test statistico e le relative probabilità.

`r punti_p()` In un confronto tra due campioni viene messo a test
$$
\begin{cases}
H_0:\sigma_A=\sigma_B\\
H_1:\sigma_A\ne \sigma_B
\end{cases}
$$
Il $p_\text{value}=0.265$. Alla luce di questo risultato, per testare la differenza tra le medie, cosa è preferibile, un test sotto ipotesi di omogeneità, oppure sotto ipotesi di eterogeneità?





### Esercizio 5

Su un campione di $n_M=34$ consumatori privati, scelti a caso tra i cittadini del comune di Mirandola, 
si è chiesto quanto spenderebbero mensilmente per poter usufruire di una connessione ultra veloce.
Il campione ha restituito una media pari a 19.4 €/mese, con una deviazione standard pari a 2.2 €/mese,

`r punti_p(nex = T)` Costruire un Intervallo di Confidenza al 95% per la media di popolazione $\mu$.

:::{.sol data-latex=""}
```{r 2022-46}
cat(idc(xm = 19.4,sd = 2.2,alpha = .05,n = 34,dist_ = "t"))
```
:::

`r punti_p()` La stessa domanda è stata posta ad un secondo campione di $n_S=38$ consumatori privati,scelti a caso tra i cittadini del comune di Sassuolo. 
Il campione ha restituito una media pari a 20.2 €/mese, con una deviazione standard pari a 2.9 €/mese. Sotto ipotesi di omogeneità testare l'ipotesi che i due comuni abbiano uguale media, contro l'alternativa che sia diversa.

:::{.sol data-latex=""}
```{r 2022-47}
n1 <- 34
n2 <- 38
s1h <- 2.2
s2h <- 2.8
mu1 <- 19.4
mu2 <- 20.2
h1 <- "\\neq"
alpha <- 0.05
a <- "M"
b <- "S"
et <- F
um <- ""
cat(ttest_2c_om(mu1 = mu1,mu2 = mu2,s1h = s1h,s2h = s2h,n1 = n1,n2 = n2,h1 = h1))
```
:::



### Esercizio 6

```{r 2022-48}

set.seed(36)
n <- 5
x <- sort(sample(seq(10,20,by=.1),n))

eps <- rnorm(n,0,3)
y <- -5+x + eps

RGX <- regr(x,y)
ls2e(RGX)
```

Sono stati analizzati `r n` comuni della provincia di Modena e su ogni comune è stato rilevato
il numero di abitanti $X$, espresso in migliaia di persone, e il numero di esercizi commerciali $Y$.

Qui di seguito i dati

```{r 2022-49}
 kable(t(prn[1:n,2:3]),booktabs=T,escape = F,linesep="") %>%
   kable_styling(full_width = F, latex_options = "HOLD_position")
```


`r punti_p(nex = T)` Calcolare il residuo del quarto dato nel modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2022-50}
 kable((prn[,]),booktabs=T,escape = F,linesep="") %>%
   kable_styling(full_width = F, latex_options = "HOLD_position")
cat(calcolo_beta())
cat(residuo(x[4],y[4]))
```
:::

`r punti_p()` Scrivere la scomposizione della varianza del modello di regressione 
e calcolare la Total Sum of Squares (TSS), la Explained Sum of Squares (ESS) e la Residual Sum of Squares (RSS) dei dati analizzati sopra.

:::{.sol data-latex=""}
```{r 2022-51}
cat(R2())
```
:::

`r punti_p()` Il parametro di regressione $\hat\beta_0$, in questo caso, è interpretabile?

`r punti_p()` Una previsione per $x=40$ è attendibile? Perché?

`r punti_p()` Se $W=5+ Y$, posto $w_i=\beta_0'+\beta_1'x_ì +\epsilon_i'$
il modello in cui $W$ viene spiegata da $X$, quanto varranno $\beta_0'$ e $\beta_1'$?





<div class="button-container"></div>

## Prova di Statistica 2022/07/01-2

```{r 2022-52}






```

### Esercizio 1 

```{r 2022-53}
compito <- compito + 1
punti <- punti_list[[compito]]
```

```{r 2022-54}
options(digits=3,nsmall=4,knitr.kable.NA = '',scipen = 1)
# Basic settings
set.seed(2)   # per ottenere sempre la stessa simulazione
n <- 220      # ampiezza campionaria
a <- 5
b <- 1

brk  <- sort(20-c(0,3, 5,13,20))
nnn  <- (c( 20,110,120, 50))
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Spesa in investimenti Green"


samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ imprese energivora della provincia di Bologna è stato 
rilevata la spesa in investimenti green, espressa in migliaia di euro. Qui di seguito i dati raccolti in classi
e le frequenze percentuali.

```{r 2022-55}
kable(dat3[,c(1,2,12)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma delle densità percentuali.

:::{.sol data-latex=""}
```{r 2022-56}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r punti_p()` Quante aziende hanno una spesa compresa tra il 25-esimo percentile e 15 mila euro?

:::{.sol data-latex=""}
$$
221(0.434-0.25)=`r  221*(.434-.25)`
$$
:::

`r punti_p()` Che relazione dobbiamo attenderci tra media, mediana e moda?

`r punti_p()` La varianza della spesa è pari a $Var=`r var(samp)`$.
Se ogni azienda aumentasse la sua spesa del 15%, quanto varrebbe varianza dei dati così trasformati?



### Esercizio 2
  
Una rotatoria incrocia due strade, una che porta da nord a sud e una che porta da est ad ovest.

Il numero di automobili che impegna la rotatoria ogni minuto, in orario di punta, 

  |
--|--
 dalla direzione nord è descritto da una poisson di parametro 2.1 | $X_N\sim\text{Pois}(2.1)$ 
 dalla direzione sud è descritto da una poisson di parametro 0.1 | $X_S\sim\text{Pois}(0.1)$ 
 dalla direzione est è descritto da una poisson di parametro 1.4 | $X_E\sim\text{Pois}(1.4)$ 
 dalla direzione ovest è descritto da una poisson di parametro 0.2 | $X_O\sim\text{Pois}(0.2)$. 

Si assume l'indipendenza tra le variabili.

`r punti_p(nex = T)` Si consideri l'evento $E$="più di due veicoli impegnino la rotatoria". Calcolare $P(E)$.

:::{.sol data-latex=""}
$$
X\sim\text{Pois}(2.1+0.1+1.4+0.2)
$$

$$P(X\ge 2) = 1-P(X<2)=1-`r dpois(0,3.8)`-`r dpois(1,3.8)`= `r 1-sum(dpois(0:1,3.8))`$$
:::

`r punti_p()` Si osserva la rotatoria per $n=6$ minuti. Qual è
la probabilità che il numero di volte in cui l'evento $E$ è vero sia uguale a 3?

:::{.sol data-latex=""}
$$
P(\text{3 su 6})=\binom{6}{3}`r 1-sum(dpois(0:1,3.8))`^3(1-`r 1-sum(dpois(0:1,3.8))`)^3=`r dbinom(3,6,1-sum(dpois(0:1,3.8)))`
$$
:::

`r punti_p()` Se $X\sim N(0,2)$ e $X\sim N(1,1.2)$, è vero che
$$
X-Y\sim N(-1,0.8) \qquad ?
$$


`r punti_p()` Se $X$ è una VC con supporto {0,1,2} e $Y$ è una VC con supporto {2,3,4,5}.
Qual è il supporto di $X+Y$?

:::{.sol data-latex=""}
```{r 2022-57}
Sxy <- unique(sort(outer(0:2,2:5,"+")))
```
il supporto di $X+Y$ è $\{`r Sxy`\}$.
:::



### Esercizio 3

```{r 2022-58}
n <- 50
ex <- 3/10
vx <- ex*(1-ex)
es <- mm <- ex*n
vs <- ss <- n*vx
x1 <- 20
verso <- ">"
```

`r punti_p(nex = T)` Un'urna contiene 10 palline numerate da 1 a 10. 
Si vince se il numero estratto è divisibile per tre, altrimenti si perde.
Si estrae 50 volte con reintroduzione. 

Qual è la probabilità di vincere almeno 20 volte su 50 giocate?

:::{.sol data-latex=""}
$$
\pi=\frac 3{10}
$$

```{r 2022-59}
cat(tlc("somma",x1,verso = verso,mu = 3/10,n = n))
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Siano $h_1$ e $h_2$ due stimatori per $\theta$, tali che

$$
  MSE(h_1) =  \frac{\theta}{n^2}, \qquad  MSE(h_2) =  \frac{\theta}{n}
$$

Quale dei due stimatori è più efficiente?

`r punti_p()` Siano $T_1$ e $T_2$ due test statistici per la stessa $H_0$ e con la stessa significatività $\alpha$. Cosa significa dire che $T_1$ e più potente di $T_2$?

`r punti_p()` Definire la probabilità di significatività osservata.

`r punti_p()` Se in un test statistico che utilizza la statistica test _t_ con 10 gradi di libertà $t_\text{obs}=1.4$, il $p_\text{value}$ sarà maggiore o minore di 0.05? Perché?





### Esercizio 5

Su un campione di $n=75$ abitanti del quartiere _Q_ è stato chiesto se siano favorevoli o meno all'introduzione di corsie preferenziali per i mezzi pubblici. Lo studio ha riportato che 45 persone su 75 (il 60% del campione) è favorevole.


`r punti_p(nex = T)` Costruire un intervallo di confidenza la 95% per $\pi$ la quota di persone del quartiere _Q_ favorevole alle corsie preferenziali

:::{.sol data-latex=""}
```{r 2022-60}
cat(idc(xm = 45/75,alpha = .05,n = 75,dist_ = "z"))
```
:::


`r punti_p()` Un'indagine molto più ampia condotta su tutta la città ha mostrato che
la percentuale di favorevoli alle corsie preferenziali è del 55%. Testare l'ipotesi che nel quartiere _Q_ la quota di favorevoli sia uguale a quella cittadina contro l'alternativa che sia maggiore.

:::{.sol data-latex=""}
```{r 2022-61}
sn <- 45
n  <- 75
p0 <- 0.55
h1 <- ">"
alpha <- 0.05
cat(ztest_pi(sn = sn,n = n,p0 = p0,h1 = h1))
```
:::




### Esercizio 6

```{r 2022-62}

set.seed(36)
n <- 50
x <- sort(sample(seq(10,20,by=.1),n))

eps <- rnorm(n,0,3)
y <- -5+x + eps

RGX <-regr(x,y)
ls2e(RGX)
```

Sono stati analizzati `r n` comuni della provincia di Modena e su ogni comune è stato rilevato
il numero di abitanti $X$, espresso in migliaia di persone, e il numero di esercizi commerciali $Y$.

Qui di seguito le statistiche bivariate

\begin{align*}
  \sum_{i=1}^n x_i &= `r sum(x)` &\sum_{i=1}^n x_i^2 &= `r sum(x^2)` &\sum_{i=1}^n x_i y_i &= `r sum(x*y)`\\
  \sum_{i=1}^n y_i &= `r sum(y)` & \sum_{i=1}^n y_i^2 &= `r sum(y^2)` &
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=16$ nel modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2022-63}
cat(calcolo_beta())
cat(previsione(16))
```
:::


`r punti_p()` Il modello si adatta bene ai dati?

$$r^2=`r r^2`$$

`r punti_p()` Cosa sono i _punti influenti_?

`r punti_p()` Se $W=2\times Y$ e $V=X+3$, posto $w_i=\beta_0'+\beta_1'v_ì +\epsilon_i'$
il modello in cui $W$ viene spiegata da $V$, quanto varranno $\beta_0'$ e $\beta_1'$?

:::{.sol data-latex=""}
\begin{eqnarray*}
   \hat\beta_1' &=&  r_{VW}\frac{\sigma_W}{\sigma_V} \\
            &=&  r_{XY}\frac{2\sigma_Y}{\sigma_X} \\
            &=& 2\hat\beta_1\\
            &=& `r b1*22`\\
  \hat\beta_0' &=& \bar w - \hat\beta_1'\bar v\\
            &=& 2\bar y-2\hat\beta_1(\bar x + 3)\\
            &=& `r 2*mean(y)-b1*2*(mean(x)+3)`
\end{eqnarray*}
:::



<div class="button-container"></div>

## Prova di Statistica 2022/07/01-3

```{r 2022-64}






```

### Esercizio 1

```{r 2022-65}
compito <- compito + 1
punti <- punti_list[[compito]]
```

```{r 2022-66}
options(digits=3,nsmall=4,knitr.kable.NA = '',scipen = 1)
# Basic settings
set.seed(2)   # per ottenere sempre la stessa simulazione
n <- 220      # ampiezza campionaria

brk  <- (c(0,3, 5,13,20))
nnn  <- rev(c( 20,110,120, 50))
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Spesa in investimenti Green"


samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))

```

Su un campione di $`r n`$ imprese energivora della provincia di Bologna è stato 
rilevata la spesa in investimenti green, espressa in migliaia di euro. Qui di seguito i dati raccolti in classi
e le frequenze percentuali.

```{r 2022-67}
kable(dat3[,c(1,2,12)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma delle densità percentuali.

:::{.sol data-latex=""}
```{r 2022-68}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r punti_p()` Qual è la percentuale di aziende che hanno una spesa 
compresa tra il 25-esimo percentile e 15 mila euro?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \%(X<15) &=&  F_3+(15-13)\times h_4\\
  &=& `r dat2$Fj[3]`\times 100+2\times `r dat2$hj[4]`\\
  &=& `r dat2$Fj[3]*100+2*dat2$hj[4]`\\
  \%(X<x_{0.25}) &=&  25\%\\
  \%(x_{0.25}<X<15)&=& `r dat2$Fj[3]*100+2*dat2$hj[4]`-25\\
  &=& `r dat2$Fj[3]*100+2*dat2$hj[4]-25`
\end{eqnarray*}
:::

`r punti_p()` Che relazione dobbiamo attenderci tra media, mediana e moda?

`r punti_p()` La varianza della spesa è pari a $Var=`r var(samp)`$.
Se ogni azienda aumentasse la sua spesa di 10 mila euro, quanto varrebbe la media e la varianza dei dati così trasformati?




### Esercizio 2
  
Una moneta perfetta viene lanciata 5 volte, se esce almeno 3 volte testa si estrae da un'urna che contiene
un biglietto vincente ed uno perdente, altrimenti si estrae da un'urna che contine due biglietti vincenti e tre perdenti.

`r punti_p(nex = T)` Qual è la probabilità di vincere?

:::{.sol data-latex=""}

`r pe <-sum(dbinom(3:5,5,.5))`

\begin{eqnarray*}
  P(X=3) &=& `r dbinom(3,5,3/10)`\\
  P(X=4) &=& `r dbinom(4,5,3/10)`\\
  P(X=5) &=& `r dbinom(5,5,3/10)`\\
  P(X\ge 3)  &=& `r pe`\\
  P(\text{Vincere})&=& `r pe`\frac12+(1-`r pe`)\frac23\\
  &=& `r pe*.5+(1-pe)*2/3`
\end{eqnarray*}
:::
  
`r px <-pe*.5+(1-pe)*2/3`

`r punti_p()` Si ripete il gioco di sopra finché non si vince due volte. Qual è la probabilità di finire alla quarta giocata?


:::{.sol data-latex=""}
$$
3\times `r px`\times (1-`r px`)^3\times `r px` = `r 3*px^2*(1-px)^3`
$$
:::

`r punti_p()` Se $X\sim \text{Pois}(2)$ e $Y\sim\text{Pois}(1)$, è vero che
$$
X-Y\sim\text{Pois}(1)\qquad ?
$$


`r punti_p()` Se $X$ è una VC con supporto {0,1,2} e $X$ è una VC con supporto {-2,-1,0}.
Qual è il supporto di $X\times Y$?

$$
\{-4,-2,-1,0\}
$$




### Esercizio 3

```{r 2022-69}
n <- 60
ex <- 102.3
vx <- 10.2^2
es <- mm <- ex*n
vs <- ss <- vx*n
x1 <- 6700
verso <- ">"
```

`r punti_p(nex = T)` Il supermercato _S_ vende, in media ogni giorno, 102.3 kg di pasta, con una deviazione standard di 10.2. Dopo 60 giorni di apertura, qual è la probabilità che il totale di pasta venduta sia maggiore di 6700 kg?


```{r 2022-70}
cat(tlc("somma",x1 = x1,verso = verso,mu = ex,s2 = vx,n = n))
```





### Esercizio 4
  
`r punti_p(nex = T)` Siano $h_1$ e $h_2$ due stimatori per $\theta$, tali che

$$
MSE(h_1) =  \frac{\theta}{n^2}, \qquad MSE(h_2) =  \frac{\theta}{n^3}
$$

Quale dei due stimatori è più efficiente?

`r punti_p()` Se uno stimatore $h$ per $\theta$ è tale che $\lim_{n\to\infty}V(h)=0$, di quali proprietà gode $h$?

`r punti_p()` Un intervallo di confidenza per $\theta$ al 95% è più ampio o meno ampio di uno al 99%? Perché?

`r punti_p()` Se in un test statistico che utilizza la statistica test _t_ con 10 gradi di libertà $t_\text{obs}=14$, il $p_\text{value}$ sarà maggiore o minore di 0.05? Perché?





### Esercizio 5

Su un campione di $n=15$ abitanti del quartiere _Q_ è stato chiesto di fornire un punteggio da 0 a 100 per esprimere quanto si sarebbe soddisfatti dall'introduzione di corsie preferenziali per i mezzi pubblici. Lo studio ha riportato una media pari a $76.3$ e una deviazione standard pari a $3.5$


`r punti_p(nex = T)` Costruire un intervallo di confidenza la 99% per $\mu$ il punteggio medio che le persone del quartiere _Q_ esprimono riguardo alle corsie preferenziali.

:::{.sol data-latex=""}
```{r 2022-71}
cat(idc(xm = 76.3,sd = 3.5,alpha = .01,n = 15,dist_ = "t"))
```
:::

`r punti_p()` Un'indagine molto più ampia condotta su tutta la città ha mostrato che
il punteggio medio è pari a 66.3 con un deviazione standard pari a 3.3 .

Testare l'ipotesi che nel quartiere _Q_ il punteggio medio sia uguale a quello cittadino contro l'alternativa che sia maggiore.

:::{.sol data-latex=""}
```{r 2022-72}
s <- 3.3
n <- 15
muh <- 76.3
mu0 <- 66.3
h1 <- ">"
alpha <- 0.05
um <- ""
cat(ztest_mu(muh = muh,s = s,n = n,mu0 = mu0,h1 = h1))
```
:::





### Esercizio 6

```{r 2022-73}

set.seed(35)
n <- 50
x <- sort(sample(seq(10,20,by=.1),n))

eps <- rnorm(n,0,3)
y <- -5+x + eps

RGX <- regr(x,y)
ls2e(RGX)
```

Sono stati analizzati `r n` comuni della provincia di Modena e su ogni comune è stato rilevato
il numero di abitanti $X$, espresso in migliaia di persone, e il numero di esercizi commerciali $Y$.

Qui di seguito le statistiche bivariate

\begin{align*}
  \sum_{i=1}^n x_i &= `r sum(x)` &\sum_{i=1}^n x_i^2 &= `r sum(x^2)` &\sum_{i=1}^n x_i y_i &= `r sum(x*y)`\\
  \sum_{i=1}^n y_i &= `r sum(y)` & \sum_{i=1}^n y_i^2 &= `r sum(y^2)` &
\end{align*}

`r punti_p(nex = T)` Questi sono alcuni dei dati osservati

```{r 2022-74}
kable(t(prn[srr <-sample(1:n,4),2:3]),col.names = c("","","",""),booktabs=T,escape = F,linesep="") %>%
   kable_styling(full_width = F, latex_options = "HOLD_position")
```


Calcolare il residuo per $x=`r x[srr[3]]`$ nel modello di regressione dove $Y$ è spiegato da $X$.

:::{.sol data-latex=""}
```{r 2022-75}
cat(calcolo_beta())
cat(residuo(x[srr[3]],y[srr[3]]))
```
:::

`r punti_p()` Ricavare numericamente la scomposizione della varianza del modello di regressione sopra stimato.

:::{.sol data-latex=""}
```{r 2022-76}
cat(TSS())
```
:::

  
`r punti_p()` Che differenza c'è tra _interpolazione_ e _estrapolazione_?

`r punti_p()` Cosa significa che $r$ è un numero puro?



<div class="button-container"></div>

## Prova di Statistica 2022/07/27-1




### Esercizio 1

```{r 2022-77}
compito <- compito + 1
punti <- punti_list[[compito]]
```

```{r 2022-78}
# Basic settings
set.seed(2)   # per ottenere sempre la stessa simulazione
n <- 220      # ampiezza campionaria
nnn <- c(10,140,120,60,20)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Bilancio 2020"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ imprese della provincia di Milano è stato 
rilevato il bilancio, espresso in migliaia di euro, del 2020. Qui di seguito i dati raccolti in classi
e le frequenze percentuali.

:::{.sol data-latex=""}
```{r 2022-79}
tabl(dat3[,c(1,2,12)])
```
:::

`r punti_p(start=T)` Individuare la classe modale.

:::{.sol data-latex=""}
```{r 2022-80}
tabl(dat3[,1:7])

histp()
axis(1,brk)
```
:::

`r punti_p()` Quante imprese hanno un bilancio compreso tra $-4$ mila 
euro e zero.

:::{.sol data-latex=""}
$$\#(-1<X<0)=\frac{(0-(-4))`r dat2$hj[2]`}{100}\times `r n`=`r (F.int(0)-F.int(-4))*n`$$
:::

`r punti_p()`  La media è risultata essere $\bar x=`r mean(samp)`$; che
relazione mi devo aspettare tra mediana e moda?

:::{.sol data-latex=""}
$$\bar x<x_{0.5}<x_{Mo}$$
:::

`r punti_p()` Siano $x_1,...,x_n$, $n$ numeri, $n$ dispari. 
Si consideri la funzione:
$$g(x)=|x_1-x|+...+|x_n-x|.$$
Per quale valore di $x$, $g(x)$ è minima?

:::{.sol data-latex=""}
La funzione $g$ è minimizzata nel valore della mediana.
$$x_{0.5}=x_{((n+1)/2)}$$
:::




### Esercizio 2
  
Siano $X\sim N(5,1/2)$ e sia $Y\sim N(5,1/2)$, $X$ e $Y$ indipendenti. Posto $A=\{X>6\}$, $B=\{Y<4\}$.

`r punti_p(nex = T)` Calcolare $P(A\cup B)$.

:::{.sol data-latex=""}
```{r 2022-81}
x1 <- 6
verso <- ">"
ss <- .5
mm <- 5
vnam <- "X"
mu <- "\\mu_X"
sigma <- "\\sigma_X"

pa <- 1-pnorm(6,5,sqrt(.5))
pb <- pnorm(4,5,sqrt(.5))
cat(norm_int(x1 = x1,verso = verso,mm = mm,ss = ss))
```

```{r 2022-82}
x1 <- 4
verso <- "<"
ss <- .5
mm <- 5
vnam <- "Y"
mu <- "\\mu_Y"
sigma <- "\\sigma_Y"
cat(norm_int(x1 = x1,verso = verso,mm = mm,ss = ss,vnam = vnam,mu =mu,sigma = sigma))

pa <- 1-pnorm(6,5,sqrt(.5))
pb <- pnorm(4,5,sqrt(.5))
```


e quindi

\begin{eqnarray*}
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa`\times`r pb`\\
  &=& `r pa+pb-pa*pb` 
\end{eqnarray*}
:::

`r punti_p()` Posto $Z=X-Y$, Calcolare la probabilità che $P(Z>1|Z\le 2)$. 

:::{.sol data-latex=""}
\begin{eqnarray*}
  Z &=&  X-Y\\
  &\sim& N(5-5,1/2+1/2)\\
  &\sim& N(0,1)\\
P(Z>1|Z\le 2) &=&\frac{P(\{Z>1\}\cap\{Z\le 2\})}{P(Z\le 2)}  \\
&=& \frac{P(1<Z\le 2)}{P(Z\le 2)}  \\
&=&\frac{\Phi(2)-\Phi(1)}{\Phi(2)}\\
&=&\frac{`r pnorm(2)`-`r pnorm(1)`}{`r pnorm(2)`}\\
&=&`r (pnorm(2)-pnorm(1))/pnorm(2)`
\end{eqnarray*}
:::  

`r punti_p()` Siano $A$ e $B$ due eventi diversi dal vuoto.
Sono noti $P(A|B)=0.3$, $P(A|\bar B)=0.15$. $A$ e $B$ sono indipendenti? Perché?

:::{.sol data-latex=""}
No, perché se lo fossero
$$
P(A|B)=P(A|\bar B)=P(A)
$$
:::

`r punti_p()` Sia $X\sim\text{Pois}(\lambda=1)$, disegnare la
funzione di ripartizione $F(x)$ di $X$, per $x$ compreso tra $-1$ e $2.5$.

:::{.sol data-latex=""}
```{r 2022-83}
curve(ppois(x,1),-1,2.5,type = "s")
```
:::



### Esercizio 3

```{r 2022-84}
n <- 12^2
ex <- 1/3
vx <- 1/3*2/3
es <- mm <- ex
vs <- ss <- vx/n
#ss <- sqrt(vs)
# 
 # curve(dnorm(x,es,sqrt(ss)),from = es-4*sqrt(ss),to = es+4*sqrt(ss),axes=F)
 # axis(1)
 # curve(dnorm(x,es,sqrt(ss)),from = 30,to = es+4*sqrt(ss),add=T,type = "h",n=101)

vnam<- "\\hat\\pi"
mu <- "\\pi"
sigma <- "\\sqrt{\\frac{\\pi(1-\\pi)}{n}}"
x1 <- 0.35
x2 <- 9600
verso <- ">"
```

`r punti_p(nex = T)` Un'urna contiene tre palline, una Rossa, una Blue e una Nera. Si vince
se esce Rossa. Si ripete il gioco per $`r n`$ volte. Qual è la probabilità che la
**proporzione** di vincite sia maggiore di 0.35?

:::{.sol data-latex=""}
```{r 2022-85}
cat(tlc(tipo = "prop",x1 = x1,verso = verso,mu = 1/3,n = n))
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Sia $\hat \lambda$ lo stimatore di massima verosimiglianza di $\lambda$ del modello di Poisson: $\hat\lambda =  \frac 1n\sum_{i=1}^nx_i$
Scrivere la Varianza di $\hat \lambda$.

`r punti_p()` Se $h$ è uno stimatore per $\theta$ tale che
$E(h)\ne \theta$ e che $\lim_ {n\to +\infty}V(h)=0$ di quale proprietà gode $h$?

`r punti_p()` Definire gli errori di primo e di secondo 
tipo di un test statistico e le relative probabilità.

`r punti_p()` In un confronto tra due campioni viene messo a test
$$
\begin{cases}
H_0:\sigma_A=\sigma_B\\
H_1:\sigma_A\ne \sigma_B
\end{cases}
$$
Risulta $p_\text{value}=0.002$. Alla luce di questo risultato, per testare la differenza tra le medie, cosa è preferibile, un test sotto ipotesi di omogeneità, oppure sotto ipotesi di eterogeneità? Perché?




### Esercizio 5

`r punti_p(nex = T)` In uno studio sule preferenze di genere è stato chiesto ad un campione di 150 persone,
divise 80 signori e 70 signore, di esprimere la propria preferenza tra tre profumazioni (A, B e C)
di shampoo.
Qui di seguita la tavola di contingenza

```{r 2022-86}

dat <- matrix(c(50,5,10,55,20,10),2)

nome_y <- c("M","F")
nome_x <- c("A","B","C")

dat_print <- chi_print(dat,nome_x = nome_x,nome_y = nome_y)[[2]]
dat       <- chi_print(dat,nome_x = nome_x,nome_y = nome_y)[[1]]

tabl(dat_print,digits = 4) %>%
  column_spec(column = 1,bold = T)

```

Testare l'ipotesi che vi sia indipendenza tra genere e preferenza tra le profumazioni.

:::{.sol data-latex=""}
```{r 2022-87}
chi_test(dat = dat)
```
:::



### Esercizio 6

```{r 2022-88}

set.seed(666)
n <- 5
x <- sort(sample(seq(0,4,by=.1),n))

eps <- rnorm(n,0,1)
y <- round(5+x + eps,1)

RGX <-regr(x,y)
ls2e(RGX)
```

Sono stati analizzati `r n` comuni della provincia di Bologna e su ogni comune è stato rilevato
il PIL pro capite del comune $X$, espresso in decine di migliaia di euro e un valore di percezione di
qualità della vita $Y$ (espresso su opportuna scala).

Qui di seguito i dati

```{r 2022-89}
 tabl(t(prn[1:n,2:3]),col.names = LETTERS[1:n]) 
```


`r punti_p(nex = T)` Calcolare il residuo del comune B nel modello di regressione dove $Y$ viene spiegata da $X$.


:::{.sol data-latex=""}
```{r 2022-90}
 tabl((prn[,]))
cat(calcolo_beta())
cat(residuo(x[2],y[2]))
```
:::

`r punti_p()` Scrivere la scomposizione della varianza del modello di regressione 
e calcolare la Total Sum of Squares (TSS), la Explained Sum of Squares (ESS) e la Residual Sum of Squares (RSS) dei dati analizzati sopra.


:::{.sol data-latex=""}
```{r 2022-91}
cat(TSS())
```
:::
  

`r punti_p()` Interpretare il parametro di regressione $\hat\beta_1$.

`r punti_p()` Descrivere la differenza tra punti di leva e punti influenti.

`r punti_p()` Gli stimatori $\hat\beta_0$ e $\hat\beta_1$ dei minimi 
quadrati per $\beta_0$ e $\beta_1$ sono corretti?





<div class="button-container"></div>

## Prova di Statistica 2022/07/27-2


`r `

### Esercizio 1

```{r 2022-92}
compito <- compito + 1
punti <- punti_list[[compito]]
```


```{r 2022-93}
# Basic settings
set.seed(2)   # per ottenere sempre la stessa simulazione
n <- 220      # ampiezza campionaria
a <- 5
b <- 1

brk  <- c(-10,-5,0,2,4,6)
nnn <- c(10,70,120,40,20)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Bilancio 2020"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ imprese della provincia di Milano è stato 
rilevato il bilancio, espresso in migliaia di euro, del 2020. Qui di seguito i dati raccolti in classi
e le frequenze cumulate.


```{r 2022-94}
tabl(dat3[,c(1,2,7)])
```

`r punti_p(start=T)` Disegnare l'istogramma delle densità percentuali.

:::{.sol data-latex=""}
```{r 2022-95}
tabl(dat3[,1:7])

histp()
axis(1,brk)
```
:::

`r punti_p()` Quante aziende hanno un bilancio compreso tra il 25-esimo 
percentile e 3.5 mila euro?

:::{.sol data-latex=""}
$$\#(x_{0.25}<X<0)=n(F(3.5)-0.25)=`r n`(`r F.int(3.5)`-0.25)=`r n*(F.int(3.5)-0.25)`$$
:::

`r punti_p()` Che relazione dobbiamo attenderci tra media, mediana e moda?

:::{.sol data-latex=""}
$$\bar x<x_{0.5}<x_{Mo}$$
:::

`r punti_p()` Siano $x_1,...,x_n$, $n$ numeri. Si consideri la funzione:
$$g(x)=(x_1-x)^2+...+(x_n-x)^2.$$
Per quale valore di $x$, $g(x)$ è minima?




### Esercizio 2
  
In una strada, in prossimità di un dato incrocio, ci sono 3 corsie.
In orario di punta, il numero di automobili che impegna la corsia sinistra è descritto 
da una Poisson di parametro 1.1, $X_S\sim\text{Pois}(1.1)$, per quella di centro da una Poisson di parametro 1.0, $X_C\sim\text{Pois}(1.0)$ e per quella di destra da una Poisson di parametro 0.9,  $X_D\sim\text{Pois}(0.9)$. Si assume l'indipendenza tra le variabili.

`r punti_p(nex = T)` Si consideri l'evento $E$="più di due veicoli 
impegnano l'incrocio". Calcolare $P(E)$.

:::{.sol data-latex=""}
Posto $X=X_S+X_C+X_D$ osserviamo che 
$$X\sim\text{Pois}(\lambda=1.1+0.9+1)$$
e quindi
$$P(X\ge 2)=1-P(X\le 1)=1-(`r dpois(0,3)`+`r dpois(1,3)`)=`r 1-dpois(0,3)-dpois(1,3)`$$
:::

`r punti_p()` Calcolare
$$
P(X_S+X_C+X_D=3|X_S+X_C+X_D\ge 2).
$$

:::{.sol data-latex=""}
Posto $X=X_S+X_C+X_D$ osserviamo che 
$$\{X=3\}\cap\{X \ge 2\}=\{X=3\}$$
e quindi
\begin{eqnarray*}
  P(X=3|X\ge 2) &=&  \frac{P(\{X=3\}\cap\{X \ge 2\})}{P(X \ge 2)}\\
  &=&\frac{P(X=3)}{P(X \ge 2)}\\
  &=&\frac{`r dpois(3,3)`}{`r 1-dpois(0,3)-dpois(1,3)`}=`r dpois(3,3)/(1-dpois(0,3)-dpois(1,3))`\\
\end{eqnarray*}
:::  

`r punti_p()` Siano $X\sim N(0,1)$ e $Y\sim N(0,1)$, $X$ e $Y$ indipendenti.
Come si distribuisce $X^2+Y^2$?


`r punti_p()` Se $X$ è una VC con supporto {2,3,4,5} e $Y$ è una VC con supporto 
{1,2,6}.
Qual è il supporto di $X-Y$?

:::{.sol data-latex=""}
$S_{X-Y}=`r sort(unique(as.numeric(outer(2:5,c(1,2,6),"-"))))`$
:::



### Esercizio 3

```{r 2022-96}
n <- 100
ex <- mean(1:4)
vx <- s2c(1:4)
es <- mm <- ex
vs <- ss <- vx/n
#ss <- sqrt(vs)
# 
 # curve(dnorm(x,es,sqrt(ss)),from = es-4*sqrt(ss),to = es+4*sqrt(ss),axes=F)
 # axis(1)
 # curve(dnorm(x,es,sqrt(ss)),from = 30,to = es+4*sqrt(ss),add=T,type = "h",n=101)
vnam<- "\\bar X"
mu <- "\\mu"
sigma <- "\\sigma/\\sqrt{n}"
x1 <- 2.5
x2 <- 2.6

```

`r punti_p(nex = T)` Un'urna contiene 4 palline numerate da 1 a 4. 
Si estrae 100 volte con reinserimento e si fa la media dei 100 numeri
estratti. Qual è la probabilità che la media sia compresa tra 2.5 e 2.6?

:::{.sol data-latex=""}
```{r 2022-97}
cat(stat_(1:4,semp = T))
tlc(tipo = "media",x1 = 2.5,x2 = 2.6,verso = NULL,mu = mean(1:4),s2 = s2c(1:4),n = 100)
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Siano $h_1$ e $h_2$ due stimatori per $\theta$, tali che


$$
  MSE(h_1) =  \frac{\theta}{\sqrt{n}}, \qquad  MSE(h_2) =  \frac{\theta}{n}
$$

Quale dei due stimatori è più efficiente?

`r punti_p()` Sia $\hat\sigma^2$ lo stimatore di massima verosimiglianza
di $\sigma^2$. In virtù di quale proprietà $\hat \sigma$ è lo stimatore di
massima verosimiglianza per $\sigma$?

`r punti_p()` Siano $T_1$ e $T_2$ due test per lo stesso sistema di ipotesi,
con uguale significatività $\alpha=0.05$ e con probabilità di errore di secondo tipo, $\beta_1=0.3$ 
per il test $T_1$ e $\beta_2=0.15$ per il test $T_2$. Quale dei due test è più potente?

`r punti_p()` Se in un test statistico bilaterale che utilizza 
la statistica test _t_ con 11 gradi di libertà,  $t_\text{obs}=142.3$, 
il $p_\text{value}$ sarà maggiore o minore di 0.01? Perché?





### Esercizio 5

Su un campione di $n_M=35$ consumatori privati, scelti a caso tra i cittadini del comune di Modena, 
si è chiesto quanto spendono mensilmente per le forniture elettriche.
Il campione ha restituito una media pari a 12.4 €/mese, con una deviazione standard pari a 2.1 €/mese,

`r punti_p(nex = T)` Costruire un Intervallo di Confidenza al 95% per la media di popolazione $\mu$.


:::{.sol data-latex=""}
```{r 2022-98}
idc(xm = 12.4,sd = 2.1,dist_ = "t",n = 35)
```
:::

`r punti_p()` La stessa domanda è stata posta ad un secondo campione di $n_F=38$ consumatori privati,scelti a caso tra i cittadini del comune di Ferrara. 
Il campione ha restituito una media pari a 19.2 €/mese, con una deviazione standard pari a 3.9 €/mese. Sotto ipotesi di eterogeneità testare l'ipotesi che i due comuni abbiano uguale media, contro l'alternativa che a Ferrara consumino di più.

:::{.sol data-latex=""}
```{r 2022-99}
s1h <- 2.1
s2h <- 3.9
n1 <- 35
n2 <- 38
et <- T
mu1 <- 12.4
mu2 <- 19.2
alpha <- 0.05
a <- "$M$"
b <- "$F$"
h1 <- "<"
um <- ""
cat(ttest_2c_et(mu1 = mu1,mu2 = mu2,s1h = s1h,s2h = s2h,n1 = n1,n2 = n2,h1 = h1))
```
:::



### Esercizio 6

```{r 2022-100}

set.seed(666)
n <- 15
x <- sort(sample(seq(0,4,by=.1),n))

eps <- rnorm(n,0,1)
y <- round(5+x + eps,1)

RGX <-regr(x,y)
ls2e(RGX)
```

Sono stati analizzati `r n` comuni della provincia di Bologna e su ogni comune è stato rilevato
il PIL pro capite del comune $X$, espresso in decine di migliaia di euro e un valore di percezione di
qualità della vita $Y$ (espresso su opportuna scala).

Qui di seguito le statistiche bivariate

\begin{align*}
  \sum_{i=1}^n x_i &= `r sum(x)` &\sum_{i=1}^n x_i^2 &= `r sum(x^2)` &\sum_{i=1}^n x_i y_i &= `r sum(x*y)`\\
  \sum_{i=1}^n y_i &= `r sum(y)` & \sum_{i=1}^n y_i^2 &= `r sum(y^2)` &
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=1.6$ nel modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2022-101}
cat(calcolo_beta())
cat(previsione(1.6))
```
:::

`r punti_p()` Calcolare numericamente $RSS$:
$$
RSS=\sum_{i=1}^n \hat\epsilon_i^2
$$

:::{.sol data-latex=""}
$$RSS=n(1-r^2)\hat\sigma_Y^2=`r n*(1-r^2)*vy`$$
:::

`r punti_p()` Gli stimatori $\hat\beta_0$ e $\hat\beta_1$ sono consistenti? 
Perché?

`r punti_p()` Se in un modello di regressione con 11 dati, 
il residuo studentizzato del dato $i$ è $\tilde \epsilon_i=1.23$, cosa possiamo concludere?

`r punti_p()` Sia $\hat\beta_1$ lo stimatore dei minimi quadrati per $\beta_1$.
Scrivere il suo Standard Error teorico.




<div class="button-container"></div>

## Prova di Statistica 2022/07/27-3


`r `

### Esercizio 1

```{r 2022-102}
compito <- compito + 1
punti <- punti_list[[compito]]
```


```{r 2022-103}
# Basic settings
set.seed(2)   # per ottenere sempre la stessa simulazione
n <- 220      # ampiezza campionaria
a <- 5
b <- 1

brk  <- c(-10,-5,0,2,4,6)
# nnn  <- rev(c( 20,110,120, 50,10))
nnn <- c(10,40,120,40,20)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Bilancio 2020"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ imprese della provincia di Milano è stato 
rilevato il bilancio, espresso in migliaia di euro, del 2020. Qui di seguito i dati raccolti in classi
e le densità di frequenza percentuale.


```{r 2022-104}
tabl(dat3[,c(1,2,6)]) 
```

`r punti_p(start=T)` Calcolare il valore approssimato della mediana.

:::{.sol data-latex=""}
```{r 2022-105}
tabl(dat3[,1:7])
cat(percentile())
```
:::

`r punti_p()` Quante aziende hanno un bilancio compreso tra $-1$ e il 75-esimo 
percentile?

:::{.sol data-latex=""}
\begin{eqnarray*}
  F(x_{0.75}) &=&  0.75\\
  F(-1) &=& f_1+4h_2/100\\
  &=& `r dat2$fj[1]`+4\times `r dat2$hj[2]`/100\\
  &=& `r dat2$fj[1]+4*dat2$hj[2]/100`\\
  \%(-1<X<x_{0.75}) &=& (F(x_{0.75})-F(x_{-1}))\times 100\\
  &=& (`r .75-F.int(-1)`)\times 100 \%\\
  \#(-1<X<x_{0.75}) &=& n\%(-1<X<x_{0.75})/100 \\
  &=& `r n*(.75-F.int(-1))`
\end{eqnarray*}
  
$$
\#(-1<X<x_{0.75})=n\%(-1<X<x_{0.75})/100=n/100(75-F(-1))
$$
:::

`r punti_p()` Che relazione dobbiamo attenderci tra media, mediana e moda?

`r punti_p()` Sapendo che $\sigma_X=`r sc (samp)`$ la Standard Deviation di $X$
 e posto $y_i=-x_i, \forall i$, quanto varrà $\sigma_Y$, la standard deviation dei dati così
 trasformati?




### Esercizio 2
  
Una moneta perfetta viene lanciata 2 volte, se esce almeno 1 volta testa si estrae da un'urna che contiene un biglietto vincente ed uno perdente, altrimenti si estrae da un'urna che contiene due biglietti vincenti e tre perdenti.

`r punti_p(nex = T)` Qual è la probabilità di vincere?

:::{.sol data-latex=""}
Sia $X\sim\text{Binom}(1/2)$
$$P(E)=P(X\ge 1)=1-P(X=0)=1-\frac 14=\frac 34$$

\begin{eqnarray*}
  P(Vincere) &=& P(E)P(Vincere|E)+P(\bar E)P(Vincere|\bar E)\\
  &=& \frac 34\frac 12 + \frac 14 \frac 23\\
  &=& `r 3/4*1/2+1/4*2/3`
\end{eqnarray*}

`r pdv<- 3/4*1/2+1/4*2/3`
:::

`r punti_p()` Si ripete il gioco di sopra finché non si vince tre volte. Qual è la probabilità di finire alla quinta giocata?

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(\text{Finire alla quarta}) &=&  P(\text{Vincere 2 partite su 3}\cap\text{vincere alla quarta})\\
  &=& \left(\binom{3}{2}`r pdv`^2(1-`r pdv`)^1\right)\times `r pdv`\\
  &=& `r dbinom(2,3,pdv)`\times `r pdv`\\
  &=& `r dbinom(2,3,pdv)*pdv`
\end{eqnarray*}
:::

`r punti_p()` Se $X$ è una VC con supporto {1,2,3} e $Y$ è una VC con 
supporto {1,3,5}.
Qual è il supporto di $X\times Y$?

:::{.sol data-latex=""}
$$S_{X-Y}=`r sort(unique(as.numeric(outer(1:3,c(1,3,5),"*"))))`$$
:::



### Esercizio 3

```{r 2022-106}
n <- 60
ex <- 3.242
vx <- 0.5^2
es <- mm <- ex*n
vs <- ss <- vx*n
#ss <- sqrt(vs)
# 
 # curve(dnorm(x,es,sqrt(ss)),from = es-4*sqrt(ss),to = es+4*sqrt(ss),axes=F)
 # axis(1)
 # curve(dnorm(x,es,sqrt(ss)),from = 30,to = es+4*sqrt(ss),add=T,type = "h",n=101)
vnam<- "S_n"
mu <- "E(S_n)"
sigma <- "SD(S_n)"
x1 <- 225
verso <- ">"
```

`r punti_p(nex = T)` Il supermercato _S_ accoglie, in media ogni giorno, 3.242 mila persone, con una
deviazione standard di 0.5 mila persone. Dopo 60 giorni di apertura, qual è la probabilità che il 
totale dei visitatori sia maggiore di 225 mila persone?

```{r 2022-107}
tlc("somma",225,verso = ">",mu = ex,s2 = vx,n = n)
```




### Esercizio 4
  
`r punti_p(nex = T)` Sia $h$ uno stimatore per $\theta$, tale che

$$
MSE(h) =  \theta+\frac{\theta}{n^2}
$$

Lo stimatore $h$ è consistente?

`r punti_p()` Sia $\hat\theta$ lo stimatore di massima verosimiglianza 
per $\theta$. Qual è la distribuzione asintotica di $\hat\theta$?

`r punti_p()` Un intervallo di confidenza per $\theta$ al 90% è più ampio o meno ampio di uno al 95%? Perché?

`r punti_p()` Se in un test statistico bilaterale che utilizza la statistica test _z_ , risulta $z_\text{obs}=14$, il $p_\text{value}$ sarà maggiore o minore di 0.01? Perché?





### Esercizio 5

Su un campione di $n_R=75$ tassisti romani è stato chiesto se siano favorevoli o meno all'introduzione 
del decreto di liberalizzazione del trasporto. Lo studio ha riportato che 15 persone su 75 (l'20% del campione) è favorevole.

`r punti_p(nex = T)` Costruire un intervallo di confidenza la 95% per $\pi$ la quota di tassisti favorevoli al decreto liberalizzazione

:::{.sol data-latex=""}
\begin{eqnarray*}
  \left[~~0.2\pm z_{0.025}\sqrt{\frac{0.2\times 0.8}{75}}~~\right] &=&
  \left[~~0.2\pm 1.96\times`r sqrt(.2*.8/75)`~~\right]\\
  &=&\left[~~`r .2-1.96*sqrt(.2*.8/75)`; `r .2+1.96*sqrt(.2*.8/75)`~~\right]
\end{eqnarray*}
:::

`r punti_p()` La stessa domanda è stata posta ad un secondo 
campione di $n_M=95$ tassisti milanesi. Lo studio ha riportato che 32 persone su 95 (l'20% del campione) è favorevole.

Testare l'ipotesi la quota di tassisti favorevoli sia uguale tra le due città contro
l'alternativa che i tassisti milanesi siano maggiormente favorevoli.

:::{.sol data-latex=""}
```{r 2022-108}
n1 <- 75
n2 <- 95
s1 <- 15
s2 <- 32
alpha <- 0.05
a <- "$R$"
b <- "$M$"
h1 <- "<"
um <- ""
cat(ztest_2c_pi(s1 = s1,s2 = s2,n1 = n1,n2 = n2,h1 = h1,a = a,b = b))
```
:::



### Esercizio 6

```{r 2022-109}

set.seed(777)
n <- 15
x <- sort(sample(seq(0,4,by=.1),n))

eps <- rnorm(n,0,1)
y <- round(6+1.1*x + eps,1)

RGX <- regr(x,y)
ls2e(RGX)
```

Sono stati analizzati `r n` comuni della provincia di Bologna e su ogni comune è stato rilevato
il PIL pro capite del comune $X$, espresso in decine di migliaia di euro e un valore di percezione di
qualità della vita $Y$ (espresso su opportuna scala).

Qui di seguito le statistiche bivariate

\begin{align}
  \sum_{i=1}^n x_i &= `r sum(x)` &\sum_{i=1}^n x_i^2 &= `r sum(x^2)` &\sum_{i=1}^n x_i y_i &= `r sum(x*y)`\\
  \sum_{i=1}^n y_i &= `r sum(y)` & \sum_{i=1}^n y_i^2 &= `r sum(y^2)` &
\end{align}


`r punti_p(nex = T)` Questi sono alcuni dei dati osservati

```{r 2022-110}
tabl(t(prn[sample(1:n,4),2:3]),col.names = c("","","","")) 
```

Calcolare il residuo per $x=2.1$ nel modello di regressione dove $Y$ è spiegato da $X$.

:::{.sol data-latex=""}
```{r 2022-111}
cat(calcolo_beta())
cat(residuo(2.1,9.3))
```
:::

`r punti_p()` Calcolare la percentuale di varianza di $Y$ spiegata dal modello.

:::{.sol data-latex=""}
```{r 2022-112}
cat(R2())
```
:::

`r punti_p()` Se in un modello di regressione con 15 dati, 
il residuo studentizzato del dato $i$ è $\tilde \epsilon_i=12.3$, cosa possiamo concludere?


`r punti_p()` Sia $\hat\beta_0$ lo stimatore dei minimi quadrati per $\beta_0$.
Scrivere il suo Standard Error stimato.

<!--chapter:end:2022.Rmd-->


```{r 2023-105}
rm(list = rm())
source("intro.R")
if (html) cat('')
```
  
  
# Anno 2023

```{r 2023-106}
source("punti.R")
punti_list <- punti_2023
compito <- 0
```


<div class="button-container"></div>

## Prova di Statistica 2023/01/11-1


### Esercizio 1

```{r 20231}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-107}

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria
nomex <- "Investimento"

brk  <- c(0,1.5,3,5,10)
nnn  <- c( 20,110,100, 10)
nnn  <- round(nnn/sum(nnn)*n)
samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))

```

Su un campione di $`r n`$ famiglie della provincia di Modena è stato rilevato l'investimento annuo in prodotti finanziari (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze assolute:

```{r 2023-108}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale. 

:::{.sol data-latex=""}
```{r 2023-109}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp()
axis(1,brk)
axis(2,round(dat2$hj,2))
```
:::

`r punti_p()` Che percentuale di famiglie investe più di 4.5 mila euro all'anno?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \%(X>4.5) &=&  (5.0-4.5)\times`r dat2$hj[3]`+`r dat2$fj[4]*100`\\
  &=& `r (1-F.int(4.5))*100`
\end{eqnarray*}
:::

`r punti_p()` Che relazione dobbiamo aspettarci tra media e mediana? 

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$, mentre la SD è pari a $SD=`r sd(samp)`$.
Se ogni famiglia aumentasse il proprio investimento di 0.5 mila euro, quanto varrebbero la media e la SD dei dati così trasformati?



### Esercizio 2 

`r punti_p(nex = T)` Siano $X\sim N(10,1.5)$ e sia $Y\sim N(10,0.5)$, $X$ e $Y$ indipendenti. Posto $A=\{8<X<10\}$, $B=\{Y<11\}$. 
Quanto vale $P(A\cup B)$? 

:::{.sol data-latex=""}
```{r 2023-1,,results='asis'}
res1 <- norm_int(x1 = 8,x2 = 10,mm = 10,ss = 1.5,verso = NULL,vnam = "X",mu = "\\mu_X",sigma = "\\sigma_X")
res2 <- norm_int(x1 = 11,x2 = 10,mm = 10,ss = 0.5,verso = "<",vnam = "Y",mu = "\\mu_Y",sigma = "\\sigma_Y")
cat(res1)
cat(res2)
```

\begin{eqnarray*}
  P(A\cup B) &=&  `r .5-pnorm(8,10,sqrt(1.5))`+ `r pnorm(11,10,sqrt(0.5))`-`r (.5-pnorm(8,10,sqrt(1.5)))*pnorm(11,10,sqrt(0.5))`\\
             &=&  `r .5-pnorm(8,10,sqrt(1.5)) +    pnorm(11,10,sqrt(0.5)) -   (.5-pnorm(8,10,sqrt(1.5)))*pnorm(11,10,sqrt(0.5))`\\
\end{eqnarray*}
:::


`r punti_p()` Un'urna contiene due palline rosse, due bianche e una nera. Si estrae due volte senza reinserimento. Qual è la probabilità di avere due colori diversi?  

:::{.sol data-latex=""}
\begin{eqnarray*}
  \text{due colori diversi} &=& RB\cup BR \cup\\
                            &&  RN\cup NR \cup\\
                            &&  BN\cup NB\\
  P(\text{due colori diversi}) &=& P(RB)+P(BR)+P(RN)+P(NR)+P(BN)+P(NB)\\
  &=& \frac 25\frac 24+\frac 25\frac 24+\frac 25\frac 14+\frac 15\frac 24+\frac 25\frac 14+\frac 15\frac 24\\
  &=& \frac{4+4+2+2+2+2}{20}\\
  &=& `r 16/20`
\end{eqnarray*}
:::

`r punti_p()` Se $X\sim\text{Pois}(3.2)$ e $Y\sim\text{Pois}(1.2)$, $X$ e $Y$ indipendenti, quali sono valore atteso e varianza di $X+Y$ e di $X-Y$? 

`r punti_p()` Sia $X$ una VC e sia $F$ la sua funzione di ripartizione. Cosa significa dire che $F$ è continua a destra?



### Esercizio 3 

`r punti_p(nex = T)` Un'urna contiene 4 palline numerate: $\fbox{0}$, $\fbox{0}$, $\fbox{0}$ e $\fbox{1}$. Si estrae 100 volte con reinserimento. Qual è la probabilità che la proporzione di palline timbrate con 1 nelle 100 estrazioni sia maggiore di 0.27?


  
:::{.sol data-latex=""}
\begin{eqnarray*}
  \pi &=&  \frac 14\\
  E(\hat\pi) &=& \frac 14\\
  V(\hat\pi) &=& \frac {1/4(1-1/4)}{100}\\
  &=& `r 1/4*3/4/100`
\end{eqnarray*}

```{r 2023-2,,results='asis'}
urn <- c(0,0,0,1)
mm <- mean(urn)
ss <- s2c(urn)
n <- 100
cat(tlc("prop",.27,verso = ">",mu = mm,s2 = ss,n=n))
```
:::


### Esercizio 4 
  
`r punti_p(nex = T)` Sia $\hat \lambda$ lo stimatore di massima verosimiglianza di $\lambda$ del modello di Poisson.
\begin{eqnarray*}
  \hat\lambda &=&  \frac 1n\sum_{i=1}^nx_i\\
\end{eqnarray*}
Ricavare il suo $MSE$ (Mean Squared Error). 

`r punti_p()` Si $h$ uno stimatore per $\theta$ tale che $E(h)=\theta$. Di quale proprietà gode $h$? 

`r punti_p()` Definire la potenza di un test. 

`r punti_p()` In uno studio sull'efficacia degli integratori alimentari, su un gruppo di 238 atleti è stato misurato il rendimento atletico (ottimo, buono e scarso) e l'assunzione di integratori (alto, medio e basso). Qui di seguito i dati:

```{r 2023-110}

x <- matrix(c(21,20,18,35,26,38,15,30,35),3)

dimnames(x)<-list(redimento=c("ottimo","buono","scarso"),reddito=c("alto","medio","basso"))
kable(x,booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")%>%
  kable_paper("striped", full_width = F) %>%
  pack_rows("rendimento", 1, 3) %>%
  add_header_above(c(" " = 1, "Integratori" = 3))
```

il test del chi-quadro sull'indipendenza tra rendimento e assunzione di integratori restituisce un $p_\text{value}=0.08$. Che cosa possiamo concludere?



### Esercizio 5 


```{r 2023-111}
n1 <- 35
muh1 <- 68
sdh1 <- 5.1
n2 <- 35
muh2 <- 71
sdh2 <- 4.5
```

`r punti_p(nex = T)` In uno studio sul gradimento dell'azione politica della regione, nel comune $A$ si è rilevata l'opinione su `r n1` intervistati misurata in una scala di gradimento che va da zero a 100. I dati campionari hanno evidenziato una media pari a $\hat\mu_A=`r muh1`$ e una deviazione standard osservata pari a $\hat\sigma_A=`r sdh1`$, mentre nel comune $A$ si è rilevata l'opinione su `r n1` intervistati misurata in una scala di gradimento che va da zero a 100. I dati campionari hanno evidenziato una media pari a $\hat\mu_B=`r muh2`$ e una deviazione standard osservata pari a $\hat\sigma_B=`r sdh2`$. Sotto ipotesi di omogeneità delle varianza testare l'ipotesi che il gradimento politico sia uguale nei due comuni contro l'alternativa che sia **diverso**.

:::{.sol data-latex=""}
```{r 2023-3,,results='asis'}
ttest_2c_om(mu1 = muh1,mu2 = muh2,s1h = sdh1,s2h = sdh2,n1 = n1,n2 = n2,h1 = "\\neq",a = "A",b = "B")

```
:::




### Esercizio 6 

```{r rg1}

set.seed(5)
set.seed(36)
n <- 150
x <- runif(n,1,60)
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- rnorm(n,0,.25)
y <- 1+log(x)+eps

x <- x/60
y <- y/10

RGX <- regr(x,y,semp = T)
ls2e(RGX)
```

In uno studio sul potere d'acquisto delle famiglie è stato selezionato un campione di 150 nuclei familiari 
a cui è stato chiesto il reddito annuo ($X$ espressa in scala di comodo) e la spesa annua in generi alimentari ($Y$ espressa in scala di comodo). Qui di seguito le statistiche bivariate

\begin{align*}
\sum_{i=1}^n x_i &= `r sumx`,   &\sum_{i=1}^n x_i^2 &= `r sumx2` \\
\sum_{i=1}^n y_i &= `r sumy`,   &\sum_{i=1}^n y_i^2 &= `r sumy2` \\
\sum_{i=1}^n x_iy_i &= `r sumxy`.    \\
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=1.5$ nel modello di regressione dove $Y$ viene spiegata da $X$. 

:::{.sol data-latex=""}
```{r 2023-112}
cat(calcolo_beta())
cat(previsione(1.5))
```
:::

`r punti_p()` Qual è la percentuale di varianza spiegata dal modello? 

:::{.sol data-latex=""}
$$r^2\times 100=`r r^2*100`$$
:::

`r punti_p()` Interpretare il diagramma dei residui. 
```{r 2023-4,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,ml$res,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-5,,results='asis'}
plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")

spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::

`r punti_p()` Se $W=- Y$, quanto varrà $r_{XW}$, coefficiente di correlazione tra $X$ e $W$?




<div class="button-container"></div>

## Prova di Statistica 2023/01/11-2

```{r 2023-113}

source("intro.R")




```


### Esercizio 1

```{r 2023-114}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-115}
# Basic settings
set.seed(2)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- rev(10-c(0,1.5,3,5,10))
nnn  <- rev(c( 20,110,100, 10))
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"
samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))

```

Su un campione di $`r n`$ famiglie della provincia di Modena è stato rilevato l'investimento annuo in prodotti obbligazionari (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze percentuali:

:::{.sol data-latex=""}
```{r 2023-116}
kable(dat3[,c(1,2,12)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```
:::

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale. 

:::{.sol data-latex=""}
```{r 2023-117}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp()
axis(1,brk)
axis(2,round(dat2$hj,2))
```
:::

`r punti_p()` Quante famiglie investono più di 8 mila euro all'anno? 

:::{.sol data-latex=""}
\begin{eqnarray*}
  \#(X>4.5) &=&  `r n`(\frac1{100}(8.5-8)\times`r dat2$hj[3]`+`r dat2$fj[4]`)\\
  &=& `r n*(1-F.int(8))`
\end{eqnarray*}
:::  

`r punti_p()` Che relazione dobbiamo aspettarci tra media e mediana? 

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$, mentre la SD è pari a $SD=`r sd(samp)`$.
Se ogni famiglia aumentasse il proprio investimento del 2 percento, quanto varrebbero la media e la SD dei dati così trasformati?





### Esercizio 2

`r punti_p(nex = T)` I clienti in fila nell'ora di punta alla cassa di un supermercato sono distribuiti come una Poisson di parametro 2.5 ($X\sim\text{Pois}(\lambda=2.5)$). Qual è la probabilità di trovare almeno 2 clienti in coda ($X\ge 2$)? 

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(X\ge 2) &=&  1-P(X<2)\\
  &=& 1-(P(X=0)+P(X=1))\\
  &=& 1-(`r dpois(0,2.5)`+`r dpois(1,2.3)`)\\
  &=& `r 1-(dpois(0,2.5)+dpois(1,2.3))`
\end{eqnarray*}

```{r 2023-118}
pois_dis(2,2.3,">")
```
:::

`r punti_p()` Un'urna contiene 5 palline: 2 rosse e 3 bianche. Si estrae con reintroduzione finché non escono 2 bianche consecutive. Calcolare la probabilità di finire in __esattamente__ 3 estrazioni. 

:::{.sol data-latex=""}
\begin{eqnarray*}
  \text{esattamente tre} &=& R\cap B\cap B \\
  P(\text{esattamente tre}) &=& P(R\cap B\cap B)\\
  &=&\frac 25 \frac 35\frac 35\\
  &=& `r 2*3*3/5^3`
\end{eqnarray*}
:::  

`r punti_p()` Se $X\sim N(3.2,1.5)$ e $Y\sim N(1.2,1.1)$, $X$ e $Y$ indipendenti, come si distribuiscono $X+Y$ e  $X-Y$? 

`r punti_p()` Sia $X$ una VC e sia $F$ la sua funzione di ripartizione. Cosa significa dire che $F$ è crescente?




### Esercizio 3

```{r 2023-119}
n <- 365
ex <- 0.08
vx <- 0.034
es <- mm <- n*ex
vs <- ss <- n*vx
#ss <- sqrt(vs)
# 
 # curve(dnorm(x,es,sqrt(ss)),from = es-4*sqrt(ss),to = es+4*sqrt(ss),axes=F)
 # axis(1)
 # curve(dnorm(x,es,sqrt(ss)),from = 30,to = es+4*sqrt(ss),add=T,type = "h",n=101)

```

`r punti_p(nex = T)` Un'urna contiene 4 palline numerate con $\fbox{0}$, $\fbox{3}$, $\fbox{4}$ e $\fbox{6}$. Si estrae 100 volte con reinserimento. Qual è la probabilità che la somme delle 100 estrazioni sia maggiore di 310?

:::{.sol data-latex=""}
```{r 2023-6,,results='asis'}
urn <- c(0,3,4,6)
mm <- mean(urn)
ss <- s2c(urn)
n <- 100
cat(stat_(x = urn))
cat(tlc(tipo = "somma",x1 = 310,verso = ">",mu = mm,s2 = ss,n = n))
```
:::




### Esercizio 4
  
`r punti_p(nex = T)` Sia $\hat \pi$ lo stimatore di massima verosimiglianza di $\pi$ del modello Binomiale.
\begin{eqnarray*}
  \hat\pi &=&  \frac 1n\sum_{i=1}^nx_i\\
\end{eqnarray*}
Ricavare il suo $MSE$ (Mean Squared Error). 

`r punti_p()` Si $h$ uno stimatore per $\theta$ tale che $E(h)=\theta$ e $\lim_{n\to\infty} V(h)=0$. Di quale proprietà gode $h$? 

`r punti_p()` Definire la significatività di un test. 

`r punti_p()` In uno studio sull'efficacia della formazione nella scelta degli investimenti finanziari sono stati analizzati due gruppi di investitori, un primo gruppo senza alcuno studio specifico e un secondo gruppo di laureati in scienze economiche o affini. Sotto ipotesi di eterogeneità della varianze si è messo a test l'ipotesi che il rendimento medio degli investimenti dei laureati in scienze economiche $\mu_E$ sia uguale a quello dei non laureati $\mu_N$, contro l'alternativa che $\mu_E>\mu_N$. Il test ha restituito un $p_\text{value}$ pari a 0.092. Cosa possiamo concludere?




### Esercizio 5

```{r 2023-120}
s1 <- 26
n1 <- 35
s2 <- 45
n2 <- 50
```


`r punti_p(nex = T)` In uno studio sul gradimento dell'azione politica della regione, nel comune $A$ si è rilevato che `r s1` persone su `r n1` intervistati è soddisfatto, mentre nel comune $B$, `r s2` su `r n2` sono soddisfatti.
Testare usando il $p_\text{value}$ l'ipotesi che la proporzione di disoccupati sia uguale nei due comuni, contro l'alternativa che si **maggiore** nel comune $B$. 


:::{.sol data-latex=""}
```{r 2023-7,,results='asis'}
ztest_2c_pi(s1 = s1,s2 = s2,n1 = n1,n2 = n2,h1 = "<",a = "A",b = "B")
```
:::



### Esercizio 6

```{r 2023-121}

set.seed(5)
set.seed(36)
n <- 150
x <- runif(n,1,60)
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- rnorm(n,0,.25)
y <- 10-log(x)+eps

x <- x/60
y <- y/10

RGX <- regr(x,y,semp = T)
ls2e(RGX)
```

In uno studio sul potere d'acquisto delle famiglie è stato selezionato un campione di 150 nuclei familiari 
a cui è stato chiesto il reddito annuo ($X$  espressa in scala di comodo) e gli aumenti dei prezzi percepiti ($Y$ espressa in opportuna scala). Qui di seguito le statistiche bivariate

\begin{align*}
\sum_{i=1}^n x_i &= `r sumx`,   &\sum_{i=1}^n x_i^2 &= `r sumx2` \\
\sum_{i=1}^n y_i &= `r sumy`,   &\sum_{i=1}^n y_i^2 &= `r sumy2` \\
\sum_{i=1}^n x_iy_i &= `r sumxy`.    \\
\end{align*}
 
`r punti_p(nex = T)` Stimare la previsione per $x=1.5$ nel modello di regressione dove $Y$ viene spiegata da $X$. 

:::{.sol data-latex=""}
```{r 2023-8,,results='asis'}
cat(calcolo_beta())
cat(previsione(1.5))
```
:::

`r punti_p()` Il modello si adatta bene ai dati? 

:::{.sol data-latex=""}
```{r 2023-9,,results='asis'}
cat(R2())
```
:::

`r punti_p()` Interpretare il diagramma dei residui. 
```{r 2023-122}
par(cex=.35)
plot(x,ml$res,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-10,,results='asis'}

plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es,df1=5,df2=5,a = 2 )
axis(1)
axis(2)
```
:::

`r punti_p()` Se $W= 1 - Y$, quanto varrà $r_{XW}$, coefficiente di correlazione tra $X$ e $W$?





<div class="button-container"></div>

## Prova di Statistica 2023/01/11-3

```{r 2023-123}

source("intro.R")




```


### Esercizio 1

```{r 2023-124}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-125}
# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- c(0,3.5,5,6.5,10)
nnn  <- c( 20,100,100, 20)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Modena è stato rilevato l'investimento annuo in prodotti finanziari (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze cumulate:

```{r 2023-126}
kable(dat3[,c(1,2,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale. 

:::{.sol data-latex=""}
```{r 2023-127}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r punti_p()` Quante famiglie investono meno di 4.5 mila euro all'anno? 

:::{.sol data-latex=""}
\begin{eqnarray*}
  \#(X<4.5) &=&  `r n`(\frac1{100}(4.5-3.5)\times`r dat2$hj[2]`+`r dat2$fj[1]`)\\
  &=& `r n*(F.int(4.5))`
\end{eqnarray*}
:::  


`r punti_p()` Che relazione dobbiamo aspettarci tra media e mediana? 

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$, mentre la SD è pari a $SD=`r sd(samp)`$.
Se ogni famiglia diminuisse il proprio investimento del 2%, quanto varrebbero la media e la SD dei dati così trasformati?




### Esercizio 2

`r punti_p(nex = T)` Un'urna contiene 20 palline: 8 bianche e 12 nere, si estrae con reintroduzione 5 volte. 
Qual è la probabilità avere un numero di palline bianche maggiore o uguale a 2 su 5 estrazioni? 

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(X\ge 2) &=&  1-P(X<2)\\
  &=& 1-(P(X=0)+P(X=1))\\
  &=& 1-(`r dbinom(0,5,8/20)`+`r dbinom(1,5,8/20)`)\\
  &=& `r 1-dbinom(0,5,8/20)-dbinom(1,5,8/20)`
\end{eqnarray*}
:::  

`r punti_p()` Dalla stessa urna di prima, si estrae con reintroduzione finché non escono due palline bianche consecutive. Qual è la probabilità di finire in __al massimo__ 3 tentativi? 

:::{.sol data-latex=""}
\begin{eqnarray*}
  \text{al massimo tre} &=& (B\cap B)\cup(R\cap B\cap B )\\
  P(\text{al massimo tre}) &=& P(B\cap B)+P(R\cap B\cap B)\\
  &=&0.4\times 0.4 +0.6\times 0.4\times 0.4\\
  &=& `r .16*1.6`
\end{eqnarray*}
:::  

`r punti_p()` Se $X\sim N(3.2,1.1)$ e $Y\sim\text{Binom}(12,0.3)$, $X$ e $Y$ indipendenti, quali sono valore atteso e varianza di $X+Y$ e di $X-Y$? 

`r punti_p()` Sia $X$ una VC e sia $F$ la sua funzione di ripartizione. Quanto valgono $\lim_{x\to-\infty}F(x)$ e $\lim_{x\to+\infty}F(x)$?




### Esercizio 3

```{r 2023-128}
n <- 365
ex <- 0.08
vx <- 0.034
es <- mm <- n*ex
vs <- ss <- n*vx
#ss <- sqrt(vs)
# 
 # curve(dnorm(x,es,sqrt(ss)),from = es-4*sqrt(ss),to = es+4*sqrt(ss),axes=F)
 # axis(1)
 # curve(dnorm(x,es,sqrt(ss)),from = 30,to = es+4*sqrt(ss),add=T,type = "h",n=101)

```

`r punti_p(nex = T)` Un'urna contiene 4 palline numerate: $\fbox{0}$, $\fbox{1}$, $\fbox{4}$ e $\fbox{6}$. Si estrae 100 volte con reinserimento. Qual è la probabilità che la media delle 100 estrazioni sia maggiore di 2.8?

:::{.sol data-latex=""}
```{r 2023-11,,results='asis'}
urn <- c(0,1,4,6)
mm <- mean(urn)
ss <- s2c(urn)
n <- 100

cat(stat_(urn,semp=T))
cat(tlc("media",2.8,NUll,verso = ">",mu = mm,s2 = ss,n = n))
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Siano $\hat \mu$ e $\hat\sigma^2$ gli stimatori di massima verosimiglianza di $\mu$ e $\sigma^2$ del modello di Normale.
\begin{eqnarray*}
  \hat\mu &=&  \frac 1n\sum_{i=1}^nx_i \qquad \hat\sigma^2 =  \frac 1n\sum_{i=1}^n(x_i-\hat\mu)^2\\
\end{eqnarray*}
Ricavare il $MSE$ (Mean Squared Error) di $\hat\mu$. 

`r punti_p()` Si $h$ uno stimatore per $\theta$ tale che $E(h)\ne\theta$, ma che $\lim_{n\to\infty}E(h)=\theta$. Di quale proprietà gode $h$? 

`r punti_p()` Quali sono gli errori di primo e secondo tipo? 

`r punti_p()` In uno studio sull'efficacia degli integratori alimentari, a 120 atleti è stato somministrato un particolare integratore alimentare giornalmente e a 120 atleti è stato dato un placebo. Dopo 30 giorni di sperimentazione sono state eseguite prove fisiche che hanno restituito la performance degli atleti misurata in scala numerica. Gli atleti che hanno assunto l'integratore hanno ottenuto un risultato medio pari a $\hat\mu_\text{Integratore}=53.4$, mentre gli atleti che hanno assunto l'integratore hanno ottenuto un risultato medio pari a $\hat\mu_\text{Placebo}=50.8$.
Sotto ipotesi di omogeneità è stato messo a test
\[
\begin{cases}
H_0:\mu_\text{Integratore}=\mu_\text{Placebo}\\
H_1:\mu_\text{Integratore}>\mu_\text{Placebo}
\end{cases}
\]
il $p_\text{value}$ è risultato pari a $p_\text{value}=0.092$. Cosa possiamo concludere?



### Esercizio 5

```{r 2023-129}
n1 <- 35
muh <- 68
sdh <- 5
mu0 <- 71
```

`r punti_p(nex = T)` In uno studio sul gradimento dell'azione politica della regione, nel comune $A$ si è rilevata l'opinione su `r n1` intervistati misurata in una scala di gradimento che va da zero a 100. I dati campionari hanno evidenziato una media pari a $\hat\mu=`r muh`$ e una deviazione standard osservata pari a $\hat\sigma=`r sdh`$.
Costruire un intervallo di confidenza al 95% per il gradimento medio $\mu$. 

:::{.sol data-latex=""}
```{r 2023-12,,results='asis'}
options(digits = 4)
res <- idc(xm = muh,sd = sdh,alpha = .05,n = n1,dist_ = "t",mus = mu0,ss = "S")
cat(res)
```
:::

`r punti_p()` Un'indagine analoga, svolta sull'intera regione, ha mostrato un gradimento medio pari a $\mu_0=`r mu0`$. Testare l'ipotesi che nel comune A il livello di gradimento sia uguale a quello regionale contro l'alternativa che sia __minore__.

:::{.sol data-latex=""}
```{r 2023-13,,results='asis'}
res <- ttest_mu(muh = muh,sh = sdh,n = n1,mu0 = mu0,h1 = "<")
cat(res)
```
:::



### Esercizio 6

```{r 2023-130}

set.seed(5)
set.seed(4)
n <- 150
x <- sort(runif(n,0,10))
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- c(rnorm(90,0,.25),rnorm(60,0,.9))
y <- 1+x+eps
x <- x/10
y <- y/10

RGX <- regr(x,y,semp = T,ax=1)
ls2e(RGX)
```

In uno studio sul potere d'acquisto delle famiglie è stato selezionato un campione di 150 nuclei familiari 
a cui è stato chiesto il reddito annuo ($X$ espressa in scala di comodo) e la spesa annua in generi alimentari ($Y$ espressa in scala di comodo). Qui di seguito le statistiche bivariate

\begin{align*}
\sum_{i=1}^n x_i &= `r sumx`,   &\sum_{i=1}^n x_i^2 &= `r sumx2` \\
\sum_{i=1}^n y_i &= `r sumy`,   &\sum_{i=1}^n y_i^2 &= `r sumy2` \\
\sum_{i=1}^n x_iy_i &= `r sumxy`.    \\
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=1.5$ nel modello di regressione dove $Y$ viene spiegata da $X$. 

:::{.sol data-latex=""}
```{r 2023-131}
cat(calcolo_beta())
cat(previsione(1.5))
```
:::

`r punti_p()` Calcolare e interpretare $R^2$. 

:::{.sol data-latex=""}
```{r 2023-132}
cat(R2())
```
:::

`r punti_p()` Interpretare il diagramma dei residui. 
```{r 2023-14,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,ml$res,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-15,,results='asis'}

plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
axis(1)
axis(2)

# Calcolare i residui al quadrato
res_squared <- abs(es)^(1.3)

# Regressione dei residui al quadrato su x, x^2 e termine costante
fun <- function(x) x^2
xx <- fun(x)
fit <- lm(res_squared ~ x + xx)

# Estrarre i coefficienti stimati
coefficients <- coef(fit)
a <- coefficients[1]
b <- coefficients[2]
c <- coefficients[3]

# Definire la funzione per l'intervallo di confidenza
confidence_interval <- function(x) {
  sigma2 <- a + b * x + c * fun(x)
  sigma <- sqrt(sigma2)
  return(sigma)
}

# Calcolare e disegnare l'intervallo di confidenza
sigma <- confidence_interval(x)
upper_bound <- 0 + sigma/1
lower_bound <- 0 - sigma/1


# Aggiungere le linee dell'intervallo di confidenza
lines(sort(x), upper_bound[order(x)], col = "blue", lwd = 2, lty = 2)
lines(sort(x), lower_bound[order(x)], col = "blue", lwd = 2, lty = 2)

```
:::

`r punti_p()` Se $W=1+ Y$, quanto varrà $r_{XW}$, coefficiente di correlazione tra $X$ e $W$?



<div class="button-container"></div>

## Prova di Statistica 2023/02/16-1

```{r 2023-133}

source("intro.R")




```

### Esercizio 1

```{r 2023-134}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-135}

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 200      # ampiezza campionaria

brk  <- c(-2,-1,1,5,15)
nnn  <- c( 20,100,110, 10)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ imprese della provincia di Modena è stato rilevato l'utile dell'ultimo trimestre (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze assolute:

```{r 2023-136}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Individuare la classe modale.

:::{.sol data-latex=""}
```{r 2023-137}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(T)
```
:::

`r punti_p()` Quale è il numero di imprese che hanno un utile maggiore di zero?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \%(X>0) &=&  100\%-\%(X\le 0)\\
  &=& 100 - (0.09\times 100 + 20.8\times(0-(-1)))\%\\
  &=& `r (1-F.int(0))*100`\%
\end{eqnarray*}
:::

`r punti_p()` L'utile medio è pari a $\bar x=`r mean(samp)`$ che forma avrà l'istogramma?

`r punti_p()` Qual è la proprietà di associatività della media aritmetica?




### Esercizio 2

`r punti_p(nex = T)` Siano $X\sim N(1,1.5)$ e sia $Y\sim N(1,0.5)$, $X$ e $Y$ indipendenti. Posto $A=\{-2<X<1\}$, $B=\{Y<1\}$. 
Quanto vale $P(A\cap B)$?

:::{.sol data-latex=""}
```{r 2023-16,,results='asis'}
cat(norm_int(x1 = -2,x2 = 1,verso = NULL,mm = 1,ss = 1.5,vnam = "X",mu = "\\mu_X",sigma = "\\sigma_X"))
cat(norm_int(x1 =  1,verso = "<",mm = 1,ss = 1.5,vnam = "Y",mu = "\\mu_Y",sigma = "\\sigma_Y"))
```

\begin{eqnarray*}
  P(A\cap B) &=&0.5\times 0.49 = `r .5*.49`
\end{eqnarray*}
:::

`r punti_p()` Un'urna contiene 10 palline rosse, 10 bianche e 10 nere. Si estrae tre volte senza reinserimento. Qual è la probabilità di avere tre colori uguali? 

:::{.sol data-latex=""}
\begin{eqnarray*}
  E &=& \text{tre colori uguali}\\
   &=& \{(R_1\cap R_2 \cap R_3)\cup (B_1\cap B_2 \cap B_3)\cup (N_1\cap N_2 \cap N_3)\}\\
P(E) &=& P(R_1\cap R_2 \cap R_3) + P(B_1\cap B_2 \cap B_3) + P(N_1\cap N_2 \cap N_3)\\
&=& P(R_1)P(R_2|R_1)P(R_3|R_1\cap R_2)+P(B_1)P(B_2|B_1)P(B_3|B_1\cap B_2)+\\
& & + P(N_1)P(N_2|N_1)P(N_3|N_1\cap N_2)\\
&=& \frac {10}{30}\frac 9{29}\frac 8{28} + \frac {10}{30}\frac 9{29}\frac 8{28} +\frac {10}{30}\frac 9{29}\frac 8{28} \\
&=& 3\cdot \frac {10}{30}\frac 9{29}\frac 8{28} \\
&=& `r 3*10*9*8/30/29/28`
\end{eqnarray*}
:::

`r punti_p()` Se $X\sim\text{Ber}(0.2)$ e $Y\sim\text{Ber}(0.2)$, $X$ e $Y$ indipendenti, com'è distribuita $X+Y$?

`r punti_p()` Se $X$ è $Y$ sono due VC, tali che $V(X)=\sigma_X^2$ e $Y=\sigma_Y^2$, quanto vale $V(X-Y)$?



### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene 4 palline numerate: $\fbox{0}$, $\fbox{1}$, $\fbox{2}$ e $\fbox{3}$. Si estrae 100 volte con reinserimento. Qual è la probabilità che la media delle 100 estrazioni sia maggiore di 1.6?

:::{.sol data-latex=""}
```{r 2023-17,,results='asis'}
urn <- 0:3
mm <- mean(urn)
ss <- s2c(urn)
n <- 100
cat(stat_(urn,semp=T))
cat(tlc("media",x1 = 1.6,NULL,">",mu = mm,s2 = ss,n = n))
``` 
:::



### Esercizio 4
  
`r punti_p(nex = T)` Sia $\hat \lambda$ lo stimatore di massima verosimiglianza di $\lambda$ del modello di Poisson.
\begin{eqnarray*}
  \hat\lambda &=&  \frac 1n\sum_{i=1}^nx_i\\
\end{eqnarray*}
Ricavare la sua varianza e metterla in relazione con il suo MSE.

`r punti_p()` Sia $h$ uno stimatore per $\theta$. Cosa significa dire che $h$ è consistente?

`r punti_p()` Siano $T_1$ e $T_2$ due test per lo stesso sistema d'ipotesi e con probabilità di errore di secondo tipo pari a, $\beta_1=0.2$ e $\beta_2=0.3$, rispettivamente. A parità di significatività, quale dei due è più potente? Perché?

`r punti_p()` In uno studio sull'efficacia di farmaco sono stati analizzati due gruppi di pazienti, un primo gruppo di 132 pazienti col placebo e un secondo gruppo di 132 pazienti col farmaco. Il 28.8% (38 su 132) di chi ha preso il placebo è guarito entro i primi 5 giorni, mentre il 39.4% (42 su 132) di chi è stato trattato col farmaco è guarito entro i primi 5 giorni. Il test sulla differenza tra le due proporzioni ha restituito $p_\text{value}=0.09$. Possiamo affermare che il farmaco sia efficace?



### Esercizio 5


`r punti_p(nex = T)` In uno studio sull'efficacia degli integratori alimentari, su un gruppo di 238 atleti è stato misurato il rendimento atletico (ottimo, buono e scarso) e l'assunzione di integratori (alto, medio e basso). Qui di seguito i dati:

```{r 2023-138}

x <- matrix(c(21,20,18,35,26,38,15,30,35),3)

dat <- chi_print(x,c("ottimo","buono","scarso"),c("alto","medio","basso"))
tabl(dat[[2]])

```

Al livello del 5% testare l'ipotesi che integratori e rendimento siano indipendenti.

:::{.sol data-latex=""}
```{r 2023-139}
chi_test(dat[[1]])
```
:::



### Esercizio 6

```{r 2023-140}

set.seed(6)
n <- 150
x <- runif(n,1,6)
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- rnorm(n,0,.1*x/6+.01)
y <- 10-log(x*15)+eps

RGX <- regr(x,y)
ls2e(RGX)
```

In uno studio sull'adeguamento alle direttive europee sul green si sono analizzate `r n` aziende, sono stati analizzati l'investimento in green ($X$ espresso in decine migliaia di euro/anno) e l'impatto l'abbattimento di CO2 (misurata in opportuna scala). Qui di seguito le statistiche:

\begin{align*}
\sum_{i=1}^n x_i &= `r sumx`,   &\sum_{i=1}^n x_i^2 &= `r sumx2` \\
\sum_{i=1}^n y_i &= `r sumy`,   &\sum_{i=1}^n y_i^2 &= `r sumy2` \\
\sum_{i=1}^n x_iy_i &= `r sumxy`.    \\
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=3.5$ nel modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2023-141}
cat(calcolo_beta())
cat(previsione(3.5))
```
:::

`r punti_p()` Qual è la percentuale di varianza spiegata dal modello?

:::{.sol data-latex=""}
```{r 2023-142}
cat(R2())
```
:::

`r punti_p()` Interpretare il diagramma dei residui.


```{r 2023-18,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,ml$res,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-19,,results='asis'}
plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::


`r punti_p()` Se $W=- Y$, quanto varrà $r_{XW}$, coefficiente di correlazione tra $X$ e $W$?





<div class="button-container"></div>

## Prova di Statistica 2023/02/16-2

```{r 2023-143}

source("intro.R")




```

### Esercizio 1

```{r 2023-144}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-145}
options(digits = 3)

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 400      # ampiezza campionaria

brk  <- sort(-c(-2,-1,1,5,15))
nnn  <- rev(c( 20,100,110, 10))
nnn  <- round(nnn/sum(nnn)*n)
samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))

```

Su un campione di $`r n`$ imprese della provincia di Modena è stato rilevato l'utile dell'ultimo trimestre (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze assolute:

```{r 2023-146}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Individuare il valore approssimato della mediana.

:::{.sol data-latex=""}
```{r 2023-147}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

```{r 2023-20,,results='asis'}
res <- percentile(p = .5)
cat(res)
histp()
h.int(0,max(brk),density=10)
axis(1,brk)
```
:::

`r punti_p()` Quale è il numero di imprese che hanno un utile maggiore di zero?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \#(X>0) &=& n\times \frac{((1-0)\times `r dat2$hj[3]`+`r dat2$fj[4]`\times 100)}{100}\\
   &=& `r n*(1-F.int(0))`
\end{eqnarray*}
:::

`r punti_p()` L'utile medio è pari a $\bar x=`r mean(samp)`$ che forma avrà l'istogramma?

`r punti_p()` Qual è la proprietà di linearità della media aritmetica?





### Esercizio 2

`r punti_p(nex = T)` Il numero di telefonate in arrivo nell'ora di punta di un centralino è distribuito come una Poisson di parametro 3.1 ($X\sim\text{Pois}(\lambda=3.1)$). Qual è la probabilità di trovare al massimo 3 telefonate ($X\le 3$)?

:::{.sol data-latex=""}
```{r 2023-148}

x <- 0:3
l <- 3.1
```

\begin{eqnarray*}
  P(X\le 3) &=&  \frac{3.1^0}{0!}e^{-3.1}+\frac{3.1^1}{1!}e^{-3.1}+\frac{3.1^2}{2!}e^{-3.1}+\frac{3.1^3}{3!}e^{-3.1}\\
  &=& `r paste(round(dpois(0:3,3.1),4),collapse="+")`\\
  &=& `r sum(round(dpois(0:3,3.1),4))`\\
\end{eqnarray*}
:::

`r punti_p()` Un'urna contiene 4 palline: 2 rosse e 2 bianche. Si estrae seguendo il seguente schema: se esce rossa, rimettiamo la rossa estratta più altre due rosse, se esce bianca rimettiamo la bianca estratta più altre due bianche. Estraiamo con questo schema per tre volte. Calcolare la probabilità di avere tre palline rosse su tre estrazioni.

:::{.sol data-latex=""}
\begin{eqnarray*}
  E &=&  \text{tre rosse consecutive}\\
  &=& R_1\cap R_2 \cap R_3\\
P(E)  &=& P(R_1)P( R_2|R_1) P( R_3|R_1\cap R_2)\\
&=& \frac 24 \frac 46 \frac 68\\
&=& 0.25
\end{eqnarray*}
:::

`r punti_p()` Se $X\sim N(\mu_X,\sigma_X^2)$ e $Y\sim N(\mu_Y,\sigma_Y^2)$, $X$ e $Y$ indipendenti, come si distribuiscono $X+Y$ e  $X-Y$?

`r punti_p()` Siano $A$ e $B$ due eventi diversi dal vuoto tali che $A\cap B=\emptyset$, motivare perché $A$ e $B$ non possono essere indipendenti.



### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene 2 palline numerate con $\fbox{0}$, 3 numerate con $\fbox{1}$ e 2 numerate con $\fbox{2}$. Si estrae 100 volte con reinserimento. Qual è la probabilità che la somma delle 100 estrazioni sia compresa tra 80 e 120?

:::{.sol data-latex=""}
```{r 2023-21,,results='asis'}
urn <- c(0,0,1,1,1,2,2)
mm <- mean(urn)
ss <- s2c(urn)
n <- 100
stat_(urn,semp = T)
tlc(tipo = "somma",80,120,NULL,mu = mm,ss,n = n)
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Sia $\hat \pi$ lo stimatore di massima verosimiglianza di $\pi$ del modello Binomiale.
\begin{eqnarray*}
  \hat\pi &=&  \frac 1n\sum_{i=1}^nx_i\\
\end{eqnarray*}
Ricavare la sua varianza e metterla in relazione con il suo $MSE$ (Mean Squared Error).

`r punti_p()` Sia $h$ uno stimatore per $\theta$. Cosa significa dire che $h$ è consistente?

`r punti_p()` Definire la significatività e la potenza di un test.

`r punti_p()` In uno studio sull'effetto del titolo di studio sulla percezione del benessere, su un gruppo di 238 intervistati è stato chiesto il titolo di studio (basso: "al massimo le scuole medie inferiori", medio: "Diploma di scuola superiore", alto: "almeno il Diploma di Laurea") e la percezione del proprio benessere (basso, medio, alto). Qui di seguito i dati:

```{r 2023-149}

x <- matrix(c(18,21,20,26,35,38,35,30,15),3)
dimnames(x)<-list(redimento=c("basso","medio","alto"),reddito=c("basso","medio","alto"))
kable(x,booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")%>%
  kable_paper("striped", full_width = F) %>%
  pack_rows("Titolo di studio", 1, 3) %>%
  add_header_above(c(" " = 1, "Benessere" = 3))
```

Si è testata l'indipendenza tra il titolo di studio e la percezione del benessere e il test ha restituito $p_\text{value}=0.04$. Possiamo dire che titolo di studio e benessere sono indipendenti? Perché?



### Esercizio 5

```{r 2023-150}
mu1 <- 27
s1  <- 4.2
n1  <- 12
mu2 <- 24
s2  <- 3.1
n2  <- 25
```


`r punti_p(nex = T)` In uno studio comparativo tra i redditi, nel comune $A$ si è rilevato il reddito di `r n1` individui e si è osservata una media pari `r mu1` mila euro con una standard deviation pari a `r s1` mila euro , mentre nel comune $B$ si è rilevato il reddito di `r n2` individui e si è osservata una media pari `r mu2` mila euro con una standard deviation pari a `r s2` mila euro.
Sotto ipotesi di eterogeneità, testare l'ipotesi che il reddito medio sia uguale nei due comuni, contro l'alternativa che sia maggiore nel comune $A$.

:::{.sol data-latex=""}
```{r 2023-22,,results='asis'}
res <- ttest_2c_et(mu1 = mu1,mu2 = mu2,s1h = s1,s2h = s2,n1 = n1,n2 = n2,h1 = ">")
cat(res)
```
:::




### Esercizio 6

```{r 2023-151}

set.seed(6)
n <- 150
x <- runif(n,1,6)
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- rnorm(n,0,.25*(6-x)/6)
y <- 10+exp(x)/100+eps

RGX <- regr(x,y)
ls2e(RGX)
```

In uno studio sull'adeguamento alle direttive europee sul green si sono analizzate `r n` aziende, sono stati analizzati l'investimento in green ($X$ espresso in decine migliaia di euro/anno) e i risparmi globali $Y$ (espresso in decine migliaia di euro/anno). Qui di seguito le statistiche:

\begin{align*}
  \sum_{i=1}^n x_i &= `r sum(x)` &\sum_{i=1}^n x_i^2 &= `r sum(x^2)` &\sum_{i=1}^n x_i y_i &= `r sum(x*y)`\\
  \sum_{i=1}^n y_i &= `r sum(y)` & \sum_{i=1}^n y_i^2 &= `r sum(y^2)` &
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=1.5$ nel modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2023-23,,results='asis'}
cat(calcolo_beta())
cat(previsione(1.5))
```
:::




`r punti_p()` Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r 2023-24,,results='asis'}
cat(R2())
```
:::

`r punti_p()` Interpretare il diagramma dei residui.

```{r 2023-25,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,ml$res,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-26,,results='asis'}
plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::

`r punti_p()` Se $V= 1 - Y$ e $W= 1 - X$ quanto varrà $r_{VW}$, coefficiente di correlazione tra $V$ e $W$?






<div class="button-container"></div>

## Prova di Statistica 2023/02/16-3

```{r 2023-152}

source("intro.R")




```

### Esercizio 1

```{r 2023-153}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-154}

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 200      # ampiezza campionaria

brk  <- c(-2,-1,1,5,15)
nnn  <- c( 20,100,110, 10)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

```{r 2023-155}


options(digits=4)

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 50      # ampiezza campionaria

brk  <- c(-2,-1,1,5,15)
nnn  <- c( 30,100,50, 30)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ imprese della provincia di Modena è stato rilevato l'utile dell'ultimo trimestre (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze cumulate:

```{r 2023-156}
kable(dat3[,c(1,2,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
```{r 2023-157}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r punti_p()` Quante imprese hanno un utile negativo?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \#(X<0) &=&  n (f_1 + 1\cdot h_2/100)\\
  &=& `r n*dat2$fj[1]` + `r n*dat2$hj[2]/100`\\
  &=& `r n*dat2$fj[1] + n*dat2$hj[2]/100`\\
\end{eqnarray*}
:::  

`r punti_p()` Che relazione dobbiamo aspettarci tra media e mediana?

`r punti_p()` La varianza dei dati è pari a $\hat\sigma^2=`r s2c(samp)`$, se gli utili di ogni impresa aumentassero del 3%, quanto varrebbe la varianza dei dati così trasformati?

:::{.sol data-latex=""}
\[\sigma_Y^2=(1.03)^2\sigma_X^2=`r s2c(samp)*(1.03^2)`\]
:::





### Esercizio 2

`r punti_p(nex = T)` Si lancia una moneta perfetta 8 volte. Qual è la probabilità di avere un numero di volte Testa maggiore o uguale a 6 su 8 lanci?

:::{.sol data-latex=""}
\begin{eqnarray*}
  X &\sim&\text{Bin}(8;0.5)\\
  P(X\ge 6) &=& P(X=6)+p(X=7)+P(X=8)\\
  &=& \binom{8}{6} 0.5^8 + \binom{8}{7} 0.5^8 +\binom{8}{8} 0.5^8\\
  &=& `r choose(8,6)`\cdot `r 0.5^8` + `r choose(8,7)`\cdot `r 0.5^8` + `r choose(8,8)`\cdot `r 0.5^8` \\
  &=& `r choose(8,6)* 0.5^8 + choose(8,7)* 0.5^8 + choose(8,8)* 0.5^8` \\
\end{eqnarray*}
:::  

`r punti_p()` Sia $Z\sim N(0,1)$ e siano $A=\{Z<0\}$ e $B=\{Z<1\}$. Calcolare $P(A|B)$

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(B) &=&  \Phi(1)\\
  &=& `r pnorm(1)`\\
  P(A\cap B) &=& P(Z<0)\\
  &=& \Phi(0)\\
  &=& 0.5\\
  P(A|B) &=& \frac{P(A\cap B)}{P(B)}\\
  &=& \frac{0.5}{`r pnorm(1)`}\\
  &=& `r .5/pnorm(1)`
\end{eqnarray*}
:::  

`r punti_p()` Se $X\sim\text{Pois} (n)$, a cosa tende $X$ se $n$ diverge?

:::{.sol data-latex=""}
Se $n$ diverge allora $X$ tende ad un Normale di media $n$ e varianza $n$
\[
X\mathop\sim_a N(n,n)
\]
:::

`r punti_p()` Sia $X\sim N(10,1)$  e sia $F$ la sua funzione di ripartizione. Disegnare approssimativamente $F(x)$ per $x$ che varia tra 6 e 14.




### Esercizio 3

```{r 2023-158}
n <- 365
ex <- 0.08
vx <- 0.034
es <- mm <- n*ex
vs <- ss <- n*vx
#ss <- sqrt(vs)
# 
 # curve(dnorm(x,es,sqrt(ss)),from = es-4*sqrt(ss),to = es+4*sqrt(ss),axes=F)
 # axis(1)
 # curve(dnorm(x,es,sqrt(ss)),from = 30,to = es+4*sqrt(ss),add=T,type = "h",n=101)

```

`r punti_p(nex = T)` Un'urna conteni tre palline rosse, due bianche e una nera. Si estrae $n=100$ volte con reintroduzione. Qual è la probabilità che la proporzione di palline rosse sia minore di 0.45?

:::{.sol data-latex=""}
```{r 2023-27,,results='asis'}
# urn <- c(0,1,4,6)
mm <- .5
ss <- .25
n <- 100
cat(tlc(tipo = "prop",x1 = .45,x2 = NULL,verso = "<",mu = .5,n = n))
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Siano $\hat \mu$ e $\hat\sigma^2$ gli stimatori di massima verosimiglianza di $\mu$ e $\sigma^2$ del modello di Normale.
\begin{eqnarray*}
  \hat\mu &=&  \frac 1n\sum_{i=1}^nx_i \qquad \hat\sigma^2 =  \frac 1n\sum_{i=1}^n(x_i-\hat\mu)^2\\
\end{eqnarray*}
Ricavare la varianza di $\hat\mu$ e metterla in relazione con il suo $MSE$ (Mean Squared Error). 

`r punti_p()` Se $h_1$ e $h_2$ sono due stimatori per $\theta$ cosa significa dire che $h_1$ è più efficiente di $h_2$?

`r punti_p()` Definire gli errori di primo e secondo tipo e le relativa probabilità.

`r punti_p()`  Una moneta, che non sappiamo se è perfetta oppure no, viene lanciata 40 volte. Abbiamo osservato 14 volte testa su 40 lanci. Posto $\pi$ la probabilità che la moneta mostri testa, si è testato
\[
\begin{cases}
H_0:\pi=\frac 12\\
H_1:\pi\ne\frac 12
\end{cases}
\]
ed è risultato $p_\text{value}=0.08$. Possiamo concludere che la moneta sia truccata?




### Esercizio 5

```{r 2023-159}
n1 <- 35
muh <- 68
sdh <- 5
mu0 <- 71
```

`r punti_p(nex = T)` In uno studio sui redditi, nel comune $A$ si è rilevato il reddito di $n=`r n1`$ individui e si è osservata una media pari $`r muh`$ mila euro con una standard deviation pari a $`r sdh`$ mila euro.
Costruire un intervallo di confidenza al 95% per il reddito medio $\mu$.

:::{.sol data-latex=""}
```{r 2023-28,,results='asis'}
options(digits = 4)
res <- idc(xm = muh,sd = sdh,alpha = .05,n = n1,dist_ = "t",mus = mu0,ss = "S")
cat(res)
```
:::

`r punti_p()` Un'indagine analoga, svolta sull'intera regione, ha mostrato un reddito medio pari a $\mu_0=`r mu0`$. Testare l'ipotesi che nel comune $A$ il reddito medio sia uguale a quello regionale contro l'alternativa che sia __diverso__.

:::{.sol data-latex=""}
```{r 2023-29,,results='asis'}
res <- ttest_mu(muh = muh,sh = sdh,n = n1,mu0 = mu0,h1 = "\\neq")
cat(res)
```
:::



### Esercizio 6

```{r 2023-160}

set.seed(456)
n <- 150
x <- runif(n,1,6)
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- rnorm(n,0,.25*(6-x)/6)
y <- 10+exp(x)/100+eps

RGX <- regr(x,y)
ls2e(RGX)
```

In uno studio sull'adeguamento alle direttive europee sul green si sono analizzate `r n` aziende, sono stati analizzati l'investimento in green ($X$ espresso in decine migliaia di euro/anno) e le agevolazioni fiscali $Y$ (espressa in decine migliaia di euro/anno). Qui di seguito le statistiche:

\begin{align*}
\sum_{i=1}^n x_i &= `r sumx`,   &\sum_{i=1}^n x_i^2 &= `r sumx2` \\
\sum_{i=1}^n y_i &= `r sumy`,   &\sum_{i=1}^n y_i^2 &= `r sumy2` \\
\sum_{i=1}^n x_iy_i &= `r sumxy`.    \\
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=1.5$ nel modello di regressione dove $Y$ viene spiegata da $X$.


:::{.sol data-latex=""}
```{r 2023-30,,results='asis'}
cat(calcolo_beta())
cat(previsione(x = 1.5))
```
:::

`r punti_p()` Calcolare e interpretare $R^2$.

:::{.sol data-latex=""}
```{r 2023-31,,results='asis'}
cat(R2())
```
:::

`r punti_p()` Interpretare il qq-plot dei residui.
```{r 2023-32,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
qqnorm(ml$residuals,asp=1,axes=F)
abline(0,1)
axis(1)
axis(2)
abline(h=0,lty=2)
abline(v=0,lty=2)
par(cex=cex)
```

`r punti_p()` Se $V=1+ Y$ e $W=1-X$, quanto varrà $r_{VW}$, il coefficiente di correlazione tra $V$ e $W$?



<div class="button-container"></div>

## Prova di Statistica 2023/06/08-1

```{r 2023-161}

source("intro.R")




```


### Esercizio 1

```{r 2023-162}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-163}
set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 160                         # ampiezza campionaria

brk  <- c(0,1.5,3,5,10)          # intervalli (breaks)
hhh  <- c( 20,110,100, 5)       # aspetto presunto istogramma

nomex <- "Nome della X"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Modena è stata rilevata la spesa annua dedicata alle vacanze, espressa in migliaia di euro. Qui di seguito la distribuzione delle frequenze assolute:

```{r 2023-164}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
```{r 2023-165}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(axes = T)
h.int(4,10,density=20)
```
:::

`r punti_p()` Qual è la percentuale di famiglie con spesa superiore a 4 mila euro?

:::{.sol data-latex=""}
```{r 2023-33,,results='asis'}
cat(F_print(4,verso=">"))
```
:::

`r punti_p()` Che relazione dobbiamo attenderci tra moda, mediana e media?

`r punti_p()` Cosa significa che la media aritmetica rende zero la somma degli scarti?



### Esercizio 2


Siano $X_A\sim \text{Pois}(1.5)$ e sia $X_B\sim \text{Pois}(1.5)$, $X_A$ e $X_B$ indipendenti. Posto $A=\{X_A\le 1\}$ e $B=\{X_B>2\}$

`r punti_p(nex = T)` Calcolare la probabilità di  $A\cup B$.

:::{.sol data-latex=""}
```{r 2023-34,,results='asis'}
cat(pois_dis(x1 = 1,ll = 1.5,vnam = "X_A"))
cat(pois_dis(x1 = 3,ll = 1.5,vnam = "X_B",verso = "\\geq"))
pa <- ppois(1,1.5)
pb <- 1-ppois(2,1.5)
```
\begin{eqnarray*}
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa*pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
:::

`r punti_p()` Calcolare la probabilità che **solo** uno dei due eventi $A$ oppure $B$ sia vero.

`r punti_p()` Calcolare valore atteso e varianza di $X_A-X_B$.

`r punti_p()` Sia $X\sim\text{Ber}(\pi=0.4)$. Disegnare la sua funzione di ripartizione.



### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene 3 palline Rosse, 3 Bianche e 4 Blu. Si estrae senza reintroduzione per $n=81$ volte.
Calcolare la probabilità che la proporzione di palline Blu sia maggiore di 0.3.

:::{.sol data-latex=""}
```{r 2023-35,,results='asis'}
cat(tlc(tipo = "prop",x1 = 0.3,verso = ">",mu = .4,n = 81))
```
:::



### Esercizio 4

  
`r punti_p(nex = T)` Siano $\hat \mu$ e $\hat\sigma^2$ gli stimatori di massima verosimiglianza di $\mu$ e $\sigma^2$ del modello di Normale.
\begin{eqnarray*}
  \hat\mu &=&  \frac 1n\sum_{i=1}^nx_i \qquad \hat\sigma^2 =  \frac 1n\sum_{i=1}^n(x_i-\hat\mu)^2\\
\end{eqnarray*}
Ricavare lo standard error stimato di $\hat\mu$.

`r punti_p()` Se $h_1$ e $h_2$ sono due stimatori per $\theta$ tale per cui $MSE(h_1)=1.2$, e $MSE(h_2)=2.3$, quale dei due è più efficiente e perché?

`r punti_p()` Definire gli errori di primo e secondo tipo e le relative probabilità.

`r punti_p()`  Una moneta, che non sappiamo se è perfetta oppure no, viene lanciata 80 volte. Abbiamo osservato 28 volte testa su 80 lanci. Posto $\pi$ la probabilità che la moneta mostri testa, si è testato
\[
\begin{cases}
H_0:\pi=\frac 12\\
H_1:\pi\ne\frac 12
\end{cases}
\]
ed è risultato $p_\text{value}=0.009683$. Possiamo concludere che la moneta sia truccata?




### Esercizio 5

```{r 2023-166}
set.seed(12)
n <- 50
x <- runif(n,0,30)
y <- abs(.5*x + rnorm(n,0,2+x*.1))
RGX <- regr(x,y); ls2e(RGX)
```

In uno studio sull'efficacia dell'investimento pubblicitario sono stati rilevati, per $n=50$ aziende si sono rilevati l'incremento di spesa in
pubblicità ($X$) e l'incremento di utile ($Y$) nell'ultimo quinquennio. Si osservano le seguenti statistiche, $\sum_{i=1}^{50}x_i=`r sum(x)`$, $\sum_{i=1}^{50}y_i=`r sum(y)`$,
 $\sum_{i=1}^{50}x_i^2=`r sum(x^2)`$, $\sum_{i=1}^{50}y_i^2=`r sum(y^2)`$ e $\sum_{i=1}^{50}x_iy_i=`r sum(x*y)`$.

`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2023-36,,results='asis'}
cat(calcolo_beta())
```
:::

`r punti_p()` Qual è la percentuale di varianza spiegata dal modello?

:::{.sol data-latex=""}
```{r 2023-37,,results='asis'}
cat(R2())
```
:::

`r punti_p()` Testare l'ipotesi che l'intercetta sia uguale a zero contro l'alternativa che sia diversa da zero.


:::{.sol data-latex=""}
```{r 2023-38,,results='asis'}
cat(ttest_beta(0,0,h1 = "\\neq",alpha = 0.05))
```
:::


`r punti_p()` Interpretare il diagramma dei residui.

```{r 2023-39,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,es,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-40,,results='asis'}
plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::

`r punti_p()` Perché una previsione per $x=15$ è più affidabile di una per $x=50$?





<div class="button-container"></div>

## Prova di Statistica 2023/06/08-2

```{r 2023-167}

source("intro.R")




```


### Esercizio 1

```{r 2023-168}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-169}
set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 160                         # ampiezza campionaria

brk  <- rev(10-c(0,1.5,3,5,10))          # intervalli (breaks)
hhh  <- rev(c( 20,110,100, 5))       # aspetto presunto istogramma

nomex <- "Nome della X"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Modena è stata rilevata la spesa annua dedicata alle vacanze, espressa in migliaia di euro. Qui di seguito la distribuzione delle frequenze assolute:

```{r 2023-170}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
```{r 2023-171}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(axes = T)
h.int(4,8,density=20)
```
:::

`r punti_p()` Qual è la percentuale di famiglie con spesa compresa tra a 4 mila e 8 mila euro?

:::{.sol data-latex=""}

```{r 2023-41,,results='asis'}
cat(F_print(4,x2 = 8,verso = ""))
```
:::

`r punti_p()` Che relazione dobbiamo attenderci tra moda, mediana e media?

`r punti_p()` Cosa significa che la media aritmetica gode della proprietà di linearità?



### Esercizio 2

Siano $X_A\sim N(1.5,1.5)$ e sia $X_B\sim N(1.5,1.5)$, $X_A$ e $X_B$ indipendenti. Posto $A=\{X_A\le 1\}$ e $B=\{X_B>2\}$

`r punti_p(nex = T)` Calcolare la probabilità di  $A\cup B$.

:::{.sol data-latex=""}
```{r 2023-42,,results='asis'}
cat(norm_int(x1 = 1,verso = "<",mm = 1.5,ss = 1.5,mu = "\\mu_A",sigma = "\\sigma_A",vnam = "X_A"))
cat(norm_int(x1 = 2,verso = ">",mm = 1.5,ss = 1.5,mu = "\\mu_B",sigma = "\\sigma_B",vnam = "X_B"))
pa <- pnorm(1,1.5,sqrt(1.5))
pb <- 1-pnorm(2,1.5,sqrt(1.5))
```
\begin{eqnarray*}
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa*pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
:::

`r punti_p()` Si continua ad estrarre da $X_A\sim N(1.5,1.5)$ e si interrompe quando $X_A\le 1$. Calcolare la probabilità di interrompere alla quinta estrazione.

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(A) &=&  `r pa`\\
  P(\bar A) &=& `r 1-pa`\\
  P(\bar A\cap \bar A\cap\bar A\cap\bar A\cap A)&=& (1-`r pa`)^4`r pa`\\
  &=& `r (1-pa)^4*pa`
\end{eqnarray*}
:::

`r punti_p()` Come si distribuisce $X_A-X_B$?

`r punti_p()` Se $A$ e $B$ sono due eventi tali che $A\cap B=\emptyset$, $A$ e $B$ possono essere indipendenti? Perché?




### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene 3 palline col numero $\fbox{0}$, 3 col numero $\fbox{1}$ e 4 col numero $\fbox{2}$. Si estrae senza reintroduzione per $n=81$ volte.
Calcolare la probabilità che la somma dei risultati sia maggiore di 80.

:::{.sol data-latex=""}
```{r 2023-43,,results='asis'}
cat(media_(0:2,p=c(.3,.3,.4)))
cat(var_(0:2,p=c(.3,.3,.4)))
cat(tlc(tipo = "somma",x1 = 80,verso = ">",mu = 1.1,n = 81,s2 = .69))
```
:::



### Esercizio 4

`r punti_p(nex = T)` Sono stati estratti $n=10$ valori da una Poisson di parametro $\lambda$ incognito e si è ottenuta un media pari a $\bar x=3.4$. Ricavare $\widehat{SE(\hat\lambda)}$ lo Standard Error stimato $\hat\lambda$ di massima verosimiglianza.

`r punti_p()` Sia $h$ uno stimatore per $\theta$. Cosa significa dire che $h$ è consistente?

`r punti_p()` Siano $T_1$ e $T_2$ due test per lo stesso sistema d'ipotesi e con probabilità di errore di secondo tipo pari a, $\beta_1=0.02$ e $\beta_2=0.3$, rispettivamente. A parità di significatività, quale dei due è più potente? Perché?

`r punti_p()` In uno studio sull'efficacia della pubblicità televisiva sono state intervistate 64 persone suddivise in due gruppi, un primo gruppo di 32 individui che guarda abitualmente la televisione e un secondo gruppo di 32 che non la guarda. Ad ogni partecipante è stata chiesta la spesa annua in beni pubblicizzati in TV ed è risultato che la spesa media in questi prodotti di chi guarda abitualmente la TV è pari $\hat\mu_{TV}=1.4\text{ mila €}$ con una standard deviation pari a $\hat\sigma_{TV}=1.2\text{ mila €}$, mentre nel gruppo che non la guarda abitualmente è risultato $\hat\mu_{\overline{TV}}=0.9\text{ mila €}$ con una standard deviation pari a $\hat\sigma_{\overline{TV}}=1.4\text{ mila €}$. Si è testa l'uguaglianza delle medie contro l'alternativa che $\mu_{TV}$ sia maggiore di $\mu_{\overline{TV}}$ e ed è risultato un $p_\text{value}= 0.0681$. Si può concludere che la spesa in pubblicità televisiva sia efficace?



### Esercizio 5

`r punti_p(nex = T)` In uno studio sull'efficacia degli integratori alimentari, su un gruppo di 238 atleti è stato misurato il rendimento atletico (ottimo, buono e scarso) e l'assunzione di integratori (alto, medio e basso). Qui di seguito i dati:

```{r 2023-172}
x <- matrix(c(21,20,18,35,26,38),2)
rx <- rowSums(x)
cx <- colSums(x)
n <- sum(x)

dimnames(x)<-list(redimento=c("buono","scarso"),integratori=c("alto","medio","basso"))
xp <- cbind(x,rx)
xp <- rbind(xp,colSums(xp))
dimnames(xp)<-list(redimento=c("buono","scarso","Totale"),integratori=c("alto","medio","basso","Totale"))
kable(xp,booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")%>%
  kable_paper(full_width = F) %>%
  pack_rows("rendimento", 1, 3) %>%
  add_header_above(c(" " = 1, "Integratori" = 4))

dat <- chi_print(dat = x,nome_y = c("buono","scarso"),nome_x = c("alto","medio","basso"))
```

Testare al livello di significatività del 5% se c'è indipendenza tra integratori e rendimento.

:::{.sol data-latex=""}
```{r 2023-44,,results='asis'}
rx <- rowSums(x)
cx <- colSums(x)

thx <- outer(rx,cx)/n

kable(thx,booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")%>%
  kable_paper(full_width = F) %>%
  pack_rows("rendimento", 1, 2) %>%
  add_header_above(c(" " = 1, "Integratori" = 3))

chi <- (thx-x)^2/thx
kable(chi,booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")%>%
  kable_paper(full_width = F) %>%
  pack_rows("rendimento", 1, 2) %>%
  add_header_above(c(" " = 1, "Integratori" = 3))

chioss <- sum((thx-x)^2/thx)
cat(cat("Il chi oss è ",chioss,", il chi-teorico,",qchisq(.95,2)," rifiuto:",ifelse(sum((thx-x)^2/thx) > qchisq(.95,2),"sì","no")))
```
:::



### Esercizio 6

```{r 2023-173}
set.seed(12)
n <- 50
x <- runif(n,0,30)
y <- abs(.5*x + rnorm(n,0,2+(x-15)^4*.0005))
RGX <- regr(x,y); ls2e(RGX)
```

In uno studio sull'efficacia dell'investimento pubblicitario sono stati rilevati, per $n=50$ aziende si sono rilevati l'incremento di spesa in
pubblicità ($X$) e l'incremento di utile ($Y$) nell'ultimo quinquennio. Si osservano le seguenti statistiche, $\sum_{i=1}^{50}x_i=`r sum(x)`$, $\sum_{i=1}^{50}y_i=`r sum(y)`$,
 $\sum_{i=1}^{50}x_i^2=`r sum(x^2)`$, $\sum_{i=1}^{50}y_i^2=`r sum(y^2)`$ e $\sum_{i=1}^{50}x_iy_i=`r sum(x*y)`$.

`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2023-45,,results='asis'}
cat(calcolo_beta())
```
:::

`r punti_p()` Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r 2023-46,,results='asis'}
cat(R2())
```
:::

`r punti_p()` Interpretare il diagramma dei residui.

```{r 2023-47,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,es,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-48,,results='asis'}
plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::

`r punti_p()` Posto $W=-2\cdot Y$ calcolare $\beta_0'$ e $\beta_1'$ i coefficienti di regressione del modello
\[
w_i = \beta_0'+\beta_1'x_i+\epsilon_i'
\]

:::{.sol data-latex=""}
\begin{eqnarray*}
  \bar w &=&  -2\bar y\\
  &=& -2\cdot`r my`\\
  &=& `r -2*my`\\
  \hat\sigma_W&=&2\hat\sigma_Y\\
  &=& 2\cdot`r sy`\\
  &=& `r 2*sy`\\
  \hat\beta_1' &=& -\frac{\sigma_W}{\sigma_X}r\\
  &=& -\frac{`r 2*sy`}{`r sx`}`r r`\\
  &=& `r -2*sx/sx*r`\\
  \hat\beta_0'&=& \bar w - \hat\beta_1'\bar x\\
  &=& `r -2*my + 2*sx/sx*r*mx`
\end{eqnarray*}
:::





<div class="button-container"></div>

## Prova di Statistica 2023/06/08-3

```{r 2023-174}

source("intro.R")




```


### Esercizio 1

```{r 2023-175}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-176}
set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 160                         # ampiezza campionaria

brk  <- c(0,2.5,4,5,6.5,9)          # intervalli (breaks)
hhh  <- c( 10,30,50, 30,10)       # aspetto presunto istogramma

nomex <- "Nome della X"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Modena è stata rilevata la spesa annua dedicata alle vacanze, espressa in migliaia di euro. Qui di seguito la distribuzione delle frequenze cumulate:

```{r 2023-177}
kable(dat3[,c(1,2,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
```{r 2023-178}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(axes = T)
h.int(4,8,density=20)
```
:::

`r punti_p()` Qual è il numero di famiglie con spesa compresa tra a 4 mila e 8 mila euro?

:::{.sol data-latex=""}

```{r 2023-49,,results='asis'}
cat(F_print(4,x2 = 8,verso = ""))
```
:::

`r punti_p()` Che relazione dobbiamo attenderci tra moda, mediana e media?

`r punti_p()` Cosa significa che la media aritmetica goe della proprietà di linearità?



### Esercizio 2


Sia $X\sim\text{Binom}(5,0.5)$ e sia $y\sim\text{Binom}(5,0.4)$, $X$ e $Y$ indipendenti, posto $A=\{X\le 1\}$ e $B=\{Y\ge 2\}$

`r punti_p(nex = T)` Calcolare la probabilità di  $A\cup B$.

:::{.sol data-latex=""}
```{r 2023-50,,results='asis'}
cat(bin_dis(1,5,.5))
cat(bin_dis(2,5,.4,verso = "\\geq",comp = T,vnam = "Y"))
pa <- pbinom(1,5,.5)
pb <- pbinom(2,5,.4,lower.tail = F)
```
\begin{eqnarray*}
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa*pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
:::

`r punti_p()` Si estrae ripetutamente da $X\sim\text{Binom}(5,0.5)$ e ci si ferma quando $X\le 1$. Calcolare la probabilità di finire entro due estrazioni.

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(A) &=&  `r pa`\\
  P(\bar A) &=& `r 1-pa`\\
  P(A\cup (\bar A\cap A))&=& `r pa`+`r pa`\cdot (1-`r pa`)\\
  &=& `r pa+pa*(1-pa)`
\end{eqnarray*}
:::

`r punti_p()` Calcolare valore atteso e varianza di $X-Y$.

`r punti_p()` Siano $A$ e $B$ due eventi tali che $P(A)=0.6$ e $P(B)=0.5$. $A$ e $B$ possono essere incompatibili? Perché?



### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene 3 palline col numero $\fbox{0}$, 4 col numero $\fbox{1}$ e 3 col numero $\fbox{2}$. Si estrae senza reintroduzione per $n=81$ volte.
Calcolare la probabilità che la media dei risultati sia minore di 0.9.

:::{.sol data-latex=""}
```{r 2023-51,,results='asis'}
cat(media_(0:2,p=c(.3,.4,.3)))
cat(var_(0:2,p=c(.3,.4,.3)))
cat(tlc(tipo = "media",x1 = 0.9,verso = "<",mu = 1,n = 81,s2 = .6))
```
:::



### Esercizio 4

`r punti_p(nex = T)` Sono stati estratti $n=10$ valori da una Bernoulli di parametro $\pi$ incognito e si è ottenuti 4 successi in 10 estrazioni. Ricavare, $\widehat{SE(\hat\pi)}$ lo Standard Error stimato di $\hat\pi$ di massima verosimiglianza.

`r punti_p()` Sia $h$ uno stimatore per $\theta$. Cosa significa dire che $h$ è corretto asintoticamente?

`r punti_p()` Definire gli errori di primo e di secondo tipo e le relative probabilità.

`r punti_p()` Un dado viene lanciato 60 volte e si ottiene 
```{r 2023-179}
set.seed(1)
dad <- sample(1:6,size = 60,replace = T,prob=c(1,1,3,4,1,2)/sum(c(1,1,3,4,1,2)))
kable(t(table(dad)),booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")

chis <- sum((table(dad)-10)^2/10)
pval <- 1-pchisq(chis,5)
```
Ci si chiede se il dado sia truccato. Posto a test
\[
\begin{cases}
H_0:\pi_j=\frac 16, j = 1,...,6
\end{cases}
\]
si ottiene un $p_{\text{value}}=`r pval`$. Il dado si può ritenere truccato? Perché?



### Esercizio 5


```{r 2023-180}
n1 <- 35
muh <- 0.5
sdh <- 0.25
mu0 <- 0.6
```

`r punti_p(nex = T)` In uno studio sui consumi per generi di igiene personale su un campione di `r n1` famiglie della provincia di Reggio è stata chiesta la loro spesa annuale in questo genere di beni. I dati campionari hanno evidenziato una media pari a $\hat\mu=`r muh`$ e una deviazione standard osservata pari a $\hat\sigma=`r sdh`$.
Costruire un intervallo di confidenza al 95% per il gradimento medio $\mu$.

:::{.sol data-latex=""}
```{r 2023-52,,results='asis'}
cat(idc(xm = muh,sd = sdh,alpha = .05,n = n1,dist_ = "t",mus = "\\mu",ss = "S"))
```
:::

`r punti_p()` Un'indagine analoga, svolta sull'intera regione, ha mostrato un gradimento medio pari a $\mu_0=`r mu0`$. Testare l'ipotesi che nel comune A il livello di gradimento sia uguale a quello regionale contro l'alternativa che sia minore.


:::{.sol data-latex=""}
```{r 2023-53,,results='asis'}
ttest_mu(muh = muh,sh = sdh,n = n1,mu0 = mu0,h1 = "<")
```
:::




### Esercizio 6

```{r 2023-181}
set.seed(12)
n <- 50
x <- runif(n,0,30)
y <- abs(.5*x + rnorm(n,0,2+(15^2-(x-15)^2)*.005))
RGX <- regr(x,y); ls2e(RGX)
```

In uno studio sull'efficacia dell'investimento pubblicitario sono stati rilevati, per $n=50$ aziende si sono rilevati l'incremento di spesa in
pubblicità ($X$) e l'incremento di utile ($Y$) nell'ultimo quinquennio. Si osservano le seguenti statistiche, $\sum_{i=1}^{50}x_i=`r sum(x)`$, $\sum_{i=1}^{50}y_i=`r sum(y)`$,
 $\sum_{i=1}^{50}x_i^2=`r sum(x^2)`$, $\sum_{i=1}^{50}y_i^2=`r sum(y^2)`$ e $\sum_{i=1}^{50}x_iy_i=`r sum(x*y)`$.

`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2023-54,,results='asis'}
cat(calcolo_beta())
```
:::

`r punti_p()` Qual è la percentuale di varianza spiegata dal modello?

:::{.sol data-latex=""}
```{r 2023-55,,results='asis'}
cat(R2())
```
:::


`r punti_p()` Interpretare il qq-plot dei residui.

```{r 2023-56,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
qqnorm(es,asp=1)
abline(0,1)
par(cex=cex)
```

`r punti_p()` Posto $W=-2\cdot X$ calcolare $\beta_0'$ e $\beta_1'$ i coefficienti di regressione del modello
\[
y_i = \beta_0'+\beta_1'w_i+\epsilon_i'
\]

:::{.sol data-latex=""}
\begin{eqnarray*}
  \bar w &=&  -2\bar x\\
  &=& -2\cdot`r mx`\\
  &=& `r -2*mx`\\
  \hat\sigma_W&=&2\hat\sigma_X\\
  &=& 2\cdot`r sx`\\
  &=& `r 2*sx`\\
  \hat\beta_1' &=& -\frac{\sigma_Y}{\sigma_W}r\\
  &=& -\frac{`r 2*sy`}{`r sx`}`r r`\\
  &=& `r -2*sy/sx*r`\\
  \hat\beta_0'&=& \bar y - \hat\beta_1'\bar w\\
  &=& `r my - 2*sy/sx*r*mx`
\end{eqnarray*}
:::



<div class="button-container"></div>

## Prova di Statistica 2023/06/27-1

```{r 2023-182}

source("intro.R")




```



### Esercizio 1

```{r 2023-183}
compito <- compito + 1
punti <- punti_list[[compito]]
```

```{r 2023-184}
set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 250                         # ampiezza campionaria

brk  <- c(0,15,30,50,100,250)          # intervalli (breaks)
hhh  <- c( 20,120,100, 50,10)       # aspetto presunto istogramma

nomex <- "Spesa"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Modena è stato rilevata la spesa mensile in telecomunicazioni (in euro), qui di seguito 
la distribuzione delle frequenze relative:

```{r 2023-185}
kable(dat3[,c(1,2,4)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
```{r 2023-186}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(axes = T)
h.int(60,250,density=20)
```
:::

`r punti_p()` Qual è la percentuale di famiglie con spesa superiore a 60 euro?

:::{.sol data-latex=""}
```{r 2023-57,,results='asis'}
cat(F_print(60,verso=">"))
```
:::

`r punti_p()` Che relazione dobbiamo attenderci tra moda, mediana e media?

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$ e la standard deviation $\hat\sigma=`r sd(samp)`$, se tutte le famiglie risparmiassero
il 10%, come cambierebbero la media e la standard deviation?



### Esercizio 2


Un impresa di soccorso stradale ha due centralini, il numero di telefonate orarie in arrivo 
al centralino $A$ è distribuito come una Poisson $X\sim\text{Pois}(2.2)$, mentre
il numero di telefonate orarie in arrivo al centralino $B$ è distribuito come una Poisson $Y\sim\text{Pois}(1.3)$, 
$X$ e $Y$ indipendenti.

`r punti_p(nex = T)` Calcolare la probabilità che il totale di telefonate in arrivo in un'ora sia maggiore 
o uguale a tre ($S=X+Y\ge 3$).

:::{.sol data-latex=""}
```{r 2023-58,,results='asis'}
cat(pois_dis(x1 = 3,ll = 1.3+2.2,vnam = "X+Y",verso = "\\geq"))
```
:::

`r punti_p()` Sapendo che $S=X+Y\ge 3$, calcolare la probabilità che $S=X+Y= 5$ ($P(S=5|S\ge 3$)

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(X+Y\ge 3) &=& `r 1-ppois(2,1.3+2.2)`\\
  P(X+Y=5)    &=& `r dpois(5,2.2+1.3)`\\
  P(\{X+Y=5\}\cap\{X+Y\ge 3\}) &=&P(X+Y=5)\\
  P(\{P(X+Y=5)\}|\{X+Y\ge 3\}) &=&\frac{P(\{X+Y=5\}\cap\{X+Y\ge 3\})}{P(X+Y\ge 3)}\\
  &=&\frac{P(X+Y=5)}{P(X+Y\ge 3)}\\
  &=&\frac{`r dpois(5,2.2+1.3)`}{`r 1-ppois(2,1.3+2.2)`}\\
  &=&`r dpois(5,2.2+1.3)/( 1-ppois(2,1.3+2.2))`
\end{eqnarray*}
  
:::

`r punti_p()` Se $X$ ed $Y$ sono due variabili casuali, è sempre vero che
\[
V(X-Y)=V(X)+V(Y)~~~?
\]
motivare la risposta.

`r punti_p()` Sia $X\sim\text{Binom}(2,\pi=0.5)$. Disegnare la sua funzione di ripartizione.

:::{.sol data-latex=""}
```{r 2023-187}
plot((-1):3,pbinom((-1):3,2,.5),type="s",xlim=c(-.1,2.1),ylim=c(0,1),axes=F)
axis(1,0:2)
axis(2,pbinom((-1):3,2,.5),las=2)
```
:::



### Esercizio 3

`r punti_p(nex = T)` Una catena di montaggio a ciclo continuo produce ogni giorno un numero di pezzi variabile, con una media pari a
$\mu=1.2$ mila pezzi al giorno e una varianza di $\sigma^2=9.1$.

Calcolare la probabilità che il numero totale di pezzi prodotti dopo un anno ($n=365$) sia inferiore a ai 400 (mila) pezzi prodotti.

:::{.sol data-latex=""}
```{r 2023-59,,results='asis'}
cat(tlc(tipo = "somma",x1 = 400,verso = "<",mu = 1.2,s2 = 9.1,n = 365))
```
:::



### Esercizio 4

  
`r punti_p(nex = T)` Siano $\hat \mu$ e $\hat\sigma^2$ gli stimatori di massima verosimiglianza di $\mu$ e $\sigma^2$ del modello di Normale.
\begin{eqnarray*}
  \hat\mu &=&  \frac 1n\sum_{i=1}^nx_i \qquad \hat\sigma^2 =  \frac 1n\sum_{i=1}^n(x_i-\hat\mu)^2\\
\end{eqnarray*}
Come si distribuisce $\hat\mu$?

`r punti_p()` Sia $h$ uno stimatore per $\theta$ tale che 
\[V(h)=\frac\theta {\sqrt{n}};~~~~E(h)=\theta\frac{n+2}{n}\]
di quali proprietà gode $h$?

`r punti_p()` Definire il p-value e descrivere la sua interpretazione.

`r punti_p()`  Se un test è significativo al 5% può essere significativo all'1%? (scegliere la risposta tra: _mai_, _non sempre_ oppure _sempre_ e motivare la risposta)



### Esercizio 5

Nel comune $A$ si è condotta un'intervista per conoscere l'opinione
dei cittadini sulla presenza di un inceneritore. Sono state intervistate
250 persone e 70 di loro sono favorevoli.

`r punti_p(nex = T)` Costruire un intervallo di confidenza al 99%
per la proporzione dei favorevoli in popolazione.

:::{.sol data-latex=""}
```{r 2023-60,,results='asis'}
cat(idc(xm = 70,n = 250,alpha = .01,dist_ = "z"))
```
:::

`r punti_p()` Nel comune $B$ si è condotta un'intervista analoga. 
Sono state intervistate 230 persone e 75 di loro sono favorevoli. Testare 
l'ipotesi che la proporzione nei due comuni sia uguale contro l'alternativa che nel
comune $B$ sia maggiore.

:::{.sol data-latex=""}
```{r 2023-61,,results='asis'}
cat(ztest_2c_pi(s1 = 75,s2 = 70,n1 = 230,n2 = 250,h1 = ">",a = "B",b = "A"))
```
:::





### Esercizio 6

```{r 2023-188}
set.seed(16)
n <- 50
x <- runif(n,0,1.5)
y <- log(x)+rnorm(n,0,.25)
y <- y-min(y)
#plot(x,y)
RGX <- regr(x,y); ls2e(RGX)
```

In uno studio sull'efficacia del marketing sul web si sono analizzate `r n` aziende
sulle quali è stato misurata l'incremento percentuale annuo medio di investimento in marketing 
web ($X$) la l'incremento percentuale medio di utile ($Y$). Si osservano le seguenti statistiche, $\sum_{i=1}^{50}x_i=`r sum(x)`$, $\sum_{i=1}^{50}y_i=`r sum(y)`$,
 $\sum_{i=1}^{50}x_i^2=`r sum(x^2)`$, $\sum_{i=1}^{50}y_i^2=`r sum(y^2)`$ e $\sum_{i=1}^{50}x_iy_i=`r sum(x*y)`$.


`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$ e interpretare 
i coefficienti $\hat\beta_0$ e $\hat\beta_1$

:::{.sol data-latex=""}
```{r 2023-62,,results='asis'}
cat(calcolo_beta())
```
:::

`r punti_p()` Scrivere la scomposizione della varianza e 
calcolarla per questo caso.

:::{.sol data-latex=""}
```{r 2023-63,,results='asis'}
cat(TSS())
```
:::

`r punti_p()` Perché una previsione per $x=0.15$ è più affidabile di una per $x=50$?

`r punti_p()` Interpretare il diagramma dei residui.

```{r 2023-64,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,es,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```

:::{.sol data-latex=""}
```{r 2023-65,,results='asis'}

plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::

`r punti_p()` Cosa significa dire che $r$ è un numero puro?






<div class="button-container"></div>

## Prova di Statistica 2023/06/27-2

```{r 2023-189}

source("intro.R")




```



### Esercizio 1

```{r 2023-190}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-191}
set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 250                         # ampiezza campionaria

brk  <- rev(250-c(0,15,30,50,100,250))          # intervalli (breaks)
hhh  <- rev(c( 20,120,100, 50,10))       # aspetto presunto istogramma

nomex <- "Spesa"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ piccole imprese della provincia di Modena è stato rilevata la spesa mensile in telecomunicazioni (in euro), qui di seguito 
la distribuzione delle frequenze assolute:

```{r 2023-192}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
```{r 2023-193}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(axes = T)
h.int(60,250,density=20)
```
:::

`r punti_p()` Qual è il numero di imprese con spesa superiore ai 100 euro?

:::{.sol data-latex=""}
```{r 2023-66,,results='asis'}
cat(F_print(100,verso="<"))
cat(F_print(100,verso=">"))
```
:::

`r punti_p()` Che relazione dobbiamo attenderci tra moda, mediana e media?

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$ e varianza $\hat\sigma^2=`r s2c(samp)`$, se tutte le famiglie aumentassero 
del 10% la loro spesa, come cambierebbero la media e la varianza?



### Esercizio 2

Si lancia una moneta perfetta $n=6$ volte. Sia $X$ la variabile casuale che conta
il numero di volte che esce _Testa_ su 6 lanci e si considerino gli insiemi $A=\{X\le 1\}$ e $B=\{X\ge 5\}$.

`r punti_p(nex = T)` Calcolare la probabilità di $A\cup B$.

:::{.sol data-latex=""}
```{r 2023-67,,results='asis'}
cat(bin_dis(x1 = 1,n = 6,pp = .5,verso = "\\leq"))
cat(bin_dis(x1 = 5,n = 6,pp = .5,verso = "\\geq"))
pa <- pbinom(1,6,.5)
pb <- pa
```
\begin{eqnarray*}
A\cap B &=& \emptyset\\
P(A\cap B) &=& 0\\
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-0\\
  &=& `r pa+pb`
\end{eqnarray*}
:::

`r punti_p()` Si lancia una moneta, se esce testa si estrae da una normale $X\sim N(0,1)$, se esce croce si estrae
da una normale $X\sim N(1,1)$. Calcolare la probabilità che il numero estratto finale sia minore di due.

:::{.sol data-latex=""}
```{r 2023-68,,results='asis'}
cat(norm_int(x1 = 2,mm = 0,ss = 1))
cat(norm_int(x1 = 2,mm = 1,ss = 1))

pa <- pnorm(2)
pb <- pnorm(2,1)
```
\begin{eqnarray*}
P(X<2) &=& P(T)P(X<2|T)+P(C)P(X<2|C)\\
&=& \frac 12P(X<2|T)+\frac 12P(X<2|C)\\
&=& \frac 12\cdot `r pa`+\frac 12 `r pb`\\
&=& `r (pa+pb)/2`
\end{eqnarray*}
:::

`r punti_p()` Se $X\sim\text{Pois}(\lambda_X)$ e $Y\sim\text{Pois}(\lambda_Y)$, quali sono valore atteso e varianza 
di $X-Y$?

`r punti_p()` Se $A$ e $B$ sono due eventi *non* indipendenti come si può scrivere $P(A\cap B)$?




### Esercizio 3

`r punti_p(nex = T)` Una catena di montaggio a ciclo continuo produce ogni giorno un numero di pezzi variabile, con una media pari a
$\mu=1.3$ mila pezzi al giorno e una varianza di $\sigma^2=8.1$.

Calcolare la probabilità che la media annuale ($n=365$) sia inferiore a 1.2 (mila) pezzi prodotti.

:::{.sol data-latex=""}
```{r 2023-69,,results='asis'}
cat(tlc(tipo = "media",x1 = 1.2,verso = "<",mu = 1.3,s2 = 8.1,n = 365))
```
:::



### Esercizio 4

`r punti_p(nex = T)`Sia $\hat \lambda$ lo stimatore di massima verosimiglianza di $\lambda$ del modello di Poisson: 
\[\hat\lambda =  \frac 1n\sum_{i=1}^nx_i\]
Scrivere la distribuzione asintotica di $\hat \lambda$.

`r punti_p()` Sia $h$ uno stimatore per $\theta$ tale che 
\[V(h)=2\frac\theta {\sqrt{n}};~~~~E(h)=\theta\frac{n+2}{n-1}\]
$h$ è corretto? Si può correggere?

`r punti_p()` Definire la significatività di un test statistico.

`r punti_p()` Se un test è significativo all'1% può essere significativo all'5%? (scegliere la risposta tra: _mai_, _non sempre_ oppure _sempre_ e motivare la risposta)



### Esercizio 5

Nel comune $A$ si è condotta un'intervista per conoscere l'opinione
dei cittadini sulla presenza di un inceneritore. Sono state intervistate
25 persone a cui è stato chiesto di esprimete l'opinione in una scala da zero a 100.
È risultato un punteggio medio pari a $\hat\mu_A=72.1$ con una standard deviation 
$\hat\sigma_A=3.4$

`r punti_p(nex = T)` Costruire un intervallo di confidenza al 95%
per la proporzione dei favorevoli in popolazione.

:::{.sol data-latex=""}
```{r 2023-70,,results='asis'}
cat(idc(xm = 72.1,sd = 3.4,n = 25,alpha = .05,dist_ = "t"))
```
:::

`r punti_p()` Nel comune $B$ si è condotta un'intervista analoga. 
Sono state intervistate 23 persone si è osservata una media pari $\mu_B=69.6$ e una deviazione standard $\hat\sigma_B=3.3$.
Sotto ipotesi di omogeneità testare l'ipotesi che le medie dei due comuni siano uguali contro l'alternativa che siano diverse

:::{.sol data-latex=""}
```{r 2023-71,,results='asis'}
cat(ttest_2c_om(mu1 = 72.1,mu2 = 69.6,s1h =3.4,s2h = 3.3,n1 = 25,n2 = 24,h1 = "\\neq",a = "A",b = "B" ))
```
:::




### Esercizio 6

```{r 2023-194}
set.seed(111)
n <- 50
x <- runif(n,0,1.5)
y <- -log(x)+rnorm(n,0,.25)
y <- y-min(y)
# plot(x,y)
RGX <- regr(x,y); ls2e(RGX)
```

In uno studio sull'efficacia del marketing sul web si sono analizzate `r n` aziende
sulle quali è stato misurata l'incremento percentuale annuo medio di investimento in marketing 
web ($X$) la l'incremento percentuale in altre campagne di marketing ($Y$). Si osservano le seguenti statistiche, $\sum_{i=1}^{50}x_i=`r sum(x)`$, $\sum_{i=1}^{50}y_i=`r sum(y)`$,
 $\sum_{i=1}^{50}x_i^2=`r sum(x^2)`$, $\sum_{i=1}^{50}y_i^2=`r sum(y^2)`$ e $\sum_{i=1}^{50}x_iy_i=`r sum(x*y)`$.


`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$ e interpretare 
i coefficienti $\hat\beta_0$ e $\hat\beta_1$

:::{.sol data-latex=""}
```{r 2023-72,,results='asis'}
cat(calcolo_beta())
```
:::

`r punti_p()` Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r 2023-73,,results='asis'}
cat(TSS())
```
:::

`r punti_p()` Perché una previsione per $x=0.8$ è più affidabile di una per $x=0$?

`r punti_p()` Interpretare il diagramma dei residui.

```{r 2023-74,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,es,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```

:::{.sol data-latex=""}
```{r 2023-75,,results='asis'}

plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::


`r punti_p()` Cosa significa dire che $r$ è invariante ai cambiamenti di scala?





<div class="button-container"></div>

## Prova di Statistica 2023/06/27-3

```{r 2023-195}

source("intro.R")




```


### Esercizio 1

```{r 2023-196}
compito <- compito + 1
punti <- punti_list[[compito]]
```

```{r 2023-197}
set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 200                         # ampiezza campionaria

brk  <- c(0,15,30,50,100,250)          # intervalli (breaks)
hhh  <- c( 10,13,9, 4,0.5)       # aspetto presunto istogramma

nomex <- "Spesa"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ piccole imprese della provincia di Modena è stato rilevata la spesa mensile in telecomunicazioni (in euro), qui di seguito 
la divisione in classi e le densità percentuali

```{r 2023-198}
kable(dat3[,c(1,2,6)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Calcolare il valore approssimato della mediana

:::{.sol data-latex=""}
```{r 2023-76,,results='asis'}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(axes = T)
h.int(60,250,density=20)
cat(percentile())
```
:::

`r punti_p()` Qual è il numero di imprese con spesa superiore ai 60 euro?

:::{.sol data-latex=""}
```{r 2023-77,,results='asis'}
cat(F_print(60,verso=">"))
```
:::

`r punti_p()` Che relazione dobbiamo attenderci tra moda, mediana e media?

`r punti_p()` Scrivere la proprietà di associatività della media aritmetica.



### Esercizio 2

Sia $X\sim N(2,1)$ e sia $Y\sim\text{Pois}(2.9)$, si considerino gli insiemi
$A=\{X>2.5\}$ e $B=\{Y\geq 3\}$.

`r punti_p(nex = T)` Calcolare la probabilità di $A\cup B$.

:::{.sol data-latex=""}
```{r 2023-78,,results='asis'}
cat(norm_int(x1 = 2.5,verso = ">",mm = 2,ss = 1))
cat(pois_dis(x1 = 3,ll = 2.9,verso = "\\geq",vnam = "Y"))
pa <- 1-pnorm(2.5,2)
pb <- 1-ppois(2,2.9)
```
\begin{eqnarray*}
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa`\cdot`r pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
:::

`r punti_p()` Sia $X\sim N(2,1)$ e sia $A=\{X>2.5\}$.
Se $A$ è vero si estrae una volta da un'urna che contiene una pallina rossa e una bianca,
se $A$ è falso si estrae una volta da un'urna che contiene due palline rosse e una bianca.
Qual è la probabilità di estrarre una rossa?


:::{.sol data-latex=""}
\begin{eqnarray*}
P(X<2) &=& P(A)P(R|A)+P(\bar A)P(R|\bar A)\\
&=& `r pa`\frac 12 + (1-`r pa`)\frac 23\\
&=& `r pa*1/2+(1-pa)*2/3`
\end{eqnarray*}
:::

`r punti_p()` Se $X\sim\text{Pois}(\lambda_X)$ e $Y\sim\text{Pois}(\lambda_Y)$, quali sono valore atteso e varianza 
di $X-Y$?

`r punti_p()` Se due eventi $A\ne\emptyset$ e $B\ne\emptyset$ non sono indipendenti allora sono necessariamente incompatibili? Motivare la risposta.




### Esercizio 3

`r punti_p(nex = T)` Una catena di montaggio a ciclo continuo produce un pezzo al giorno e la proporzione di pezzi fallati è pari
a $\pi=0.15$.

Calcolare la probabilità che il numero totale di pezzi fallati in un anno ($n=365$) sia maggiore di 60

:::{.sol data-latex=""}
```{r 2023-79,,results='asis'}
cat(tlc(tipo = "somma",x1 = 60,verso = ">",mu = .15,n = 365))
```
:::



### Esercizio 4

`r punti_p(nex = T)`Sia $\hat \lambda$ lo stimatore di massima verosimiglianza di $\lambda$ del modello di Poisson: 
\[\hat\lambda =  \frac 1n\sum_{i=1}^nx_i\]
Scrivere la distribuzione asintotica di $\hat \lambda$.

`r punti_p()` `r punti_p()` Sia $h$ uno stimatore per $\theta$ tale che 
\[V(h)=2\frac\theta {\sqrt{n}};~~~~E(h)=\theta\frac{n+2}{n-1}\]
scrive il Mean Squared Error di $h$ ($MSE(h)$).

`r punti_p()` Definire la potenza di un test statistico.

`r punti_p()` Se un t-test bilaterale con 13 gradi libertà presenta una
t osservata pari a $t_\text{obs}=1.974$, il $p_\text{value}$ sarà maggiore o minore di 0.05? Perché?



### Esercizio 5

Nel comune $C$ si è condotta un'intervista per conoscere l'opinione
dei cittadini sulla presenza di un inceneritore. Sono state intervistate
25 persone a cui è stato chiesto di esprimete l'opinione in una scala da zero a 100.
È risultato un punteggio medio pari a $\hat\mu_C=77.25$ con una standard deviation 
$\hat\sigma_C=3.41$.

`r punti_p(nex = T)` Costruire un intervallo di confidenza al 95%
per la proporzione dei favorevoli in popolazione.

:::{.sol data-latex=""}
```{r 2023-80,,results='asis'}
cat(idc(xm = 77.25,sd = 3.41,n = 25,alpha = .05,dist_ = "t"))
```
:::

`r punti_p()` Nella regione è stata condotta un'indagine analoga
di larga scala che ha evidenziato un gradimento medio pari a $\mu_0=76$
Testare l'ipotesi che nel comune $C$ il gradimento sia uguale a quello regionale contro l'alternativa che sia maggiore.

:::{.sol data-latex=""}
```{r 2023-81,,results='asis'}
ttest_mu(muh = 77.25,sh = 3.41,n = 25,mu0 = 76,h1 = ">")
```
:::




### Esercizio 6

```{r 2023-199}
set.seed(16)
n <- 4
x <- sort(runif(n,0,1.5))
y <- -log(x)+rnorm(n,0,.25)
y <- round(y-min(y),2)
x <- round(x,2)
# plot(x,y)
RGX <- regr(x,y); ls2e(RGX)
```

In uno studio sull'efficacia del marketing sul web si sono analizzate `r n` aziende
sulle quali è stato misurata l'incremento percentuale annuo medio di investimento in marketing 
web ($X$) la l'incremento percentuale in altre campagne di marketing ($Y$). 

Qui di seguito i dati

```{r 2023-200}
kable(prn[1:5,1:3], booktabs=T,escape = F,linesep="")%>%
  kable_styling(full_width = T) %>%
    row_spec(5, bold = T, color = "white", background = "gray")
```


`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$ e interpretare 
e calcolare il residuo per $x=`r x[2]`$.

:::{.sol data-latex=""}
```{r 2023-82,,results='asis'}
kable(prn, digits = 4,booktabs=T,escape = F,linesep="")%>%
  kable_styling(full_width = T) %>%
  row_spec(5, bold = T, color = "white", background = "gray")

cat(calcolo_beta())
cat(residuo(x[2],y[2]))
```
:::

`r punti_p()` Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r 2023-83,,results='asis'}
cat(R2())
```
:::
:::

`r punti_p()` Che differenza c'è tra interpolazione ed estrapolazione?

`r punti_p()` Definire il diagramma dei residui.

`r punti_p()` Cosa significa che $\hat\beta_0$ e $\hat\beta_1$ sono BLUE?



<div class="button-container"></div>

## Prova di Statistica 2023/07/23-1

### Esercizio 1

```{r 2023-201}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-202}


set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 180                         # ampiezza campionaria

brk  <- c(-10,-5,0,1,5)          # intervalli (breaks)
hhh  <- c( 2,4,10, .5)       # aspetto presunto istogramma

nomex <- "Bilancio"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ di piccole e medie  aziende  della provincia di Modena è stato rilevato l'utile netto (espresso in centinaia di migliaia di euro) durante il periodo del covid. Qui di seguito la distribuzione delle frequenze assolute:

```{r 2023-203}
tabl(dat3[,c(1,2,3)])
```

`r punti_p(start=T)` Individuare la classe modale

:::{.sol data-latex=""}
```{r 2023-204}
tabl(dat3[,1:7])
histp(axes = T)
h.int(-10,3,density=20)
```
:::

`r punti_p()` Qual è la percentuale di imprese con bilancio inferiore a 3 (centomila) euro?

:::{.sol data-latex=""}
```{r 2023-84,,results='asis'}
cat(F_print(3,verso="<"))
```
:::

`r punti_p()` la media aritmetica è pari a `r mean(samp)`, in base al punto 1a che relazione dobbiamo attenderci tra media, mediana e moda?

`r punti_p()` Si considerino i seguenti dati

\[
\{x_1=1.2,x_2=2.3,x_3=6.7\}
\]

Per quale valore di $x$
\[
f(x)=(x_1-x)^2+(x_2-x)^2+(x_3-x)^2
\]
$f$ è minima?



### Esercizio 2

Il numero di automobili in fila al semaforo $A$ in orario di punta è distribuito come una
Poisson di parametro $\lambda_A=2.2$ ($X_A\sim \text{Pois}(2.2)$). 
Mentre il numero di automobili in fila al semaforo $B$ in orario di punta è distribuito come una
Poisson di parametro $\lambda_B=1.5$ ($X_B\sim \text{Pois}(1.5)$). $X_A$ e $X_B$ indipendenti. 

`r punti_p(nex = T)` Calcolare la probabilità che in almeno uno dei due semafori ci siano 2 o più automobili in coda (suggerimento: _almeno uno_ si rappresenta con l'unione).

:::{.sol data-latex=""}
Diretta
```{r 2023-85,,results='asis'}
cat(pois_dis(x1 = 2,ll = 2.2,vnam = "X_A",verso = "\\geq"))
cat(pois_dis(x1 = 2,ll = 1.5,vnam = "X_B",verso = "\\geq"))
pa <- 1-ppois(1,2.2)
pb <- 1-ppois(1,1.5)
```
\begin{eqnarray*}
  A =\{X_A\ge 2\} && B =\{X_B\ge 2\}\\
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa*pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
Indiretta
\begin{eqnarray*}
  \overline{\text{almeno uno}} &=&  \text{nessuno}\\
  \overline{A\cup B} &=& \bar A\cap \bar B\\
  P(\overline{A\cup B}) &=& P(\bar A)P(\bar B)\\
  P(A\cup B) &=& 1- P(X_A<2)(X_B<2)\\
  &=& 1-(1-`r pa` )\times(1-`r pb`)\\
  &=& `r 1-(1-pa)*(1-pb)`
\end{eqnarray*}
  
:::

`r punti_p()` Per andare al lavoro Michele prende la strada che 
lo porta al semaforo $A$, ($X_A\sim \text{Pois}(2.2)$) se la tangenziale è libera, altrimenti
prende la strada che lo porta al semaforo $B$ ($X_B\sim \text{Pois}(1.5)$).
La probabilità di trovare la tangenziale sia libera è pari a
$P(\text{Libera})=0.65$. Qual è la probabilità che Michele incontri più di due auto in fila?

:::{.sol data-latex=""}
\begin{eqnarray*}
E &=& \{X\ge 2\}\\
P(E) &=& P(\text{Libera})P(E|\text{Libera})+P\left(\overline{\text{Libera}}\right)P\left(E|\overline{\text{Libera}}\right)\\
   &=&  0.65\times`r pa`+(1-0.65)\times `r pb`\\
  &=& `r .65*pa+(1-.65)*pb`
\end{eqnarray*}
:::

`r punti_p()` Sia $Z\sim N(0,1)$ e $Y\sim \chi^2_2$, $Z$ e $Y$ indipendenti.
Come si distribuisce
\[
\frac{Z}{\sqrt{Y/2}} ~~~?
\]

`r punti_p()` Se $P(A)=0.3$, $P(B|A)=0.6$, e $P(B|\bar A)=0.4$, quanto valgono $P(B)$ e $P(A|B)$?

:::{.sol data-latex=""}
\begin{eqnarray*}
P(B) &=& P(A)P(B|A)+P(\bar A)P(B|\bar A)\\
     &=& 0.3\times0.6+0.7\times 0.4\\
     &=& `r .3*.6+.7*.4`\\
P(A|B) &=& \frac {P(A)P(B|A)}{P(B)}\\
       &=& \frac {`r .3*.6`}{`r .3*.6+.7*.4`}\\
       &=& `r .3*.6/(.3*.6+.7*.4)`
\end{eqnarray*}
:::




### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene le seguenti palline numerate {3,5,7,11}. Si estrae con reintroduzione per $n=81$ volte.
Calcolare la probabilità che la media delle palline estratte sia inferiore a 6.

:::{.sol data-latex=""}
```{r 2023-86,,results='asis'}
cat(stat_(urn<-c(3,5,7,11),semp = T))
cat(tlc(tipo = "media",x1 = 6,verso = "<",mu = mean(urn),s2 = s2c(urn),n = 81))
```
:::





### Esercizio 4

  
`r punti_p(nex = T)` Siano $\hat \mu$ e $\hat\sigma^2$ gli stimatori di massima verosimiglianza di $\mu$ e $\sigma^2$ del modello di Normale.
\begin{eqnarray*}
  \hat\mu &=&  \frac 1n\sum_{i=1}^nx_i \qquad \hat\sigma^2 =  \frac 1n\sum_{i=1}^n(x_i-\hat\mu)^2\\
\end{eqnarray*}
Dimostrare la consistenza di $\hat\mu$.

`r punti_p()` Cosa significa che gli stimatori di massima verosimiglianza sono invarianti alle trasformazioni monotone invertibili?

`r punti_p()` Definire la significatività di un test.

```{r 2023-205}
tabella <- matrix(c(50, 120, 50, 60, 80, 40, 40, 50, 50), nrow = 3, ncol = 3, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(tabella)$p.value,digits = 4,nsmall = 4)
```

`r punti_p()` Un sociologo sta conducendo uno studio sull'associazione tra l'orientamento politico e l'atteggiamento nei confronti del cambiamento climatico. Ha somministrato un questionario a `r n` partecipanti, chiedendo loro di indicare il proprio orientamento politico (Conservatore, Progressista, Indipendente) e l'atteggiamento nei confronti del cambiamento climatico (Molto, poco, per nulla) preoccupato. L'obiettivo è determinare se c'è un'associazione significativa tra l'orientamento politico e l'atteggiamento nei confronti del cambiamento climatico.

```{r 2023-206}

# Assegnazione dei nomi alle righe e alle colonne
rownames(tabella) <- c("Conservatore", "Progressista", "Indipendente")
colnames(tabella) <- c("Molto", "Poco", "Per nulla")


 tabl(tabella)  %>%
   kable_styling(full_width = F)  %>%
   kable_paper(full_width = F)  %>%
   pack_rows("Orientamento politico", 1, 3) %>%
   add_header_above(c(" " = 1, "Preoccupato per i cambiamenti climatici" = 3))
```
Eseguito il test del $\chi^2$ per verificare l'indipendenza tra l'orientamento politico e la preoccupazione
sui cambiamenti climatici il sociologo ottiene un $p_\text{value}=`r pval`$. Quali conclusioni può trarne?



### Esercizio 5


```{r 2023-207}
# Dati campionari
n1 <- 10
muh <- 1200
sdh <- 300
mu0 <- 1100
```
`r punti_p(nex = T)`  In uno studio sulle spese mensili dei dipendenti di un'azienda, è stato selezionato un campione di `r n1` individui. I dati campionari hanno mostrato una media di spese mensili pari a $\hat\mu = `r muh`€$ con una deviazione standard osservata pari a $\hat\sigma = `r sdh`€$. Costruire un intervallo di confidenza al 95% per la media delle spese mensili $\mu$.

:::{.sol data-latex=""}
```{r 2023-87,,results='asis'}
idc(xm = muh,sd = sdh,alpha = .05,n = n1,dist_ = "t")
```
:::

`r punti_p()`  L'azienda afferma che la media delle spese mensili dei dipendenti è pari a $1100€$. Effettuare un test di ipotesi per verificare se la media delle spese mensili sia superiore a $1100€$.

:::{.sol data-latex=""}
```{r 2023-88,,results='asis'}
ttest_mu(muh = muh,sh = sdh,n = n1,mu0 = mu0,h1 = ">",um = "€")
```
:::



### Esercizio 6

```{r 2023-208}
set.seed(789)
n <- 50
x <- abs(rnorm(n, 0, 6)) + 6 # Anni di studio
y <- abs(2*x + rnorm(n, 0, 5)) + 15 # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di $n=`r n`$ individui, sono state analizzati il livello di istruzione (in anni di studio, $X$) e il reddito annuale (in migliaia di euro, $Y$).

 Si osservano le seguenti statistiche, $\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
 $\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.

`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$ e prevedere il reddito per un individuo con 12 anni di studio.

:::{.sol data-latex=""}
```{r 2023-89,,results='asis'}
cat(calcolo_beta())
cat(previsione(12))
```
:::

`r punti_p()` Qual è la percentuale di varianza spiegata dal modello?

:::{.sol data-latex=""}
```{r 2023-90,,results='asis'}
cat(R2())
```
:::

`r punti_p()` Stimare lo Standard Error di $\hat\beta_1$.


:::{.sol data-latex=""}
```{r 2023-91,,results='asis'}
cat(se_beta1())
```
:::

`r punti_p()` Definire i punti di leva.

`r punti_p()` Se in un modello di regressione sappiamo che $\hat\sigma_X=0.5$, $\hat\sigma_Y=1.2$ e $r=0.8$, quanto varrà $\hat\beta_1$, il coefficiente angolare del modello di regressione dove $Y$ viene spiegata da $X$?






<div class="button-container"></div>

## Prova di Statistica 2023/07/23-2


### Esercizio 1

```{r 2023-209}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-210}


set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 200                         # ampiezza campionaria

brk  <- c(0, 2, 5, 10, 20, 50)   # intervalli (breaks)
hhh  <- c(50, 90, 60, 40, 10)    # aspetto presunto istogramma

nomex <- "Utilizzo servizi di streaming"
samp <- genera_dati(brk = brk, hhh = hhh, n = n)

ls2e(stat_base(samp,brk))      # crea il data set e la tabella dat3
```

Su un campione di $`r n`$ famiglie della provincia di Modena è stata rilevata la quantità mensile di ore dedicate all'utilizzo di servizi di streaming. Di seguito è riportata la distribuzione delle frequenze percentuali:

```{r 2023-211}
tabl(dat3[,c(1,2,12)])
```

`r punti_p(start=T)` Individuare la classe modale.

:::{.sol data-latex=""}
```{r 2023-212}
tabl(dat3[,1:7])
histp(axes = T)
h.int(30,50,density=20)
```
:::

`r punti_p()` Qual è il numero di famiglie che consuma più di 30 ore di streaming?

:::{.sol data-latex=""}

```{r 2023-92,,results='asis'}
cat(percentile())
cat(F_print(30,verso = ">"))
```
:::

`r punti_p()` la media aritmetica è pari a `r mean(samp)`, in base al punto 1a che relazione dobbiamo attenderci tra media, mediana e moda?

`r punti_p()` Si considerino i seguenti dati

\[
\{x_1=1.2,x_2=2.3,x_3=6.7\}
\]

Per quale valore di $x$
\[
f(x)=|x_1-x|+|x_2-x|+|x_3-x|
\]
$f$ è minima?



### Esercizio 2


Siano $X$ e $Y$ due variabili casuali che rappresentano rispettivamente il tempo di manutenzione per due tipi di macchinari diversi in un'azienda manifatturiera. Si sa che $X\sim N(15,1.5)$ e $Y\sim N(12,1.5)$. L'azienda ha definito due eventi $A=\{X< 14\}$ e $B=\{Y<13\}$
Si suppone inoltre che i tempi di manutenzione dei due macchinari siano indipendenti tra loro.

`r punti_p(nex = T)`  Calcola la probabilità che almeno uno dei due eventi sia vero ($A \cup B$).


:::{.sol data-latex=""}
```{r 2023-93,,results='asis'}
cat(norm_int(x1 = 14,verso = "<",mm = 15,ss = 1.5,mu = "\\mu_X",sigma = "\\sigma_X",vnam = "X"))
cat(norm_int(x1 = 13,verso = "<",mm = 12,ss = 1.5,mu = "\\mu_Y",sigma = "\\sigma_Y",vnam = "Y"))
pa <- pnorm(14,15,sqrt(1.5))
pb <- pnorm(13,12,sqrt(1.5))
```
\begin{eqnarray*}
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa*pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
:::

`r punti_p()` Quando il tempo di manutenzione del macchinario $X$ è inferiore a 14 ore ($A=\{X< 14\}$), la perdita economica dell'azienda è di €100. Mentre quando è superiore a 14 la perdita è di 500€.

Quando il tempo di manutenzione del macchinario $Y$ è inferiore a 12 ore ($B=\{Y< 12\}$), l'azienda subisce una perdita economica di €70, mentre quando è superiore a 12 il danno economico è di 600€.

Calcolare la probabilità che l'azienda abbia una perdita economica totale superiore ai 600€.

:::{.sol data-latex=""}
```{r 2023-213}
two_way2(c(100,500),c(70,600),c(pa,1-pa),c(pb,1-pb),EV = F)
0.0429 + 0.1642
```
:::

`r punti_p()`  Siano $Z_1\sim N(0,1)$, $Z_2\sim N(0,1)$, $Z_3\sim N(0,1)$, tre VC normali standard indipendenti.
Come si distribuisce
\[
Y=Z_1^2+Z_2^2+Z_3^3~~~?
\]

`r punti_p()` Se $A$ e $B$ sono due eventi tali che $A\cap B\ne\emptyset$, $A$ e $B$ sono indipendenti? (scegliere tra _sempre, mai, dipende_ e motivare la risposta)





### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene le seguenti palline numerate {3,4,5,6,7,11}. Si vine se esce un numero pari. Si estrae con reintroduzione per $n=81$ volte.
Calcolare la probabilità di vincere più di 30 volte.

:::{.sol data-latex=""}
\[\pi=\frac 13\]
```{r 2023-94,,results='asis'}
cat(tlc(tipo = "somma",x1 = 30,verso = ">",mu = 1/3,n = 81))
```
:::




### Esercizio 4

`r punti_p(nex = T)` Sia $\hat \beta_1$ lo stimatore dei minimi quadrati di $\beta_1$ del modello di regressione lineare.
\begin{eqnarray*}
  \hat\beta_1 &=&  \frac{\text{cov}(X,Y)}{\hat\sigma_X^2}\\
\end{eqnarray*}
Dimostrare la consistenza di $\hat\beta_1$.

`r punti_p()` Come si distribuiscono gli stimatori di massima verosimiglianze asintoticamente?

`r punti_p()` Definire la potenza di un test.

```{r 2023-214}
tabella <- matrix(c(50, 80, 50, 60, 80, 40, 40, 50, 50), nrow = 3, ncol = 3, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(tabella)$p.value,digits = 4,nsmall = 4)
```

`r punti_p()` Un sociologo sta conducendo uno studio sull'associazione tra l'orientamento politico e l'atteggiamento nei confronti del cambiamento climatico. Ha somministrato un questionario a `r n` partecipanti, chiedendo loro di indicare il proprio orientamento politico (Conservatore, Progressista, Indipendente) e l'atteggiamento nei confronti del cambiamento climatico (Molto, poco, per nulla) preoccupato. L'obiettivo è determinare se c'è un'associazione significativa tra l'orientamento politico e l'atteggiamento nei confronti del cambiamento climatico.

```{r 2023-215}

# Assegnazione dei nomi alle righe e alle colonne
rownames(tabella) <- c("Conservatore", "Progressista", "Indipendente")
colnames(tabella) <- c("Molto", "Poco", "Per nulla")


 tabl(tabella)  %>%
   kable_styling(full_width = F)  %>%
   kable_paper(full_width = F)  %>%
   pack_rows("Orientamento politico", 1, 3) %>%
   add_header_above(c(" " = 1, "Preoccupato per i cambiamenti climatici" = 3))
```
Eseguito il test del $\chi^2$ per verificare l'indipendenza tra l'orientamento politico e la preoccupazione
sui cambiamenti climatici il sociologo ottiene un $p_\text{value}=`r pval`$. Quali conclusioni può trarne?



### Esercizio 5


```{r 2023-216}
# Dati campionari
# Dati campionari
n1 <- 80
x1 <- 48
p0 <- 0.5
alpha <- 0.01
```

`r punti_p(nex = T)` In uno studio clinico per valutare l'efficacia di un nuovo farmaco, sono stati selezionati `r n1` pazienti con una particolare condizione medica. Tra questi, `r x1` pazienti hanno mostrato un miglioramento utilizzando il nuovo farmaco. Testare usando il $p_\text{value}$ che il farmaco sia maggiormente efficace rispetto al trattamento esistente che una proporzione pari a $\pi_0 = `r p0`$

:::{.sol data-latex=""}
```{r 2023-95,,results='asis'}
ztest_pi(sn = x1,n = n1,p0 = p0,h1 = ">")
```
:::




### Esercizio 6
```{r 2023-217}
set.seed(7)
n <- 50
x <- round(abs(rnorm(n, 0, 6)) + 6) # Anni di studio
y <- round(abs(1.5*x + rnorm(n, 0, 5)) + 15,2) # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di $n=`r n`$ individui, sono state analizzati il livello di istruzione (in anni di studio, $X$) e il reddito annuale (in migliaia di euro, $Y$).
Si osservano le seguenti statistiche, $\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r punti_p(nex = T)` Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r 2023-96,,results='asis'}
cat(calcolo_beta())
cat(residuo(x = x[3],y = y[3]))
```
:::

`r punti_p()` Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r 2023-97,,results='asis'}
cat(R2())
```
:::

`r punti_p()` Stimare lo Standard Error di $\hat\beta_0$.

:::{.sol data-latex=""}
```{r 2023-98,,results='asis'}
cat(se_beta0())
```
:::

`r punti_p()` Definire il qq-plot.

`r punti_p()` Se in un modello di regressione $r=0.35$, $\hat\sigma_X=1.2$ e $\hat\sigma_X=0.5$, quanto varrà
$\hat\beta_1$, il coefficiente angolare della retta di regressione in cui $Y$ è spiegata da  $X$?





<div class="button-container"></div>

## Prova di Statistica 2023/07/23-3



### Esercizio 1

```{r 2023-218}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-219}


set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 200                         # ampiezza campionaria

brk  <- c(0, 100, 300, 600, 1000)   # intervalli (breaks)
nnn  <- c(40, 40, 15, 5)    # aspetto presunto istogramma

nomex <- "Spesa mensile per abbigliamento"
samp <- genera_dati(brk = brk, nnn = nnn, n = n)

ls2e(stat_base(samp,brk))      # crea il data set e la tabella dat3
```

Su un campione di $`r n`$ individui è stata rilevata la spesa mensile in euro per abbigliamento. Di seguito sono riportate la densità percentuali:

```{r 2023-220}
tabl(dat3[,c(1:2,6)])
```

`r punti_p(start=T)` Ricavare il valore approssimato della mediana.

:::{.sol data-latex=""}
```{r 2023-221}
tabl(dat3[,1:7])
histp(axes = T)
h.int(150,1000,density=20)
cat(percentile())
```
:::

`r punti_p()` Qual è il numero di individui che spende più di 150€ al mese?

:::{.sol data-latex=""}
```{r 2023-99,,results='asis'}
cat(F_print(150,verso = ">"))
```
:::

`r punti_p()` Individuare la classe modale, metterla in relazione con la mediana e indicare la loro relazione con la media.

`r punti_p()` Michele ha sostenuto tre esami e ha la media del 26, al quarto esame ha preso 28. Qual è la media calcolata sui 4 esami?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \bar x &=&\frac {26\times 3+28}{3+1}\\
  &=& \frac {`r 26*3+28`}{4}\\
  &=& `r (26*3+28)/4`
\end{eqnarray*}
  
:::



### Esercizio 2

Supponiamo di avere due urne, urna A e urna B, contenenti palline di due colori: rosse e blu.
Nell'urna A, ci sono 10 palline di cui 4 rosse e 6 blu. Nell'urna B, ci sono 20 palline di cui 8 rosse e 12 blu.
Estraiamo con reintroduzione 5 palline da ciascuna urna in modo indipendente.
Definiamo gli eventi: 

- $A=$ "l'estrazione dall'urna A dà al massimo una pallina rossa (1 pallina rossa o meno)".
- $B=$ "L'estrazione dall'urna B dà come risultato almeno 4 palline blu (4 o più palline blu)".

**(Punti 14)** Calcola la probabilità che almeno uno dei due eventi sia vero, ovvero la probabilità di $A \cup B$.

:::{.sol data-latex=""}
```{r 2023-100,,results='asis'}
cat(bin_dis(1,5,1/3))
cat(bin_dis(4,5,2/3,verso = "\\geq",comp = F,vnam = "Y"))
pa <- pbinom(1,5,1/3)
pb <- sum(dbinom(4:5,5,2/3))
```
\begin{eqnarray*}
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa*pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
:::

`r punti_p(nex = T)` Qual è la probabilità di avere **esattamente** uno solo due eventi sia vera?

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(A) &=&  `r pa`\\
  P(B) &=& `r pb`\\
  P(\text{Solo uno dei due vero}) &=& P(A\cap\bar B)+P(\bar A\cap B)\\
  &=& `r pa`\times (1 - `r pb`)+(1-`r pa`)\times  `r pb`\\
  &=& `r pa*(1-pb)+pb*(1-pa)`
\end{eqnarray*}
:::

`r punti_p()` Siano $X_1\sim N(5,1)$ e $X_2\sim N(5,1)$, $X_1$ e $X_2$ indipendenti. Come si distribuisce
\[
\bar X = \frac 12 (X_1+X_2) ~~~?
\]

`r punti_p()` Siano $A$ e $B$ due eventi tali che $P(A)=0.3$ e $P(B)=0.3$. $A$ e $B$ possono essere incompatibili? (scegliere tra _sempre, mai, dipende_ e motivare la risposta)



### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene le seguenti palline numerate {3,4,5,6,7,12}. Si vine se esce un numero pari. Si estrae con reintroduzione per $n=81$ volte.
Calcolare la probabilità che la **proporzione** di vincite sia minore più di 0.55.

:::{.sol data-latex=""}
\[\pi=\frac 12\]
```{r 2023-101,,results='asis'}
cat(tlc(tipo = "prop",x1 = 0.55,verso = "<",mu = 1/2,n = 81))
```
:::



### Esercizio 4

`r punti_p(nex = T)` Sia $\hat \beta_0$ lo stimatore dei minimi quadrati di $\beta_0$ del modello di regressione lineare.
\begin{eqnarray*}
  \hat\beta_0 &=&\bar y-  \hat\beta_1\bar x\\
\end{eqnarray*}
Dimostrare la consistenza di $\hat\beta_0$.

`r punti_p()` Cosa significa che gli stimatori di massima verosimiglianza sono asintoticamente a massima efficienza?

`r punti_p()` Definire gli errori di primo e secondo tipo.

```{r 2023-222}
tabella <- matrix(c(50, 80, 50, 60, 100, 40, 40, 50, 50), nrow = 3, ncol = 3, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(tabella)$p.value,digits = 4,nsmall = 4)
```

`r punti_p()` Un sociologo sta conducendo uno studio sull'associazione tra l'orientamento politico e l'atteggiamento nei confronti del cambiamento climatico. Ha somministrato un questionario a `r n` partecipanti, chiedendo loro di indicare il proprio orientamento politico (Conservatore, Progressista, Indipendente) e l'atteggiamento nei confronti del cambiamento climatico (Molto, poco, per nulla) preoccupato. L'obiettivo è determinare se c'è un'associazione significativa tra l'orientamento politico e l'atteggiamento nei confronti del cambiamento climatico.

```{r 2023-223}

# Assegnazione dei nomi alle righe e alle colonne
rownames(tabella) <- c("Conservatore", "Progressista", "Indipendente")
colnames(tabella) <- c("Molto", "Poco", "Per nulla")


 tabl(tabella)  %>%
   kable_styling(full_width = F)  %>%
   kable_paper(full_width = F)  %>%
   pack_rows("Orientamento politico", 1, 3) %>%
   add_header_above(c(" " = 1, "Preoccupato per i cambiamenti climatici" = 3))
```
Eseguito il test del $\chi^2$ per verificare l'indipendenza tra l'orientamento politico e la preoccupazione
sui cambiamenti climatici il sociologo ottiene un $p_\text{value}=`r pval`$. Quali conclusioni può trarne?




### Esercizio 5


```{r 2023-224}
# Dati campionari
# Dati campionari
n1 <- 80
n2 <- 80
x2 <- 40
x1 <- 48
p0 <- 0.5
alpha <- 0.01
```

`r punti_p(nex = T)` In uno studio clinico per valutare l'efficacia di un nuovo farmaco, sono stati selezionati `r n1+n2` pazienti con una particolare condizione medica. Tra questi, `r n1` sono stati trattati con un farmaco sperimentale e `r n2` col placebo. Tra i trattati, `r x1` pazienti hanno mostrato un miglioramento utilizzando il nuovo farmaco, mentre sono `r x2` quelli che hanno assunto il placebo e hanno mostrato miglioramenti. Testare l'ipotesi, usando il il $p_\text{value}$, che il farmaco sia maggiormente efficace rispetto al placebo.

:::{.sol data-latex=""}
```{r 2023-102,,results='asis'}
cat(ztest_2c_pi(s1 = x1,s2 = x2,n1 = n1,n2 = n2,h1 = ">",a = "F",b = "P"))
```
:::





### Esercizio 6
```{r 2023-225}
set.seed(9)
n <- 50
x <- round(abs(rnorm(n, 0, 6)) + 6) # Anni di studio
y <- round(abs(2.1*x + rnorm(n, 0, 5)) + 12) # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di $n=`r n`$ individui, sono state analizzati il livello di istruzione (in anni di studio, $X$) e il reddito annuale (in migliaia di euro, $Y$).
Si osservano le seguenti statistiche, $\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r punti_p(nex = T)` Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r 2023-103,,results='asis'}
cat(calcolo_beta())
cat(residuo(x = x[3],y = y[3]))
```
:::

`r punti_p()` Scrivere la scomposizione della varianza e calcolarla per i dati in esame.

:::{.sol data-latex=""}
```{r 2023-104,,results='asis'}
cat(TSS())
```
:::

`r punti_p()` Stimare $\sigma^2_\varepsilon$.

:::{.sol data-latex=""}

\begin{eqnarray*}
\hat{\sigma_\varepsilon}^2&=&(1-r^2)\hat\sigma_Y^2\\
&=& (1-`r r^2`)\times`r vy`\\
    &=& `r sh2`\\
    S_\varepsilon^2 &=& \frac{n} {n-2} \hat{\sigma_\varepsilon}^2\\
    &=&  \frac{`r n`} {`r n`-2} \hat{\sigma_\varepsilon}^2 \\
 &=&  \frac{`r n`} {`r n`-2} \times `r sh2` = `r se2` 
\end{eqnarray*}
:::

`r punti_p()` Definire i punti influenti.

`r punti_p()` Se in un modello di regressione $r=0.35$, $\hat\sigma_X=1.2$ e $\hat\beta_1=0.5$, quanto varrà
$\hat\sigma_Y$, la standard deviation di $Y$?




<!--chapter:end:2023.Rmd-->


```{r 2024-38}
rm(list = rm())
source("intro.R")
if (html) cat('')
```
  
# Anno 2024

```{r 2024-39}
source("punti.R")
punti_list <- punti_2024
compito <- 0
```


<div class="button-container"></div>

## Prova di Statistica 2024/06/03-1

### Esercizio 1

```{r 2024-40}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2024-41}

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- c(0,1.5,3,8,20)
nnn  <- c( 200,100,100, 50)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(x = stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Milano è stato rilevata la spesa annua per le vacanze (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze cumulate:

```{r 2024-42}
kable(dat3[,c(1,2,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

```

`r punti_p(start=T)`  Disegnare l'istogramma di densità percentuale. 

:::{.sol data-latex=""}
```{r 2024-43}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r punti_p()` Quante famiglie spendono meno di 5 mila euro all'anno? 

:::{.sol data-latex=""}
```{r 2024-44}
F_print(x = 5,verso = "<")
```
:::  


`r punti_p()` Che relazione dobbiamo aspettarci tra media,  mediana e moda? 

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$, mentre la SD è pari a $SD=`r sd(samp)`$.
Se ogni famiglia spendesse 2 mila euro in più all'anno, quanto varrebbero la media e la SD dei dati trasformati?

### Esercizio 2 


`r punti_p(nex=T)`  Si lancia una moneta perfetta 4 volte. Sia $X$ la variabile casuale che conta il numero di Teste su 4 lanci. Calcolare la probabilità che $X\leq 2$.

:::{.sol data-latex=""}
```{r 2024-1,,results='asis'}
bin_dis(x1 = 2,n = 4,pp = .5)
```
:::  

`r punti_p()` Sia lancia una seconda moneta perfetta 3 volte. Sia $Y$ la variabile casuale che conta il numero di Teste su 3 lanci. Calcolare la probabilità che $X+Y=3$.

:::{.sol data-latex=""}
Siccome $X+Y\sim\text{Binom(4+3,0.5)}$, allora
```{r 2024-2,,results='asis'}
bin_dis(x1 = 3,n = 7,pp = .5,sing = T,vnam = "X+Y")
```
:::  

`r punti_p()` Se $P(A)=0.4$ e $P(B)=0.8$, $A$ e $B$ possono essere incompatibili? Perché?

:::{.sol data-latex=""}
Se $A$ e $B$ fossero incompatibili, allora $A\cap B=\emptyset$ allora $P(A\cup B)=P(A)+P(B)$, ma essendo $0.4+0.8=1.2>1$ allora $A\cap B\neq\emptyset$
:::

`r punti_p()` Cosa significa che la funzione di ripartizione è continua a destra?

### Esercizio 3 



`r punti_p(nex=T)` Un'urna 3 premi da $\mbox{0}$ euro, 2 premi da $\mbox{1}$ euro e un premio da $\mbox{2}$ euro.
Si estrae 100 volte con reintroduzione. 
Qual è la probabilità di vincere più di 60 euro?

:::{.sol data-latex=""}

```{r 2024-45}
n <- 100
mx <- sum(0:2*c(3,2,1)/6)
vx <- sum((0:2)^2*c(3,2,1)/6)-mx^2
stat_(rep(0:2,times=c(3,2,1)),semp = T)
tlc("somma",60,verso = ">",mu = mx,s2 = vx,n = n)
```
:::

### Esercizio 4 


  
`r punti_p(nex=T)` (**Punti 3**) Si consideri il modello normale $X\sim N(\mu,\sigma^2)$. Sia $\hat\mu$ lo stimatore di massima verosimiglianza per $\mu$

$$
  \hat\mu = \frac 1n \sum_{i=1}^n X_i
$$

Dimostrare la consistenza di $\hat\mu$.

`r punti_p()` Definire lo Standard Error di uno stimatore.

`r punti_p()` Definire la significatività di un test.

```{r 2024-46}
tabella <- matrix(c(45, 35, 20, 25, 30, 45, 10, 15, 25), nrow = 3, ncol = 3, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(t(tabella))$p.value, digits = 4, nsmall = 4)

```

`r punti_p()` Un sociologo sta conducendo uno studio sull'associazione tra il livello di istruzione e il comportamento di voto. Ha somministrato un questionario a `r n` partecipanti, chiedendo loro di indicare il proprio livello di istruzione (Basso, Medio, Alto) e il comportamento di voto (Regolarmente, Occasionalmente, Mai). L'obiettivo è determinare se c'è un'associazione significativa tra il livello di istruzione e il comportamento di voto.

```{r 2024-47}

# Assegnazione dei nomi alle righe e alle colonne
rownames(tabella) <- c("Basso", "Medio", "Alto")
colnames(tabella) <- c("Regolarmente", "Occasionalmente", "Mai")

tabl(t(tabella)) %>%
  kable_styling(full_width = F) %>%
  kable_paper(full_width = F) %>%
  pack_rows("Comportamento di Voto", 1, 3) %>%
  add_header_above(c(" " = 1, "Livello di Istruzione" = 3))

# dat_print <- chi_print(dat = tabella,nome_x =  c("Basso", "Medio", "Alto"),nome_y =  c("Regolarmente", "Occasionalmente", "Mai"))[[2]]
# tabl(dat_print, digits = 4) %>%
#   column_spec(column = 1, bold = T)

```

Eseguito il test del $\chi^2$ per verificare l'indipendenza tra il livello di istruzione e il comportamento di voto, il sociologo ottiene un $p_\text{value}=`r pval`$. Quali conclusioni può trarne?


### Esercizio 5


```{r 2024-48}
set.seed(9)
n <- 50
x <- round(runif(n = n,min = 8,20),0) # Anni di studio
y <- round(abs(2.1*x + rnorm(n, 0, 5)) + 12) # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di \(n=`r n`\) individui, sono stati analizzati il livello di istruzione (in anni di studio, \(X\)) e il reddito annuale (in migliaia di euro, \(Y\)). 
Si osservano le seguenti statistiche:
, $\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r punti_p(nex=T)`  Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r 2024-3,,results='asis'}
calcolo_beta()
residuo(x = x[3],y = y[3])
```
:::

`r punti_p()` Qual è la percentuale di varianza spiegata dal modello?


`r punti_p()` Definire i punti influenti.

`r punti_p()` Se in un modello di regressione $r=-1$ cosa significa?

`r punti_p()` Se in un modello di regressione $r=0.55$, $\hat\sigma_X=0.9$ e $\hat\beta_1=1.5$, quanto varrà
$\hat\sigma_Y$, la standard deviation di $Y$?

`r punti_p()` Testare l'ipotesi che $\beta_1$ sia uguale a zero, contro l'alternativa che sia diverso per diversi livelli di significatività e dare una valutazione approssimativa del $p$-value (ad esempio il $p$-value è minore di 0.001, compreso tra 0.05 e tra 0.01, ecc.).

:::{.sol data-latex=""}
```{r 2024-49}
ttest_beta(1,0,SE = T)
```
:::




## Prova di Statistica 2024/06/03-2


### Esercizio 1

```{r 2024-50}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2024-51}

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- c(0,1.5,3,8,20)
nnn  <- c( 10,100,110, 50)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(x = stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Milano è stato rilevata la spesa annua per le vacanze (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze relative:

```{r 2024-52}
kable(dat3[,c(1,2,4)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

```

`r punti_p(start=T)`  Individuare l'intervallo modale. 

:::{.sol data-latex=""}
```{r 2024-53}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r punti_p()` Quante famiglie investono più di 4 mila euro all'anno? 

:::{.sol data-latex=""}
```{r 2024-54}
F_print(x = 4,verso = ">")
```
:::  

`r punti_p()` Che relazione dobbiamo aspettarci tra media,  mediana e moda? 

`r punti_p()` La spesa media è pari a $`r mean(samp)`$, mentre la varianza è pari a $`r s2c(samp)`$.
Se ogni famiglia aumentasse la propria spesa del 2%, quanto varrebbero la media e la varianza dei dati così trasformati?

:::{.sol data-latex=""}
\[
\bar y = `r 1.02*mean(samp)`\qquad \sigma^2 = `r (1.02)^2*s2c(samp)`
\]
:::  



### Esercizio 2 


`r punti_p(nex=T)`  Sia $X$ numero settimanale di pratiche inevase dall'ufficio provinciale, si assume $X\sim\text{Pois}(3.5)$. Calcolare la probabilità che $X\geq 3$.

:::{.sol data-latex=""}
```{r 2024-4,,results='asis'}
pois_dis(x1 = 3,ll = 3.5,verso = "\\geq")
```
:::  

`r punti_p()` Sia $Y$ numero settimanale di pratiche inevase dall'ufficio comunale, si assume $Y\sim\text{Pois}(2)$ e si assume $X$ indipendente da $Y$. Calcolare la probabilità che $X+Y=5$.

:::{.sol data-latex=""}
```{r 2024-5,,results='asis'}
pois_dis(x1 = 5,ll = 3.5+2,sing = T)
```
:::  

`r punti_p()` Se $P(A)=0.4$ e $P(B)=0.4$, $A$ e $B$ possono essere incompatibili? Perché?

`r punti_p()` Sia $X$ una variabile casuale e sia $F$ la sa funzione di ripartizione. Siano $a$ e $b$ due numeri reali, $a<b$, esprimere
\[
P(a<X\leq b)
\]
in termini di $F$.

### Esercizio 3 



`r punti_p(nex=T)` Un'urna 4 premi da $\mbox{0}$ euro, 3 premi da $\mbox{1}$ euro e 2 premi da $\mbox{2}$ euro.
Si estrae 50 volte con reintroduzione. 
Qual è la probabilità che la media delle vincite ottenute sia minore di 0.6 euro?

:::{.sol data-latex=""}
```{r 2024-55}
n <- 50
mx <- sum(0:2*4:2/9)
vx <- sum((0:2)^2*4:2/9)-mx^2
urn <- c(0,0,0,0,1,1,1,2,2)
stat_(urn,semp = T)
tlc("media",0.6,verso = "<",mu = mx,s2 = vx,n = n)
```
:::

### Esercizio 4 


  
`r punti_p(nex=T)` (**Punti 3**) Si consideri il modello di Bernoulli $X\sim\text{Ber}(\pi)$. Sia $\hat\pi$ lo stimatore di massima verosimiglianza per $\pi$

$$
  \hat\pi = \frac 1n \sum_{i=1}^n X_i
$$

Dimostrare la consistenza di $\hat\pi$.

`r punti_p()` Che differenza c'è tra lo Standard Error di uno stimatore e la Deviazione Standard del campione?

`r punti_p()` Definire la potenza di un test.

```{r 2024-56}
tabella <- matrix(c(30, 20, 10, 40, 35, 25), nrow = 3, ncol = 2, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(tabella)$p.value, digits = 4, nsmall = 4)

# Assegnazione dei nomi alle righe e alle colonne
rownames(tabella) <- c("Basso", "Medio", "Alto")
colnames(tabella) <- c("Sì", "No")
```

`r punti_p()` Un economista sta conducendo uno studio sull'associazione tra il livello di istruzione e il possesso di una casa. Ha somministrato un questionario a `r n` partecipanti, chiedendo loro di indicare il proprio livello di istruzione (Basso, Medio, Alto) e se possiedono una casa (Sì, No). L'obiettivo è determinare se c'è un'associazione significativa tra il livello di istruzione e il possesso di una casa.

```{r 2024-57}
tabella <- matrix(c(30, 20, 10, 40, 35, 25), nrow = 3, ncol = 2, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(t(tabella))$p.value, digits = 4, nsmall = 4)

# Assegnazione dei nomi alle righe e alle colonne
rownames(tabella) <- c("Basso", "Medio", "Alto")
colnames(tabella) <- c("Sì", "No")

tabl(t(tabella)) %>%
  kable_styling(full_width = F) %>%
  kable_paper(full_width = F) %>%
  pack_rows("Possesso \n di Casa", 1, 2) %>%
  add_header_above(c(" " = 1, "Livello di Istruzione" = 3))

# t_p <- chi_print(dat = tabella,nome_y =  c("Basso", "Medio", "Alto"),nome_x =  c("Sì","No"))[[2]]
# tabl(t_p, digits = 4) %>%
#   column_spec(column = 1, bold = T)

```

Eseguito il test del $\chi^2$ per verificare l'indipendenza tra il livello di istruzione e il possesso di una casa, l'economista ottiene un $p_\text{value}=`r pval`$. Quali conclusioni può trarne?

### Esercizio 5


```{r 2024-58}
set.seed(90)
n <- 50
x <- round(runif(n = n,min = 8,20),0) # Anni di studio
y <- round(abs(-1.1*x + rnorm(n, 0, 5)) + 30) # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di \(n=`r n`\) individui, sono stati analizzati il livello di istruzione (in anni di studio, \(X\)) e la propensione a credere in teorie del complotto (in opportuna scala, \(Y\)). 
Si osservano le seguenti statistiche:
, $\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r punti_p(nex=T)`  Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r 2024-6,,results='asis'}
calcolo_beta()
residuo(x = x[3],y = y[3])
```
:::

`r punti_p()` Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r 2024-7,,results='asis'}
R2()
```
:::

`r punti_p()` Definire i punti di leva.

`r punti_p()` Se in un modello di regressione $r=+1$ cosa significa?

`r punti_p()` Se in un modello di regressione $r<0$ è possibile che $\hat\beta_1>0$? Perché?

`r punti_p()` Testare l'ipotesi che $\beta_0$ sia uguale a 35, contro l'alternativa che sia minore per diversi livelli di significatività e dare una valutazione approssimativa del $p$-value (ad esempio il $p$-value è minore di 0.0005, compreso tra 0.05 e  0.01, ecc.).

:::{.sol data-latex=""}
```{r 2024-59}
ttest_beta(0,35,h1 = "<",SE = T)
```
:::




## Prova di Statistica 2024/06/03-3



### Esercizio 1

```{r 2024-60}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2024-61}

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- c(0,1.5,3,8,20)
nnn  <- c( 50,100,110, 50)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(x = stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Milano è stato rilevata la spesa annua per le vacanze (espresso in migliaia di euro). Qui di seguito la distribuzione delle densità percentuali:

```{r 2024-62}
kable(dat3[,c(1,2,6)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

```

`r punti_p(start=T)`  Calcolare il valore approssimativo della mediana. 

:::{.sol data-latex=""}
```{r 2024-63}
percentile()
histp(T)
draw_dist(dist = H.int,z1 = 4,z2 = 10)
```
:::

`r punti_p()` Quante famiglie spendono tra 4 mila e 10 mila euro l'anno? 

:::{.sol data-latex=""}
```{r 2024-64}
F_print(x = 4,x2 = 10,verso = F)
```
:::  


`r punti_p()` Che relazione dobbiamo aspettarci tra media,  mediana e moda? 

`r punti_p()` La spesa media è pari a $`r mean(samp)`$, mentre la varianza è pari a $`r s2c(samp)`$.
Se ogni famiglia diminuisse la propria spesa del 2%, quanto varrebbero la media e la varianza dei dati così trasformati?

:::{.sol data-latex=""}
\[
\bar y = `r 0.98*mean(samp)`\qquad \sigma^2 = `r (0.98)^2*s2c(samp)`
\]
:::  


### Esercizio 2 


`r punti_p(nex=T)`  Sia $X\sim N(5,2)$ sia $A=\{X>4\}$ e $B=\{X<6\}$. Calcolare $P(A\cap B)$.

:::{.sol data-latex=""}
```{r 2024-8,,results='asis'}
norm_int(x1 = 4,x2 = 6,verso = NULL,5,2)
```
:::  

`r punti_p()` Sia $Y\sim N(3,1)$, $X$ e $Y$ indipendenti, posto $W=X-Y$, calcolare $P(W<0)$.

:::{.sol data-latex=""}
```{r 2024-9,,results='asis'}
norm_int(x1 = 0,verso = "<",mm = 5-3,ss = 2+1)
```
:::  

`r punti_p()` Se $P(A)=0.4$ e $P(B)=0.6$, in che relazione sono $A$ e $B$?


`r punti_p()` Sia $X$ una variabile casuale e sia $F$ la sua funzione di ripartizione. Cosa significa che $F$ è una funzione crescente?


### Esercizio 3 



`r punti_p(nex=T)` Un'urna 4 premi da $\mbox{0}$ euro, 2 premi da $\mbox{1}$ euro.
Si estrae 50 volte con reintroduzione. 

Qual è la probabilità che la la vincita totale sia maggiore di 50?

:::{.sol data-latex=""}

```{r 2024-65}
n <- 50
mx <- 2/6

tlc("somma",50,verso = ">",mu = mx,n = n)
```
:::

### Esercizio 4 


  
`r punti_p(nex=T)` (**Punti 3**) Si consideri il modello binomiale $X\sim\text{Pois}(\lambda)$. Sia $\hat\lambda$ lo stimatore di massima verosimiglianza per $\mu$

$$
  \hat\lambda = \frac 1n \sum_{i=1}^n X_i
$$

Dimostrare la consistenza di $\hat\lambda$.

`r punti_p()` Che differenza c'è tra lo Standard Error di uno stimatore e la Deviazione Standard di popolazione?

`r punti_p()` Definire gli errori di primo e di secondo tipo.


```{r 2024-66}
# Definizione dei dati osservati
observed <- c(5, 8, 12, 7, 6, 4, 3)
total <- sum(observed)
lambda <- sum((0:(length(observed) - 1)) * observed) / total
expected <- dpois(0:(length(observed) - 1), lambda) * total
chisq_result <- chisq.test(observed, p = expected / sum(expected))
pval_poisson <- format(chisq_result$p.value, digits = 4, nsmall = 4)
```


`r punti_p()` Un biologo sta studiando il numero di cellule di una certa specie osservate in campioni di terreno. Ha raccolto dati sul numero di cellule in `r total` campioni. I dati osservati sono riportati nella tabella seguente. L'obiettivo è determinare se i dati seguono una distribuzione di Poisson.

```{r 2024-67}
# Definizione dei dati osservati
observed <- c(5, 8, 12, 7, 6, 4, 3)
total <- sum(observed)
lambda <- sum((0:(length(observed) - 1)) * observed) / total
expected <- dpois(0:(length(observed) - 1), lambda) * total
chisq_result <- chisq.test(observed, p = expected / sum(expected))
pval_poisson <- format(chisq_result$p.value, digits = 4, nsmall = 4)

# Creazione della tabella
dati <- data.frame(
  Numero = 0:(length(observed) - 1),
  Osservati = observed,
  Attesi = round(expected, 2)
)


 kable(dati) %>%
   kable_styling(full_width = F, latex_options = "HOLD_position")

```

Eseguito il test del $\chi^2$ per verificare la conformità dei dati alla distribuzione di Poisson, il biologo ottiene un $p_\text{value}=`r pval_poisson`$. Il modello Poisson è adeguato?

### Esercizio 5


`r punti_p(nex=T)` (**Punti 12**) In un'indagine sull'opinione sul reddito di inclusione sono stati intervistate 150 persone che vivono al nord e 180 che vivono al sud: 60 su 150 che vivono al nord sono favorevoli al reddito di cittadinanza mentre 95 su 180 che vivono al sud sono favorevoli. 

Testare l'ipotesi che la proporzione di persone favorevoli al reddito di cittadinanza che vivono al sud sia uguale a quelle di quelli che vivono al nord, contro l'alternativa che siano diverse.

`r punti_p()` Calcolare e discutere il $p$-value del test precedente.

:::{.sol data-latex=""}
```{r 2024-68}
s1 <- 60
n1 <- 150
s2 <- 95
n2 <- 180
h1 <- "\\neq"
alpha <- 0.01
a <- "N"
b<- "S"
um <- ""
ztest_2c_pi(s1 = s1,s2 = s2,n1 = n1,n2 = n2,h1 = h1,a = a,b = b)
```
:::


### Esercizio 6


```{r 2024-69}
set.seed(12)
n <- 50
x <- round(runif(n = n,min = 8,20),0) # Anni di studio
y <- round(abs(1.1*x + rnorm(n, 0, 2.25)) + 0) # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di \(n=`r n`\) individui, sono stati analizzati il livello di istruzione (in anni di studio, \(X\)) e il numero di libri letti l'anno (\(Y\)).
Si osservano le seguenti statistiche:
, $\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r punti_p(nex=T)`  Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r 2024-10,,results='asis'}
calcolo_beta()
residuo(x = x[3],y = y[3])
```
:::


`r punti_p()` Dare un'interpretazione dei parametri di regressione stimati.

`r punti_p()` Definire gli outliers.

`r punti_p()` Se in un modello di regressione $r=0$ cosa significa?

`r punti_p()` Se in un modello di regressione $r=0.55$, $\hat\sigma_Y=0.9$ e $\hat\beta_1=1.5$, quanto varrà
$\hat\sigma_X$, la standard deviation di $X$?


## Prova di Statistica 2024/06/21-1




### Esercizio 1

```{r 2024-70}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2024-71}

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 250      # ampiezza campionaria

brk  <- c(0,1.5,3,8,20)
nnn  <- c( 200,100,80, 50)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(x = stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie dell'Emilia-Romagna sono stati rilevati i consumi annui in beni tecnologici (dati espressi in migliaia di euro). Qui di seguito la distribuzione delle frequenze cumulate:

```{r 2024-72}
kable(dat3[,c(1,2,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

```

`r punti_p(start=T)`  Disegnare l'istogramma di densità percentuale. 

:::{.sol data-latex=""}
```{r 2024-73}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r punti_p()` Quante famiglie spendono meno di 5 mila euro all'anno? 

:::{.sol data-latex=""}
```{r 2024-74}
F_print(x = 5,verso = "<")
```
:::  


`r punti_p()` Che relazione dobbiamo aspettarci tra media,  mediana e moda? 

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$, mentre la SD è pari a $SD=`r sd(samp)`$.
Se ogni famiglia spendesse 2 mila euro in più all'anno, quanto varrebbero la media e la SD dei dati trasformati?

### Esercizio 2 


`r punti_p(nex=T)`  Si consideri un'urna che ha una pallina bianche e due nere. Si estrae 4 volte con reinserimento. Sia $X$ la variabile casuale che conta il numero di bianche su 4 estrazioni. Calcolare la probabilità che $X\leq 2$.

:::{.sol data-latex=""}
```{r 2024-11,,results='asis'}
bin_dis(x1 = 2,n = 4,pp = 1/3,comp = F)
```
:::  

`r punti_p()` Sia $X$ la VC del punto precedente e sia $Y\sim N(0,1)$, $X$ ed $Y$ indipendenti. Considerato $A=\{X\leq 2\}$, $B=\{Y<1\}$, calcolare $P(A\cup B)$.

:::{.sol data-latex=""}
```{r 2024-12,,results='asis'}
pa <- pbinom(2,4,1/3)
pb <- pnorm(1)
p_aub(pa,pb)
```
:::  


`r punti_p()` Se $A$ e $B$, sono due eventi tali che $P(B|A)=1$, determinare $A\cap B$.

:::{.sol data-latex=""}
Se $P(B|A)=P(A\cap B)/P(A)$ e $P(B|A)=P(A\cap B)/P(A)=1$ se e solo se $P(A\cap B)=P(A)$ e quindi $A\cap B = A$.
:::

`r punti_p()` Sia $X$ una Bernoulli di parametro $\pi$, $X\sim\text{Ber}(\pi)$ e sia $F$ la sua funzione di ripartizione. Se $F(0)=0.6$, quanto vale $\pi$?

### Esercizio 3 



`r punti_p(nex=T)` Un'urna contiene 6 premi da $\mbox{0}$ euro, 3 premi da $\mbox{1}$ euro e un premio da $\mbox{2}$ euro.
Si estrae 100 volte con reintroduzione. 
Qual è la probabilità di vincere più di 55 euro?

:::{.sol data-latex=""}

```{r 2024-75}
n <- 100
mx <- sum(0:2*c(6,3,1)/10)
vx <- sum((0:2)^2*c(6,3,1)/10)-mx^2
stat_(rep(0:2,times=c(6,3,1)),semp = T)
tlc("somma",55,verso = ">",mu = mx,s2 = vx,n = n)
```
:::

### Esercizio 4 


  
`r punti_p(nex=T)` (**Punti 3**) Si consideri il modello normale $X\sim N(\mu,\sigma^2)$. Sia $\hat\mu$ lo stimatore di massima verosimiglianza per $\mu$

$$
  \hat\mu = \frac 1n \sum_{i=1}^n X_i
$$

Ricavare il suo _Standard Error_ teorico e quello stimato.

`r punti_p()` Se $\hat\theta$ è lo stimatore di massima verosimiglianza 
per $\theta$, con $E(\hat\theta)=\theta$ e $V(\hat\theta)=I^{-1}(\theta)$. 
Com'è distribuito asintoticamente $\hat\theta$?

`r punti_p()` Definire la significatività di un test.

```{r 2024-76}
tabella <- matrix(c(15, 20, 25, 25, 30, 25, 35, 30, 15), nrow = 3, ncol = 3, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(t(tabella))$p.value, digits = 4, nsmall = 4)
```

`r punti_p()` Un nutrizionista sta conducendo uno studio sull'associazione tra il tipo di dieta e lo stato di salute. Ha somministrato un questionario a `r n` partecipanti, chiedendo loro di indicare il proprio stato di salute  Ottimo, Buono, Scarso e il tipo di dieta seguito (Vegano, Vegetariano, Onnivoro). L'obiettivo è determinare se c'è un'associazione tra il tipo di dieta e lo stato di salute.

```{r 2024-77}

# Assegnazione dei nomi alle righe e alle colonne
colnames(tabella) <-  c("Ottimo", "Buono", "Scarso")
rownames(tabella) <- c("Vegano", "Vegetariano", "Onnivoro")

tabl((tabella)) %>%
  kable_styling(full_width = F) %>%
  kable_paper(full_width = F) %>%
  pack_rows("Tipo di Dieta", 1, 3) %>%
  add_header_above(c(" " = 1, "Stato di Salute" = 3))


```

Eseguito il test del $\chi^2$ per verificare l'indipendenza tra il livello di istruzione e il comportamento di voto, il sociologo ottiene un $p_\text{value}=`r pval`$. Quali conclusioni può trarne?


### Esercizio 5


```{r 2024-78}
set.seed(9)
n <- 25
sig <- 2
x <- round(runif(n = n,min = 0,20),2) # reddito
y <- round(0.9+0.2*x+rnorm(n,0,sig),2) # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 2))
```

In uno studio sui consumi, in un campione di \(n=`r n`\) individui, sono stati analizzati il reddito  (in migliaia di euro, \(X\)) e il consumo (in migliaia di euro, \(Y\)).

Si osservano le seguenti statistiche:
$\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r punti_p(nex=T)`  Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r 2024-13,,results='asis'}
calcolo_beta()
residuo(x = x[3],y = y[3])
```
:::

`r punti_p()` Qual è la percentuale di varianza spiegata dal modello?

:::{.sol data-latex=""}
```{r 2024-14,,results='asis'}
R2()
```
:::


`r punti_p()` perché la previsione per $x=`r round(mx)`$ è più affidabile di quella per $x=`r round(10*mx)`$.

`r punti_p()` Se in un modello di regressione $r=-1$ cosa significa?

`r punti_p()` Se in un modello di regressione $r=0.75$, $\hat\sigma_X=0.8$ e $\hat\beta_1=1.2$, calcolare
$\hat\alpha_1$, la stima del coefficiente angolare del modello

$$
X_i = \alpha_0+\alpha_1 Y_i + \delta_i, \qquad E(\delta_i)=0; V(\delta_i)=\sigma_\delta^2
$$

dove la $X$ è spiegata dalla $Y$.

:::{.sol data-latex=""}
Per trovare la stima del coefficiente angolare \(\hat\alpha_1\), possiamo usare la relazione tra il coefficiente di correlazione \(r\), la deviazione standard di \(X\) (\(\hat\sigma_X\)) e la stima del coefficiente di regressione \(\hat\beta_1\).

La formula per il coefficiente di regressione \(\hat\beta_1\) in termini di \(r\), \(\hat\sigma_X\) e \(\hat\sigma_Y\) è:

\[
\hat\beta_1 = r \cdot \frac{\hat\sigma_X}{\hat\sigma_Y}
\]

Dove \(\hat\sigma_Y\) è la deviazione standard di \(Y\). Dato che abbiamo \(\hat\beta_1 = 1.2\), \(r = 0.75\) e \(\hat\sigma_X = 0.8\), possiamo isolare \(\hat\sigma_Y\) nella formula:

\[
1.2 = 0.75 \cdot \frac{0.8}{\hat\sigma_Y}
\]

Da cui:

\[
\hat\sigma_Y = 0.75 \cdot 0.8 / 1.2
\]

Calcolando il valore:

```{r 2024-79}
sigma_X <- 0.8
beta_1 <- 1.2
r <- 0.75

sigma_Y <- (r * sigma_X) / beta_1

```

\[
\hat\sigma_Y \approx `r sigma_Y`
\]

Ora possiamo trovare \(\hat\alpha_1\) usando il valore di \(\hat\sigma_Y\):


```{r 2024-80}
alpha_1 <- r * (sigma_X / sigma_Y)
```

\begin{eqnarray*}
   \hat\alpha_1 &=& r \cdot \frac{\hat\sigma_X}{\hat\sigma_Y}\\
               &\approx& `r alpha_1`
\end{eqnarray*}
  

Pertanto, la stima del coefficiente angolare \(\hat\alpha_1\) è approssimativamente `r alpha_1`.
:::


`r punti_p()` Testare l'ipotesi che $\beta_1$ sia uguale a zero, contro l'alternativa che sia diverso per $\alpha=0.1,0.05,0.01,0.001$ e dare una valutazione approssimativa del $p_\text{value}$ (ad esempio il $p_\text{value}$ è minore di 0.001, compreso tra 0.05 e tra 0.01, ecc.).

:::{.sol data-latex=""}
```{r 2024-81}
ttest_beta(1,0,SE = T)
```
:::




## Prova di Statistica 2024/06/21-2




### Esercizio 1

```{r 2024-82}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2024-83}

# Basic settings
set.seed(10)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- c(0,1.5,3,5,20)
nnn  <- c( 30,100,110, 50)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n,rand = F)
  
ls2e(x = stat_base(samp,brk))

n_ER <- n 
n_L <- n_ER + 20 
n_V <- n_ER - 10 
set.seed(10) 
x_ER <- mean(samp) 
x_L <- mean(samp) + rnorm(1, 0, sd(samp))
x_V <- mean(samp) + rnorm(1, 0, sd(samp))
# Calcolo della media aggregata
x_agg <- (n_ER * x_ER + n_L * x_L + n_V * x_V) / (n_ER + n_L + n_V)

```

Su un campione di $`r n`$ famiglie dell'Emilia-Romagna sono stati rilevati i consumi annui in beni tecnologici (dai espressi in migliaia di euro). Qui di seguito la distribuzione delle frequenze relative:

```{r 2024-84}
kable(dat3[,c(1,2,4)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

```

`r punti_p(start=T)`  Individuare l'intervallo modale. 

:::{.sol data-latex=""}
```{r 2024-85}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r punti_p()` Quante famiglie spendono più del 25-esimo percentile $x_{0.25}$? 

:::{.sol data-latex=""}
```{r 2024-86}
F_print(x = Q.int(.25),verso = ">")
```
:::  

`r punti_p()` La media è pari a $\bar x=`r p(mean(samp),2)`$, senza disegnare l'istogramma, che forma distributiva dobbiamo aspettarci?

`r punti_p()` `r round_all(2)`La spesa media della regione Emilia-Romagna, calcolata su `r n_ER` famiglie è pari $\bar x_{ER}=`r x_ER`$, quella della Lombardia, calcolata su `r n_L` famiglie è pari $\bar x_{L}=`r x_L`$, mentre quella del Veneto,  calcolata su `r n_V` famiglie è pari $\bar x_{V}=`r x_V`$. Qual è la spesa media complessiva delle tre regioni?

:::{.sol data-latex=""}
Per trovare la spesa media delle tre regioni aggregate, dobbiamo considerare sia le medie delle singole regioni sia il numero di famiglie su cui sono state calcolate. La formula per la media aggregata \(\bar{x}_{agg}\) è:

\begin{eqnarray*}
\bar{x}_{agg}    &=&  \frac{n_{ER} \bar{x}_{ER} + n_{L} \bar{x}_{L} + n_{V} \bar{x}_{V}}{n_{ER} + n_{L} + n_{V}}\\
&=& \frac{`r n_ER`\cdot`r x_ER`+`r n_L`\cdot`r x_L`+`r n_V`\cdot`r x_V`}{`r n_ER`+`r n_L`+`r n_V`}\\
&=& `r x_agg`
\end{eqnarray*}
  

Dove:

- \(n_{ER}\) è il numero di famiglie in Emilia-Romagna
- \(n_{L}\) è il numero di famiglie in Lombardia
- \(n_{V}\) è il numero di famiglie in Veneto
- \(\bar{x}_{ER}\), \(\bar{x}_{L}\), \(\bar{x}_{V}\) sono le spese medie delle rispettive regioni

:::  



### Esercizio 2 


`r punti_p(nex=T)`  Sia $X$ il numero di telefonate in arrivo ad un centralino di emergenza, si assume $X\sim\text{Pois}(1.2)$. Calcolare la probabilità che $X\geq 2$.

:::{.sol data-latex=""}
```{r 2024-15,,results='asis'}
pois_dis(x1 = 2,ll = 1.2,verso = "\\geq")
```
:::  

`r punti_p()` Siano $X\sim\text{Pois}(1.2)$ e $Y\sim\text{Binom}(n=2,\pi=0.5)$, $X$ e $Y$ indipendenti, posto $A=\{X\geq 2\}$, $B=\{Y=0\}$, calcolare $P(A\cup B)$.

:::{.sol data-latex=""}
```{r 2024-16,,results='asis'}
pa <- 1-sum(dpois(0:1,1.2))
pb <- .5^2
```
\begin{eqnarray*}
  P(A) &=&  `r pa`\\
  P(B) &=& 0.5^2 = `r pb`
\end{eqnarray*}
  
```{r 2024-87}
p_aub(pa = pa,pb = pb)
```
:::  

`r punti_p()` Se $A$ e $B$ sono due eventi diversi da $\emptyset$, se
$P(A|B)=0$ in che relazione sono $A$ e $B$?


`r punti_p()` Sia $X$ una variabile casuale con supporto $S_X=c\{-1,0,2\}$ e con funzione di probabilità
$$
f(x)=\begin{cases}
\frac 25, &\text{ se $x=-1$}\\
\frac 25, &\text{ se $x=\phantom{-} 0$}\\
\frac 15, &\text{ se $x=\phantom{-} 2$}\\
\end{cases}
$$
Disegnare le sua funzione di ripartizione, $F(x)$, nell'intervallo $-2\leq x\leq 3$.

:::{.sol data-latex=""}
```{r 2024-88}
x <- c(-2,-1,0,2,3)
px <- c(0,c(2,2,1)/5,0)
plot(x,pbinom(x,2,.5),type="n",ylab="F(x)",axes = F)
axis(1,x)
axis(2,cumsum(px),las=2)
segments(x[1:4],cumsum(px)[1:4],x[2:5],cumsum(px)[1:4])
segments(x[2:4],cumsum(px)[1:3],x[2:4],cumsum(px)[2:4],lty=2)
points(x[2:4],cumsum(px)[1:3])
points(x[2:4],cumsum(px)[2:4],pch=16)
```
:::

### Esercizio 3 



`r punti_p(nex=T)` Un'urna 4 premi da $\mbox{0}$ euro, 1 premio da $\mbox{2}$ euro.
Si estrae 50 volte con reintroduzione. 
Qual è la probabilità che la proporzione di premi da 2 euro sia compresa tra 0.20 e 0.23.

:::{.sol data-latex=""}
```{r 2024-89}
n <- 50
mx <- sum(0:2*4:2/9)
vx <- sum((0:2)^2*4:2/9)-mx^2
urn <- c(0,0,0,0,1,1,1,2,2)
stat_(urn,semp = T)
tlc("prop",1/5,x2 = .23,verso = NULL,mu = 1/5,n = n)
```
:::

### Esercizio 4 


  
`r punti_p(nex=T)` (**Punti 3**) Si consideri il modello di Bernoulli $X\sim\text{Ber}(\pi)$. Sia $\hat\pi$ lo stimatore di massima verosimiglianza per $\pi$

$$
  \hat\pi = \frac 1n \sum_{i=1}^n X_i
$$

Ricavare il suo _Standard Error_ teorico e quello stimato.

`r punti_p()` Cosa significa che lo stimatore di massima verosimiglianza è invariante alle trasformazioni monotone invertibili?

`r punti_p()` Siano $T_1$ e $T_2$ due test per lo stesso sistema di ipotesi con la stessa significatività $\alpha$, sia $\beta_1=0.23$ la probabilità di errore di secondo tipo del test $T_1$ e $\beta_2=0.18$ la probabilità di errore di secondo tipo del test $T_2$. Quale dei due test è più potente?

`r punti_p()`  In un'indagine sull'opinione sul reddito di inclusione sono stati intervistate 150 persone che vivono al nord e 180 che vivono al sud: 60 su 150 che vivono al nord sono favorevoli al reddito di cittadinanza mentre 95 su 180 che vivono al sud sono favorevoli. 
Messo a test

$$
\begin{cases}
   H_0: \pi_\text{N} = \pi_\text{S} \\
   H_1: \pi_\text{N} \neq \pi_\text{S} 
\end{cases}
$$

è risultato  $p_{\text{value}} =0.0206$. Cosa possiamo concludere?


### Esercizio 5


```{r 2024-90}
set.seed(9)
n <- 50
x <- round(runif(n = n,min = 8,20),0) # Anni di studio
y <- round(100 -.2*x^2.5 + rnorm(n, 0, 20),2) # Reddito annuo in migliaia di euro
y <- (y - min(y))/(max(y)-min(y))*10
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di \(n=`r n`\) individui, sono stati analizzati il livello di istruzione (in anni di studio, \(X\)) e la propensione a credere in teorie del complotto (in opportuna scala, \(Y\)). 

Si osservano le seguenti statistiche:
$\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r punti_p(nex=T)`  Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r 2024-17,,results='asis'}
calcolo_beta()
residuo(x = x[3],y = y[3])
```
:::

`r punti_p()` Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r 2024-18,,results='asis'}
R2()
```
:::

`r punti_p()` Interpretare il diagramma dei residui.

```{r 2024-19,, fig.width=5, fig.height=3.5}
par(mar=c(4,4,0,2),cex=.8)
plot(x, es, ylab=expression(hat(epsilon)), pch=16, cex=.5, axes=F)
axis(1, cex=1)
axis(2, cex=1)
abline(h=0, lty=2)
```

:::{.sol data-latex=""}
```{r 2024-20,,results='asis'}
plot(x, es, ylab=expression(hat(epsilon)), pch=16, cex=.5, axes=F)
axis(1, cex=1)
axis(2, cex=1)
abline(h=0, lty=2)
spline_pat(x,es,df1 = 5,df2 = 4)
```
:::

`r punti_p()` Se in un modello di regressione $r^2=1$ cosa significa?

`r punti_p()` Se in un modello di regressione $r<0$ che segno avrà $\hat\beta_1$? Perché?

`r punti_p()` Testare l'ipotesi che $\beta_0$ sia uguale a 16.4, contro l'alternativa che sia minore per $\alpha=0.1,0.05,0.01,0.001$ e dare una valutazione approssimativa del $p_\text{value}$ (ad esempio il $p_\text{value}$ è minore di 0.001, compreso tra 0.05 e tra 0.01, ecc.).

:::{.sol data-latex=""}
```{r 2024-91}
ttest_beta(0,16.4,h1 = "<",SE = T)
```
:::




## Prova di Statistica 2024/06/21-3




### Esercizio 1

```{r 2024-92}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2024-93}

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- c(0,1.5,3,8,20)
nnn  <- c( 50,100,110, 20)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(x = stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie dell'Emilia-Romagna sono stati rilevati i consumi annui in beni tecnologici (dai espressi in migliaia di euro). Qui di seguito la distribuzione delle densità percentuali:

```{r 2024-94}
kable(dat3[,c(1,2,6)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

```

`r punti_p(start=T)`  Calcolare il valore approssimativo della mediana. 

:::{.sol data-latex=""}
```{r 2024-95}
percentile()
histp(T)
draw_dist(dist = H.int,z1 = 4,z2 = 10)
```
:::

`r punti_p()` Qual è la percentuale di famiglie spendono più del 55-esimo percentile $x_{0.55}$? 

:::{.sol data-latex=""}
```{r 2024-96}
F_print(x = Q.int(.55),verso = ">")
```
:::  

`r punti_p()` La media è pari a $\bar x=`r p(mean(samp),2)`$, senza disegnare l'istogramma, che forma distributiva dobbiamo aspettarci?

`r punti_p()` La spesa media è pari a $`r mean(samp)`$, mentre la varianza è pari a $`r s2c(samp)`$.
Se ogni famiglia diminuisse la propria spesa del 2%, quanto varrebbero la media e la varianza dei dati così trasformati?

:::{.sol data-latex=""}
\[
\bar y = `r 0.98*mean(samp)`\qquad \sigma^2 = `r (0.98)^2*s2c(samp)`
\]
:::  


### Esercizio 2 


`r punti_p(nex=T)`  Sia $X\sim N(6,0.5)$ e sia $Y\sim N(6,0.5)$, $X$ e $Y$ indipendenti sia $A=\{X>5\}$ e $B=\{Y<7\}$. 
Calcolare $P(A\cup B)$.

:::{.sol data-latex=""}
```{r 2024-21,,results='asis'}
norm_int(x1 =  5,verso = ">",mm =  6,ss = 0.5,vnam = "X")
norm_int(x1 = 7,verso = "<",mm = 6,ss = 0.5,vnam = "Y")
zx <- round((5-6)/sqrt(0.5),2)
zy <- round((7-6)/sqrt(0.5),2)
pa <- pnorm(zx,lower.tail = F)
pb <- pnorm(zy,lower.tail = T)
p_aub(pa,pb)
```
:::  

`r punti_p()` , posto $W=X-Y$, calcolare $P(W<1|W>-1)$.

:::{.sol data-latex=""}
```{r 2024-22,,results='asis'}
pab <- pnorm(1)-pnorm(-1)
pb  <- pnorm(-1,lower.tail = F)
```
$$ 
P(W<1|W>-1)=\frac{P(-1<W<1)}{P(W>-1)}=\frac{`r pab`}{`r pb`}=`r pab/pb`
$$
:::  

`r punti_p()` Se $P(A)=0.4$ e $P(B)=0.7$, è possibile che $A\cap B=\emptyset$? Perché?

:::{.sol data-latex=""}
No perché se fosse $A\cap B=\emptyset$, allora
\begin{eqnarray*}
P(A \cup B)    &=&  P(A) + P(B) - P(A\cap B)\\
               &=&  P(A) + P(B) - P(\emptyset)\\
               &=&  P(A) + P(B) - 0 \\
               &=&  0.4 + 0.7\\
               &=& 1.3 > 1 \qquad\text{impossibile}
\end{eqnarray*}
  
:::

`r punti_p()` Sia $X\sim\text{Binom}(n=2,\pi=0.5)$ e sia $F$ la sua funzione di ripartizione. Disegnare $F(x)$ nell'intervallo $-1\leq x\leq 3$

:::{.sol data-latex=""}
```{r 2024-97}
bin_dis(x1 = 0,n = 2,pp = .5)
bin_dis(x1 = 1,n = 2,pp = .5)
bin_dis(x1 = 2,n = 2,pp = .5)
x <- (-1):3
px <- dbinom(x,2,.5)
plot(x,pbinom(x,2,.5),type="n",ylab="F(x)",axes = F)
axis(1,x)
axis(2,cumsum(px),las=2)
segments(x[1:4],cumsum(px)[1:4],x[2:5],cumsum(px)[1:4])
segments(x[2:4],cumsum(px)[1:3],x[2:4],cumsum(px)[2:4],lty=2)
points(x[2:4],cumsum(px)[1:3])
points(x[2:4],cumsum(px)[2:4],pch=16)
```
:::

### Esercizio 3 



`r punti_p(nex=T)` Un'urna 3 premi da $\mbox{0}$ euro, un premio da $\mbox{1}$ euro.
Si estrae 100 volte con reintroduzione. 

Qual è la probabilità che la la vincita totale sia maggiore di 30?

:::{.sol data-latex=""}

```{r 2024-98}
n <- 100
mx <- 1/4

tlc("somma",30,verso = ">",mu = mx,n = n)
```
:::

### Esercizio 4 


  
`r punti_p(nex=T)` (**Punti 3**) Si consideri il modello binomiale $X\sim\text{Pois}(\lambda)$. Sia $\hat\lambda$ lo stimatore di massima verosimiglianza per $\mu$

$$
  \hat\lambda = \frac 1n \sum_{i=1}^n X_i
$$

Ricavare il suo _Standard Error_ teorico e quello stimato.

`r punti_p()` Che differenza c'è tra lo Standard Error di uno stimatore e la Deviazione Standard di popolazione?

`r punti_p()` Definire gli errori di primo e di secondo tipo e le relative probabilità.

```{r 2024-99}
# Definizione dei dati osservati
observed <- c(13, 5, 10, 10, 8, 7, 4)
total <- sum(observed)
lambda <- sum((0:(length(observed) - 1)) * observed) / total
expected <- dpois(0:(length(observed) - 1), lambda) * total
chisq_result <- chisq.test(observed, p = expected / sum(expected))
pval_poisson <- format(chisq_result$p.value, digits = 4, nsmall = 4)
```

`r punti_p()` Un economista sta studiando il numero di piccole imprese che aprono ogni mese in una certa regione. Ha raccolto dati sul numero di nuove imprese in `r total` mesi. I dati osservati sono riportati nella tabella seguente. L'obiettivo è determinare se i dati seguono una distribuzione di Poisson.

```{r 2024-100}
# Definizione dei dati osservati

# Creazione della tabella
dati <- data.frame(
  Numero = 0:(length(observed) - 1),
  Osservati = observed,
  Attesi = round(expected, 2)
)


kable(t(dati)) %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

```

Eseguito il test del $\chi^2$ per verificare la conformità dei dati alla distribuzione di Poisson, il biologo ottiene un $p_\text{value}=`r pval_poisson`$. Il modello Poisson è adeguato?

### Esercizio 5


```{r 2024-101}
s1 <- 1.1
n1 <- 18
mu1 <- 1.8
mu2 <- 0.8
s2 <- 0.9
n2 <- 21
h1 <- "\\neq"
alpha <- 0.01
a <- "$N$"
b<- "$S$"
```

`r punti_p(nex=T)`  In un'indagine sui consumi in beni alimentari sono stati intervistati 13 nuclei familiari al Nord d'Italia e 15 al Sud.
Per le $n_N=`r n1`$ famiglie del nord si è osservato un consumo medio pari a $\mu_N=`r mu1`$ mila euro con una deviazione standard pari a $\hat\sigma_N=`r s1`$ mila euro, mentre per le $n_S=`r n2`$ famiglie del sud si è osservato un consumo medio pari a $\mu_S=`r mu2`$ mila euro con una deviazione standard pari a $\hat\sigma_S=`r s2`$ mila euro.

Sotto ipotesi di omogeneità, testare l'ipotesi che il consumo medio sia uguale tra nord e sud, contro l'alternativa che sia maggiore al nord,
per $\alpha=0.1,0.05,0.01,0.001$ e dare una valutazione approssimativa del $p_\text{value}$ (ad esempio il $p_\text{value}$ è minore di 0.001, compreso tra 0.05 e tra 0.01, ecc.).


:::{.sol data-latex=""}
```{r 2024-102}
ttest_2c_om(mu1 = mu1,mu2 = mu2,s1h = s1,s2h = s2,n1 = n1,n2 = n2,h1 = ">",a = a,b = b,um = "mila euro")
```
:::


### Esercizio 6


```{r 2024-103}
set.seed(9)
n <- 50
x <- round(runif(n = n,min = 0,8),2) # Anni di studio
y <- round(10 -.2*x^2 + rnorm(n, 0, 1.5),2) # Reddito annuo in migliaia di euro
y <- (y - min(y))/(max(y)-min(y))*10
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sull'uso delle nuove tecnologie, in un campione di \(n=`r n`\) individui, sono stati analizzati il tempo passato sui social (in ore al giorno, \(X\)) e il numero di libri letti in un anno  \(Y\). 
Si osservano le seguenti statistiche: 
$\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r punti_p(nex=T)`  Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r 2024-23,,results='asis'}
calcolo_beta()
residuo(x = x[3],y = y[3])
```
:::


`r punti_p()` Dare un'interpretazione dei parametri di regressione stimati.

`r punti_p()` Definire i punti di leva e indicare una misura per misurarli.

`r punti_p()` Se in un modello di regressione $r^2=0$ cosa significa?

`r punti_p()` Se in un modello di regressione $r=0.55$, $\hat\sigma_Y=0.9$ e $\hat\beta_1=1.5$,  calcolare
$\hat\alpha_1$, la stima del coefficiente angolare del modello

$$
X_i = \alpha_0+\alpha_1 Y_i + \delta_i, \qquad E(\delta_i)=0; V(\delta_i)=\sigma_\delta^2
$$

dove la $X$ è spiegata dalla $Y$.



```{r include=FALSE}
punti <- list(
  e1 = c(a1,a2,a3,a3),
  e2 = c(a1,a2,a3,a3),
  e3 = c(a1),
  e4 = c(a4,a4,a4,a4),
  e5 = c(a1-a4,a4),
  e6 = c(a1,a2,a3,a3,a3)
)

par(bg="transparent")
```


## Prova di Statistica 24/07/06 -1



### Esercizio 1
```{r 2024-104}
# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 150      # ampiezza campionaria

brk  <- c(0,2,4,8,16)
nnn  <- c( 50,100,50, 50)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(x = stat_base(samp,brk))
```

Su un campione di $`r n`$ di piccole e medie imprese dell'Emilia-Romagna sono stati rilevati gli investimenti in infrastrutture tecnologiche (dati espressi in migliaia di euro). Qui di seguito la distribuzione delle frequenze cumulate:

```{r 2024-105}
kable(dat3[,c(1,2,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
i2 <- 0
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale. 

:::{.sol data-latex=""}
```{r 2024-106}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r punti_p()` Quante imprese investono tra $x_{0.15}$ il 15-esimo e $x_{0.85}$ l'85-esimo percentile? 

:::{.sol data-latex=""}
```{r 2024-107}
F_print(x = Q.int(.15),x2 = Q.int(.85),verso = "alt")
```
:::  


`r punti_p()` Che relazione dobbiamo aspettarci tra media,  mediana e moda? 

`r punti_p()` Siano $x_1,...,x_n$, $n$ dati e $\bar x=\frac 1n \sum_{i=1}^n x_i$ la loro media aritmetica. Quanto vale

$$
\sum_{i=1}^n (x_i-\bar x)=~~?
$$

### Esercizio 2 

`r punti_p(nex=T)` Si consideri un'urna che ha una pallina bianche, due nere e due verdi. Si estrae 5 volte con reinserimento. Sia $X$ la variabile casuale che conta il numero di bianche su 5 estrazioni. Calcolare la probabilità che $X\leq 1$.

:::{.sol data-latex=""}
```{r 2024-24,,results='asis'}
bin_dis(x1 = 1,n = 5,pp = 1/5,comp = F)
```
:::  

`r punti_p()` Sia $X$ la VC del punto precedente. Considerato $A=\{X\leq 1\}$, $B=\{X\leq 2\}$, calcolare $P(A|B)$.

:::{.sol data-latex=""}
```{r 2024-25,,results='asis'}
pa <- pbinom(1,5,1/5)
pb <- pbinom(2,5,1/5)
pab <- pa
```

\begin{eqnarray*}
  P(B) &=&  `r pb`\\
  P(A\cap B) &=& P( \{X \leq 1\} \cap \{X \leq 2\})\\
             &=& P(  X \leq 1)\\
             &=& `r pab`\\
  P(A|B)     &=& \frac{P(A\cap B)}{P(B)}\\
             &=& \frac{`r pab`}{`r pb`}\\
             &=& `r pab/pb`
\end{eqnarray*}
:::  


`r punti_p()` Se $A$ e $B$, sono due eventi tali che $P(A)=0.2$, $P(B)=0.6$, e $P(A\cap B)=0.18$, $A$ e $B$ sono indipendenti? Perché?

`r punti_p()` Sia $X$ una variabile casuale con supporto $S_X=c\{-1,+1\}$ e con funzione di probabilità
$$
f(x)=\begin{cases}
\frac 25, &\text{ se $x=-1$}\\
\frac 35, &\text{ se $x=+1$}
\end{cases}
$$
Disegnare le sua funzione di ripartizione, $F(x)$, nell'intervallo $-2\leq x\leq 2$.

:::{.sol data-latex=""}
```{r 2024-108}
x <- c(-2,-1,1,2)
px <- c(0,c(2,3)/5,0)
kk <- length(px)
plot(x,pbinom(x,2,.5),type="n",ylab="F(x)",axes = F)
axis(1,x)
axis(2,cumsum(px),las=2)
segments(x[1:(kk-1)],cumsum(px)[1:(kk-1)],x[2:kk],cumsum(px)[1:(kk-1)])
segments(x[2:kk],cumsum(px)[1:(kk-1)],x[2:kk],cumsum(px)[2:4],lty=2)
points(x[2:(kk-1)],cumsum(px)[1:(kk-2)])
points(x[2:(kk-1)],cumsum(px)[2:(kk-1)],pch=16)
```
:::

### Esercizio 3 

`r punti_p(nex=T)` Un'urna contiene 4 palline col numero $\mbox{-1}$ e 6 col $\mbox{1}$.
Si estrae 100 volte con reintroduzione. 
Qual è la probabilità che la somma sia maggiore di 25?

:::{.sol data-latex=""}

```{r 2024-109}
n <- 100
mx <- sum(-1*.4+1*.6)
vx <- sum(.4+.6)-mx^2
stat_(rep(c(-1,1),times=c(4,6)),semp = T)
tlc("somma",25,verso = ">",mu = mx,s2 = vx,n = n)
```
:::

### Esercizio 4 


`r punti_p(nex=T)` Si consideri il modello normale $X\sim N(\mu,\sigma^2)$. Sia $\hat\mu$ lo stimatore di massima verosimiglianza per $\mu$

$$
  \hat\mu = \frac 1n \sum_{i=1}^n X_i
$$

Estratti $n=25$ dati si è ottenuto $\sum_{i=1}^n x_i = 45$ e $\sum_{i=1}^n x_i^2 = 105$. Ricavare il suo _Standard Error_ teorico e quello stimato.

:::{.sol data-latex=""}
\begin{eqnarray*}
  \hat\mu  &=&\frac{45}{25}=`r 42/25`\\
  \hat\sigma &=&\sqrt{\frac 1{25}105-`r 42/25`^2}=`r sqrt(105/25-(42/25)^2)`\\
  S &=&\sqrt{\frac{n}{n-1}}\hat\sigma=`r sqrt(25/24)*sqrt(105/25-(42/25)^2)`\\
  SE(\hat\mu) &=&  \frac{\sigma}{\sqrt{n}}\\
  \widehat{SE(\hat\mu)} &=& \frac{S}{\sqrt{n}}\\
  \widehat{SE(\hat\mu)} &=& \frac{`r sqrt(25/24)*sqrt(105/25-(42/25)^2)`}{\sqrt{25}}=`r sqrt(25/24)*sqrt(105/25-(42/25)^2)/5`\\
\end{eqnarray*}
:::
`r punti_p()` Sia $h$ uno stimatore per $\theta$, cosa significa che $h$ è consistente?

`r punti_p()` Definire la significatività e la potenza di un test.

```{r 2024-110}
# Creazione della tabella con i dati
tabella_aziendale <- matrix(c(30, 15, 20, 20, 25, 40, 45, 30, 35), nrow = 3, ncol = 3, byrow = TRUE)
n_aziendale <- sum(tabella_aziendale)
pval  <- format(chisq.test(t(tabella_aziendale))$p.value, digits = 4, nsmall = 4)
```

`r punti_p()` Un responsabile delle risorse umane sta conducendo uno studio sull'associazione tra il tipo di formazione ricevuta e la performance lavorativa. Ha somministrato un questionario a `r n_aziendale` dipendenti, chiedendo loro di indicare la propria performance lavorativa (Alta, Media, Bassa) e il tipo di formazione ricevuta (Tecnica, Manageriale, Soft Skills). L'obiettivo è determinare se c'è un'associazione tra il tipo di formazione ricevuta e la performance lavorativa.

```{r 2024-111}

# Assegnazione dei nomi alle righe e alle colonne
colnames(tabella_aziendale) <-  c("Alta", "Media", "Bassa")
rownames(tabella_aziendale) <- c("Tecnica", "Manageriale", "Soft Skills")

tabl(tabella_aziendale) %>%
  kable_styling(full_width = F) %>%
  kable_paper(full_width = F) %>%
  pack_rows("Tipo di Formazione", 1, 3) %>%
  add_header_above(c(" " = 1, "Performance Lavorativa" = 3))
```

Eseguito il test del $\chi^2$ per verificare l'indipendenza tra il livello di istruzione e il comportamento di voto, il sociologo ottiene un $p_\text{value}=`r pval`$. Quali conclusioni può trarne?

### Esercizio 5


`r punti_p(nex=T)` Sia \(X\) il reddito annuale dei manager italiani.
Si sceglie un campione di 30 manager italiani e si ottiene una
media di 85 mila euro con una deviazione standard pari a 15 mila euro.

Determinare un intervallo di confidenza al 95\% per
il reddito medio annuale dei manager italiani.

:::{.sol data-latex=""}
```{r 2024-26,,results='asis'}
idc(xm = 85,sd = 15,alpha = 0.05,n = 30,dist_ = "t",mus = "\\hat\\mu",ss = "S")
```
:::

`r punti_p()` È noto che il reddito medio annuale dei manager europei
è di 80 mila euro.
Verificare l'ipotesi
che il reddito medio annuale dei manager italiani sia uguale a quello
dei manager europei contro l'alternativa che sia maggiore, per $\alpha=0.1,0.05,0.01,0.001$ e dare una valutazione approssimativa del $p_\text{value}$ (ad esempio il $p_\text{value}$ è minore di 0.001, compreso tra 0.05 e tra 0.01, ecc.).

:::{.sol data-latex=""}
```{r 2024-27,,results='asis'}
ttest_mu(muh = 85,sh = 15,n = 30,mu0 = 80,h1 = ">")
```
:::


### Esercizio 6

```{r 2024-112}
set.seed(42)
n <- 30
sig <- 1.5
x <- round(runif(n = n, min = 10, max = 50), 2) # sales in thousands of units
y <- round(1.2 + 0.5 * x + rnorm(n, 0, sig), 2) # annual profit in thousands of euros
ls2e(regr(x, y, semp = TRUE, ax = 2))
```


In uno studio sulla formazione aziendale, in un campione di \(n=`r n`\) dipendenti, sono state analizzate le ore di formazione (in ore, \(X\)) e il punteggio di performance (in opportuna, \(Y\)).

Si osservano le seguenti statistiche:
$\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r punti_p(nex=T)` Si è osservato $x_7=`r p(x[7])`$ e $y_7=`r p(y[7])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=7$.

:::{.sol data-latex=""}
```{r 2024-28,,results='asis'}
calcolo_beta()
residuo(x = x[7],y = y[7])
```
:::

`r punti_p()` Dare un'interpretazione dei parametri di regressione stimati.

`r punti_p()` Perché la previsione per $x=`r round(mx)`$ è più affidabile di quella per $x=`r round(10*mx)`$?

`r punti_p()` Cosa significa che $r$ è un numero puro?

`r punti_p()` Se in un modello di regressione \(r=0.65\), \(\hat\sigma_X=1.1\) e \(\hat\sigma_Y=0.9\), calcolare \(\hat\beta_1\).

:::{.sol data-latex=""}
Per calcolare \(\hat\beta_1\) in un modello di regressione, si usa la formula:

\[
\hat\beta_1 = r \frac{\hat\sigma_Y}{\hat\sigma_X}
\]

Dati:
- \(r = 0.65\)
- \(\hat\sigma_X = 1.1\)
- \(\hat\sigma_Y = 0.9\)

Calcolo:

\[
\hat\beta_1 = 0.65 \times \frac{0.9}{1.1} = 0.65 \times 0.8182 = 0.532
\]
:::

<!-- `r punti_p()` Testare l'ipotesi che $\beta_1$ sia uguale a zero, contro l'alternativa che sia diverso per $\alpha=0.1,0.05,0.01,0.001$ e dare una valutazione approssimativa del $p_\text{value}$ (ad esempio il $p_\text{value}$ è minore di 0.001, compreso tra 0.05 e tra 0.01, ecc.). -->

<!-- :::{.sol data-latex=""} -->
<!-- ```{r 2024-113} -->
<!-- ttest_beta(1,0,SE = T) -->
<!-- ``` -->
<!-- ::: -->

<div style="page-break-before: always;" />


## Prova di Statistica 24/07/06 -2



### Esercizio 1
```{r 2024-114}

punti <- list(
  e1 = c(14,3,2,2),
  e2 = c(14,3,2,2),
  e3 = c(14),
  e4 = c(3,3,3,3),
  e5 = c(14),
  e6 = c(14,3,2,2,2)
)

# Basic settings
set.seed(10)   # per ottenere sempre la stessa simulazione
n <- 200      # ampiezza campionaria

brk  <- c(0,2,4,8,16)
nnn  <- c( 30,100,110, 50)
brk <- 16-rev(brk)
nnn <- rev(nnn)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n,rand = F)
  
ls2e(x = stat_base(samp,brk))

n_ER <- n 
n_L <- n_ER + 15 
n_V <- n_ER -  5 
set.seed(10) 
x_ER <- mean(samp) 
x_L <- mean(samp) + rnorm(1, 0, sd(samp))
x_V <- mean(samp) + rnorm(1, 0, sd(samp))
# Calcolo della media aggregata
x_agg <- (n_ER * x_ER + n_L * x_L + n_V * x_V) / (n_ER + n_L + n_V)

```

Su un campione di $`r n`$ di piccole e medie imprese dell'Emilia-Romagna sono stati rilevati gli investimenti in infrastrutture tecnologiche (dati espressi in migliaia di euro). Qui di seguito la distribuzione delle frequenze assolute:

```{r 2024-115}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
i2 <- 0
```

`r punti_p(start=T)` Individuare l'intervallo modale. 

:::{.sol data-latex=""}
```{r 2024-116}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r punti_p()` Quante imprese investono tra $x_{0.25}$ il 25-esimo e $x_{0.75}$ il 75-esimo percentile? 

:::{.sol data-latex=""}
```{r 2024-117}
F_print(x = Q.int(.25),x2 = Q.int(.75),verso = "alt")
invisible(round_all(2))
```
:::  

`r punti_p()` La media è pari a $\bar x=`r p(mean(samp),2)`$, senza disegnare l'istogramma, che forma distributiva dobbiamo aspettarci?

`r punti_p()` La spesa media della regione Emilia-Romagna, calcolata su `r n_ER` famiglie è pari $\bar x_{ER}=`r x_ER`$, quella della Lombardia, calcolata su `r n_L` famiglie è pari $\bar x_{L}=`r x_L`$, mentre quella del Veneto,  calcolata su `r n_V` famiglie è pari $\bar x_{V}=`r x_V`$. Qual è la spesa media complessiva delle tre regioni?

:::{.sol data-latex=""}
Per trovare la spesa media delle tre regioni aggregate, dobbiamo considerare sia le medie delle singole regioni sia il numero di famiglie su cui sono state calcolate. La formula per la media aggregata \(\bar{x}_{agg}\) è:

\begin{eqnarray*}
\bar{x}_{agg}    &=&  \frac{n_{ER} \bar{x}_{ER} + n_{L} \bar{x}_{L} + n_{V} \bar{x}_{V}}{n_{ER} + n_{L} + n_{V}}\\
&=& \frac{`r n_ER`\cdot`r x_ER`+`r n_L`\cdot`r x_L`+`r n_V`\cdot`r x_V`}{`r n_ER`+`r n_L`+`r n_V`}\\
&=& `r x_agg`
\end{eqnarray*}
  

Dove:

- \(n_{ER}\) è il numero di famiglie in Emilia-Romagna
- \(n_{L}\) è il numero di famiglie in Lombardia
- \(n_{V}\) è il numero di famiglie in Veneto
- \(\bar{x}_{ER}\), \(\bar{x}_{L}\), \(\bar{x}_{V}\) sono le spese medie delle rispettive regioni

:::  



### Esercizio 2 


`r punti_p(nex=T)` Sia $X$ il numero di telefonate in arrivo ad un centralino di emergenza, si assume $X\sim\text{Pois}(1.3)$. Calcolare la probabilità che $X\geq 1$.

:::{.sol data-latex=""}
```{r 2024-29,,results='asis'}
pois_dis(x1 = 1,ll = 1.3,verso = "\\geq")
```
:::  

`r punti_p()` Sia $X\sim\text{Pois}(1.3)$, posto $A=\{X\geq 2\}$, $B=\{X\geq 1\}$, calcolare $P(A|B)$.

:::{.sol data-latex=""}
```{r 2024-118}
pa <- 1-ppois(1,1.3)
pb <- 1-ppois(0,1.3)
pab <- pa
```

\begin{eqnarray*}
  P(B) &=&  `r pb`\\
  P(A\cap B) &=& P( \{X \geq 1\} \cap \{X \geq 2\})\\
             &=& P(  X \geq 2)\\
             &=& `r pab`\\
  P(A|B)     &=& \frac{P(A\cap B)}{P(B)}\\
             &=& \frac{`r pab`}{`r pb`}\\
             &=& `r pab/pb`
\end{eqnarray*}
:::  

`r punti_p()` Se $A$ e $B$, sono due eventi tali che $P(A)=0.2$, $P(B)=0.6$, e $P(A\cup B)=0.8$, $A$ e $B$ sono indipendenti? Perché?


`r punti_p()` Sia $X$ una variabile casuale con supporto $S_X=\{-1,0,1\}$ e con funzione di probabilità
$$
f(x)=\begin{cases}
\frac 13, &\text{ se $x=-1$}\\
\frac 13, &\text{ se $x=\phantom{-} 0$}\\
\frac 13, &\text{ se $x=+ 1$}\\
\end{cases}
$$
Disegnare le sua funzione di ripartizione, $F(x)$, nell'intervallo $-2\leq x\leq 3$.

:::{.sol data-latex=""}
```{r 2024-119}
x <- c(-1,0,1)
px <- c(1,1,1)/3
plot_FdR(x,px,-2,3)
```
:::

### Esercizio 3 

`r punti_p(nex=T)` Un'urna contiene 2 palline col numero $\mbox{-2}$, e 2 palline col numero $\mbox{-1}$ e 6 palline col numero $\mbox{+2}$.
Si estrae 50 volte con reintroduzione. 
Qual è la probabilità che la proporzione di palline maggiori di zero sia compresa tra 0.65 e 0.70?

:::{.sol data-latex=""}
```{r 2024-120}
n <- 50
mx <- sum(0:2*4:2/9)
vx <- sum((0:2)^2*4:2/9)-mx^2
urn <- c(0,0,0,0,1,1,1,2,2)

tlc("prop",x1 = .65,x2 = .70,verso = NULL,mu = .6,n = n)
```
:::

### Esercizio 4 


  
`r punti_p(nex=T)` Si consideri il modello di Bernoulli $X\sim\text{Ber}(\pi)$. Sia $\hat\pi$ lo stimatore di massima verosimiglianza per $\pi$

$$
  \hat\pi = \frac 1n \sum_{i=1}^n X_i
$$


Estratti $n=25$ dati si è ottenuto $\sum_{i=1}^n x_i = 15$. Ricavare il suo _Standard Error_ teorico e quello stimato.


`r punti_p()` Siano $h_1$ e $h_2$ due stimatori per $\theta$, cosa significa che $h_1$ è più efficiente di $h_2$?

`r punti_p()` Siano $T_1$ e $T_2$ due test per lo stesso sistema di ipotesi con la stessa significatività $\alpha$, siano $\beta_1$ la probabilità di errore di secondo tipo del test $T_1$ e $\beta_2$ la probabilità di errore di secondo tipo del test $T_2$. Cosa significa dire che $T_1$ è più potente di $T_2$?

`r punti_p()`  In un'indagine sull'opinione sull'autonomia differenziata sono stati intervistate 180 persone che vivono al nord e 130 che vivono al sud: 108 su 180 che vivono al nord sono favorevoli al reddito di cittadinanza mentre 55 su 130 che vivono al sud sono favorevoli. 
Messo a test

$$
\begin{cases}
   H_0: \pi_\text{N} = \pi_\text{S} \\
   H_1: \pi_\text{N} > \pi_\text{S} 
\end{cases}
$$

è risultato  $p_{\text{value}} =0.001041$. Possiamo concludere che al nord siano più propensi all'autonomia che al sud? Perché?


### Esercizio 5

`r punti_p(nex=T)` In uno studio sull'efficacia di due metodi di insegnamento della matematica, si è proceduto facendo seguire il metodo \(A\) ad un campione di 15 studenti (gruppo \(A\)) e il metodo \(B\) ad un secondo campione di 18 studenti (gruppo \(B\)). Si è quindi misurata la prestazione degli studenti con un test finale. La prestazione media del gruppo \(A\) risulta pari a 78 con una deviazione standard pari a 8.3, mentre la prestazione media del gruppo \(B\) risulta pari a 74 con una deviazione standard pari a 7.5. Sotto ipotesi di eterogeneità verificare l'ipotesi che la prestazione media dei due metodi di insegnamento sia uguale, contro l'alternativa che il metodo \(A\) produca prestazioni mediamente migliori di quello \(B\), per $\alpha=0.1,0.05,0.01,0.001$ e dare una valutazione approssimativa del $p_\text{value}$ (ad esempio il $p_\text{value}$ è minore di 0.001, compreso tra 0.05 e tra 0.01, ecc.).

:::{.sol data-latex=""}
```{r 2024-30,,results='asis'}
ttest_2c_et(mu1 = 78,mu2 = 74,s1h = 8.3,s2h = 7.5,n1 = 15,n2 = 18,h1 = ">",a = "A",b = "B")
```
:::

### Esercizio 6

```{r 2024-121}
set.seed(42)
n <- 40
sig <- .25
x <- round(runif(n = n, min = 0, max = 10), 2) 
y <- round(10 - (0.7 * x )^2 + rnorm(n, 0, sig), 2) 
ls2e(regr(x, y, semp = TRUE, ax = 2))
```

In uno studio sulla relazione tra tempo libero e stress, in un campione di \(n=`r n`\) individui, sono state analizzate le ore settimanali dedicate al tempo libero (in ore, \(X\)) e i livelli di stress misurati (su una scala da 1 a 10, \(Y\)).

Si osservano le seguenti statistiche:
$\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r punti_p(nex=T)` Si è osservato $x_4=`r x[4]`$ e $y_4=`r round(y[4],2)`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=4$.

:::{.sol data-latex=""}
```{r 2024-31,,results='asis'}
calcolo_beta()
residuo(x = x[4],y = y[4])
```
:::

`r punti_p()` Scomporre la Total Sum of Squares.

:::{.sol data-latex=""}
```{r 2024-32,,results='asis'}
TSS()
```
:::

`r punti_p()` Interpretare il diagramma dei residui.

```{r 2024-33,, fig.width=5, fig.height=3.5}
par(mar=c(4,4,0,2),cex=.8)
plot(x, es, ylab=expression(hat(epsilon)), pch=16, cex=.5, axes=F)
axis(1, cex=1)
axis(2, cex=1)
abline(h=0, lty=2)
```

:::{.sol data-latex=""}
```{r 2024-34,,results='asis'}
plot(x, es, ylab=expression(hat(epsilon)), pch=16, cex=.5, axes=F)
axis(1, cex=1)
axis(2, cex=1)
abline(h=0, lty=2)
spline_pat(x,es,df1 = 5,df2 = 5)
```
:::

`r punti_p()` Cosa significa che $r$ è invariante ai cambiamenti di scala?

`r punti_p()` Se in un modello di regressione $r^2=0$ significa che non c'è relazione tra $X$ ed $Y$?

<!-- `r punti_p()` Testare l'ipotesi che $\beta_0$ sia uguale a 12, contro l'alternativa che sia maggiore per $\alpha=0.1,0.05,0.01,0.001$ e dare una valutazione approssimativa del $p_\text{value}$ (ad esempio il $p_\text{value}$ è minore di 0.001, compreso tra 0.05 e tra 0.01, ecc.). -->

<!-- :::{.sol data-latex=""} -->
<!-- ```{r 2024-122} -->
<!-- ttest_beta(0,12.5,h1 = ">",SE = T) -->
<!-- ``` -->
<!-- ::: -->

<div style="page-break-before: always;" />


## Prova di Statistica 24/07/06 -3



### Esercizio 1
```{r 2024-123}
punti <- list(
  e1 = c(14,3,2,2),
  e2 = c(14,3,2,2),
  e3 = c(14),
  e4 = c(3,3,3,3),
  e5 = c(4,10),
  e6 = c(14,3,2,2,2)
)

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 200      # ampiezza campionaria

brk  <- c(0,3,4.5,5.5,7,10)
nnn  <- c(5,20,35,20,5)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,hhh = nnn,n=n)
  
ls2e(x = stat_base(samp,brk))
```

Su un campione di $`r n`$ di piccole e medie imprese dell'Emilia-Romagna sono stati rilevati gli investimenti in infrastrutture tecnologiche (dati espressi in migliaia di euro).  Qui di seguito la distribuzione delle densità percentuali:

```{r 2024-124}
kable(dat3[,c(1,2,6)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Calcolare il valore approssimativo della mediana. 

:::{.sol data-latex=""}
```{r 2024-125}
kable(dat3[,c(1:7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
percentile()
histp(T)
draw_dist(dist = H.int,z1 = Q.int(.30),z2 = 7,col=ablue,border = T,lwd=2)
```
:::

`r punti_p()` Qual è la percentuale di imprese che investe tra il 30-esimo percentile $x_{0.30}$ e 7? 

:::{.sol data-latex=""}
$$
\%(x_{0.30}<X<7) = (F(7)-F(x_{0.30}))\times 100 = (`r F.int(7)`- 0.30)\times 100=`r F.int(7)- 0.30`\times 100
$$
:::  

`r punti_p()` La media è pari a $\bar x=`r 5`$, senza disegnare l'istogramma, che forma distributiva dobbiamo aspettarci?

`r punti_p()` Se $\{x_1,...,x_n\}$ è una serie di dati con media aritmetica $\bar x=\frac 1n\sum_i x_i$ e varianza $\sigma_X^2=\frac 1n\sum_i(x-\bar x)^2$. Posto
$$
y_i = 1-x_i,~~\forall i=1,...,n
$$
ricavare media aritmetica e varianza delle $\{y_1,...,y_n\}$.

:::{.sol data-latex=""}
$$
\bar y = 1-\bar x;~~~~\sigma_Y^2=(-1)^2\sigma_X^2
$$

:::  


### Esercizio 2 


`r punti_p(nex=T)` Sia $X\sim N(1,1.5)$ e sia $Y\sim N(-1,1.5)$, $X$ e $Y$ indipendenti sia $A=\{X>0\}$ e $B=\{Y<0\}$. 
Calcolare $P(A\cup B)$.

:::{.sol data-latex=""}
```{r 2024-35,,results='asis'}
norm_int(x1 =  0,verso = ">",mm =  1,ss = 1.5,vnam = "X")
norm_int(x1 = 0,verso = "<",mm = -1,ss = 1.5,vnam = "Y")
zx <- round((0-1)/sqrt(1.5),2)
zy <- round((0+1)/sqrt(1.5),2)
pa <- pnorm(zx,lower.tail = F)
pb <- pnorm(zy,lower.tail = T)
p_aub(pa,pb)
```
:::  

`r punti_p()` , posto $W=(X+Y)/2$, calcolare $P(W<1|W>-1)$.

:::{.sol data-latex=""}
```{r 2024-36,,results='asis'}
pab <- pnorm(1,0,sqrt(3/4))-pnorm(-1,0,sqrt(3/4))
pb  <- pnorm(-1,0,sqrt(3/4),lower.tail = F)
```

$$
W\sim N(+1-1,(1/2)^2(1.5+1.5))
$$

$$ 
P(W<1|W>-1)=\frac{P(-1<W<1)}{P(W>-1)}=\frac{`r pab`}{`r pb`}=`r pab/pb`
$$
:::  

`r punti_p()` Se $A\neq\emptyset$ e $B\neq\emptyset$, sono due eventi tali che $P(A)=0.2$, $P(B)=0.6$, e $P(A\cup B)=0.6$, $A$ e $B$ sono indipendenti? Perché?


`r punti_p()` Sia $X\sim\text{Binom}(n=2,\pi=0.5)$ e sia $F$ la sua funzione di ripartizione. Disegnare $F(x)$ nell'intervallo $-1\leq x\leq 3$

:::{.sol data-latex=""}
```{r 2024-126}
bin_dis(x1 = 0,n = 2,pp = .5)
bin_dis(x1 = 1,n = 2,pp = .5)
bin_dis(x1 = 2,n = 2,pp = .5)
x <- (-1):3
px <- dbinom(x,2,.5)
plot(x,pbinom(x,2,.5),type="n",ylab="F(x)",axes = F)
axis(1,x)
axis(2,cumsum(px),las=2)
segments(x[1:4],cumsum(px)[1:4],x[2:5],cumsum(px)[1:4])
segments(x[2:4],cumsum(px)[1:3],x[2:4],cumsum(px)[2:4],lty=2)
points(x[2:4],cumsum(px)[1:3])
points(x[2:4],cumsum(px)[2:4],pch=16)
```
:::

### Esercizio 3 



`r punti_p(nex=T)` Un'urna contiene 2 palline col numero $\mbox{-2}$, e 2 palline col numero $\mbox{-1}$ e 6 palline col numero $\mbox{+2}$.
Si estrae 150 volte con reintroduzione. 
Qual è la probabilità che la somma sia minore di 80?

:::{.sol data-latex=""}
```{r 2024-127}
n <- 150
xx <- rep(c(-2,-1,2),times=c(2,2,6))
mx <- mean(xx)
vx <- s2c(xx)
stat_(xx,semp = T)
tlc("somma",x1 = 80,verso = "<",mu = mx,n = n,s2 = vx)
```
:::


### Esercizio 4 

`r punti_p(nex=T)` Si consideri il modello di Poisson $X\sim\text{Pois}(\lambda)$. Sia $\hat\lambda$ lo stimatore di massima verosimiglianza per $\mu$

$$
  \hat\lambda = \frac 1n \sum_{i=1}^n X_i
$$

Estratti $n=25$ dati si è osservato $\sum_{i=1}^nx_i=54$. Ricavare il suo _Standard Error_ teorico e quello stimato.

:::{.sol data-latex=""}
Dato il modello binomiale \(X \sim \text{Pois}(\lambda)\) e \(\hat\lambda = \frac{1}{n} \sum_{i=1}^n X_i\), con \(n = 25\) e \(\sum_{i=1}^n x_i = 54\):

Standard Error Teorico
\[
SE(\hat\lambda) = \sqrt{\frac{\lambda}{n}}
\]

Standard Error Stimato
\[
\hat\lambda = \frac{54}{25} = 2.16
\]
\[
SE(\hat\lambda) = \sqrt{\frac{2.16}{25}} = \sqrt{0.0864} \approx 0.294
\]
:::

`r punti_p()` Cosa significa che uno stimatore è asintoticamente corretto?

`r punti_p()` Definire la significatività e la potenza di un test.

`r punti_p()`L'Associazione dei Commercianti della Toscana ha condotto un'indagine sulle preferenze dei metodi di pagamento tra i clienti dei negozi della regione. Durante una settimana, sono stati intervistati 350 clienti di vari negozi. L'associazione è interessata a capire se le preferenze dei clienti per i metodi di pagamento differiscono dalla media nazionale.

Qui di seguito è riportata la tabella delle preferenze dei clienti dei negozi della Toscana e le percentuali nazionali:

```{r 2024-128}
X <- c("Contanti", "Carta di Credito", "Carta di Debito", "Bonifico Bancario", "Pagamento Mobile")

Y <- c("Dati Associazione", "Media Nazionale")
ntot <- 350
Freq_0 <- c(100, 120, 50, 30, 50)/sum(c(100, 120, 50, 30, 50))*100
Freq_c <- c(110, 130, 40, 35, 35)
Freq_c <- round(Freq_c/sum(Freq_c)*ntot)

chi_print_conf(Freq_c = Freq_c,Freq_0 = Freq_0,X,Y)
```

Eseguito il test del $\chi^2$ per verificare la conformità delle due distribuzioni si ottiene un $p_\text{value}=0.0667$. Le due distribuzioni possono essere considerate uguali?

### Esercizio 5

`r punti_p(nex=T)` Su un campione di \( n = 120 \) startup tecnologiche italiane, è stato chiesto se abbiano implementato misure di cybersecurity avanzate. Lo studio ha riportato che 84 startup su 120 (il 70% del campione) hanno implementato queste misure.

Costruire un intervallo di confidenza al 95% per \(\pi\), la quota di startup italiane che hanno implementato misure di cybersecurity avanzate.

:::{.sol data-latex=""}
```{r 2024-129}
idc(xm = 84,alpha = .05,n = 120,dist_ = "z")
```
:::

`r punti_p()` Un'indagine molto più ampia condotta su startup europee ha mostrato che la percentuale di startup con misure di cybersecurity avanzate è del 80%. Testare l'ipotesi che in Italia la quota di startup con misure di cybersecurity avanzate sia uguale a quella europea contro l'alternativa che sia minore. Risolvere col $p_\text{value}$ e confrontarlo per $\alpha=0.1,0.05,0.01,0.001$.

:::{.sol data-latex=""}
```{r 2024-130}
sn <- 84
n  <- 120
p0 <- 0.80
h1 <- "<"
ztest_pi(sn = sn,n = n,p0 = p0,h1 = h1)
```
:::


### Esercizio 6


```{r 2024-131}
set.seed(9)
n <- 50
x <- round(runif(n = n,min = 0,8),2) # Anni di studio
y <- round(10 -.2*x^2 + rnorm(n, 0, 1.5),2) # Reddito annuo in migliaia di euro
y <- (y - min(y))/(max(y)-min(y))*10
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sull'uso delle nuove tecnologie, in un campione di \(n=`r n`\) individui, sono stati analizzati il tempo passato sui social (in ore al giorno, \(X\)) e il numero di libri letti in un anno  \(Y\). 

`r punti_p(nex=T)` Si è osservato $x_5=`r p(x[5])`$ e $y_5=`r p(y[5])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=5$.

:::{.sol data-latex=""}
```{r 2024-37,,results='asis'}
calcolo_beta()
residuo(x = x[3],y = y[3])
```
:::


`r punti_p()` Dare un'interpretazione dei parametri di regressione stimati.

`r punti_p()` Definire i punti di leva e indicare una misura per misurarli.

`r punti_p()` Se in un modello di regressione $r=-1$, cosa significa?

`r punti_p()` Se in un modello di regressione $r=0.55$, $\hat\sigma_Y=0.9$ e $\hat\sigma_X=1.9$, calcolare $\hat\beta_1$ e
$\hat\alpha_1$, gli stimatori stima del coefficiente angolare dei modelli:

\begin{eqnarray*}
Y_i &=& \beta_0+\beta_1 Y_i + \varepsilon_i, \qquad E(\varepsilon_i)=0; V(\varepsilon_i)=\sigma_\varepsilon^2\\
X_i &=& \alpha_0+\alpha_1 Y_i + \delta_i, \qquad E(\delta_i)=0; V(\delta_i)=\sigma_\delta^2.
\end{eqnarray*}

<!--chapter:end:2024.Rmd-->

