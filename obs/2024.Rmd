
```{r}
rm(list = rm())
source("intro.R")
if (html) cat('')
```
  
# Anno 2024



<div class="button-container"></div>

## Prova di Statistica 2024/06/03-1

### Esercizio 1
```{r}
i1 <- 1
# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- c(0,1.5,3,8,20)
nnn  <- c( 200,100,100, 50)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(x = stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Milano è stato rilevata la spesa annua per le vacanze (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze cumulate:

```{r}
kable(dat3[,c(1,2,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
i2 <- 0
```

`r item(T)` (**Punti 14**) Disegnare l'istogramma di densità percentuale. 

:::{.sol data-latex=""}
```{r}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r item()` (**Punti 3**) Quante famiglie spendono meno di 5 mila euro all'anno? 

:::{.sol data-latex=""}
```{r}
F_print(x = 5,verso = "<")
```
:::  


`r item()` (**Punti 2**) Che relazione dobbiamo aspettarci tra media,  mediana e moda? 

`r item()` (**Punti 2**) La spesa media è pari a $\bar x=`r mean(samp)`$, mentre la SD è pari a $SD=`r sd(samp)`$.
Se ogni famiglia spendesse 2 mila euro in più all'anno, quanto varrebbero la media e la SD dei dati trasformati?

### Esercizio 2 
`r i1 <- i1+1`

`r item(T)` (**Punti 14**) Si lancia una moneta perfetta 4 volte. Sia $X$ la variabile casuale che conta il numero di Teste su 4 lanci. Calcolare la probabilità che $X\leq 2$.

:::{.sol data-latex=""}
```{r,results='asis'}
bin_dis(x1 = 2,n = 4,pp = .5)
```
:::  

`r item()` (**Punti 3**) Sia lancia una seconda moneta perfetta 3 volte. Sia $Y$ la variabile casuale che conta il numero di Teste su 3 lanci. Calcolare la probabilità che $X+Y=3$.

:::{.sol data-latex=""}
Siccome $X+Y\sim\text{Binom(4+3,0.5)}$, allora
```{r,results='asis'}
bin_dis(x1 = 3,n = 7,pp = .5,sing = T,vnam = "X+Y")
```
:::  

`r item()` (**Punti 2**) Se $P(A)=0.4$ e $P(B)=0.8$, $A$ e $B$ possono essere incompatibili? Perché?

:::{.sol data-latex=""}
Se $A$ e $B$ fossero incompatibili, allora $A\cap B=\emptyset$ allora $P(A\cup B)=P(A)+P(B)$, ma essendo $0.4+0.8=1.2>1$ allora $A\cap B\neq\emptyset$
:::

`r item()` (**Punti 2**) Cosa significa che la funzione di ripartizione è continua a destra?

### Esercizio 3 

`r i1 <- i1+1`

(**Punti 14**) Un'urna 3 premi da $\mbox{0}$ euro, 2 premi da $\mbox{1}$ euro e un premio da $\mbox{2}$ euro.
Si estrae 100 volte con reintroduzione. 
Qual è la probabilità di vincere più di 60 euro?

:::{.sol data-latex=""}

```{r}
n <- 100
mx <- sum(0:2*c(3,2,1)/6)
vx <- sum((0:2)^2*c(3,2,1)/6)-mx^2
stat_(rep(0:2,times=c(3,2,1)),semp = T)
tlc("somma",60,verso = ">",mu = mx,s2 = vx,n = n)
```
:::

### Esercizio 4 

`r i1 <- i1+1`
  
`r item(T)` (**Punti 3**) Si consideri il modello normale $X\sim N(\mu,\sigma^2)$. Sia $\hat\mu$ lo stimatore di massima verosimiglianza per $\mu$

$$
  \hat\mu = \frac 1n \sum_{i=1}^n X_i
$$

Dimostrare la consistenza di $\hat\mu$.

`r item()` (**Punti 3**) Definire lo Standard Error di uno stimatore.

`r item()` (**Punti 3**) Definire la significatività di un test.

```{r}
tabella <- matrix(c(45, 35, 20, 25, 30, 45, 10, 15, 25), nrow = 3, ncol = 3, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(t(tabella))$p.value, digits = 4, nsmall = 4)

```

`r item()` (**Punti 3**) Un sociologo sta conducendo uno studio sull'associazione tra il livello di istruzione e il comportamento di voto. Ha somministrato un questionario a `r n` partecipanti, chiedendo loro di indicare il proprio livello di istruzione (Basso, Medio, Alto) e il comportamento di voto (Regolarmente, Occasionalmente, Mai). L'obiettivo è determinare se c'è un'associazione significativa tra il livello di istruzione e il comportamento di voto.

```{r}

# Assegnazione dei nomi alle righe e alle colonne
rownames(tabella) <- c("Basso", "Medio", "Alto")
colnames(tabella) <- c("Regolarmente", "Occasionalmente", "Mai")

tabl(t(tabella)) %>%
  kable_styling(full_width = F) %>%
  kable_paper(full_width = F) %>%
  pack_rows("Comportamento di Voto", 1, 3) %>%
  add_header_above(c(" " = 1, "Livello di Istruzione" = 3))

# dat_print <- chi_print(dat = tabella,nome_x =  c("Basso", "Medio", "Alto"),nome_y =  c("Regolarmente", "Occasionalmente", "Mai"))[[2]]
# tabl(dat_print, digits = 4) %>%
#   column_spec(column = 1, bold = T)

```

Eseguito il test del $\chi^2$ per verificare l'indipendenza tra il livello di istruzione e il comportamento di voto, il sociologo ottiene un $p_\text{value}=`r pval`$. Quali conclusioni può trarne?


### Esercizio 5
`r i1 <- i1+1`

```{r}
set.seed(9)
n <- 50
x <- round(runif(n = n,min = 8,20),0) # Anni di studio
y <- round(abs(2.1*x + rnorm(n, 0, 5)) + 12) # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di \(n=`r n`\) individui, sono stati analizzati il livello di istruzione (in anni di studio, \(X\)) e il reddito annuale (in migliaia di euro, \(Y\)). 
Si osservano le seguenti statistiche:
, $\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r item(T)` (**Punti 14**) Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r,results='asis'}
calcolo_beta()
residuo(x = x[3],y = y[3])
```
:::

`r item()` (**Punti 3**) Qual è la percentuale di varianza spiegata dal modello?


`r item()` (**Punti 2**) Definire i punti influenti.

`r item()` (**Punti 2**) Se in un modello di regressione $r=-1$ cosa significa?

`r item()` (**Punti 2**) Se in un modello di regressione $r=0.55$, $\hat\sigma_X=0.9$ e $\hat\beta_1=1.5$, quanto varrà
$\hat\sigma_Y$, la standard deviation di $Y$?

`r item()` (**Punti 14**) Testare l'ipotesi che $\beta_1$ sia uguale a zero, contro l'alternativa che sia diverso per diversi livelli di significatività e dare una valutazione approssimativa del $p$-value (ad esempio il $p$-value è minore di 0.001, compreso tra 0.05 e tra 0.01, ecc.).

:::{.sol data-latex=""}
```{r}
ttest_beta(1,0,SE = T)
```
:::




## Prova di Statistica 2024/06/03-2


### Esercizio 1
```{r}
i1 <- 1
# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- c(0,1.5,3,8,20)
nnn  <- c( 10,100,110, 50)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(x = stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Milano è stato rilevata la spesa annua per le vacanze (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze relative:

```{r}
kable(dat3[,c(1,2,4)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
i2 <- 0
```

`r item(T)` (**Punti 14**) Individuare l'intervallo modale. 

:::{.sol data-latex=""}
```{r}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r item()` (**Punti 3**) Quante famiglie investono più di 4 mila euro all'anno? 

:::{.sol data-latex=""}
```{r}
F_print(x = 4,verso = ">")
```
:::  

`r item()` (**Punti 2**) Che relazione dobbiamo aspettarci tra media,  mediana e moda? 

`r item()` (**Punti 2**) La spesa media è pari a $`r mean(samp)`$, mentre la varianza è pari a $`r s2c(samp)`$.
Se ogni famiglia aumentasse la propria spesa del 2%, quanto varrebbero la media e la varianza dei dati così trasformati?

:::{.sol data-latex=""}
\[
\bar y = `r 1.02*mean(samp)`\qquad \sigma^2 = `r (1.02)^2*s2c(samp)`
\]
:::  



### Esercizio 2 
`r i1 <- i1+1`

`r item(T)` (**Punti 14**) Sia $X$ numero settimanale di pratiche inevase dall'ufficio provinciale, si assume $X\sim\text{Pois}(3.5)$. Calcolare la probabilità che $X\geq 3$.

:::{.sol data-latex=""}
```{r,results='asis'}
pois_dis(x1 = 3,ll = 3.5,verso = "\\geq")
```
:::  

`r item()` (**Punti 3**) Sia $Y$ numero settimanale di pratiche inevase dall'ufficio comunale, si assume $Y\sim\text{Pois}(2)$ e si assume $X$ indipendente da $Y$. Calcolare la probabilità che $X+Y=5$.

:::{.sol data-latex=""}
```{r,results='asis'}
pois_dis(x1 = 5,ll = 3.5+2,sing = T)
```
:::  

`r item()` (**Punti 2**) Se $P(A)=0.4$ e $P(B)=0.4$, $A$ e $B$ possono essere incompatibili? Perché?

`r item()` (**Punti 2**) Sia $X$ una variabile casuale e sia $F$ la sa funzione di ripartizione. Siano $a$ e $b$ due numeri reali, $a<b$, esprimere
\[
P(a<X\leq b)
\]
in termini di $F$.

### Esercizio 3 

`r i1 <- i1+1`

(**Punti 14**) Un'urna 4 premi da $\mbox{0}$ euro, 3 premi da $\mbox{1}$ euro e 2 premi da $\mbox{2}$ euro.
Si estrae 50 volte con reintroduzione. 
Qual è la probabilità che la media delle vincite ottenute sia minore di 0.6 euro?

:::{.sol data-latex=""}
```{r}
n <- 50
mx <- sum(0:2*4:2/9)
vx <- sum((0:2)^2*4:2/9)-mx^2
urn <- c(0,0,0,0,1,1,1,2,2)
stat_(urn,semp = T)
tlc("media",0.6,verso = "<",mu = mx,s2 = vx,n = n)
```
:::

### Esercizio 4 

`r i1 <- i1+1`
  
`r item(T)` (**Punti 3**) Si consideri il modello di Bernoulli $X\sim\text{Ber}(\pi)$. Sia $\hat\pi$ lo stimatore di massima verosimiglianza per $\pi$

$$
  \hat\pi = \frac 1n \sum_{i=1}^n X_i
$$

Dimostrare la consistenza di $\hat\pi$.

`r item()` (**Punti 3**) Che differenza c'è tra lo Standard Error di uno stimatore e la Deviazione Standard del campione?

`r item()` (**Punti 3**) Definire la potenza di un test.

```{r}
tabella <- matrix(c(30, 20, 10, 40, 35, 25), nrow = 3, ncol = 2, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(tabella)$p.value, digits = 4, nsmall = 4)

# Assegnazione dei nomi alle righe e alle colonne
rownames(tabella) <- c("Basso", "Medio", "Alto")
colnames(tabella) <- c("Sì", "No")
```

`r item()` (**Punti 3**) Un economista sta conducendo uno studio sull'associazione tra il livello di istruzione e il possesso di una casa. Ha somministrato un questionario a `r n` partecipanti, chiedendo loro di indicare il proprio livello di istruzione (Basso, Medio, Alto) e se possiedono una casa (Sì, No). L'obiettivo è determinare se c'è un'associazione significativa tra il livello di istruzione e il possesso di una casa.

```{r}
tabella <- matrix(c(30, 20, 10, 40, 35, 25), nrow = 3, ncol = 2, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(t(tabella))$p.value, digits = 4, nsmall = 4)

# Assegnazione dei nomi alle righe e alle colonne
rownames(tabella) <- c("Basso", "Medio", "Alto")
colnames(tabella) <- c("Sì", "No")

tabl(t(tabella)) %>%
  kable_styling(full_width = F) %>%
  kable_paper(full_width = F) %>%
  pack_rows("Possesso \n di Casa", 1, 2) %>%
  add_header_above(c(" " = 1, "Livello di Istruzione" = 3))

# t_p <- chi_print(dat = tabella,nome_y =  c("Basso", "Medio", "Alto"),nome_x =  c("Sì","No"))[[2]]
# tabl(t_p, digits = 4) %>%
#   column_spec(column = 1, bold = T)

```

Eseguito il test del $\chi^2$ per verificare l'indipendenza tra il livello di istruzione e il possesso di una casa, l'economista ottiene un $p_\text{value}=`r pval`$. Quali conclusioni può trarne?

### Esercizio 5
`r i1 <- i1+1`

```{r}
set.seed(90)
n <- 50
x <- round(runif(n = n,min = 8,20),0) # Anni di studio
y <- round(abs(-1.1*x + rnorm(n, 0, 5)) + 30) # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di \(n=`r n`\) individui, sono stati analizzati il livello di istruzione (in anni di studio, \(X\)) e la propensione a credere in teorie del complotto (in opportuna scala, \(Y\)). 
Si osservano le seguenti statistiche:
, $\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r item(T)` (**Punti 14**) Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r,results='asis'}
calcolo_beta()
residuo(x = x[3],y = y[3])
```
:::

`r item()` (**Punti 3**) Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r,results='asis'}
R2()
```
:::

`r item()` (**Punti 2**) Definire i punti di leva.

`r item()` (**Punti 2**) Se in un modello di regressione $r=+1$ cosa significa?

`r item()` (**Punti 2**) Se in un modello di regressione $r<0$ è possibile che $\hat\beta_1>0$? Perché?

`r item()` (**Punti 14**) Testare l'ipotesi che $\beta_0$ sia uguale a 35, contro l'alternativa che sia minore per diversi livelli di significatività e dare una valutazione approssimativa del $p$-value (ad esempio il $p$-value è minore di 0.0005, compreso tra 0.05 e  0.01, ecc.).

:::{.sol data-latex=""}
```{r}
ttest_beta(0,35,h1 = "<",SE = T)
```
:::




## Prova di Statistica 2024/06/03-3



### Esercizio 1
```{r}
i1 <- 1
# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- c(0,1.5,3,8,20)
nnn  <- c( 50,100,110, 50)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(x = stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Milano è stato rilevata la spesa annua per le vacanze (espresso in migliaia di euro). Qui di seguito la distribuzione delle densità percentuali:

```{r}
kable(dat3[,c(1,2,6)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
i2 <- 0
```

`r item(T)` (**Punti 14**) Calcolare il valore approssimativo della mediana. 

:::{.sol data-latex=""}
```{r}
percentile()
histp(T)
draw_dist(dist = H.int,z1 = 4,z2 = 10)
```
:::

`r item()` (**Punti 3**) Quante famiglie spendono tra 4 mila e 10 mila euro l'anno? 

:::{.sol data-latex=""}
```{r}
F_print(x = 4,x2 = 10,verso = F)
```
:::  


`r item()` (**Punti 2**) Che relazione dobbiamo aspettarci tra media,  mediana e moda? 

`r item()` (**Punti 2**) La spesa media è pari a $`r mean(samp)`$, mentre la varianza è pari a $`r s2c(samp)`$.
Se ogni famiglia diminuisse la propria spesa del 2%, quanto varrebbero la media e la varianza dei dati così trasformati?

:::{.sol data-latex=""}
\[
\bar y = `r 0.98*mean(samp)`\qquad \sigma^2 = `r (0.98)^2*s2c(samp)`
\]
:::  


### Esercizio 2 
`r i1 <- i1+1`

`r item(T)` (**Punti 14**) Sia $X\sim N(5,2)$ sia $A=\{X>4\}$ e $B=\{X<6\}$. Calcolare $P(A\cap B)$.

:::{.sol data-latex=""}
```{r,results='asis'}
norm_int(x1 = 4,x2 = 6,verso = NULL,5,2)
```
:::  

`r item()` (**Punti 3**) Sia $Y\sim N(3,1)$, $X$ e $Y$ indipendenti, posto $W=X-Y$, calcolare $P(W<0)$.

:::{.sol data-latex=""}
```{r,results='asis'}
norm_int(x1 = 0,verso = "<",mm = 5-3,ss = 2+1)
```
:::  

`r item()` (**Punti 2**) Se $P(A)=0.4$ e $P(B)=0.6$, in che relazione sono $A$ e $B$?


`r item()` (**Punti 2**) Sia $X$ una variabile casuale e sia $F$ la sua funzione di ripartizione. Cosa significa che $F$ è una funzione crescente?


### Esercizio 3 

`r i1 <- i1+1`

(**Punti 14**) Un'urna 4 premi da $\mbox{0}$ euro, 2 premi da $\mbox{1}$ euro.
Si estrae 50 volte con reintroduzione. 

Qual è la probabilità che la la vincita totale sia maggiore di 50?

:::{.sol data-latex=""}

```{r}
n <- 50
mx <- 2/6

tlc("somma",50,verso = ">",mu = mx,n = n)
```
:::

### Esercizio 4 

`r i1 <- i1+1`
  
`r item(T)` (**Punti 3**) Si consideri il modello binomiale $X\sim\text{Pois}(\lambda)$. Sia $\hat\lambda$ lo stimatore di massima verosimiglianza per $\mu$

$$
  \hat\lambda = \frac 1n \sum_{i=1}^n X_i
$$

Dimostrare la consistenza di $\hat\lambda$.

`r item()` (**Punti 3**) Che differenza c'è tra lo Standard Error di uno stimatore e la Deviazione Standard di popolazione?

`r item()` (**Punti 3**) Definire gli errori di primo e di secondo tipo.


```{r}
# Definizione dei dati osservati
observed <- c(5, 8, 12, 7, 6, 4, 3)
total <- sum(observed)
lambda <- sum((0:(length(observed) - 1)) * observed) / total
expected <- dpois(0:(length(observed) - 1), lambda) * total
chisq_result <- chisq.test(observed, p = expected / sum(expected))
pval_poisson <- format(chisq_result$p.value, digits = 4, nsmall = 4)
```


`r item()` (**Punti 3**) Un biologo sta studiando il numero di cellule di una certa specie osservate in campioni di terreno. Ha raccolto dati sul numero di cellule in `r total` campioni. I dati osservati sono riportati nella tabella seguente. L'obiettivo è determinare se i dati seguono una distribuzione di Poisson.

```{r}
# Definizione dei dati osservati
observed <- c(5, 8, 12, 7, 6, 4, 3)
total <- sum(observed)
lambda <- sum((0:(length(observed) - 1)) * observed) / total
expected <- dpois(0:(length(observed) - 1), lambda) * total
chisq_result <- chisq.test(observed, p = expected / sum(expected))
pval_poisson <- format(chisq_result$p.value, digits = 4, nsmall = 4)

# Creazione della tabella
dati <- data.frame(
  Numero = 0:(length(observed) - 1),
  Osservati = observed,
  Attesi = round(expected, 2)
)


 kable(dati, caption = "Numero di cellule osservate nei campioni di terreno") %>%
   kable_styling(full_width = F, latex_options = "HOLD_position")

```

Eseguito il test del $\chi^2$ per verificare la conformità dei dati alla distribuzione di Poisson, il biologo ottiene un $p_\text{value}=`r pval_poisson`$. Il modello Poisson è adeguato?

### Esercizio 5
`r i1 <- i1+1`

`r item(T)` (**Punti 12**) In un'indagine sull'opinione sul reddito di inclusione sono stati intervistate 150 persone che vivono al nord e 180 che vivono al sud: 60 su 150 che vivono al nord sono favorevoli al reddito di cittadinanza mentre 95 su 180 che vivono al sud sono favorevoli. 

Testare all'un percento che la proporzione di persone favorevoli al reddito di cittadinanza che vivono al sud sia uguale a quelle di quelli che vivono al nord, contro l'alternativa che siano diverse.

`r item()` (**Punti 2**) Calcolare e discutere il $p$-value del test precedente.

:::{.sol data-latex=""}
```{r}
s1 <- 60
n1 <- 150
s2 <- 95
n2 <- 180
h1 <- "\\neq"
alpha <- 0.01
a <- "N"
b<- "S"
um <- ""
ztest_2c_pi(s1 = s1,s2 = s2,n1 = n1,n2 = n2,h1 = h1,alpha = alpha,a = a,b = b)
```
:::


### Esercizio 6
`r i1 <- i1+1`

```{r}
set.seed(12)
n <- 50
x <- round(runif(n = n,min = 8,20),0) # Anni di studio
y <- round(abs(1.1*x + rnorm(n, 0, 2.25)) + 0) # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di \(n=`r n`\) individui, sono stati analizzati il livello di istruzione (in anni di studio, \(X\)) e il numero di libri letti l'anno (\(Y\)).
Si osservano le seguenti statistiche:
, $\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r item(T)` (**Punti 14**) Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r,results='asis'}
calcolo_beta()
residuo(x = x[3],y = y[3])
```
:::


`r item()` (**Punti 3**) Dare un'interpretazione dei parametri di regressione stimati.

`r item()` (**Punti 2**) Definire gli outliers.

`r item()` (**Punti 2**) Se in un modello di regressione $r=0$ cosa significa?

`r item()` (**Punti 2**) Se in un modello di regressione $r=0.55$, $\hat\sigma_Y=0.9$ e $\hat\beta_1=1.5$, quanto varrà
$\hat\sigma_X$, la standard deviation di $X$?


## Prova di Statistica 2024/06/21-1




### Esercizio 1
```{r}
i1 <- 1
# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 250      # ampiezza campionaria

brk  <- c(0,1.5,3,8,20)
nnn  <- c( 200,100,80, 50)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(x = stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie dell'Emilia-Romagna sono stati rilevati i consumi annui in beni tecnologici (dati espressi in migliaia di euro). Qui di seguito la distribuzione delle frequenze cumulate:

```{r}
kable(dat3[,c(1,2,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
i2 <- 0
```

`r item(T)` (**Punti 14**) Disegnare l'istogramma di densità percentuale. 

:::{.sol data-latex=""}
```{r}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r item()` (**Punti 3**) Quante famiglie spendono meno di 5 mila euro all'anno? 

:::{.sol data-latex=""}
```{r}
F_print(x = 5,verso = "<")
```
:::  


`r item()` (**Punti 2**) Che relazione dobbiamo aspettarci tra media,  mediana e moda? 

`r item()` (**Punti 2**) La spesa media è pari a $\bar x=`r mean(samp)`$, mentre la SD è pari a $SD=`r sd(samp)`$.
Se ogni famiglia spendesse 2 mila euro in più all'anno, quanto varrebbero la media e la SD dei dati trasformati?

### Esercizio 2 
`r i1 <- i1+1`

`r item(T)` (**Punti 14**) Si consideri un'urna che ha una pallina bianche e due nere. Si estrae 4 volte con reinserimento. Sia $X$ la variabile casuale che conta il numero di bianche su 4 estrazioni. Calcolare la probabilità che $X\leq 2$.

:::{.sol data-latex=""}
```{r,results='asis'}
bin_dis(x1 = 2,n = 4,pp = 1/3,comp = F)
```
:::  

`r item()` (**Punti 3**) Sia $X$ la VC del punto precedente e sia $Y\sim N(0,1)$, $X$ ed $Y$ indipendenti. Considerato $A=\{X\leq 2\}$, $B=\{Y<1\}$, calcolare $P(A\cup B)$.

:::{.sol data-latex=""}
```{r,results='asis'}
pa <- pbinom(2,4,1/3)
pb <- pnorm(1)
p_aub(pa,pb)
```
:::  


`r item()` (**Punti 2**) Se $A$ e $B$, sono due eventi tali che $P(B|A)=1$, determinare $A\cap B$.

:::{.sol data-latex=""}
Se $P(B|A)=P(A\cap B)/P(A)$ e $P(B|A)=P(A\cap B)/P(A)=1$ se e solo se $P(A\cap B)=P(A)$ e quindi $A\cap B = A$.
:::

`r item()` (**Punti 2**) Sia $X$ una Bernoulli di parametro $\pi$, $X\sim\text{Ber}(\pi)$ e sia $F$ la sua funzione di ripartizione. Se $F(0)=0.6$, quanto vale $\pi$?

### Esercizio 3 

`r i1 <- i1+1`

(**Punti 14**) Un'urna contiene 6 premi da $\mbox{0}$ euro, 3 premi da $\mbox{1}$ euro e un premio da $\mbox{2}$ euro.
Si estrae 100 volte con reintroduzione. 
Qual è la probabilità di vincere più di 55 euro?

:::{.sol data-latex=""}

```{r}
n <- 100
mx <- sum(0:2*c(6,3,1)/10)
vx <- sum((0:2)^2*c(6,3,1)/10)-mx^2
stat_(rep(0:2,times=c(6,3,1)),semp = T)
tlc("somma",55,verso = ">",mu = mx,s2 = vx,n = n)
```
:::

### Esercizio 4 

`r i1 <- i1+1`
  
`r item(T)` (**Punti 3**) Si consideri il modello normale $X\sim N(\mu,\sigma^2)$. Sia $\hat\mu$ lo stimatore di massima verosimiglianza per $\mu$

$$
  \hat\mu = \frac 1n \sum_{i=1}^n X_i
$$

Ricavare il suo _Standard Error_ teorico e quello stimato.

`r item()` (**Punti 3**) Se $\hat\theta$ è lo stimatore di massima verosimiglianza 
per $\theta$, con $E(\hat\theta)=\theta$ e $V(\hat\theta)=I^{-1}(\theta)$. 
Com'è distribuito asintoticamente $\hat\theta$?

`r item()` (**Punti 3**) Definire la significatività di un test.

```{r}
tabella <- matrix(c(15, 20, 25, 25, 30, 25, 35, 30, 15), nrow = 3, ncol = 3, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(t(tabella))$p.value, digits = 4, nsmall = 4)
```

`r item()` (**Punti 3**) Un nutrizionista sta conducendo uno studio sull'associazione tra il tipo di dieta e lo stato di salute. Ha somministrato un questionario a `r n` partecipanti, chiedendo loro di indicare il proprio stato di salute  Ottimo, Buono, Scarso e il tipo di dieta seguito (Vegano, Vegetariano, Onnivoro). L'obiettivo è determinare se c'è un'associazione tra il tipo di dieta e lo stato di salute.

```{r}

# Assegnazione dei nomi alle righe e alle colonne
colnames(tabella) <-  c("Ottimo", "Buono", "Scarso")
rownames(tabella) <- c("Vegano", "Vegetariano", "Onnivoro")

tabl((tabella)) %>%
  kable_styling(full_width = F) %>%
  kable_paper(full_width = F) %>%
  pack_rows("Tipo di Dieta", 1, 3) %>%
  add_header_above(c(" " = 1, "Stato di Salute" = 3))


```

Eseguito il test del $\chi^2$ per verificare l'indipendenza tra il livello di istruzione e il comportamento di voto, il sociologo ottiene un $p_\text{value}=`r pval`$. Quali conclusioni può trarne?


### Esercizio 5
`r i1 <- i1+1`

```{r}
set.seed(9)
n <- 25
sig <- 2
x <- round(runif(n = n,min = 0,20),2) # reddito
y <- round(0.9+0.2*x+rnorm(n,0,sig),2) # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 2))
```

In uno studio sui consumi, in un campione di \(n=`r n`\) individui, sono stati analizzati il reddito  (in migliaia di euro, \(X\)) e il consumo (in migliaia di euro, \(Y\)).

Si osservano le seguenti statistiche:
$\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r item(T)` (**Punti 14**) Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r,results='asis'}
calcolo_beta()
residuo(x = x[3],y = y[3])
```
:::

`r item()` (**Punti 3**) Qual è la percentuale di varianza spiegata dal modello?

:::{.sol data-latex=""}
```{r,results='asis'}
R2()
```
:::


`r item()` (**Punti 2**) perché la previsione per $x=`r round(mx)`$ è più affidabile di quella per $x=`r round(10*mx)`$.

`r item()` (**Punti 2**) Se in un modello di regressione $r=-1$ cosa significa?

`r item()` (**Punti 2**) Se in un modello di regressione $r=0.75$, $\hat\sigma_X=0.8$ e $\hat\beta_1=1.2$, calcolare
$\hat\alpha_1$, la stima del coefficiente angolare del modello

$$
X_i = \alpha_0+\alpha_1 Y_i + \delta_i, \qquad E(\delta_i)=0; V(\delta_i)=\sigma_\delta^2
$$

dove la $X$ è spiegata dalla $Y$.

:::{.sol data-latex=""}
Per trovare la stima del coefficiente angolare \(\hat\alpha_1\), possiamo usare la relazione tra il coefficiente di correlazione \(r\), la deviazione standard di \(X\) (\(\hat\sigma_X\)) e la stima del coefficiente di regressione \(\hat\beta_1\).

La formula per il coefficiente di regressione \(\hat\beta_1\) in termini di \(r\), \(\hat\sigma_X\) e \(\hat\sigma_Y\) è:

\[
\hat\beta_1 = r \cdot \frac{\hat\sigma_X}{\hat\sigma_Y}
\]

Dove \(\hat\sigma_Y\) è la deviazione standard di \(Y\). Dato che abbiamo \(\hat\beta_1 = 1.2\), \(r = 0.75\) e \(\hat\sigma_X = 0.8\), possiamo isolare \(\hat\sigma_Y\) nella formula:

\[
1.2 = 0.75 \cdot \frac{0.8}{\hat\sigma_Y}
\]

Da cui:

\[
\hat\sigma_Y = 0.75 \cdot 0.8 / 1.2
\]

Calcolando il valore:

```{r}
sigma_X <- 0.8
beta_1 <- 1.2
r <- 0.75

sigma_Y <- (r * sigma_X) / beta_1

```

\[
\hat\sigma_Y \approx `r sigma_Y`
\]

Ora possiamo trovare \(\hat\alpha_1\) usando il valore di \(\hat\sigma_Y\):


```{r}
alpha_1 <- r * (sigma_X / sigma_Y)
```

\begin{eqnarray}
   \hat\alpha_1 &=& r \cdot \frac{\hat\sigma_X}{\hat\sigma_Y}\\
               &\approx& `r alpha_1`
\end{eqnarray}
  

Pertanto, la stima del coefficiente angolare \(\hat\alpha_1\) è approssimativamente `r alpha_1`.
:::


`r item()` (**Punti 14**) Testare l'ipotesi che $\beta_1$ sia uguale a zero, contro l'alternativa che sia diverso per $\alpha=0.1,0.05,0.01,0.001$ e dare una valutazione approssimativa del $p_\text{value}$ (ad esempio il $p_\text{value}$ è minore di 0.001, compreso tra 0.05 e tra 0.01, ecc.).

:::{.sol data-latex=""}
```{r}
ttest_beta(1,0,SE = T)
```
:::




## Prova di Statistica 2024/06/21-2




### Esercizio 1
```{r}
i1 <- 1
# Basic settings
set.seed(10)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- c(0,1.5,3,5,20)
nnn  <- c( 30,100,110, 50)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n,rand = F)
  
ls2e(x = stat_base(samp,brk))

n_ER <- n 
n_L <- n_ER + 20 
n_V <- n_ER - 10 
set.seed(10) 
x_ER <- mean(samp) 
x_L <- mean(samp) + rnorm(1, 0, sd(samp))
x_V <- mean(samp) + rnorm(1, 0, sd(samp))
# Calcolo della media aggregata
x_agg <- (n_ER * x_ER + n_L * x_L + n_V * x_V) / (n_ER + n_L + n_V)

```

Su un campione di $`r n`$ famiglie dell'Emilia-Romagna sono stati rilevati i consumi annui in beni tecnologici (dai espressi in migliaia di euro). Qui di seguito la distribuzione delle frequenze relative:

```{r}
kable(dat3[,c(1,2,4)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
i2 <- 0
```

`r item(T)` (**Punti 14**) Individuare l'intervallo modale. 

:::{.sol data-latex=""}
```{r}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r item()` (**Punti 3**) Quante famiglie spendono più del 25-esimo percentile $x_{0.25}$? 

:::{.sol data-latex=""}
```{r}
F_print(x = Q.int(.25),verso = ">")
```
:::  

`r item()` (**Punti 2**) La media è pari a $\bar x=`r p(mean(samp),2)`$, senza disegnare l'istogramma, che forma distributiva dobbiamo aspettarci?

`r item()` (**Punti 2**) `r round_all(2)`La spesa media della regione Emilia-Romagna, calcolata su `r n_ER` famiglie è pari $\bar x_{ER}=`r x_ER`$, quella della Lombardia, calcolata su `r n_L` famiglie è pari $\bar x_{L}=`r x_L`$, mentre quella del Veneto,  calcolata su `r n_V` famiglie è pari $\bar x_{V}=`r x_V`$. Qual è la spesa media complessiva delle tre regioni?

:::{.sol data-latex=""}
Per trovare la spesa media delle tre regioni aggregate, dobbiamo considerare sia le medie delle singole regioni sia il numero di famiglie su cui sono state calcolate. La formula per la media aggregata \(\bar{x}_{agg}\) è:

\begin{eqnarray}
\bar{x}_{agg}    &=&  \frac{n_{ER} \bar{x}_{ER} + n_{L} \bar{x}_{L} + n_{V} \bar{x}_{V}}{n_{ER} + n_{L} + n_{V}}\\
&=& \frac{`r n_ER`\cdot`r x_ER`+`r n_L`\cdot`r x_L`+`r n_V`\cdot`r x_V`}{`r n_ER`+`r n_L`+`r n_V`}\\
&=& `r x_agg`
\end{eqnarray}
  

Dove:

- \(n_{ER}\) è il numero di famiglie in Emilia-Romagna
- \(n_{L}\) è il numero di famiglie in Lombardia
- \(n_{V}\) è il numero di famiglie in Veneto
- \(\bar{x}_{ER}\), \(\bar{x}_{L}\), \(\bar{x}_{V}\) sono le spese medie delle rispettive regioni

:::  



### Esercizio 2 
`r i1 <- i1+1`

`r item(T)` (**Punti 14**) Sia $X$ il numero di telefonate in arrivo ad un centralino di emergenza, si assume $X\sim\text{Pois}(1.2)$. Calcolare la probabilità che $X\geq 2$.

:::{.sol data-latex=""}
```{r,results='asis'}
pois_dis(x1 = 2,ll = 1.2,verso = "\\geq")
```
:::  

`r item()` (**Punti 3**) Siano $X\sim\text{Pois}(1.2)$ e $Y\sim\text{Binom}(n=2,\pi=0.5)$, $X$ e $Y$ indipendenti, posto $A=\{X\geq 2\}$, $B=\{Y=0\}$, calcolare $P(A\cup B)$.

:::{.sol data-latex=""}
```{r,results='asis'}
pa <- 1-sum(dpois(0:1,1.2))
pb <- .5^2
```
\begin{eqnarray}
  P(A) &=&  `r pa`\\
  P(B) &=& 0.5^2 = `r pb`
\end{eqnarray}
  
```{r}
p_aub(pa = pa,pb = pb)
```
:::  

`r item()` (**Punti 2**) Se $A$ e $B$ sono due eventi diversi da $\emptyset$, se
$P(A|B)=0$ in che relazione sono $A$ e $B$?


`r item()` (**Punti 2**) Sia $X$ una variabile casuale con supporto $S_X=c\{-1,0,2\}$ e con funzione di probabilità
$$
f(x)=\begin{cases}
\frac 25, &\text{ se $x=-1$}\\
\frac 25, &\text{ se $x=\phantom{-} 0$}\\
\frac 15, &\text{ se $x=\phantom{-} 2$}\\
\end{cases}
$$
Disegnare le sua funzione di ripartizione, $F(x)$, nell'intervallo $-2\leq x\leq 3$.

:::{.sol data-latex=""}
```{r}
x <- c(-2,-1,0,2,3)
px <- c(0,c(2,2,1)/5,0)
plot(x,pbinom(x,2,.5),type="n",ylab="F(x)",axes = F)
axis(1,x)
axis(2,cumsum(px),las=2)
segments(x[1:4],cumsum(px)[1:4],x[2:5],cumsum(px)[1:4])
segments(x[2:4],cumsum(px)[1:3],x[2:4],cumsum(px)[2:4],lty=2)
points(x[2:4],cumsum(px)[1:3])
points(x[2:4],cumsum(px)[2:4],pch=16)
```
:::

### Esercizio 3 

`r i1 <- i1+1`

(**Punti 14**) Un'urna 4 premi da $\mbox{0}$ euro, 1 premio da $\mbox{2}$ euro.
Si estrae 50 volte con reintroduzione. 
Qual è la probabilità che la proporzione di premi da 2 euro sia compresa tra 0.20 e 0.23.

:::{.sol data-latex=""}
```{r}
n <- 50
mx <- sum(0:2*4:2/9)
vx <- sum((0:2)^2*4:2/9)-mx^2
urn <- c(0,0,0,0,1,1,1,2,2)
stat_(urn,semp = T)
tlc("prop",1/5,x2 = .23,verso = NULL,mu = 1/5,n = n)
```
:::

### Esercizio 4 

`r i1 <- i1+1`
  
`r item(T)` (**Punti 3**) Si consideri il modello di Bernoulli $X\sim\text{Ber}(\pi)$. Sia $\hat\pi$ lo stimatore di massima verosimiglianza per $\pi$

$$
  \hat\pi = \frac 1n \sum_{i=1}^n X_i
$$

Ricavare il suo _Standard Error_ teorico e quello stimato.

`r item()` (**Punti 3**) Cosa significa che lo stimatore di massima verosimiglianza è invariante alle trasformazioni monotone invertibili?

`r item()` (**Punti 3**) Siano $T_1$ e $T_2$ due test per lo stesso sistema di ipotesi con la stessa significatività $\alpha$, sia $\beta_1=0.23$ la probabilità di errore di secondo tipo del test $T_1$ e $\beta_2=0.18$ la probabilità di errore di secondo tipo del test $T_2$. Quale dei due test è più potente?

`r item()` (**Punti 3**)  In un'indagine sull'opinione sul reddito di inclusione sono stati intervistate 150 persone che vivono al nord e 180 che vivono al sud: 60 su 150 che vivono al nord sono favorevoli al reddito di cittadinanza mentre 95 su 180 che vivono al sud sono favorevoli. 
Messo a test

$$
\begin{cases}
   H_0: \pi_\text{N} = \pi_\text{S} \\
   H_1: \pi_\text{N} \neq \pi_\text{S} 
\end{cases}
$$

è risultato  $p_{\text{value}} =0.0206$. Cosa possiamo concludere?


### Esercizio 5
`r i1 <- i1+1`

```{r}
set.seed(9)
n <- 50
x <- round(runif(n = n,min = 8,20),0) # Anni di studio
y <- round(100 -.2*x^2.5 + rnorm(n, 0, 20),2) # Reddito annuo in migliaia di euro
y <- (y - min(y))/(max(y)-min(y))*10
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di \(n=`r n`\) individui, sono stati analizzati il livello di istruzione (in anni di studio, \(X\)) e la propensione a credere in teorie del complotto (in opportuna scala, \(Y\)). 

Si osservano le seguenti statistiche:
$\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r item(T)` (**Punti 14**) Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r,results='asis'}
calcolo_beta()
residuo(x = x[3],y = y[3])
```
:::

`r item()` (**Punti 3**) Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r,results='asis'}
R2()
```
:::

`r item()` (**Punti 2**) Interpretare il diagramma dei residui.

```{r, fig.width=5, fig.height=3.5}
par(mar=c(4,4,0,2),cex=.8)
plot(x, es, ylab=expression(hat(epsilon)), pch=16, cex=.5, axes=F)
axis(1, cex=1)
axis(2, cex=1)
abline(h=0, lty=2)
```


`r item()` (**Punti 2**) Se in un modello di regressione $r^2=1$ cosa significa?

`r item()` (**Punti 2**) Se in un modello di regressione $r<0$ che segno avrà $\hat\beta_1$? Perché?

`r item()` (**Punti 14**) Testare l'ipotesi che $\beta_0$ sia uguale a 16.4, contro l'alternativa che sia minore per $\alpha=0.1,0.05,0.01,0.001$ e dare una valutazione approssimativa del $p_\text{value}$ (ad esempio il $p_\text{value}$ è minore di 0.001, compreso tra 0.05 e tra 0.01, ecc.).

:::{.sol data-latex=""}
```{r}
ttest_beta(0,16.4,h1 = "<",SE = T)
```
:::




## Prova di Statistica 2024/06/21-3




### Esercizio 1
```{r}
i1 <- 1
# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- c(0,1.5,3,8,20)
nnn  <- c( 50,100,110, 20)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(x = stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie dell'Emilia-Romagna sono stati rilevati i consumi annui in beni tecnologici (dai espressi in migliaia di euro). Qui di seguito la distribuzione delle densità percentuali:

```{r}
kable(dat3[,c(1,2,6)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
i2 <- 0
```

`r item(T)` (**Punti 14**) Calcolare il valore approssimativo della mediana. 

:::{.sol data-latex=""}
```{r}
percentile()
histp(T)
draw_dist(dist = H.int,z1 = 4,z2 = 10)
```
:::

`r item()` (**Punti 3**) Qual è la percentuale di famiglie spendono più del 55-esimo percentile $x_{0.55}$? 

:::{.sol data-latex=""}
```{r}
F_print(x = Q.int(.55),verso = ">")
```
:::  

`r item()` (**Punti 2**) La media è pari a $\bar x=`r p(mean(samp),2)`$, senza disegnare l'istogramma, che forma distributiva dobbiamo aspettarci?

`r item()` (**Punti 2**) La spesa media è pari a $`r mean(samp)`$, mentre la varianza è pari a $`r s2c(samp)`$.
Se ogni famiglia diminuisse la propria spesa del 2%, quanto varrebbero la media e la varianza dei dati così trasformati?

:::{.sol data-latex=""}
\[
\bar y = `r 0.98*mean(samp)`\qquad \sigma^2 = `r (0.98)^2*s2c(samp)`
\]
:::  


### Esercizio 2 
`r i1 <- i1+1`

`r item(T)` (**Punti 14**) Sia $X\sim N(6,0.5)$ e sia $Y\sim N(6,0.5)$, $X$ e $Y$ indipendenti sia $A=\{X>5\}$ e $B=\{Y<7\}$. 
Calcolare $P(A\cup B)$.

:::{.sol data-latex=""}
```{r,results='asis'}
norm_int(x1 =  5,verso = ">",mm =  6,ss = 0.5,vnam = "X")
norm_int(x1 = 7,verso = "<",mm = 6,ss = 0.5,vnam = "Y")
zx <- round((5-6)/sqrt(0.5),2)
zy <- round((7-6)/sqrt(0.5),2)
pa <- pnorm(zx,lower.tail = F)
pb <- pnorm(zy,lower.tail = T)
p_aub(pa,pb)
```
:::  

`r item()` (**Punti 3**) , posto $W=X-Y$, calcolare $P(W<1|W>-1)$.

:::{.sol data-latex=""}
```{r,results='asis'}
pab <- pnorm(1)-pnorm(-1)
pb  <- pnorm(-1,lower.tail = F)
```
$$ 
P(W<1|W>-1)=\frac{P(-1<W<1)}{P(W>-1)}=\frac{`r pab`}{`r pb`}=`r pab/pb`
$$
:::  

`r item()` (**Punti 2**) Se $P(A)=0.4$ e $P(B)=0.7$, è possibile che $A\cap B=\emptyset$? Perché?

:::{.sol data-latex=""}
No perché se fosse $A\cap B=\emptyset$, allora
\begin{eqnarray}
P(A \cup B)    &=&  P(A) + P(B) - P(A\cap B)\\
               &=&  P(A) + P(B) - P(\emptyset)\\
               &=&  P(A) + P(B) - 0 \\
               &=&  0.4 + 0.7\\
               &=& 1.3 > 1 \qquad\text{impossibile}
\end{eqnarray}
  
:::

`r item()` (**Punti 2**) Sia $X\sim\text{Binom}(n=2,\pi=0.5)$ e sia $F$ la sua funzione di ripartizione. Disegnare $F(x)$ nell'intervallo $-1\leq x\leq 3$

:::{.sol data-latex=""}
```{r}
bin_dis(x1 = 0,n = 2,pp = .5)
bin_dis(x1 = 1,n = 2,pp = .5)
bin_dis(x1 = 2,n = 2,pp = .5)
x <- (-1):3
px <- dbinom(x,2,.5)
plot(x,pbinom(x,2,.5),type="n",ylab="F(x)",axes = F)
axis(1,x)
axis(2,cumsum(px),las=2)
segments(x[1:4],cumsum(px)[1:4],x[2:5],cumsum(px)[1:4])
segments(x[2:4],cumsum(px)[1:3],x[2:4],cumsum(px)[2:4],lty=2)
points(x[2:4],cumsum(px)[1:3])
points(x[2:4],cumsum(px)[2:4],pch=16)
```
:::

### Esercizio 3 

`r i1 <- i1+1`

(**Punti 14**) Un'urna 3 premi da $\mbox{0}$ euro, un premio da $\mbox{1}$ euro.
Si estrae 100 volte con reintroduzione. 

Qual è la probabilità che la la vincita totale sia maggiore di 30?

:::{.sol data-latex=""}

```{r}
n <- 100
mx <- 1/4

tlc("somma",30,verso = ">",mu = mx,n = n)
```
:::

### Esercizio 4 

`r i1 <- i1+1`
  
`r item(T)` (**Punti 3**) Si consideri il modello binomiale $X\sim\text{Pois}(\lambda)$. Sia $\hat\lambda$ lo stimatore di massima verosimiglianza per $\mu$

$$
  \hat\lambda = \frac 1n \sum_{i=1}^n X_i
$$

Ricavare il suo _Standard Error_ teorico e quello stimato.

`r item()` (**Punti 3**) Che differenza c'è tra lo Standard Error di uno stimatore e la Deviazione Standard di popolazione?

`r item()` (**Punti 3**) Definire gli errori di primo e di secondo tipo e le relative probabilità.

```{r}
# Definizione dei dati osservati
observed <- c(13, 5, 10, 10, 8, 7, 4)
total <- sum(observed)
lambda <- sum((0:(length(observed) - 1)) * observed) / total
expected <- dpois(0:(length(observed) - 1), lambda) * total
chisq_result <- chisq.test(observed, p = expected / sum(expected))
pval_poisson <- format(chisq_result$p.value, digits = 4, nsmall = 4)
```

`r item()` (**Punti 3**) Un economista sta studiando il numero di piccole imprese che aprono ogni mese in una certa regione. Ha raccolto dati sul numero di nuove imprese in `r total` mesi. I dati osservati sono riportati nella tabella seguente. L'obiettivo è determinare se i dati seguono una distribuzione di Poisson.

```{r}
# Definizione dei dati osservati

# Creazione della tabella
dati <- data.frame(
  Numero = 0:(length(observed) - 1),
  Osservati = observed,
  Attesi = round(expected, 2)
)


kable(t(dati), caption = "Numero di nuove piccole imprese settimanale.") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

```

Eseguito il test del $\chi^2$ per verificare la conformità dei dati alla distribuzione di Poisson, il biologo ottiene un $p_\text{value}=`r pval_poisson`$. Il modello Poisson è adeguato?

### Esercizio 5
`r i1 <- i1+1`

```{r}
s1 <- 1.1
n1 <- 18
mu1 <- 1.8
mu2 <- 0.8
s2 <- 0.9
n2 <- 21
h1 <- "\\neq"
alpha <- 0.01
a <- "$N$"
b<- "$S$"
```

`r item(T)` (**Punti 14**) In un'indagine sui consumi in beni alimentari sono stati intervistati 13 nuclei familiari al Nord d'Italia e 15 al Sud.
Per le $n_N=`r n1`$ famiglie del nord si è osservato un consumo medio pari a $\mu_N=`r mu1`$ mila euro con una deviazione standard pari a $\hat\sigma_N=`r s1`$ mila euro, mentre per le $n_S=`r n2`$ famiglie del sud si è osservato un consumo medio pari a $\mu_S=`r mu2`$ mila euro con una deviazione standard pari a $\hat\sigma_S=`r s2`$ mila euro.

Sotto ipotesi di omogeneità, testare l'ipotesi che il consumo medio sia uguale tra nord e sud, contro l'alternativa che sia maggiore al nord,
per $\alpha=0.1,0.05,0.01,0.001$ e dare una valutazione approssimativa del $p_\text{value}$ (ad esempio il $p_\text{value}$ è minore di 0.001, compreso tra 0.05 e tra 0.01, ecc.).


:::{.sol data-latex=""}
```{r}
ttest_2c_om(mu1 = mu1,mu2 = mu2,s1h = s1,s2h = s2,n1 = n1,n2 = n2,h1 = ">",a = a,b = b,um = "mila euro")
```
:::


### Esercizio 6
`r i1 <- i1+1`

```{r}
set.seed(9)
n <- 50
x <- round(runif(n = n,min = 0,8),2) # Anni di studio
y <- round(10 -.2*x^2 + rnorm(n, 0, 1.5),2) # Reddito annuo in migliaia di euro
y <- (y - min(y))/(max(y)-min(y))*10
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sull'uso delle nuove tecnologie, in un campione di \(n=`r n`\) individui, sono stati analizzati il tempo passato sui social (in ore al giorno, \(X\)) e il numero di libri letti in un anno  \(Y\). 
Si osservano le seguenti statistiche: 
$\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r item(T)` (**Punti 14**) Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r,results='asis'}
calcolo_beta()
residuo(x = x[3],y = y[3])
```
:::


`r item()` (**Punti 3**) Dare un'interpretazione dei parametri di regressione stimati.

`r item()` (**Punti 2**) Definire i punti di leva e indicare una misura per misurarli.

`r item()` (**Punti 2**) Se in un modello di regressione $r^2=0$ cosa significa?

`r item()` (**Punti 2**) Se in un modello di regressione $r=0.55$, $\hat\sigma_Y=0.9$ e $\hat\beta_1=1.5$,  calcolare
$\hat\alpha_1$, la stima del coefficiente angolare del modello

$$
X_i = \alpha_0+\alpha_1 Y_i + \delta_i, \qquad E(\delta_i)=0; V(\delta_i)=\sigma_\delta^2
$$

dove la $X$ è spiegata dalla $Y$.
