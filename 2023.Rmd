
```{r 2023-105}
rm(list = rm())
source("intro.R")
if (html) cat('')
```
  
  
# Anno 2023

```{r 2023-106}
source("punti.R")
punti_list <- punti_2023
compito <- 0
```


<div class="button-container"></div>

## Prova di Statistica 2023/01/11-1


### Esercizio 1

```{r 20231}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-107}

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria
nomex <- "Investimento"

brk  <- c(0,1.5,3,5,10)
nnn  <- c( 20,110,100, 10)
nnn  <- round(nnn/sum(nnn)*n)
samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))

```

Su un campione di $`r n`$ famiglie della provincia di Modena è stato rilevato l'investimento annuo in prodotti finanziari (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze assolute:

```{r 2023-108}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale. 

:::{.sol data-latex=""}
```{r 2023-109}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp()
axis(1,brk)
axis(2,round(dat2$hj,2))
```
:::

`r punti_p()` Che percentuale di famiglie investe più di 4.5 mila euro all'anno?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \%(X>4.5) &=&  (5.0-4.5)\times`r dat2$hj[3]`+`r dat2$fj[4]*100`\\
  &=& `r (1-F.int(4.5))*100`
\end{eqnarray*}
:::

`r punti_p()` Che relazione dobbiamo aspettarci tra media e mediana? 

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$, mentre la SD è pari a $SD=`r sd(samp)`$.
Se ogni famiglia aumentasse il proprio investimento di 0.5 mila euro, quanto varrebbero la media e la SD dei dati così trasformati?



### Esercizio 2 

`r punti_p(nex = T)` Siano $X\sim N(10,1.5)$ e sia $Y\sim N(10,0.5)$, $X$ e $Y$ indipendenti. Posto $A=\{8<X<10\}$, $B=\{Y<11\}$. 
Quanto vale $P(A\cup B)$? 

:::{.sol data-latex=""}
```{r 2023-1,,results='asis'}
res1 <- norm_int(x1 = 8,x2 = 10,mm = 10,ss = 1.5,verso = NULL,vnam = "X",mu = "\\mu_X",sigma = "\\sigma_X")
res2 <- norm_int(x1 = 11,x2 = 10,mm = 10,ss = 0.5,verso = "<",vnam = "Y",mu = "\\mu_Y",sigma = "\\sigma_Y")
cat(res1)
cat(res2)
```

\begin{eqnarray*}
  P(A\cup B) &=&  `r .5-pnorm(8,10,sqrt(1.5))`+ `r pnorm(11,10,sqrt(0.5))`-`r (.5-pnorm(8,10,sqrt(1.5)))*pnorm(11,10,sqrt(0.5))`\\
             &=&  `r .5-pnorm(8,10,sqrt(1.5)) +    pnorm(11,10,sqrt(0.5)) -   (.5-pnorm(8,10,sqrt(1.5)))*pnorm(11,10,sqrt(0.5))`\\
\end{eqnarray*}
:::


`r punti_p()` Un'urna contiene due palline rosse, due bianche e una nera. Si estrae due volte senza reinserimento. Qual è la probabilità di avere due colori diversi?  

:::{.sol data-latex=""}
\begin{eqnarray*}
  \text{due colori diversi} &=& RB\cup BR \cup\\
                            &&  RN\cup NR \cup\\
                            &&  BN\cup NB\\
  P(\text{due colori diversi}) &=& P(RB)+P(BR)+P(RN)+P(NR)+P(BN)+P(NB)\\
  &=& \frac 25\frac 24+\frac 25\frac 24+\frac 25\frac 14+\frac 15\frac 24+\frac 25\frac 14+\frac 15\frac 24\\
  &=& \frac{4+4+2+2+2+2}{20}\\
  &=& `r 16/20`
\end{eqnarray*}
:::

`r punti_p()` Se $X\sim\text{Pois}(3.2)$ e $Y\sim\text{Pois}(1.2)$, $X$ e $Y$ indipendenti, quali sono valore atteso e varianza di $X+Y$ e di $X-Y$? 

`r punti_p()` Sia $X$ una VC e sia $F$ la sua funzione di ripartizione. Cosa significa dire che $F$ è continua a destra?



### Esercizio 3 

`r punti_p(nex = T)` Un'urna contiene 4 palline numerate: $\fbox{0}$, $\fbox{0}$, $\fbox{0}$ e $\fbox{1}$. Si estrae 100 volte con reinserimento. Qual è la probabilità che la proporzione di palline timbrate con 1 nelle 100 estrazioni sia maggiore di 0.27?


  
:::{.sol data-latex=""}
\begin{eqnarray*}
  \pi &=&  \frac 14\\
  E(\hat\pi) &=& \frac 14\\
  V(\hat\pi) &=& \frac {1/4(1-1/4)}{100}\\
  &=& `r 1/4*3/4/100`
\end{eqnarray*}

```{r 2023-2,,results='asis'}
urn <- c(0,0,0,1)
mm <- mean(urn)
ss <- s2c(urn)
n <- 100
cat(tlc("prop",.27,verso = ">",mu = mm,s2 = ss,n=n))
```
:::


### Esercizio 4 
  
`r punti_p(nex = T)` Sia $\hat \lambda$ lo stimatore di massima verosimiglianza di $\lambda$ del modello di Poisson.
\begin{eqnarray*}
  \hat\lambda &=&  \frac 1n\sum_{i=1}^nx_i\\
\end{eqnarray*}
Ricavare il suo $MSE$ (Mean Squared Error). 

`r punti_p()` Si $h$ uno stimatore per $\theta$ tale che $E(h)=\theta$. Di quale proprietà gode $h$? 

`r punti_p()` Definire la potenza di un test. 

`r punti_p()` In uno studio sull'efficacia degli integratori alimentari, su un gruppo di 238 atleti è stato misurato il rendimento atletico (ottimo, buono e scarso) e l'assunzione di integratori (alto, medio e basso). Qui di seguito i dati:

```{r 2023-110}

x <- matrix(c(21,20,18,35,26,38,15,30,35),3)

dimnames(x)<-list(redimento=c("ottimo","buono","scarso"),reddito=c("alto","medio","basso"))
kable(x,booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")%>%
  kable_paper("striped", full_width = F) %>%
  pack_rows("rendimento", 1, 3) %>%
  add_header_above(c(" " = 1, "Integratori" = 3))
```

il test del chi-quadro sull'indipendenza tra rendimento e assunzione di integratori restituisce un $p_\text{value}=0.08$. Che cosa possiamo concludere?



### Esercizio 5 


```{r 2023-111}
n1 <- 35
muh1 <- 68
sdh1 <- 5.1
n2 <- 35
muh2 <- 71
sdh2 <- 4.5
```

`r punti_p(nex = T)` In uno studio sul gradimento dell'azione politica della regione, nel comune $A$ si è rilevata l'opinione su `r n1` intervistati misurata in una scala di gradimento che va da zero a 100. I dati campionari hanno evidenziato una media pari a $\hat\mu_A=`r muh1`$ e una deviazione standard osservata pari a $\hat\sigma_A=`r sdh1`$, mentre nel comune $A$ si è rilevata l'opinione su `r n1` intervistati misurata in una scala di gradimento che va da zero a 100. I dati campionari hanno evidenziato una media pari a $\hat\mu_B=`r muh2`$ e una deviazione standard osservata pari a $\hat\sigma_B=`r sdh2`$. Sotto ipotesi di omogeneità delle varianza testare l'ipotesi che il gradimento politico sia uguale nei due comuni contro l'alternativa che sia **diverso**.

:::{.sol data-latex=""}
```{r 2023-3,,results='asis'}
ttest_2c_om(mu1 = muh1,mu2 = muh2,s1h = sdh1,s2h = sdh2,n1 = n1,n2 = n2,h1 = "\\neq",a = "A",b = "B")

```
:::




### Esercizio 6 

```{r rg1}

set.seed(5)
set.seed(36)
n <- 150
x <- runif(n,1,60)
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- rnorm(n,0,.25)
y <- 1+log(x)+eps

x <- x/60
y <- y/10

RGX <- regr(x,y,semp = T)
ls2e(RGX)
```

In uno studio sul potere d'acquisto delle famiglie è stato selezionato un campione di 150 nuclei familiari 
a cui è stato chiesto il reddito annuo ($X$ espressa in scala di comodo) e la spesa annua in generi alimentari ($Y$ espressa in scala di comodo). Qui di seguito le statistiche bivariate

\begin{align*}
\sum_{i=1}^n x_i &= `r sumx`,   &\sum_{i=1}^n x_i^2 &= `r sumx2` \\
\sum_{i=1}^n y_i &= `r sumy`,   &\sum_{i=1}^n y_i^2 &= `r sumy2` \\
\sum_{i=1}^n x_iy_i &= `r sumxy`.    \\
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=1.5$ nel modello di regressione dove $Y$ viene spiegata da $X$. 

:::{.sol data-latex=""}
```{r 2023-112}
cat(calcolo_beta())
cat(previsione(1.5))
```
:::

`r punti_p()` Qual è la percentuale di varianza spiegata dal modello? 

:::{.sol data-latex=""}
$$r^2\times 100=`r r^2*100`$$
:::

`r punti_p()` Interpretare il diagramma dei residui. 
```{r 2023-4,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,ml$res,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-5,,results='asis'}
plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")

spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::

`r punti_p()` Se $W=- Y$, quanto varrà $r_{XW}$, coefficiente di correlazione tra $X$ e $W$?




<div class="button-container"></div>

## Prova di Statistica 2023/01/11-2

```{r 2023-113}

source("intro.R")




```


### Esercizio 1

```{r 2023-114}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-115}
# Basic settings
set.seed(2)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- rev(10-c(0,1.5,3,5,10))
nnn  <- rev(c( 20,110,100, 10))
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"
samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))

```

Su un campione di $`r n`$ famiglie della provincia di Modena è stato rilevato l'investimento annuo in prodotti obbligazionari (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze percentuali:

:::{.sol data-latex=""}
```{r 2023-116}
kable(dat3[,c(1,2,12)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```
:::

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale. 

:::{.sol data-latex=""}
```{r 2023-117}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp()
axis(1,brk)
axis(2,round(dat2$hj,2))
```
:::

`r punti_p()` Quante famiglie investono più di 8 mila euro all'anno? 

:::{.sol data-latex=""}
\begin{eqnarray*}
  \#(X>4.5) &=&  `r n`(\frac1{100}(8.5-8)\times`r dat2$hj[3]`+`r dat2$fj[4]`)\\
  &=& `r n*(1-F.int(8))`
\end{eqnarray*}
:::  

`r punti_p()` Che relazione dobbiamo aspettarci tra media e mediana? 

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$, mentre la SD è pari a $SD=`r sd(samp)`$.
Se ogni famiglia aumentasse il proprio investimento del 2 percento, quanto varrebbero la media e la SD dei dati così trasformati?





### Esercizio 2

`r punti_p(nex = T)` I clienti in fila nell'ora di punta alla cassa di un supermercato sono distribuiti come una Poisson di parametro 2.5 ($X\sim\text{Pois}(\lambda=2.5)$). Qual è la probabilità di trovare almeno 2 clienti in coda ($X\ge 2$)? 

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(X\ge 2) &=&  1-P(X<2)\\
  &=& 1-(P(X=0)+P(X=1))\\
  &=& 1-(`r dpois(0,2.5)`+`r dpois(1,2.3)`)\\
  &=& `r 1-(dpois(0,2.5)+dpois(1,2.3))`
\end{eqnarray*}

```{r 2023-118}
pois_dis(2,2.3,">")
```
:::

`r punti_p()` Un'urna contiene 5 palline: 2 rosse e 3 bianche. Si estrae con reintroduzione finché non escono 2 bianche consecutive. Calcolare la probabilità di finire in __esattamente__ 3 estrazioni. 

:::{.sol data-latex=""}
\begin{eqnarray*}
  \text{esattamente tre} &=& R\cap B\cap B \\
  P(\text{esattamente tre}) &=& P(R\cap B\cap B)\\
  &=&\frac 25 \frac 35\frac 35\\
  &=& `r 2*3*3/5^3`
\end{eqnarray*}
:::  

`r punti_p()` Se $X\sim N(3.2,1.5)$ e $Y\sim N(1.2,1.1)$, $X$ e $Y$ indipendenti, come si distribuiscono $X+Y$ e  $X-Y$? 

`r punti_p()` Sia $X$ una VC e sia $F$ la sua funzione di ripartizione. Cosa significa dire che $F$ è crescente?




### Esercizio 3

```{r 2023-119}
n <- 365
ex <- 0.08
vx <- 0.034
es <- mm <- n*ex
vs <- ss <- n*vx
#ss <- sqrt(vs)
# 
 # curve(dnorm(x,es,sqrt(ss)),from = es-4*sqrt(ss),to = es+4*sqrt(ss),axes=F)
 # axis(1)
 # curve(dnorm(x,es,sqrt(ss)),from = 30,to = es+4*sqrt(ss),add=T,type = "h",n=101)

```

`r punti_p(nex = T)` Un'urna contiene 4 palline numerate con $\fbox{0}$, $\fbox{3}$, $\fbox{4}$ e $\fbox{6}$. Si estrae 100 volte con reinserimento. Qual è la probabilità che la somme delle 100 estrazioni sia maggiore di 310?

:::{.sol data-latex=""}
```{r 2023-6,,results='asis'}
urn <- c(0,3,4,6)
mm <- mean(urn)
ss <- s2c(urn)
n <- 100
cat(stat_(x = urn))
cat(tlc(tipo = "somma",x1 = 310,verso = ">",mu = mm,s2 = ss,n = n))
```
:::




### Esercizio 4
  
`r punti_p(nex = T)` Sia $\hat \pi$ lo stimatore di massima verosimiglianza di $\pi$ del modello Binomiale.
\begin{eqnarray*}
  \hat\pi &=&  \frac 1n\sum_{i=1}^nx_i\\
\end{eqnarray*}
Ricavare il suo $MSE$ (Mean Squared Error). 

`r punti_p()` Si $h$ uno stimatore per $\theta$ tale che $E(h)=\theta$ e $\lim_{n\to\infty} V(h)=0$. Di quale proprietà gode $h$? 

`r punti_p()` Definire la significatività di un test. 

`r punti_p()` In uno studio sull'efficacia della formazione nella scelta degli investimenti finanziari sono stati analizzati due gruppi di investitori, un primo gruppo senza alcuno studio specifico e un secondo gruppo di laureati in scienze economiche o affini. Sotto ipotesi di eterogeneità della varianze si è messo a test l'ipotesi che il rendimento medio degli investimenti dei laureati in scienze economiche $\mu_E$ sia uguale a quello dei non laureati $\mu_N$, contro l'alternativa che $\mu_E>\mu_N$. Il test ha restituito un $p_\text{value}$ pari a 0.092. Cosa possiamo concludere?




### Esercizio 5

```{r 2023-120}
s1 <- 26
n1 <- 35
s2 <- 45
n2 <- 50
```


`r punti_p(nex = T)` In uno studio sul gradimento dell'azione politica della regione, nel comune $A$ si è rilevato che `r s1` persone su `r n1` intervistati è soddisfatto, mentre nel comune $B$, `r s2` su `r n2` sono soddisfatti.
Testare usando il $p_\text{value}$ l'ipotesi che la proporzione di disoccupati sia uguale nei due comuni, contro l'alternativa che si **maggiore** nel comune $B$. 


:::{.sol data-latex=""}
```{r 2023-7,,results='asis'}
ztest_2c_pi(s1 = s1,s2 = s2,n1 = n1,n2 = n2,h1 = "<",a = "A",b = "B")
```
:::



### Esercizio 6

```{r 2023-121}

set.seed(5)
set.seed(36)
n <- 150
x <- runif(n,1,60)
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- rnorm(n,0,.25)
y <- 10-log(x)+eps

x <- x/60
y <- y/10

RGX <- regr(x,y,semp = T)
ls2e(RGX)
```

In uno studio sul potere d'acquisto delle famiglie è stato selezionato un campione di 150 nuclei familiari 
a cui è stato chiesto il reddito annuo ($X$  espressa in scala di comodo) e gli aumenti dei prezzi percepiti ($Y$ espressa in opportuna scala). Qui di seguito le statistiche bivariate

\begin{align*}
\sum_{i=1}^n x_i &= `r sumx`,   &\sum_{i=1}^n x_i^2 &= `r sumx2` \\
\sum_{i=1}^n y_i &= `r sumy`,   &\sum_{i=1}^n y_i^2 &= `r sumy2` \\
\sum_{i=1}^n x_iy_i &= `r sumxy`.    \\
\end{align*}
 
`r punti_p(nex = T)` Stimare la previsione per $x=1.5$ nel modello di regressione dove $Y$ viene spiegata da $X$. 

:::{.sol data-latex=""}
```{r 2023-8,,results='asis'}
cat(calcolo_beta())
cat(previsione(1.5))
```
:::

`r punti_p()` Il modello si adatta bene ai dati? 

:::{.sol data-latex=""}
```{r 2023-9,,results='asis'}
R2(percent = F)
```
:::

`r punti_p()` Interpretare il diagramma dei residui. 
```{r 2023-122}
par(cex=.35)
plot(x,ml$res,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-10,,results='asis'}

plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es,df1=5,df2=5,a = 2 )
axis(1)
axis(2)
```
:::

`r punti_p()` Se $W= 1 - Y$, quanto varrà $r_{XW}$, coefficiente di correlazione tra $X$ e $W$?





<div class="button-container"></div>

## Prova di Statistica 2023/01/11-3

```{r 2023-123}

source("intro.R")




```


### Esercizio 1

```{r 2023-124}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-125}
# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 160      # ampiezza campionaria

brk  <- c(0,3.5,5,6.5,10)
nnn  <- c( 20,100,100, 20)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Modena è stato rilevato l'investimento annuo in prodotti finanziari (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze cumulate:

```{r 2023-126}
kable(dat3[,c(1,2,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale. 

:::{.sol data-latex=""}
```{r 2023-127}
kable(dat3[,1:6],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r punti_p()` Quante famiglie investono meno di 4.5 mila euro all'anno? 

:::{.sol data-latex=""}
\begin{eqnarray*}
  \#(X<4.5) &=&  `r n`(\frac1{100}(4.5-3.5)\times`r dat2$hj[2]`+`r dat2$fj[1]`)\\
  &=& `r n*(F.int(4.5))`
\end{eqnarray*}
:::  


`r punti_p()` Che relazione dobbiamo aspettarci tra media e mediana? 

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$, mentre la SD è pari a $SD=`r sd(samp)`$.
Se ogni famiglia diminuisse il proprio investimento del 2%, quanto varrebbero la media e la SD dei dati così trasformati?




### Esercizio 2

`r punti_p(nex = T)` Un'urna contiene 20 palline: 8 bianche e 12 nere, si estrae con reintroduzione 5 volte. 
Qual è la probabilità avere un numero di palline bianche maggiore o uguale a 2 su 5 estrazioni? 

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(X\ge 2) &=&  1-P(X<2)\\
  &=& 1-(P(X=0)+P(X=1))\\
  &=& 1-(`r dbinom(0,5,8/20)`+`r dbinom(1,5,8/20)`)\\
  &=& `r 1-dbinom(0,5,8/20)-dbinom(1,5,8/20)`
\end{eqnarray*}
:::  

`r punti_p()` Dalla stessa urna di prima, si estrae con reintroduzione finché non escono due palline bianche consecutive. Qual è la probabilità di finire in __al massimo__ 3 tentativi? 

:::{.sol data-latex=""}
\begin{eqnarray*}
  \text{al massimo tre} &=& (B\cap B)\cup(R\cap B\cap B )\\
  P(\text{al massimo tre}) &=& P(B\cap B)+P(R\cap B\cap B)\\
  &=&0.4\times 0.4 +0.6\times 0.4\times 0.4\\
  &=& `r .16*1.6`
\end{eqnarray*}
:::  

`r punti_p()` Se $X\sim N(3.2,1.1)$ e $Y\sim\text{Binom}(12,0.3)$, $X$ e $Y$ indipendenti, quali sono valore atteso e varianza di $X+Y$ e di $X-Y$? 

`r punti_p()` Sia $X$ una VC e sia $F$ la sua funzione di ripartizione. Quanto valgono $\lim_{x\to-\infty}F(x)$ e $\lim_{x\to+\infty}F(x)$?




### Esercizio 3

```{r 2023-128}
n <- 365
ex <- 0.08
vx <- 0.034
es <- mm <- n*ex
vs <- ss <- n*vx
#ss <- sqrt(vs)
# 
 # curve(dnorm(x,es,sqrt(ss)),from = es-4*sqrt(ss),to = es+4*sqrt(ss),axes=F)
 # axis(1)
 # curve(dnorm(x,es,sqrt(ss)),from = 30,to = es+4*sqrt(ss),add=T,type = "h",n=101)

```

`r punti_p(nex = T)` Un'urna contiene 4 palline numerate: $\fbox{0}$, $\fbox{1}$, $\fbox{4}$ e $\fbox{6}$. Si estrae 100 volte con reinserimento. Qual è la probabilità che la media delle 100 estrazioni sia maggiore di 2.8?

:::{.sol data-latex=""}
```{r 2023-11,,results='asis'}
urn <- c(0,1,4,6)
mm <- mean(urn)
ss <- s2c(urn)
n <- 100

cat(stat_(urn,semp=T))
cat(tlc("media",2.8,NUll,verso = ">",mu = mm,s2 = ss,n = n))
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Siano $\hat \mu$ e $\hat\sigma^2$ gli stimatori di massima verosimiglianza di $\mu$ e $\sigma^2$ del modello di Normale.
\begin{eqnarray*}
  \hat\mu &=&  \frac 1n\sum_{i=1}^nx_i \qquad \hat\sigma^2 =  \frac 1n\sum_{i=1}^n(x_i-\hat\mu)^2\\
\end{eqnarray*}
Ricavare il $MSE$ (Mean Squared Error) di $\hat\mu$. 

`r punti_p()` Si $h$ uno stimatore per $\theta$ tale che $E(h)\ne\theta$, ma che $\lim_{n\to\infty}E(h)=\theta$. Di quale proprietà gode $h$? 

`r punti_p()` Quali sono gli errori di primo e secondo tipo? 

`r punti_p()` In uno studio sull'efficacia degli integratori alimentari, a 120 atleti è stato somministrato un particolare integratore alimentare giornalmente e a 120 atleti è stato dato un placebo. Dopo 30 giorni di sperimentazione sono state eseguite prove fisiche che hanno restituito la performance degli atleti misurata in scala numerica. Gli atleti che hanno assunto l'integratore hanno ottenuto un risultato medio pari a $\hat\mu_\text{Integratore}=53.4$, mentre gli atleti che hanno assunto l'integratore hanno ottenuto un risultato medio pari a $\hat\mu_\text{Placebo}=50.8$.
Sotto ipotesi di omogeneità è stato messo a test
\[
\begin{cases}
H_0:\mu_\text{Integratore}=\mu_\text{Placebo}\\
H_1:\mu_\text{Integratore}>\mu_\text{Placebo}
\end{cases}
\]
il $p_\text{value}$ è risultato pari a $p_\text{value}=0.092$. Cosa possiamo concludere?



### Esercizio 5

```{r 2023-129}
n1 <- 35
muh <- 68
sdh <- 5
mu0 <- 71
```

`r punti_p(nex = T)` In uno studio sul gradimento dell'azione politica della regione, nel comune $A$ si è rilevata l'opinione su `r n1` intervistati misurata in una scala di gradimento che va da zero a 100. I dati campionari hanno evidenziato una media pari a $\hat\mu=`r muh`$ e una deviazione standard osservata pari a $\hat\sigma=`r sdh`$.
Costruire un intervallo di confidenza al 95% per il gradimento medio $\mu$. 

:::{.sol data-latex=""}
```{r 2023-12,,results='asis'}
options(digits = 4)
res <- idc(xm = muh,sd = sdh,alpha = .05,n = n1,dist_ = "t",mus = mu0,ss = "S")
cat(res)
```
:::

`r punti_p()` Un'indagine analoga, svolta sull'intera regione, ha mostrato un gradimento medio pari a $\mu_0=`r mu0`$. Testare l'ipotesi che nel comune A il livello di gradimento sia uguale a quello regionale contro l'alternativa che sia __minore__.

:::{.sol data-latex=""}
```{r 2023-13,,results='asis'}
res <- ttest_mu(muh = muh,sh = sdh,n = n1,mu0 = mu0,h1 = "<")
cat(res)
```
:::



### Esercizio 6

```{r 2023-130}

set.seed(5)
set.seed(4)
n <- 150
x <- sort(runif(n,0,10))
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- c(rnorm(90,0,.25),rnorm(60,0,.9))
y <- 1+x+eps
x <- x/10
y <- y/10

RGX <- regr(x,y,semp = T,ax=1)
ls2e(RGX)
```

In uno studio sul potere d'acquisto delle famiglie è stato selezionato un campione di 150 nuclei familiari 
a cui è stato chiesto il reddito annuo ($X$ espressa in scala di comodo) e la spesa annua in generi alimentari ($Y$ espressa in scala di comodo). Qui di seguito le statistiche bivariate

\begin{align*}
\sum_{i=1}^n x_i &= `r sumx`,   &\sum_{i=1}^n x_i^2 &= `r sumx2` \\
\sum_{i=1}^n y_i &= `r sumy`,   &\sum_{i=1}^n y_i^2 &= `r sumy2` \\
\sum_{i=1}^n x_iy_i &= `r sumxy`.    \\
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=1.5$ nel modello di regressione dove $Y$ viene spiegata da $X$. 

:::{.sol data-latex=""}
```{r 2023-131}
cat(calcolo_beta())
cat(previsione(1.5))
```
:::

`r punti_p()` Calcolare e interpretare $R^2$. 

:::{.sol data-latex=""}
```{r 2023-132}
R2()
```
:::

`r punti_p()` Interpretare il diagramma dei residui. 
```{r 2023-14,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,ml$res,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-15,,results='asis'}

plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
axis(1)
axis(2)

# Calcolare i residui al quadrato
res_squared <- abs(es)^(1.3)

# Regressione dei residui al quadrato su x, x^2 e termine costante
fun <- function(x) x^2
xx <- fun(x)
fit <- lm(res_squared ~ x + xx)

# Estrarre i coefficienti stimati
coefficients <- coef(fit)
a <- coefficients[1]
b <- coefficients[2]
c <- coefficients[3]

# Definire la funzione per l'intervallo di confidenza
confidence_interval <- function(x) {
  sigma2 <- a + b * x + c * fun(x)
  sigma <- sqrt(sigma2)
  return(sigma)
}

# Calcolare e disegnare l'intervallo di confidenza
sigma <- confidence_interval(x)
upper_bound <- 0 + sigma/1
lower_bound <- 0 - sigma/1


# Aggiungere le linee dell'intervallo di confidenza
lines(sort(x), upper_bound[order(x)], col = "blue", lwd = 2, lty = 2)
lines(sort(x), lower_bound[order(x)], col = "blue", lwd = 2, lty = 2)

```
:::

`r punti_p()` Se $W=1+ Y$, quanto varrà $r_{XW}$, coefficiente di correlazione tra $X$ e $W$?



<div class="button-container"></div>

## Prova di Statistica 2023/02/16-1

```{r 2023-133}

source("intro.R")




```

### Esercizio 1

```{r 2023-134}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-135}

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 200      # ampiezza campionaria

brk  <- c(-2,-1,1,5,15)
nnn  <- c( 20,100,110, 10)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ imprese della provincia di Modena è stato rilevato l'utile dell'ultimo trimestre (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze assolute:

```{r 2023-136}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Individuare la classe modale.

:::{.sol data-latex=""}
```{r 2023-137}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(T)
```
:::

`r punti_p()` Quale è il numero di imprese che hanno un utile maggiore di zero?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \%(X>0) &=&  100\%-\%(X\le 0)\\
  &=& 100 - (0.09\times 100 + 20.8\times(0-(-1)))\%\\
  &=& `r (1-F.int(0))*100`\%
\end{eqnarray*}
:::

`r punti_p()` L'utile medio è pari a $\bar x=`r mean(samp)`$ che forma avrà l'istogramma?

`r punti_p()` Qual è la proprietà di associatività della media aritmetica?




### Esercizio 2

`r punti_p(nex = T)` Siano $X\sim N(1,1.5)$ e sia $Y\sim N(1,0.5)$, $X$ e $Y$ indipendenti. Posto $A=\{-2<X<1\}$, $B=\{Y<1\}$. 
Quanto vale $P(A\cap B)$?

:::{.sol data-latex=""}
```{r 2023-16,,results='asis'}
cat(norm_int(x1 = -2,x2 = 1,verso = NULL,mm = 1,ss = 1.5,vnam = "X",mu = "\\mu_X",sigma = "\\sigma_X"))
cat(norm_int(x1 =  1,verso = "<",mm = 1,ss = 1.5,vnam = "Y",mu = "\\mu_Y",sigma = "\\sigma_Y"))
```

\begin{eqnarray*}
  P(A\cap B) &=&0.5\times 0.49 = `r .5*.49`
\end{eqnarray*}
:::

`r punti_p()` Un'urna contiene 10 palline rosse, 10 bianche e 10 nere. Si estrae tre volte senza reinserimento. Qual è la probabilità di avere tre colori uguali? 

:::{.sol data-latex=""}
\begin{eqnarray*}
  E &=& \text{tre colori uguali}\\
   &=& \{(R_1\cap R_2 \cap R_3)\cup (B_1\cap B_2 \cap B_3)\cup (N_1\cap N_2 \cap N_3)\}\\
P(E) &=& P(R_1\cap R_2 \cap R_3) + P(B_1\cap B_2 \cap B_3) + P(N_1\cap N_2 \cap N_3)\\
&=& P(R_1)P(R_2|R_1)P(R_3|R_1\cap R_2)+P(B_1)P(B_2|B_1)P(B_3|B_1\cap B_2)+\\
& & + P(N_1)P(N_2|N_1)P(N_3|N_1\cap N_2)\\
&=& \frac {10}{30}\frac 9{29}\frac 8{28} + \frac {10}{30}\frac 9{29}\frac 8{28} +\frac {10}{30}\frac 9{29}\frac 8{28} \\
&=& 3\cdot \frac {10}{30}\frac 9{29}\frac 8{28} \\
&=& `r 3*10*9*8/30/29/28`
\end{eqnarray*}
:::

`r punti_p()` Se $X\sim\text{Ber}(0.2)$ e $Y\sim\text{Ber}(0.2)$, $X$ e $Y$ indipendenti, com'è distribuita $X+Y$?

`r punti_p()` Se $X$ è $Y$ sono due VC, tali che $V(X)=\sigma_X^2$ e $Y=\sigma_Y^2$, quanto vale $V(X-Y)$?



### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene 4 palline numerate: $\fbox{0}$, $\fbox{1}$, $\fbox{2}$ e $\fbox{3}$. Si estrae 100 volte con reinserimento. Qual è la probabilità che la media delle 100 estrazioni sia maggiore di 1.6?

:::{.sol data-latex=""}
```{r 2023-17,,results='asis'}
urn <- 0:3
mm <- mean(urn)
ss <- s2c(urn)
n <- 100
cat(stat_(urn,semp=T))
cat(tlc("media",x1 = 1.6,NULL,">",mu = mm,s2 = ss,n = n))
``` 
:::



### Esercizio 4
  
`r punti_p(nex = T)` Sia $\hat \lambda$ lo stimatore di massima verosimiglianza di $\lambda$ del modello di Poisson.
\begin{eqnarray*}
  \hat\lambda &=&  \frac 1n\sum_{i=1}^nx_i\\
\end{eqnarray*}
Ricavare la sua varianza e metterla in relazione con il suo MSE.

`r punti_p()` Sia $h$ uno stimatore per $\theta$. Cosa significa dire che $h$ è consistente?

`r punti_p()` Siano $T_1$ e $T_2$ due test per lo stesso sistema d'ipotesi e con probabilità di errore di secondo tipo pari a, $\beta_1=0.2$ e $\beta_2=0.3$, rispettivamente. A parità di significatività, quale dei due è più potente? Perché?

`r punti_p()` In uno studio sull'efficacia di farmaco sono stati analizzati due gruppi di pazienti, un primo gruppo di 132 pazienti col placebo e un secondo gruppo di 132 pazienti col farmaco. Il 28.8% (38 su 132) di chi ha preso il placebo è guarito entro i primi 5 giorni, mentre il 39.4% (42 su 132) di chi è stato trattato col farmaco è guarito entro i primi 5 giorni. Il test sulla differenza tra le due proporzioni ha restituito $p_\text{value}=0.09$. Possiamo affermare che il farmaco sia efficace?



### Esercizio 5


`r punti_p(nex = T)` In uno studio sull'efficacia degli integratori alimentari, su un gruppo di 238 atleti è stato misurato il rendimento atletico (ottimo, buono e scarso) e l'assunzione di integratori (alto, medio e basso). Qui di seguito i dati:

```{r 2023-138}

x <- matrix(c(21,20,18,35,26,38,15,30,35),3)

dat <- chi_print(x,c("ottimo","buono","scarso"),c("alto","medio","basso"))
tabl(dat[[2]])

```

Al livello del 5% testare l'ipotesi che integratori e rendimento siano indipendenti.

:::{.sol data-latex=""}
```{r 2023-139}
chi_test(dat[[1]])
```
:::



### Esercizio 6

```{r 2023-140}

set.seed(6)
n <- 150
x <- runif(n,1,6)
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- rnorm(n,0,.1*x/6+.01)
y <- 10-log(x*15)+eps

RGX <- regr(x,y)
ls2e(RGX)
```

In uno studio sull'adeguamento alle direttive europee sul green si sono analizzate `r n` aziende, sono stati analizzati l'investimento in green ($X$ espresso in decine migliaia di euro/anno) e l'impatto l'abbattimento di CO2 (misurata in opportuna scala). Qui di seguito le statistiche:

\begin{align*}
\sum_{i=1}^n x_i &= `r sumx`,   &\sum_{i=1}^n x_i^2 &= `r sumx2` \\
\sum_{i=1}^n y_i &= `r sumy`,   &\sum_{i=1}^n y_i^2 &= `r sumy2` \\
\sum_{i=1}^n x_iy_i &= `r sumxy`.    \\
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=3.5$ nel modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2023-141}
cat(calcolo_beta())
cat(previsione(3.5))
```
:::

`r punti_p()` Qual è la percentuale di varianza spiegata dal modello?

:::{.sol data-latex=""}
```{r 2023-142}
R2(adatto = F)
```
:::

`r punti_p()` Interpretare il diagramma dei residui.


```{r 2023-18,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,ml$res,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-19,,results='asis'}
plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::


`r punti_p()` Se $W=- Y$, quanto varrà $r_{XW}$, coefficiente di correlazione tra $X$ e $W$?





<div class="button-container"></div>

## Prova di Statistica 2023/02/16-2

```{r 2023-143}

source("intro.R")




```

### Esercizio 1

```{r 2023-144}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-145}
options(digits = 3)

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 400      # ampiezza campionaria

brk  <- sort(-c(-2,-1,1,5,15))
nnn  <- rev(c( 20,100,110, 10))
nnn  <- round(nnn/sum(nnn)*n)
samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))

```

Su un campione di $`r n`$ imprese della provincia di Modena è stato rilevato l'utile dell'ultimo trimestre (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze assolute:

```{r 2023-146}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Individuare il valore approssimato della mediana.

:::{.sol data-latex=""}
```{r 2023-147}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

```{r 2023-20,,results='asis'}
res <- percentile(p = .5)
cat(res)
histp()
h.int(0,max(brk),density=10)
axis(1,brk)
```
:::

`r punti_p()` Quale è il numero di imprese che hanno un utile maggiore di zero?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \#(X>0) &=& n\times \frac{((1-0)\times `r dat2$hj[3]`+`r dat2$fj[4]`\times 100)}{100}\\
   &=& `r n*(1-F.int(0))`
\end{eqnarray*}
:::

`r punti_p()` L'utile medio è pari a $\bar x=`r mean(samp)`$ che forma avrà l'istogramma?

`r punti_p()` Qual è la proprietà di linearità della media aritmetica?





### Esercizio 2

`r punti_p(nex = T)` Il numero di telefonate in arrivo nell'ora di punta di un centralino è distribuito come una Poisson di parametro 3.1 ($X\sim\text{Pois}(\lambda=3.1)$). Qual è la probabilità di trovare al massimo 3 telefonate ($X\le 3$)?

:::{.sol data-latex=""}
```{r 2023-148}

x <- 0:3
l <- 3.1
```

\begin{eqnarray*}
  P(X\le 3) &=&  \frac{3.1^0}{0!}e^{-3.1}+\frac{3.1^1}{1!}e^{-3.1}+\frac{3.1^2}{2!}e^{-3.1}+\frac{3.1^3}{3!}e^{-3.1}\\
  &=& `r paste(round(dpois(0:3,3.1),4),collapse="+")`\\
  &=& `r sum(round(dpois(0:3,3.1),4))`\\
\end{eqnarray*}
:::

`r punti_p()` Un'urna contiene 4 palline: 2 rosse e 2 bianche. Si estrae seguendo il seguente schema: se esce rossa, rimettiamo la rossa estratta più altre due rosse, se esce bianca rimettiamo la bianca estratta più altre due bianche. Estraiamo con questo schema per tre volte. Calcolare la probabilità di avere tre palline rosse su tre estrazioni.

:::{.sol data-latex=""}
\begin{eqnarray*}
  E &=&  \text{tre rosse consecutive}\\
  &=& R_1\cap R_2 \cap R_3\\
P(E)  &=& P(R_1)P( R_2|R_1) P( R_3|R_1\cap R_2)\\
&=& \frac 24 \frac 46 \frac 68\\
&=& 0.25
\end{eqnarray*}
:::

`r punti_p()` Se $X\sim N(\mu_X,\sigma_X^2)$ e $Y\sim N(\mu_Y,\sigma_Y^2)$, $X$ e $Y$ indipendenti, come si distribuiscono $X+Y$ e  $X-Y$?

`r punti_p()` Siano $A$ e $B$ due eventi diversi dal vuoto tali che $A\cap B=\emptyset$, motivare perché $A$ e $B$ non possono essere indipendenti.



### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene 2 palline numerate con $\fbox{0}$, 3 numerate con $\fbox{1}$ e 2 numerate con $\fbox{2}$. Si estrae 100 volte con reinserimento. Qual è la probabilità che la somma delle 100 estrazioni sia compresa tra 80 e 120?

:::{.sol data-latex=""}
```{r 2023-21,,results='asis'}
urn <- c(0,0,1,1,1,2,2)
mm <- mean(urn)
ss <- s2c(urn)
n <- 100
stat_(urn,semp = T)
tlc(tipo = "somma",80,120,NULL,mu = mm,ss,n = n)
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Sia $\hat \pi$ lo stimatore di massima verosimiglianza di $\pi$ del modello Binomiale.
\begin{eqnarray*}
  \hat\pi &=&  \frac 1n\sum_{i=1}^nx_i\\
\end{eqnarray*}
Ricavare la sua varianza e metterla in relazione con il suo $MSE$ (Mean Squared Error).

`r punti_p()` Sia $h$ uno stimatore per $\theta$. Cosa significa dire che $h$ è consistente?

`r punti_p()` Definire la significatività e la potenza di un test.

`r punti_p()` In uno studio sull'effetto del titolo di studio sulla percezione del benessere, su un gruppo di 238 intervistati è stato chiesto il titolo di studio (basso: "al massimo le scuole medie inferiori", medio: "Diploma di scuola superiore", alto: "almeno il Diploma di Laurea") e la percezione del proprio benessere (basso, medio, alto). Qui di seguito i dati:

```{r 2023-149}

x <- matrix(c(18,21,20,26,35,38,35,30,15),3)
dimnames(x)<-list(redimento=c("basso","medio","alto"),reddito=c("basso","medio","alto"))
kable(x,booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")%>%
  kable_paper("striped", full_width = F) %>%
  pack_rows("Titolo di studio", 1, 3) %>%
  add_header_above(c(" " = 1, "Benessere" = 3))
```

Si è testata l'indipendenza tra il titolo di studio e la percezione del benessere e il test ha restituito $p_\text{value}=0.04$. Possiamo dire che titolo di studio e benessere sono indipendenti? Perché?



### Esercizio 5

```{r 2023-150}
mu1 <- 27
s1  <- 4.2
n1  <- 12
mu2 <- 24
s2  <- 3.1
n2  <- 25
```


`r punti_p(nex = T)` In uno studio comparativo tra i redditi, nel comune $A$ si è rilevato il reddito di `r n1` individui e si è osservata una media pari `r mu1` mila euro con una standard deviation pari a `r s1` mila euro , mentre nel comune $B$ si è rilevato il reddito di `r n2` individui e si è osservata una media pari `r mu2` mila euro con una standard deviation pari a `r s2` mila euro.
Sotto ipotesi di eterogeneità, testare l'ipotesi che il reddito medio sia uguale nei due comuni, contro l'alternativa che sia maggiore nel comune $A$.

:::{.sol data-latex=""}
```{r 2023-22,,results='asis'}
res <- ttest_2c_et(mu1 = mu1,mu2 = mu2,s1h = s1,s2h = s2,n1 = n1,n2 = n2,h1 = ">")
cat(res)
```
:::




### Esercizio 6

```{r 2023-151}

set.seed(6)
n <- 150
x <- runif(n,1,6)
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- rnorm(n,0,.25*(6-x)/6)
y <- 10+exp(x)/100+eps

RGX <- regr(x,y)
ls2e(RGX)
```

In uno studio sull'adeguamento alle direttive europee sul green si sono analizzate `r n` aziende, sono stati analizzati l'investimento in green ($X$ espresso in decine migliaia di euro/anno) e i risparmi globali $Y$ (espresso in decine migliaia di euro/anno). Qui di seguito le statistiche:

\begin{align*}
  \sum_{i=1}^n x_i &= `r sum(x)` &\sum_{i=1}^n x_i^2 &= `r sum(x^2)` &\sum_{i=1}^n x_i y_i &= `r sum(x*y)`\\
  \sum_{i=1}^n y_i &= `r sum(y)` & \sum_{i=1}^n y_i^2 &= `r sum(y^2)` &
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=1.5$ nel modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2023-23,,results='asis'}
cat(calcolo_beta())
cat(previsione(1.5))
```
:::




`r punti_p()` Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r 2023-24,,results='asis'}
R2(percent = F)
```
:::

`r punti_p()` Interpretare il diagramma dei residui.

```{r 2023-25,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,ml$res,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-26,,results='asis'}
plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::

`r punti_p()` Se $V= 1 - Y$ e $W= 1 - X$ quanto varrà $r_{VW}$, coefficiente di correlazione tra $V$ e $W$?






<div class="button-container"></div>

## Prova di Statistica 2023/02/16-3

```{r 2023-152}

source("intro.R")




```

### Esercizio 1

```{r 2023-153}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-154}

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 200      # ampiezza campionaria

brk  <- c(-2,-1,1,5,15)
nnn  <- c( 20,100,110, 10)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

```{r 2023-155}


options(digits=4)

# Basic settings
set.seed(1)   # per ottenere sempre la stessa simulazione
n <- 50      # ampiezza campionaria

brk  <- c(-2,-1,1,5,15)
nnn  <- c( 30,100,50, 30)
nnn  <- round(nnn/sum(nnn)*n)
nomex <- "Investimento"

samp <- genera_dati(brk = brk,nnn=nnn,n=n)
  
ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ imprese della provincia di Modena è stato rilevato l'utile dell'ultimo trimestre (espresso in migliaia di euro). Qui di seguito la distribuzione delle frequenze cumulate:

```{r 2023-156}
kable(dat3[,c(1,2,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
```{r 2023-157}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")

histp(T)
```
:::

`r punti_p()` Quante imprese hanno un utile negativo?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \#(X<0) &=&  n (f_1 + 1\cdot h_2/100)\\
  &=& `r n*dat2$fj[1]` + `r n*dat2$hj[2]/100`\\
  &=& `r n*dat2$fj[1] + n*dat2$hj[2]/100`\\
\end{eqnarray*}
:::  

`r punti_p()` Che relazione dobbiamo aspettarci tra media e mediana?

`r punti_p()` La varianza dei dati è pari a $\hat\sigma^2=`r s2c(samp)`$, se gli utili di ogni impresa aumentassero del 3%, quanto varrebbe la varianza dei dati così trasformati?

:::{.sol data-latex=""}
\[\sigma_Y^2=(1.03)^2\sigma_X^2=`r s2c(samp)*(1.03^2)`\]
:::





### Esercizio 2

`r punti_p(nex = T)` Si lancia una moneta perfetta 8 volte. Qual è la probabilità di avere un numero di volte Testa maggiore o uguale a 6 su 8 lanci?

:::{.sol data-latex=""}
\begin{eqnarray*}
  X &\sim&\text{Bin}(8;0.5)\\
  P(X\ge 6) &=& P(X=6)+p(X=7)+P(X=8)\\
  &=& \binom{8}{6} 0.5^8 + \binom{8}{7} 0.5^8 +\binom{8}{8} 0.5^8\\
  &=& `r choose(8,6)`\cdot `r 0.5^8` + `r choose(8,7)`\cdot `r 0.5^8` + `r choose(8,8)`\cdot `r 0.5^8` \\
  &=& `r choose(8,6)* 0.5^8 + choose(8,7)* 0.5^8 + choose(8,8)* 0.5^8` \\
\end{eqnarray*}
:::  

`r punti_p()` Sia $Z\sim N(0,1)$ e siano $A=\{Z<0\}$ e $B=\{Z<1\}$. Calcolare $P(A|B)$

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(B) &=&  \Phi(1)\\
  &=& `r pnorm(1)`\\
  P(A\cap B) &=& P(Z<0)\\
  &=& \Phi(0)\\
  &=& 0.5\\
  P(A|B) &=& \frac{P(A\cap B)}{P(B)}\\
  &=& \frac{0.5}{`r pnorm(1)`}\\
  &=& `r .5/pnorm(1)`
\end{eqnarray*}
:::  

`r punti_p()` Se $X\sim\text{Pois} (n)$, a cosa tende $X$ se $n$ diverge?

:::{.sol data-latex=""}
Se $n$ diverge allora $X$ tende ad un Normale di media $n$ e varianza $n$
\[
X\mathop\sim_a N(n,n)
\]
:::

`r punti_p()` Sia $X\sim N(10,1)$  e sia $F$ la sua funzione di ripartizione. Disegnare approssimativamente $F(x)$ per $x$ che varia tra 6 e 14.




### Esercizio 3

```{r 2023-158}
n <- 365
ex <- 0.08
vx <- 0.034
es <- mm <- n*ex
vs <- ss <- n*vx
#ss <- sqrt(vs)
# 
 # curve(dnorm(x,es,sqrt(ss)),from = es-4*sqrt(ss),to = es+4*sqrt(ss),axes=F)
 # axis(1)
 # curve(dnorm(x,es,sqrt(ss)),from = 30,to = es+4*sqrt(ss),add=T,type = "h",n=101)

```

`r punti_p(nex = T)` Un'urna conteni tre palline rosse, due bianche e una nera. Si estrae $n=100$ volte con reintroduzione. Qual è la probabilità che la proporzione di palline rosse sia minore di 0.45?

:::{.sol data-latex=""}
```{r 2023-27,,results='asis'}
# urn <- c(0,1,4,6)
mm <- .5
ss <- .25
n <- 100
cat(tlc(tipo = "prop",x1 = .45,x2 = NULL,verso = "<",mu = .5,n = n))
```
:::



### Esercizio 4
  
`r punti_p(nex = T)` Siano $\hat \mu$ e $\hat\sigma^2$ gli stimatori di massima verosimiglianza di $\mu$ e $\sigma^2$ del modello di Normale.
\begin{eqnarray*}
  \hat\mu &=&  \frac 1n\sum_{i=1}^nx_i \qquad \hat\sigma^2 =  \frac 1n\sum_{i=1}^n(x_i-\hat\mu)^2\\
\end{eqnarray*}
Ricavare la varianza di $\hat\mu$ e metterla in relazione con il suo $MSE$ (Mean Squared Error). 

`r punti_p()` Se $h_1$ e $h_2$ sono due stimatori per $\theta$ cosa significa dire che $h_1$ è più efficiente di $h_2$?

`r punti_p()` Definire gli errori di primo e secondo tipo e le relativa probabilità.

`r punti_p()`  Una moneta, che non sappiamo se è perfetta oppure no, viene lanciata 40 volte. Abbiamo osservato 14 volte testa su 40 lanci. Posto $\pi$ la probabilità che la moneta mostri testa, si è testato
\[
\begin{cases}
H_0:\pi=\frac 12\\
H_1:\pi\ne\frac 12
\end{cases}
\]
ed è risultato $p_\text{value}=0.08$. Possiamo concludere che la moneta sia truccata?




### Esercizio 5

```{r 2023-159}
n1 <- 35
muh <- 68
sdh <- 5
mu0 <- 71
```

`r punti_p(nex = T)` In uno studio sui redditi, nel comune $A$ si è rilevato il reddito di $n=`r n1`$ individui e si è osservata una media pari $`r muh`$ mila euro con una standard deviation pari a $`r sdh`$ mila euro.
Costruire un intervallo di confidenza al 95% per il reddito medio $\mu$.

:::{.sol data-latex=""}
```{r 2023-28,,results='asis'}
options(digits = 4)
res <- idc(xm = muh,sd = sdh,alpha = .05,n = n1,dist_ = "t",mus = mu0,ss = "S")
cat(res)
```
:::

`r punti_p()` Un'indagine analoga, svolta sull'intera regione, ha mostrato un reddito medio pari a $\mu_0=`r mu0`$. Testare l'ipotesi che nel comune $A$ il reddito medio sia uguale a quello regionale contro l'alternativa che sia __diverso__.

:::{.sol data-latex=""}
```{r 2023-29,,results='asis'}
res <- ttest_mu(muh = muh,sh = sdh,n = n1,mu0 = mu0,h1 = "\\neq")
cat(res)
```
:::



### Esercizio 6

```{r 2023-160}

set.seed(456)
n <- 150
x <- runif(n,1,6)
#curve(dgamma(x,1,1/100),0,691)
#qgamma(.999,1,1/100)

eps <- rnorm(n,0,.25*(6-x)/6)
y <- 10+exp(x)/100+eps

RGX <- regr(x,y)
ls2e(RGX)
```

In uno studio sull'adeguamento alle direttive europee sul green si sono analizzate `r n` aziende, sono stati analizzati l'investimento in green ($X$ espresso in decine migliaia di euro/anno) e le agevolazioni fiscali $Y$ (espressa in decine migliaia di euro/anno). Qui di seguito le statistiche:

\begin{align*}
\sum_{i=1}^n x_i &= `r sumx`,   &\sum_{i=1}^n x_i^2 &= `r sumx2` \\
\sum_{i=1}^n y_i &= `r sumy`,   &\sum_{i=1}^n y_i^2 &= `r sumy2` \\
\sum_{i=1}^n x_iy_i &= `r sumxy`.    \\
\end{align*}

`r punti_p(nex = T)` Stimare la previsione per $x=1.5$ nel modello di regressione dove $Y$ viene spiegata da $X$.


:::{.sol data-latex=""}
```{r 2023-30,,results='asis'}
cat(calcolo_beta())
cat(previsione(x = 1.5))
```
:::

`r punti_p()` Calcolare e interpretare $R^2$.

:::{.sol data-latex=""}
```{r 2023-31,,results='asis'}
R2()
```
:::

`r punti_p()` Interpretare il qq-plot dei residui.
```{r 2023-32,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
qqnorm(ml$residuals,asp=1,axes=F)
abline(0,1)
axis(1)
axis(2)
abline(h=0,lty=2)
abline(v=0,lty=2)
par(cex=cex)
```

`r punti_p()` Se $V=1+ Y$ e $W=1-X$, quanto varrà $r_{VW}$, il coefficiente di correlazione tra $V$ e $W$?



<div class="button-container"></div>

## Prova di Statistica 2023/06/08-1

```{r 2023-161}

source("intro.R")




```


### Esercizio 1

```{r 2023-162}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-163}
set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 160                         # ampiezza campionaria

brk  <- c(0,1.5,3,5,10)          # intervalli (breaks)
hhh  <- c( 20,110,100, 5)       # aspetto presunto istogramma

nomex <- "Nome della X"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Modena è stata rilevata la spesa annua dedicata alle vacanze, espressa in migliaia di euro. Qui di seguito la distribuzione delle frequenze assolute:

```{r 2023-164}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
```{r 2023-165}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(axes = T)
h.int(4,10,density=20)
```
:::

`r punti_p()` Qual è la percentuale di famiglie con spesa superiore a 4 mila euro?

:::{.sol data-latex=""}
```{r 2023-33,,results='asis'}
cat(F_print(4,verso=">"))
```
:::

`r punti_p()` Che relazione dobbiamo attenderci tra moda, mediana e media?

`r punti_p()` Cosa significa che la media aritmetica rende zero la somma degli scarti?



### Esercizio 2


Siano $X_A\sim \text{Pois}(1.5)$ e sia $X_B\sim \text{Pois}(1.5)$, $X_A$ e $X_B$ indipendenti. Posto $A=\{X_A\le 1\}$ e $B=\{X_B>2\}$

`r punti_p(nex = T)` Calcolare la probabilità di  $A\cup B$.

:::{.sol data-latex=""}
```{r 2023-34,,results='asis'}
cat(pois_dis(x1 = 1,ll = 1.5,vnam = "X_A"))
cat(pois_dis(x1 = 3,ll = 1.5,vnam = "X_B",verso = "\\geq"))
pa <- ppois(1,1.5)
pb <- 1-ppois(2,1.5)
```
\begin{eqnarray*}
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa*pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
:::

`r punti_p()` Calcolare la probabilità che **solo** uno dei due eventi $A$ oppure $B$ sia vero.

`r punti_p()` Calcolare valore atteso e varianza di $X_A-X_B$.

`r punti_p()` Sia $X\sim\text{Ber}(\pi=0.4)$. Disegnare la sua funzione di ripartizione.



### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene 3 palline Rosse, 3 Bianche e 4 Blu. Si estrae con reintroduzione per $n=81$ volte.
Calcolare la probabilità che la proporzione di palline Blu sia maggiore di 0.3.

:::{.sol data-latex=""}
```{r 2023-35,,results='asis'}
cat(tlc(tipo = "prop",x1 = 0.3,verso = ">",mu = .4,n = 81))
```
:::



### Esercizio 4

  
`r punti_p(nex = T)` Siano $\hat \mu$ e $\hat\sigma^2$ gli stimatori di massima verosimiglianza di $\mu$ e $\sigma^2$ del modello di Normale.
\begin{eqnarray*}
  \hat\mu &=&  \frac 1n\sum_{i=1}^nx_i \qquad \hat\sigma^2 =  \frac 1n\sum_{i=1}^n(x_i-\hat\mu)^2\\
\end{eqnarray*}
Ricavare lo standard error stimato di $\hat\mu$.

`r punti_p()` Se $h_1$ e $h_2$ sono due stimatori per $\theta$ tale per cui $MSE(h_1)=1.2$, e $MSE(h_2)=2.3$, quale dei due è più efficiente e perché?

`r punti_p()` Definire gli errori di primo e secondo tipo e le relative probabilità.

`r punti_p()`  Una moneta, che non sappiamo se è perfetta oppure no, viene lanciata 80 volte. Abbiamo osservato 28 volte testa su 80 lanci. Posto $\pi$ la probabilità che la moneta mostri testa, si è testato
\[
\begin{cases}
H_0:\pi=\frac 12\\
H_1:\pi\ne\frac 12
\end{cases}
\]
ed è risultato $p_\text{value}=0.009683$. Possiamo concludere che la moneta sia truccata?




### Esercizio 5

```{r 2023-166}
set.seed(12)
n <- 50
x <- runif(n,0,30)
y <- abs(.5*x + rnorm(n,0,2+x*.1))
RGX <- regr(x,y); ls2e(RGX)
```

In uno studio sull'efficacia dell'investimento pubblicitario sono stati rilevati, per $n=50$ aziende si sono rilevati l'incremento di spesa in
pubblicità ($X$) e l'incremento di utile ($Y$) nell'ultimo quinquennio. Si osservano le seguenti statistiche, $\sum_{i=1}^{50}x_i=`r sum(x)`$, $\sum_{i=1}^{50}y_i=`r sum(y)`$,
 $\sum_{i=1}^{50}x_i^2=`r sum(x^2)`$, $\sum_{i=1}^{50}y_i^2=`r sum(y^2)`$ e $\sum_{i=1}^{50}x_iy_i=`r sum(x*y)`$.

`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2023-36,,results='asis'}
cat(calcolo_beta())
```
:::

`r punti_p()` Qual è la percentuale di varianza spiegata dal modello?

:::{.sol data-latex=""}
```{r 2023-37,,results='asis'}
R2(adatto = F)
```
:::

`r punti_p()` Testare l'ipotesi che l'intercetta sia uguale a zero contro l'alternativa che sia diversa da zero.


:::{.sol data-latex=""}
```{r 2023-38,,results='asis'}
cat(ttest_beta(0,0,h1 = "\\neq",alpha = 0.05))
```
:::


`r punti_p()` Interpretare il diagramma dei residui.

```{r 2023-39,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,es,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-40,,results='asis'}
plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::

`r punti_p()` Perché una previsione per $x=15$ è più affidabile di una per $x=50$?





<div class="button-container"></div>

## Prova di Statistica 2023/06/08-2

```{r 2023-167}

source("intro.R")




```


### Esercizio 1

```{r 2023-168}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-169}
set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 160                         # ampiezza campionaria

brk  <- rev(10-c(0,1.5,3,5,10))          # intervalli (breaks)
hhh  <- rev(c( 20,110,100, 5))       # aspetto presunto istogramma

nomex <- "Nome della X"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Modena è stata rilevata la spesa annua dedicata alle vacanze, espressa in migliaia di euro. Qui di seguito la distribuzione delle frequenze assolute:

```{r 2023-170}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
```{r 2023-171}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(axes = T)
h.int(4,8,density=20)
```
:::

`r punti_p()` Qual è la percentuale di famiglie con spesa compresa tra a 4 mila e 8 mila euro?

:::{.sol data-latex=""}

```{r 2023-41,,results='asis'}
cat(F_print(4,x2 = 8,verso = ""))
```
:::

`r punti_p()` Che relazione dobbiamo attenderci tra moda, mediana e media?

`r punti_p()` Cosa significa che la media aritmetica gode della proprietà di linearità?



### Esercizio 2

Siano $X_A\sim N(1.5,1.5)$ e sia $X_B\sim N(1.5,1.5)$, $X_A$ e $X_B$ indipendenti. Posto $A=\{X_A\le 1\}$ e $B=\{X_B>2\}$

`r punti_p(nex = T)` Calcolare la probabilità di  $A\cup B$.

:::{.sol data-latex=""}
```{r 2023-42,,results='asis'}
cat(norm_int(x1 = 1,verso = "<",mm = 1.5,ss = 1.5,mu = "\\mu_A",sigma = "\\sigma_A",vnam = "X_A"))
cat(norm_int(x1 = 2,verso = ">",mm = 1.5,ss = 1.5,mu = "\\mu_B",sigma = "\\sigma_B",vnam = "X_B"))
pa <- pnorm(1,1.5,sqrt(1.5))
pb <- 1-pnorm(2,1.5,sqrt(1.5))
```
\begin{eqnarray*}
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa*pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
:::

`r punti_p()` Si continua ad estrarre da $X_A\sim N(1.5,1.5)$ e si interrompe quando $X_A\le 1$. Calcolare la probabilità di interrompere alla quinta estrazione.

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(A) &=&  `r pa`\\
  P(\bar A) &=& `r 1-pa`\\
  P(\bar A\cap \bar A\cap\bar A\cap\bar A\cap A)&=& (1-`r pa`)^4`r pa`\\
  &=& `r (1-pa)^4*pa`
\end{eqnarray*}
:::

`r punti_p()` Come si distribuisce $X_A-X_B$?

`r punti_p()` Se $A$ e $B$ sono due eventi tali che $A\cap B=\emptyset$, $A$ e $B$ possono essere indipendenti? Perché?




### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene 3 palline col numero $\fbox{0}$, 3 col numero $\fbox{1}$ e 4 col numero $\fbox{2}$. Si estrae con reintroduzione per $n=81$ volte.
Calcolare la probabilità che la somma dei risultati sia maggiore di 80.

:::{.sol data-latex=""}
```{r 2023-43,,results='asis'}
stat_(0:2,p = c(.3,.3,.4))
cat(tlc(tipo = "somma",x1 = 80,verso = ">",mu = 1.1,n = 81,s2 = .69))
```
:::



### Esercizio 4

`r punti_p(nex = T)` Sono stati estratti $n=10$ valori da una Poisson di parametro $\lambda$ incognito e si è ottenuta un media pari a $\bar x=3.4$. Ricavare $\widehat{SE(\hat\lambda)}$ lo Standard Error stimato $\hat\lambda$ di massima verosimiglianza.

`r punti_p()` Sia $h$ uno stimatore per $\theta$. Cosa significa dire che $h$ è consistente?

`r punti_p()` Siano $T_1$ e $T_2$ due test per lo stesso sistema d'ipotesi e con probabilità di errore di secondo tipo pari a, $\beta_1=0.02$ e $\beta_2=0.3$, rispettivamente. A parità di significatività, quale dei due è più potente? Perché?

`r punti_p()` In uno studio sull'efficacia della pubblicità televisiva sono state intervistate 64 persone suddivise in due gruppi, un primo gruppo di 32 individui che guarda abitualmente la televisione e un secondo gruppo di 32 che non la guarda. Ad ogni partecipante è stata chiesta la spesa annua in beni pubblicizzati in TV ed è risultato che la spesa media in questi prodotti di chi guarda abitualmente la TV è pari $\hat\mu_{TV}=1.4\text{ mila €}$ con una standard deviation pari a $\hat\sigma_{TV}=1.2\text{ mila €}$, mentre nel gruppo che non la guarda abitualmente è risultato $\hat\mu_{\overline{TV}}=0.9\text{ mila €}$ con una standard deviation pari a $\hat\sigma_{\overline{TV}}=1.4\text{ mila €}$. Si è testa l'uguaglianza delle medie contro l'alternativa che $\mu_{TV}$ sia maggiore di $\mu_{\overline{TV}}$ e ed è risultato un $p_\text{value}= 0.0681$. Si può concludere che la spesa in pubblicità televisiva sia efficace?



### Esercizio 5

`r punti_p(nex = T)` In uno studio sull'efficacia degli integratori alimentari, su un gruppo di 238 atleti è stato misurato il rendimento atletico (ottimo, buono e scarso) e l'assunzione di integratori (alto, medio e basso). Qui di seguito i dati:

```{r 2023-172}
x <- matrix(c(21,20,18,35,26,38),2)
rx <- rowSums(x)
cx <- colSums(x)
n <- sum(x)

dimnames(x)<-list(redimento=c("buono","scarso"),integratori=c("alto","medio","basso"))
xp <- cbind(x,rx)
xp <- rbind(xp,colSums(xp))
dimnames(xp)<-list(redimento=c("buono","scarso","Totale"),integratori=c("alto","medio","basso","Totale"))
kable(xp,booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")%>%
  kable_paper(full_width = F) %>%
  pack_rows("rendimento", 1, 3) %>%
  add_header_above(c(" " = 1, "Integratori" = 4))

dat <- chi_print(dat = x,nome_y = c("buono","scarso"),nome_x = c("alto","medio","basso"))
```

Testare al livello di significatività del 5% se c'è indipendenza tra integratori e rendimento.

:::{.sol data-latex=""}
```{r 2023-44,,results='asis'}
rx <- rowSums(x)
cx <- colSums(x)

thx <- outer(rx,cx)/n

kable(thx,booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")%>%
  kable_paper(full_width = F) %>%
  pack_rows("rendimento", 1, 2) %>%
  add_header_above(c(" " = 1, "Integratori" = 3))

chi <- (thx-x)^2/thx
kable(chi,booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")%>%
  kable_paper(full_width = F) %>%
  pack_rows("rendimento", 1, 2) %>%
  add_header_above(c(" " = 1, "Integratori" = 3))

chioss <- sum((thx-x)^2/thx)
cat(cat("Il chi oss è ",chioss,", il chi-teorico,",qchisq(.95,2)," rifiuto:",ifelse(sum((thx-x)^2/thx) > qchisq(.95,2),"sì","no")))
```
:::



### Esercizio 6

```{r 2023-173}
set.seed(12)
n <- 50
x <- runif(n,0,30)
y <- abs(.5*x + rnorm(n,0,2+(x-15)^4*.0005))
RGX <- regr(x,y); ls2e(RGX)
```

In uno studio sull'efficacia dell'investimento pubblicitario sono stati rilevati, per $n=50$ aziende si sono rilevati l'incremento di spesa in
pubblicità ($X$) e l'incremento di utile ($Y$) nell'ultimo quinquennio. Si osservano le seguenti statistiche, $\sum_{i=1}^{50}x_i=`r sum(x)`$, $\sum_{i=1}^{50}y_i=`r sum(y)`$,
 $\sum_{i=1}^{50}x_i^2=`r sum(x^2)`$, $\sum_{i=1}^{50}y_i^2=`r sum(y^2)`$ e $\sum_{i=1}^{50}x_iy_i=`r sum(x*y)`$.

`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2023-45,,results='asis'}
cat(calcolo_beta())
```
:::

`r punti_p()` Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r 2023-46,,results='asis'}
R2(percent = F)
```
:::

`r punti_p()` Interpretare il diagramma dei residui.

```{r 2023-47,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,es,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```


:::{.sol data-latex=""}
```{r 2023-48,,results='asis'}
plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::

`r punti_p()` Posto $W=-2\cdot Y$ calcolare $\beta_0'$ e $\beta_1'$ i coefficienti di regressione del modello
\[
w_i = \beta_0'+\beta_1'x_i+\epsilon_i'
\]

:::{.sol data-latex=""}
\begin{eqnarray*}
  \bar w &=&  -2\bar y\\
  &=& -2\cdot`r my`\\
  &=& `r -2*my`\\
  \hat\sigma_W&=&2\hat\sigma_Y\\
  &=& 2\cdot`r sy`\\
  &=& `r 2*sy`\\
  \hat\beta_1' &=& -\frac{\sigma_W}{\sigma_X}r\\
  &=& -\frac{`r 2*sy`}{`r sx`}`r r`\\
  &=& `r -2*sx/sx*r`\\
  \hat\beta_0'&=& \bar w - \hat\beta_1'\bar x\\
  &=& `r -2*my + 2*sx/sx*r*mx`
\end{eqnarray*}
:::





<div class="button-container"></div>

## Prova di Statistica 2023/06/08-3

```{r 2023-174}

source("intro.R")




```


### Esercizio 1

```{r 2023-175}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-176}
set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 160                         # ampiezza campionaria

brk  <- c(0,2.5,4,5,6.5,9)          # intervalli (breaks)
hhh  <- c( 10,30,50, 30,10)       # aspetto presunto istogramma

nomex <- "Nome della X"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Modena è stata rilevata la spesa annua dedicata alle vacanze, espressa in migliaia di euro. Qui di seguito la distribuzione delle frequenze cumulate:

```{r 2023-177}
kable(dat3[,c(1,2,7)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
```{r 2023-178}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(axes = T)
h.int(4,8,density=20)
```
:::

`r punti_p()` Qual è il numero di famiglie con spesa compresa tra a 4 mila e 8 mila euro?

:::{.sol data-latex=""}

```{r 2023-49,,results='asis'}
cat(F_print(4,x2 = 8,verso = ""))
```
:::

`r punti_p()` Che relazione dobbiamo attenderci tra moda, mediana e media?

`r punti_p()` Cosa significa che la media aritmetica goe della proprietà di linearità?



### Esercizio 2


Sia $X\sim\text{Binom}(5,0.5)$ e sia $y\sim\text{Binom}(5,0.4)$, $X$ e $Y$ indipendenti, posto $A=\{X\le 1\}$ e $B=\{Y\ge 2\}$

`r punti_p(nex = T)` Calcolare la probabilità di  $A\cup B$.

:::{.sol data-latex=""}
```{r 2023-50,,results='asis'}
cat(bin_dis(1,5,.5))
cat(bin_dis(2,5,.4,verso = "\\geq",comp = T,vnam = "Y"))
pa <- pbinom(1,5,.5)
pb <- pbinom(2,5,.4,lower.tail = F)
```
\begin{eqnarray*}
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa*pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
:::

`r punti_p()` Si estrae ripetutamente da $X\sim\text{Binom}(5,0.5)$ e ci si ferma quando $X\le 1$. Calcolare la probabilità di finire entro due estrazioni.

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(A) &=&  `r pa`\\
  P(\bar A) &=& `r 1-pa`\\
  P(A\cup (\bar A\cap A))&=& `r pa`+`r pa`\cdot (1-`r pa`)\\
  &=& `r pa+pa*(1-pa)`
\end{eqnarray*}
:::

`r punti_p()` Calcolare valore atteso e varianza di $X-Y$.

`r punti_p()` Siano $A$ e $B$ due eventi tali che $P(A)=0.6$ e $P(B)=0.5$. $A$ e $B$ possono essere incompatibili? Perché?



### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene 3 palline col numero $\fbox{0}$, 4 col numero $\fbox{1}$ e 3 col numero $\fbox{2}$. Si estrae con reintroduzione per $n=81$ volte.
Calcolare la probabilità che la media dei risultati sia minore di 0.9.

:::{.sol data-latex=""}
```{r 2023-51,,results='asis'}
stat_(0:2,p=c(.3,.4,.3))
cat(tlc(tipo = "media",x1 = 0.9,verso = "<",mu = 1,n = 81,s2 = .6))
```
:::



### Esercizio 4

`r punti_p(nex = T)` Sono stati estratti $n=10$ valori da una Bernoulli di parametro $\pi$ incognito e si è ottenuti 4 successi in 10 estrazioni. Ricavare, $\widehat{SE(\hat\pi)}$ lo Standard Error stimato di $\hat\pi$ di massima verosimiglianza.

`r punti_p()` Sia $h$ uno stimatore per $\theta$. Cosa significa dire che $h$ è corretto asintoticamente?

`r punti_p()` Definire gli errori di primo e di secondo tipo e le relative probabilità.

`r punti_p()` Un dado viene lanciato 60 volte e si ottiene 
```{r 2023-179}
set.seed(1)
dad <- sample(1:6,size = 60,replace = T,prob=c(1,1,3,4,1,2)/sum(c(1,1,3,4,1,2)))
kable(t(table(dad)),booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")

chis <- sum((table(dad)-10)^2/10)
pval <- 1-pchisq(chis,5)
```
Ci si chiede se il dado sia truccato. Posto a test
\[
\begin{cases}
H_0:\pi_j=\frac 16, j = 1,...,6
\end{cases}
\]
si ottiene un $p_{\text{value}}=`r pval`$. Il dado si può ritenere truccato? Perché?



### Esercizio 5


```{r 2023-180}
n1 <- 35
muh <- 0.5
sdh <- 0.25
mu0 <- 0.6
```

`r punti_p(nex = T)` In uno studio sui consumi per generi di igiene personale su un campione di `r n1` famiglie della provincia di Reggio è stata chiesta la loro spesa annuale in questo genere di beni. I dati campionari hanno evidenziato una media pari a $\hat\mu=`r muh`$ e una deviazione standard osservata pari a $\hat\sigma=`r sdh`$.
Costruire un intervallo di confidenza al 95% per il gradimento medio $\mu$.

:::{.sol data-latex=""}
```{r 2023-52,,results='asis'}
cat(idc(xm = muh,sd = sdh,alpha = .05,n = n1,dist_ = "t",mus = "\\mu",ss = "S"))
```
:::

`r punti_p()` Un'indagine analoga, svolta sull'intera regione, ha mostrato un gradimento medio pari a $\mu_0=`r mu0`$. Testare l'ipotesi che nel comune A il livello di gradimento sia uguale a quello regionale contro l'alternativa che sia minore.


:::{.sol data-latex=""}
```{r 2023-53,,results='asis'}
ttest_mu(muh = muh,sh = sdh,n = n1,mu0 = mu0,h1 = "<")
```
:::




### Esercizio 6

```{r 2023-181}
set.seed(12)
n <- 50
x <- runif(n,0,30)
y <- abs(.5*x + rnorm(n,0,2+(15^2-(x-15)^2)*.005))
RGX <- regr(x,y); ls2e(RGX)
```

In uno studio sull'efficacia dell'investimento pubblicitario sono stati rilevati, per $n=50$ aziende si sono rilevati l'incremento di spesa in
pubblicità ($X$) e l'incremento di utile ($Y$) nell'ultimo quinquennio. Si osservano le seguenti statistiche, $\sum_{i=1}^{50}x_i=`r sum(x)`$, $\sum_{i=1}^{50}y_i=`r sum(y)`$,
 $\sum_{i=1}^{50}x_i^2=`r sum(x^2)`$, $\sum_{i=1}^{50}y_i^2=`r sum(y^2)`$ e $\sum_{i=1}^{50}x_iy_i=`r sum(x*y)`$.

`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$.

:::{.sol data-latex=""}
```{r 2023-54,,results='asis'}
cat(calcolo_beta())
```
:::

`r punti_p()` Qual è la percentuale di varianza spiegata dal modello?

:::{.sol data-latex=""}
```{r 2023-55,,results='asis'}
R2(adatto = F)
```
:::


`r punti_p()` Interpretare il qq-plot dei residui.

```{r 2023-56,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
qqnorm(es,asp=1)
abline(0,1)
par(cex=cex)
```

`r punti_p()` Posto $W=-2\cdot X$ calcolare $\beta_0'$ e $\beta_1'$ i coefficienti di regressione del modello
\[
y_i = \beta_0'+\beta_1'w_i+\epsilon_i'
\]

:::{.sol data-latex=""}
\begin{eqnarray*}
  \bar w &=&  -2\bar x\\
  &=& -2\cdot`r mx`\\
  &=& `r -2*mx`\\
  \hat\sigma_W&=&2\hat\sigma_X\\
  &=& 2\cdot`r sx`\\
  &=& `r 2*sx`\\
  \hat\beta_1' &=& -\frac{\sigma_Y}{\sigma_W}r\\
  &=& -\frac{`r 2*sy`}{`r sx`}`r r`\\
  &=& `r -2*sy/sx*r`\\
  \hat\beta_0'&=& \bar y - \hat\beta_1'\bar w\\
  &=& `r my - 2*sy/sx*r*mx`
\end{eqnarray*}
:::



<div class="button-container"></div>

## Prova di Statistica 2023/06/27-1

```{r 2023-182}

source("intro.R")




```



### Esercizio 1

```{r 2023-183}
compito <- compito + 1
punti <- punti_list[[compito]]
```

```{r 2023-184}
set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 250                         # ampiezza campionaria

brk  <- c(0,15,30,50,100,250)          # intervalli (breaks)
hhh  <- c( 20,120,100, 50,10)       # aspetto presunto istogramma

nomex <- "Spesa"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ famiglie della provincia di Modena è stato rilevata la spesa mensile in telecomunicazioni (in euro), qui di seguito 
la distribuzione delle frequenze relative:

```{r 2023-185}
kable(dat3[,c(1,2,4)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
```{r 2023-186}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(axes = T)
h.int(60,250,density=20)
```
:::

`r punti_p()` Qual è la percentuale di famiglie con spesa superiore a 60 euro?

:::{.sol data-latex=""}
```{r 2023-57,,results='asis'}
cat(F_print(60,verso=">"))
```
:::

`r punti_p()` Che relazione dobbiamo attenderci tra moda, mediana e media?

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$ e la standard deviation $\hat\sigma=`r sd(samp)`$, se tutte le famiglie risparmiassero
il 10%, come cambierebbero la media e la standard deviation?



### Esercizio 2


Un impresa di soccorso stradale ha due centralini, il numero di telefonate orarie in arrivo 
al centralino $A$ è distribuito come una Poisson $X\sim\text{Pois}(2.2)$, mentre
il numero di telefonate orarie in arrivo al centralino $B$ è distribuito come una Poisson $Y\sim\text{Pois}(1.3)$, 
$X$ e $Y$ indipendenti.

`r punti_p(nex = T)` Calcolare la probabilità che il totale di telefonate in arrivo in un'ora sia maggiore 
o uguale a tre ($S=X+Y\ge 3$).

:::{.sol data-latex=""}
```{r 2023-58,,results='asis'}
cat(pois_dis(x1 = 3,ll = 1.3+2.2,vnam = "X+Y",verso = "\\geq"))
```
:::

`r punti_p()` Sapendo che $S=X+Y\ge 3$, calcolare la probabilità che $S=X+Y= 5$ ($P(S=5|S\ge 3$)

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(X+Y\ge 3) &=& `r 1-ppois(2,1.3+2.2)`\\
  P(X+Y=5)    &=& `r dpois(5,2.2+1.3)`\\
  P(\{X+Y=5\}\cap\{X+Y\ge 3\}) &=&P(X+Y=5)\\
  P(\{P(X+Y=5)\}|\{X+Y\ge 3\}) &=&\frac{P(\{X+Y=5\}\cap\{X+Y\ge 3\})}{P(X+Y\ge 3)}\\
  &=&\frac{P(X+Y=5)}{P(X+Y\ge 3)}\\
  &=&\frac{`r dpois(5,2.2+1.3)`}{`r 1-ppois(2,1.3+2.2)`}\\
  &=&`r dpois(5,2.2+1.3)/( 1-ppois(2,1.3+2.2))`
\end{eqnarray*}
  
:::

`r punti_p()` Se $X$ ed $Y$ sono due variabili casuali, è sempre vero che
\[
V(X-Y)=V(X)+V(Y)~~~?
\]
motivare la risposta.

`r punti_p()` Sia $X\sim\text{Binom}(2,\pi=0.5)$. Disegnare la sua funzione di ripartizione.

:::{.sol data-latex=""}
```{r 2023-187}
plot((-1):3,pbinom((-1):3,2,.5),type="s",xlim=c(-.1,2.1),ylim=c(0,1),axes=F)
axis(1,0:2)
axis(2,pbinom((-1):3,2,.5),las=2)
```
:::



### Esercizio 3

`r punti_p(nex = T)` Una catena di montaggio a ciclo continuo produce ogni giorno un numero di pezzi variabile, con una media pari a
$\mu=1.2$ mila pezzi al giorno e una varianza di $\sigma^2=9.1$.

Calcolare la probabilità che il numero totale di pezzi prodotti dopo un anno ($n=365$) sia inferiore a ai 400 (mila) pezzi prodotti.

:::{.sol data-latex=""}
```{r 2023-59,,results='asis'}
cat(tlc(tipo = "somma",x1 = 400,verso = "<",mu = 1.2,s2 = 9.1,n = 365))
```
:::



### Esercizio 4

  
`r punti_p(nex = T)` Siano $\hat \mu$ e $\hat\sigma^2$ gli stimatori di massima verosimiglianza di $\mu$ e $\sigma^2$ del modello di Normale.
\begin{eqnarray*}
  \hat\mu &=&  \frac 1n\sum_{i=1}^nx_i \qquad \hat\sigma^2 =  \frac 1n\sum_{i=1}^n(x_i-\hat\mu)^2\\
\end{eqnarray*}
Come si distribuisce $\hat\mu$?

`r punti_p()` Sia $h$ uno stimatore per $\theta$ tale che 
\[V(h)=\frac\theta {\sqrt{n}};~~~~E(h)=\theta\frac{n+2}{n}\]
di quali proprietà gode $h$?

`r punti_p()` Definire il p-value e descrivere la sua interpretazione.

`r punti_p()`  Se un test è significativo al 5% può essere significativo all'1%? (scegliere la risposta tra: _mai_, _non sempre_ oppure _sempre_ e motivare la risposta)



### Esercizio 5

Nel comune $A$ si è condotta un'intervista per conoscere l'opinione
dei cittadini sulla presenza di un inceneritore. Sono state intervistate
250 persone e 70 di loro sono favorevoli.

`r punti_p(nex = T)` Costruire un intervallo di confidenza al 99%
per la proporzione dei favorevoli in popolazione.

:::{.sol data-latex=""}
```{r 2023-60,,results='asis'}
cat(idc(xm = 70,n = 250,alpha = .01,dist_ = "z"))
```
:::

`r punti_p()` Nel comune $B$ si è condotta un'intervista analoga. 
Sono state intervistate 230 persone e 75 di loro sono favorevoli. Testare 
l'ipotesi che la proporzione nei due comuni sia uguale contro l'alternativa che nel
comune $B$ sia maggiore.

:::{.sol data-latex=""}
```{r 2023-61,,results='asis'}
cat(ztest_2c_pi(s1 = 75,s2 = 70,n1 = 230,n2 = 250,h1 = ">",a = "B",b = "A"))
```
:::





### Esercizio 6

```{r 2023-188}
set.seed(16)
n <- 50
x <- runif(n,0,1.5)
y <- log(x)+rnorm(n,0,.25)
y <- y-min(y)
#plot(x,y)
RGX <- regr(x,y); ls2e(RGX)
```

In uno studio sull'efficacia del marketing sul web si sono analizzate `r n` aziende
sulle quali è stato misurata l'incremento percentuale annuo medio di investimento in marketing 
web ($X$) la l'incremento percentuale medio di utile ($Y$). Si osservano le seguenti statistiche, $\sum_{i=1}^{50}x_i=`r sum(x)`$, $\sum_{i=1}^{50}y_i=`r sum(y)`$,
 $\sum_{i=1}^{50}x_i^2=`r sum(x^2)`$, $\sum_{i=1}^{50}y_i^2=`r sum(y^2)`$ e $\sum_{i=1}^{50}x_iy_i=`r sum(x*y)`$.


`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$ e interpretare 
i coefficienti $\hat\beta_0$ e $\hat\beta_1$

:::{.sol data-latex=""}
```{r 2023-62,,results='asis'}
cat(calcolo_beta())
```
:::

`r punti_p()` Scrivere la scomposizione della varianza e 
calcolarla per questo caso.

:::{.sol data-latex=""}
```{r 2023-63,,results='asis'}
cat(TSS())
```
:::

`r punti_p()` Perché una previsione per $x=0.15$ è più affidabile di una per $x=50$?

`r punti_p()` Interpretare il diagramma dei residui.

```{r 2023-64,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,es,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```

:::{.sol data-latex=""}
```{r 2023-65,,results='asis'}

plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::

`r punti_p()` Cosa significa dire che $r$ è un numero puro?






<div class="button-container"></div>

## Prova di Statistica 2023/06/27-2

```{r 2023-189}

source("intro.R")




```



### Esercizio 1

```{r 2023-190}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-191}
set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 250                         # ampiezza campionaria

brk  <- rev(250-c(0,15,30,50,100,250))          # intervalli (breaks)
hhh  <- rev(c( 20,120,100, 50,10))       # aspetto presunto istogramma

nomex <- "Spesa"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ piccole imprese della provincia di Modena è stato rilevata la spesa mensile in telecomunicazioni (in euro), qui di seguito 
la distribuzione delle frequenze assolute:

```{r 2023-192}
kable(dat3[,c(1,2,3)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Disegnare l'istogramma di densità percentuale.

:::{.sol data-latex=""}
```{r 2023-193}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(axes = T)
h.int(60,250,density=20)
```
:::

`r punti_p()` Qual è il numero di imprese con spesa superiore ai 100 euro?

:::{.sol data-latex=""}
```{r 2023-66,,results='asis'}
cat(F_print(100,verso="<"))
cat(F_print(100,verso=">"))
```
:::

`r punti_p()` Che relazione dobbiamo attenderci tra moda, mediana e media?

`r punti_p()` La spesa media è pari a $\bar x=`r mean(samp)`$ e varianza $\hat\sigma^2=`r s2c(samp)`$, se tutte le famiglie aumentassero 
del 10% la loro spesa, come cambierebbero la media e la varianza?



### Esercizio 2

Si lancia una moneta perfetta $n=6$ volte. Sia $X$ la variabile casuale che conta
il numero di volte che esce _Testa_ su 6 lanci e si considerino gli insiemi $A=\{X\le 1\}$ e $B=\{X\ge 5\}$.

`r punti_p(nex = T)` Calcolare la probabilità di $A\cup B$.

:::{.sol data-latex=""}
```{r 2023-67,,results='asis'}
cat(bin_dis(x1 = 1,n = 6,pp = .5,verso = "\\leq"))
cat(bin_dis(x1 = 5,n = 6,pp = .5,verso = "\\geq"))
pa <- pbinom(1,6,.5)
pb <- pa
```
\begin{eqnarray*}
A\cap B &=& \emptyset\\
P(A\cap B) &=& 0\\
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-0\\
  &=& `r pa+pb`
\end{eqnarray*}
:::

`r punti_p()` Si lancia una moneta, se esce testa si estrae da una normale $X\sim N(0,1)$, se esce croce si estrae
da una normale $X\sim N(1,1)$. Calcolare la probabilità che il numero estratto finale sia minore di due.

:::{.sol data-latex=""}
```{r 2023-68,,results='asis'}
cat(norm_int(x1 = 2,mm = 0,ss = 1))
cat(norm_int(x1 = 2,mm = 1,ss = 1))

pa <- pnorm(2)
pb <- pnorm(2,1)
```
\begin{eqnarray*}
P(X<2) &=& P(T)P(X<2|T)+P(C)P(X<2|C)\\
&=& \frac 12P(X<2|T)+\frac 12P(X<2|C)\\
&=& \frac 12\cdot `r pa`+\frac 12 `r pb`\\
&=& `r (pa+pb)/2`
\end{eqnarray*}
:::

`r punti_p()` Se $X\sim\text{Pois}(\lambda_X)$ e $Y\sim\text{Pois}(\lambda_Y)$, quali sono valore atteso e varianza 
di $X-Y$?

`r punti_p()` Se $A$ e $B$ sono due eventi *non* indipendenti come si può scrivere $P(A\cap B)$?




### Esercizio 3

`r punti_p(nex = T)` Una catena di montaggio a ciclo continuo produce ogni giorno un numero di pezzi variabile, con una media pari a
$\mu=1.3$ mila pezzi al giorno e una varianza di $\sigma^2=8.1$.

Calcolare la probabilità che la media annuale ($n=365$) sia inferiore a 1.2 (mila) pezzi prodotti.

:::{.sol data-latex=""}
```{r 2023-69,,results='asis'}
cat(tlc(tipo = "media",x1 = 1.2,verso = "<",mu = 1.3,s2 = 8.1,n = 365))
```
:::



### Esercizio 4

`r punti_p(nex = T)`Sia $\hat \lambda$ lo stimatore di massima verosimiglianza di $\lambda$ del modello di Poisson: 
\[\hat\lambda =  \frac 1n\sum_{i=1}^nx_i\]
Scrivere la distribuzione asintotica di $\hat \lambda$.

`r punti_p()` Sia $h$ uno stimatore per $\theta$ tale che 
\[V(h)=2\frac\theta {\sqrt{n}};~~~~E(h)=\theta\frac{n+2}{n-1}\]
$h$ è corretto? Si può correggere?

`r punti_p()` Definire la significatività di un test statistico.

`r punti_p()` Se un test è significativo all'1% può essere significativo all'5%? (scegliere la risposta tra: _mai_, _non sempre_ oppure _sempre_ e motivare la risposta)



### Esercizio 5

Nel comune $A$ si è condotta un'intervista per conoscere l'opinione
dei cittadini sulla presenza di un inceneritore. Sono state intervistate
25 persone a cui è stato chiesto di esprimete l'opinione in una scala da zero a 100.
È risultato un punteggio medio pari a $\hat\mu_A=72.1$ con una standard deviation 
$\hat\sigma_A=3.4$

`r punti_p(nex = T)` Costruire un intervallo di confidenza al 95%
per la proporzione dei favorevoli in popolazione.

:::{.sol data-latex=""}
```{r 2023-70,,results='asis'}
cat(idc(xm = 72.1,sd = 3.4,n = 25,alpha = .05,dist_ = "t"))
```
:::

`r punti_p()` Nel comune $B$ si è condotta un'intervista analoga. 
Sono state intervistate 23 persone si è osservata una media pari $\mu_B=69.6$ e una deviazione standard $\hat\sigma_B=3.3$.
Sotto ipotesi di omogeneità testare l'ipotesi che le medie dei due comuni siano uguali contro l'alternativa che siano diverse

:::{.sol data-latex=""}
```{r 2023-71,,results='asis'}
cat(ttest_2c_om(mu1 = 72.1,mu2 = 69.6,s1h =3.4,s2h = 3.3,n1 = 25,n2 = 24,h1 = "\\neq",a = "A",b = "B" ))
```
:::




### Esercizio 6

```{r 2023-194}
set.seed(111)
n <- 50
x <- runif(n,0,1.5)
y <- -log(x)+rnorm(n,0,.25)
y <- y-min(y)
# plot(x,y)
RGX <- regr(x,y); ls2e(RGX)
```

In uno studio sull'efficacia del marketing sul web si sono analizzate `r n` aziende
sulle quali è stato misurata l'incremento percentuale annuo medio di investimento in marketing 
web ($X$) la l'incremento percentuale in altre campagne di marketing ($Y$). Si osservano le seguenti statistiche, $\sum_{i=1}^{50}x_i=`r sum(x)`$, $\sum_{i=1}^{50}y_i=`r sum(y)`$,
 $\sum_{i=1}^{50}x_i^2=`r sum(x^2)`$, $\sum_{i=1}^{50}y_i^2=`r sum(y^2)`$ e $\sum_{i=1}^{50}x_iy_i=`r sum(x*y)`$.


`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$ e interpretare 
i coefficienti $\hat\beta_0$ e $\hat\beta_1$

:::{.sol data-latex=""}
```{r 2023-72,,results='asis'}
cat(calcolo_beta())
```
:::

`r punti_p()` Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r 2023-73,,results='asis'}
cat(TSS())
```
:::

`r punti_p()` Perché una previsione per $x=0.8$ è più affidabile di una per $x=0$?

`r punti_p()` Interpretare il diagramma dei residui.

```{r 2023-74,,fig.height=2.5,fig.width=3.5}
par(cex=.35)
plot(x,es,axes=F,xlab="x",ylab="Residui")
axis(1)
axis(2)
abline(h=0,lty=2)
par(cex=cex)
```

:::{.sol data-latex=""}
```{r 2023-75,,results='asis'}

plot(x,es,axes=F,ylab=expression(hat(epsilon[i])),cex=.35)
abline(h=0,lty=2,col="grey")
spline_pat(x = x,y = es)
axis(1)
axis(2)
```
:::


`r punti_p()` Cosa significa dire che $r$ è invariante ai cambiamenti di scala?





<div class="button-container"></div>

## Prova di Statistica 2023/06/27-3

```{r 2023-195}

source("intro.R")




```


### Esercizio 1

```{r 2023-196}
compito <- compito + 1
punti <- punti_list[[compito]]
```

```{r 2023-197}
set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 200                         # ampiezza campionaria

brk  <- c(0,15,30,50,100,250)          # intervalli (breaks)
hhh  <- c( 10,13,9, 4,0.5)       # aspetto presunto istogramma

nomex <- "Spesa"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ piccole imprese della provincia di Modena è stato rilevata la spesa mensile in telecomunicazioni (in euro), qui di seguito 
la divisione in classi e le densità percentuali

```{r 2023-198}
kable(dat3[,c(1,2,6)],booktabs=T,escape = F,linesep="") %>%
  kable_styling(full_width = F, latex_options = "HOLD_position")
```

`r punti_p(start=T)` Calcolare il valore approssimato della mediana

:::{.sol data-latex=""}
```{r 2023-76,,results='asis'}
kable(dat3[,1:7],booktabs=T,escape = F,linesep="") %>%            # Stampa la tabella
  kable_styling(full_width = F, latex_options = "HOLD_position")
histp(axes = T)
h.int(60,250,density=20)
cat(percentile())
```
:::

`r punti_p()` Qual è il numero di imprese con spesa superiore ai 60 euro?

:::{.sol data-latex=""}
```{r 2023-77,,results='asis'}
cat(F_print(60,verso=">"))
```
:::

`r punti_p()` Che relazione dobbiamo attenderci tra moda, mediana e media?

`r punti_p()` Scrivere la proprietà di associatività della media aritmetica.



### Esercizio 2

Sia $X\sim N(2,1)$ e sia $Y\sim\text{Pois}(2.9)$, si considerino gli insiemi
$A=\{X>2.5\}$ e $B=\{Y\geq 3\}$.

`r punti_p(nex = T)` Calcolare la probabilità di $A\cup B$.

:::{.sol data-latex=""}
```{r 2023-78,,results='asis'}
cat(norm_int(x1 = 2.5,verso = ">",mm = 2,ss = 1))
cat(pois_dis(x1 = 3,ll = 2.9,verso = "\\geq",vnam = "Y"))
pa <- 1-pnorm(2.5,2)
pb <- 1-ppois(2,2.9)
```
\begin{eqnarray*}
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa`\cdot`r pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
:::

`r punti_p()` Sia $X\sim N(2,1)$ e sia $A=\{X>2.5\}$.
Se $A$ è vero si estrae una volta da un'urna che contiene una pallina rossa e una bianca,
se $A$ è falso si estrae una volta da un'urna che contiene due palline rosse e una bianca.
Qual è la probabilità di estrarre una rossa?


:::{.sol data-latex=""}
\begin{eqnarray*}
P(X<2) &=& P(A)P(R|A)+P(\bar A)P(R|\bar A)\\
&=& `r pa`\frac 12 + (1-`r pa`)\frac 23\\
&=& `r pa*1/2+(1-pa)*2/3`
\end{eqnarray*}
:::

`r punti_p()` Se $X\sim\text{Pois}(\lambda_X)$ e $Y\sim\text{Pois}(\lambda_Y)$, quali sono valore atteso e varianza 
di $X-Y$?

`r punti_p()` Se due eventi $A\ne\emptyset$ e $B\ne\emptyset$ non sono indipendenti allora sono necessariamente incompatibili? Motivare la risposta.




### Esercizio 3

`r punti_p(nex = T)` Una catena di montaggio a ciclo continuo produce un pezzo al giorno e la proporzione di pezzi fallati è pari
a $\pi=0.15$.

Calcolare la probabilità che il numero totale di pezzi fallati in un anno ($n=365$) sia maggiore di 60

:::{.sol data-latex=""}
```{r 2023-79,,results='asis'}
cat(tlc(tipo = "somma",x1 = 60,verso = ">",mu = .15,n = 365))
```
:::



### Esercizio 4

`r punti_p(nex = T)`Sia $\hat \lambda$ lo stimatore di massima verosimiglianza di $\lambda$ del modello di Poisson: 
\[\hat\lambda =  \frac 1n\sum_{i=1}^nx_i\]
Scrivere la distribuzione asintotica di $\hat \lambda$.

`r punti_p()` `r punti_p()` Sia $h$ uno stimatore per $\theta$ tale che 
\[V(h)=2\frac\theta {\sqrt{n}};~~~~E(h)=\theta\frac{n+2}{n-1}\]
scrive il Mean Squared Error di $h$ ($MSE(h)$).

`r punti_p()` Definire la potenza di un test statistico.

`r punti_p()` Se un t-test bilaterale con 13 gradi libertà presenta una
t osservata pari a $t_\text{obs}=1.974$, il $p_\text{value}$ sarà maggiore o minore di 0.05? Perché?



### Esercizio 5

Nel comune $C$ si è condotta un'intervista per conoscere l'opinione
dei cittadini sulla presenza di un inceneritore. Sono state intervistate
25 persone a cui è stato chiesto di esprimete l'opinione in una scala da zero a 100.
È risultato un punteggio medio pari a $\hat\mu_C=77.25$ con una standard deviation 
$\hat\sigma_C=3.41$.

`r punti_p(nex = T)` Costruire un intervallo di confidenza al 95%
per la proporzione dei favorevoli in popolazione.

:::{.sol data-latex=""}
```{r 2023-80,,results='asis'}
cat(idc(xm = 77.25,sd = 3.41,n = 25,alpha = .05,dist_ = "t"))
```
:::

`r punti_p()` Nella regione è stata condotta un'indagine analoga
di larga scala che ha evidenziato un gradimento medio pari a $\mu_0=76$
Testare l'ipotesi che nel comune $C$ il gradimento sia uguale a quello regionale contro l'alternativa che sia maggiore.

:::{.sol data-latex=""}
```{r 2023-81,,results='asis'}
ttest_mu(muh = 77.25,sh = 3.41,n = 25,mu0 = 76,h1 = ">")
```
:::




### Esercizio 6

```{r 2023-199}
set.seed(16)
n <- 4
x <- sort(runif(n,0,1.5))
y <- -log(x)+rnorm(n,0,.25)
y <- round(y-min(y),2)
x <- round(x,2)
# plot(x,y)
RGX <- regr(x,y); ls2e(RGX)
```

In uno studio sull'efficacia del marketing sul web si sono analizzate `r n` aziende
sulle quali è stato misurata l'incremento percentuale annuo medio di investimento in marketing 
web ($X$) la l'incremento percentuale in altre campagne di marketing ($Y$). 

Qui di seguito i dati

```{r 2023-200}
kable(prn[1:5,1:3], booktabs=T,escape = F,linesep="")%>%
  kable_styling(full_width = T) %>%
    row_spec(5, bold = T, color = "white", background = "gray")
```


`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$ e interpretare 
e calcolare il residuo per $x=`r x[2]`$.

:::{.sol data-latex=""}
```{r 2023-82,,results='asis'}
kable(prn, digits = 4,booktabs=T,escape = F,linesep="")%>%
  kable_styling(full_width = T) %>%
  row_spec(5, bold = T, color = "white", background = "gray")

cat(calcolo_beta())
cat(residuo(x[2],y[2]))
```
:::

`r punti_p()` Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r 2023-83,,results='asis'}
R2(percent = F)
```
:::
:::

`r punti_p()` Che differenza c'è tra interpolazione ed estrapolazione?

`r punti_p()` Definire il diagramma dei residui.

`r punti_p()` Cosa significa che $\hat\beta_0$ e $\hat\beta_1$ sono BLUE?



<div class="button-container"></div>

## Prova di Statistica 2023/07/23-1

### Esercizio 1

```{r 2023-201}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-202}


set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 180                         # ampiezza campionaria

brk  <- c(-10,-5,0,1,5)          # intervalli (breaks)
hhh  <- c( 2,4,10, .5)       # aspetto presunto istogramma

nomex <- "Bilancio"
samp <- genera_dati(brk = brk,hhh = hhh,n = n)

ls2e(stat_base(samp,brk))
```

Su un campione di $`r n`$ di piccole e medie  aziende  della provincia di Modena è stato rilevato l'utile netto (espresso in centinaia di migliaia di euro) durante il periodo del covid. Qui di seguito la distribuzione delle frequenze assolute:

```{r 2023-203}
tabl(dat3[,c(1,2,3)])
```

`r punti_p(start=T)` Individuare la classe modale

:::{.sol data-latex=""}
```{r 2023-204}
tabl(dat3[,1:7])
histp(axes = T)
h.int(-10,3,density=20)
```
:::

`r punti_p()` Qual è la percentuale di imprese con bilancio inferiore a 3 (centomila) euro?

:::{.sol data-latex=""}
```{r 2023-84,,results='asis'}
cat(F_print(3,verso="<"))
```
:::

`r punti_p()` la media aritmetica è pari a `r mean(samp)`, in base al punto 1a che relazione dobbiamo attenderci tra media, mediana e moda?

`r punti_p()` Si considerino i seguenti dati

\[
\{x_1=1.2,x_2=2.3,x_3=6.7\}
\]

Per quale valore di $x$
\[
f(x)=(x_1-x)^2+(x_2-x)^2+(x_3-x)^2
\]
$f$ è minima?



### Esercizio 2

Il numero di automobili in fila al semaforo $A$ in orario di punta è distribuito come una
Poisson di parametro $\lambda_A=2.2$ ($X_A\sim \text{Pois}(2.2)$). 
Mentre il numero di automobili in fila al semaforo $B$ in orario di punta è distribuito come una
Poisson di parametro $\lambda_B=1.5$ ($X_B\sim \text{Pois}(1.5)$). $X_A$ e $X_B$ indipendenti. 

`r punti_p(nex = T)` Calcolare la probabilità che in almeno uno dei due semafori ci siano 2 o più automobili in coda (suggerimento: _almeno uno_ si rappresenta con l'unione).

:::{.sol data-latex=""}
Diretta
```{r 2023-85,,results='asis'}
cat(pois_dis(x1 = 2,ll = 2.2,vnam = "X_A",verso = "\\geq"))
cat(pois_dis(x1 = 2,ll = 1.5,vnam = "X_B",verso = "\\geq"))
pa <- 1-ppois(1,2.2)
pb <- 1-ppois(1,1.5)
```
\begin{eqnarray*}
  A =\{X_A\ge 2\} && B =\{X_B\ge 2\}\\
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa*pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
Indiretta
\begin{eqnarray*}
  \overline{\text{almeno uno}} &=&  \text{nessuno}\\
  \overline{A\cup B} &=& \bar A\cap \bar B\\
  P(\overline{A\cup B}) &=& P(\bar A)P(\bar B)\\
  P(A\cup B) &=& 1- P(X_A<2)(X_B<2)\\
  &=& 1-(1-`r pa` )\times(1-`r pb`)\\
  &=& `r 1-(1-pa)*(1-pb)`
\end{eqnarray*}
  
:::

`r punti_p()` Per andare al lavoro Michele prende la strada che 
lo porta al semaforo $A$, ($X_A\sim \text{Pois}(2.2)$) se la tangenziale è libera, altrimenti
prende la strada che lo porta al semaforo $B$ ($X_B\sim \text{Pois}(1.5)$).
La probabilità di trovare la tangenziale sia libera è pari a
$P(\text{Libera})=0.65$. Qual è la probabilità che Michele incontri più di due auto in fila?

:::{.sol data-latex=""}
\begin{eqnarray*}
E &=& \{X\ge 2\}\\
P(E) &=& P(\text{Libera})P(E|\text{Libera})+P\left(\overline{\text{Libera}}\right)P\left(E|\overline{\text{Libera}}\right)\\
   &=&  0.65\times`r pa`+(1-0.65)\times `r pb`\\
  &=& `r .65*pa+(1-.65)*pb`
\end{eqnarray*}
:::

`r punti_p()` Sia $Z\sim N(0,1)$ e $Y\sim \chi^2_2$, $Z$ e $Y$ indipendenti.
Come si distribuisce
\[
\frac{Z}{\sqrt{Y/2}} ~~~?
\]

`r punti_p()` Se $P(A)=0.3$, $P(B|A)=0.6$, e $P(B|\bar A)=0.4$, quanto valgono $P(B)$ e $P(A|B)$?

:::{.sol data-latex=""}
\begin{eqnarray*}
P(B) &=& P(A)P(B|A)+P(\bar A)P(B|\bar A)\\
     &=& 0.3\times0.6+0.7\times 0.4\\
     &=& `r .3*.6+.7*.4`\\
P(A|B) &=& \frac {P(A)P(B|A)}{P(B)}\\
       &=& \frac {`r .3*.6`}{`r .3*.6+.7*.4`}\\
       &=& `r .3*.6/(.3*.6+.7*.4)`
\end{eqnarray*}
:::




### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene le seguenti palline numerate {3,5,7,11}. Si estrae con reintroduzione per $n=81$ volte.
Calcolare la probabilità che la media delle palline estratte sia inferiore a 6.

:::{.sol data-latex=""}
```{r 2023-86,,results='asis'}
cat(stat_(urn<-c(3,5,7,11),semp = T))
cat(tlc(tipo = "media",x1 = 6,verso = "<",mu = mean(urn),s2 = s2c(urn),n = 81))
```
:::





### Esercizio 4

  
`r punti_p(nex = T)` Siano $\hat \mu$ e $\hat\sigma^2$ gli stimatori di massima verosimiglianza di $\mu$ e $\sigma^2$ del modello di Normale.
\begin{eqnarray*}
  \hat\mu &=&  \frac 1n\sum_{i=1}^nx_i \qquad \hat\sigma^2 =  \frac 1n\sum_{i=1}^n(x_i-\hat\mu)^2\\
\end{eqnarray*}
Dimostrare la consistenza di $\hat\mu$.

`r punti_p()` Cosa significa che gli stimatori di massima verosimiglianza sono invarianti alle trasformazioni monotone invertibili?

`r punti_p()` Definire la significatività di un test.

```{r 2023-205}
tabella <- matrix(c(50, 120, 50, 60, 80, 40, 40, 50, 50), nrow = 3, ncol = 3, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(tabella)$p.value,digits = 4,nsmall = 4)
```

`r punti_p()` Un sociologo sta conducendo uno studio sull'associazione tra l'orientamento politico e l'atteggiamento nei confronti del cambiamento climatico. Ha somministrato un questionario a `r n` partecipanti, chiedendo loro di indicare il proprio orientamento politico (Conservatore, Progressista, Indipendente) e l'atteggiamento nei confronti del cambiamento climatico (Molto, poco, per nulla) preoccupato. L'obiettivo è determinare se c'è un'associazione significativa tra l'orientamento politico e l'atteggiamento nei confronti del cambiamento climatico.

```{r 2023-206}

# Assegnazione dei nomi alle righe e alle colonne
rownames(tabella) <- c("Conservatore", "Progressista", "Indipendente")
colnames(tabella) <- c("Molto", "Poco", "Per nulla")


 tabl(tabella)  %>%
   kable_styling(full_width = F)  %>%
   kable_paper(full_width = F)  %>%
   pack_rows("Orientamento politico", 1, 3) %>%
   add_header_above(c(" " = 1, "Preoccupato per i cambiamenti climatici" = 3))
```
Eseguito il test del $\chi^2$ per verificare l'indipendenza tra l'orientamento politico e la preoccupazione
sui cambiamenti climatici il sociologo ottiene un $p_\text{value}=`r pval`$. Quali conclusioni può trarne?



### Esercizio 5


```{r 2023-207}
# Dati campionari
n1 <- 10
muh <- 1200
sdh <- 300
mu0 <- 1100
```
`r punti_p(nex = T)`  In uno studio sulle spese mensili dei dipendenti di un'azienda, è stato selezionato un campione di `r n1` individui. I dati campionari hanno mostrato una media di spese mensili pari a $\hat\mu = `r muh`€$ con una deviazione standard osservata pari a $\hat\sigma = `r sdh`€$. Costruire un intervallo di confidenza al 95% per la media delle spese mensili $\mu$.

:::{.sol data-latex=""}
```{r 2023-87,,results='asis'}
idc(xm = muh,sd = sdh,alpha = .05,n = n1,dist_ = "t")
```
:::

`r punti_p()`  L'azienda afferma che la media delle spese mensili dei dipendenti è pari a $1100€$. Effettuare un test di ipotesi per verificare se la media delle spese mensili sia superiore a $1100€$.

:::{.sol data-latex=""}
```{r 2023-88,,results='asis'}
ttest_mu(muh = muh,sh = sdh,n = n1,mu0 = mu0,h1 = ">",um = "€")
```
:::



### Esercizio 6

```{r 2023-208}
set.seed(789)
n <- 50
x <- abs(rnorm(n, 0, 6)) + 6 # Anni di studio
y <- abs(2*x + rnorm(n, 0, 5)) + 15 # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di $n=`r n`$ individui, sono state analizzati il livello di istruzione (in anni di studio, $X$) e il reddito annuale (in migliaia di euro, $Y$).

 Si osservano le seguenti statistiche, $\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
 $\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.

`r punti_p(nex = T)` Stimare il modello di regressione dove $Y$ viene spiegata da $X$ e prevedere il reddito per un individuo con 12 anni di studio.

:::{.sol data-latex=""}
```{r 2023-89,,results='asis'}
cat(calcolo_beta())
cat(previsione(12))
```
:::

`r punti_p()` Qual è la percentuale di varianza spiegata dal modello?

:::{.sol data-latex=""}
```{r 2023-90,,results='asis'}
R2(adatto = F)
```
:::

`r punti_p()` Stimare lo Standard Error di $\hat\beta_1$.


:::{.sol data-latex=""}
```{r 2023-91,,results='asis'}
cat(se_beta1())
```
:::

`r punti_p()` Definire i punti di leva.

`r punti_p()` Se in un modello di regressione sappiamo che $\hat\sigma_X=0.5$, $\hat\sigma_Y=1.2$ e $r=0.8$, quanto varrà $\hat\beta_1$, il coefficiente angolare del modello di regressione dove $Y$ viene spiegata da $X$?






<div class="button-container"></div>

## Prova di Statistica 2023/07/23-2


### Esercizio 1

```{r 2023-209}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-210}


set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 200                         # ampiezza campionaria

brk  <- c(0, 2, 5, 10, 20, 50)   # intervalli (breaks)
hhh  <- c(50, 90, 60, 40, 10)    # aspetto presunto istogramma

nomex <- "Utilizzo servizi di streaming"
samp <- genera_dati(brk = brk, hhh = hhh, n = n)

ls2e(stat_base(samp,brk))      # crea il data set e la tabella dat3
```

Su un campione di $`r n`$ famiglie della provincia di Modena è stata rilevata la quantità mensile di ore dedicate all'utilizzo di servizi di streaming. Di seguito è riportata la distribuzione delle frequenze percentuali:

```{r 2023-211}
tabl(dat3[,c(1,2,12)])
```

`r punti_p(start=T)` Individuare la classe modale.

:::{.sol data-latex=""}
```{r 2023-212}
tabl(dat3[,1:7])
histp(axes = T)
h.int(30,50,density=20)
```
:::

`r punti_p()` Qual è il numero di famiglie che consuma più di 30 ore di streaming?

:::{.sol data-latex=""}

```{r 2023-92,,results='asis'}
cat(F_print(30,verso = ">"))
```
:::

`r punti_p()` la media aritmetica è pari a `r mean(samp)`, in base al punto 1a che relazione dobbiamo attenderci tra media, mediana e moda?

`r punti_p()` Si considerino i seguenti dati

\[
\{x_1=1.2,x_2=2.3,x_3=6.7\}
\]

Per quale valore di $x$
\[
f(x)=|x_1-x|+|x_2-x|+|x_3-x|
\]
$f$ è minima?



### Esercizio 2


Siano $X$ e $Y$ due variabili casuali che rappresentano rispettivamente il tempo di manutenzione per due tipi di macchinari diversi in un'azienda manifatturiera. Si sa che $X\sim N(15,1.5)$ e $Y\sim N(12,1.5)$. L'azienda ha definito due eventi $A=\{X< 14\}$ e $B=\{Y<13\}$
Si suppone inoltre che i tempi di manutenzione dei due macchinari siano indipendenti tra loro.

`r punti_p(nex = T)`  Calcola la probabilità che almeno uno dei due eventi sia vero ($A \cup B$).


:::{.sol data-latex=""}
```{r 2023-93,,results='asis'}
cat(norm_int(x1 = 14,verso = "<",mm = 15,ss = 1.5,mu = "\\mu_X",sigma = "\\sigma_X",vnam = "X"))
cat(norm_int(x1 = 13,verso = "<",mm = 12,ss = 1.5,mu = "\\mu_Y",sigma = "\\sigma_Y",vnam = "Y"))
pa <- pnorm(14,15,sqrt(1.5))
pb <- pnorm(13,12,sqrt(1.5))
```
\begin{eqnarray*}
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa*pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
:::

`r punti_p()` Quando il tempo di manutenzione del macchinario $X$ è inferiore a 14 ore ($A=\{X< 14\}$), la perdita economica dell'azienda è di €100. Mentre quando è superiore a 14 la perdita è di 500€.

Quando il tempo di manutenzione del macchinario $Y$ è inferiore a 12 ore ($B=\{Y< 12\}$), l'azienda subisce una perdita economica di €70, mentre quando è superiore a 12 il danno economico è di 600€.

Calcolare la probabilità che l'azienda abbia una perdita economica totale superiore ai 600€.

:::{.sol data-latex=""}
```{r 2023-213}
two_way2(c(100,500),c(70,600),c(pa,1-pa),c(pb,1-pb),EV = F)
0.0429 + 0.1642
```
:::

`r punti_p()`  Siano $Z_1\sim N(0,1)$, $Z_2\sim N(0,1)$, $Z_3\sim N(0,1)$, tre VC normali standard indipendenti.
Come si distribuisce
\[
Y=Z_1^2+Z_2^2+Z_3^3~~~?
\]

`r punti_p()` Se $A$ e $B$ sono due eventi tali che $A\cap B\ne\emptyset$, $A$ e $B$ sono indipendenti? (scegliere tra _sempre, mai, dipende_ e motivare la risposta)





### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene le seguenti palline numerate {3,4,5,6,7,11}. Si vine se esce un numero pari. Si estrae con reintroduzione per $n=81$ volte.
Calcolare la probabilità di vincere più di 30 volte.

:::{.sol data-latex=""}
\[\pi=\frac 13\]
```{r 2023-94,,results='asis'}
cat(tlc(tipo = "somma",x1 = 30,verso = ">",mu = 1/3,n = 81))
```
:::




### Esercizio 4

`r punti_p(nex = T)` Sia $\hat \beta_1$ lo stimatore dei minimi quadrati di $\beta_1$ del modello di regressione lineare.
\begin{eqnarray*}
  \hat\beta_1 &=&  \frac{\text{cov}(X,Y)}{\hat\sigma_X^2}\\
\end{eqnarray*}
Dimostrare la consistenza di $\hat\beta_1$.

`r punti_p()` Come si distribuiscono gli stimatori di massima verosimiglianze asintoticamente?

`r punti_p()` Definire la potenza di un test.

```{r 2023-214}
tabella <- matrix(c(50, 80, 50, 60, 80, 40, 40, 50, 50), nrow = 3, ncol = 3, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(tabella)$p.value,digits = 4,nsmall = 4)
```

`r punti_p()` Un sociologo sta conducendo uno studio sull'associazione tra l'orientamento politico e l'atteggiamento nei confronti del cambiamento climatico. Ha somministrato un questionario a `r n` partecipanti, chiedendo loro di indicare il proprio orientamento politico (Conservatore, Progressista, Indipendente) e l'atteggiamento nei confronti del cambiamento climatico (Molto, poco, per nulla) preoccupato. L'obiettivo è determinare se c'è un'associazione significativa tra l'orientamento politico e l'atteggiamento nei confronti del cambiamento climatico.

```{r 2023-215}

# Assegnazione dei nomi alle righe e alle colonne
rownames(tabella) <- c("Conservatore", "Progressista", "Indipendente")
colnames(tabella) <- c("Molto", "Poco", "Per nulla")


 tabl(tabella)  %>%
   kable_styling(full_width = F)  %>%
   kable_paper(full_width = F)  %>%
   pack_rows("Orientamento politico", 1, 3) %>%
   add_header_above(c(" " = 1, "Preoccupato per i cambiamenti climatici" = 3))
```
Eseguito il test del $\chi^2$ per verificare l'indipendenza tra l'orientamento politico e la preoccupazione
sui cambiamenti climatici il sociologo ottiene un $p_\text{value}=`r pval`$. Quali conclusioni può trarne?



### Esercizio 5


```{r 2023-216}
# Dati campionari
# Dati campionari
n1 <- 80
x1 <- 48
p0 <- 0.5
alpha <- 0.01
```

`r punti_p(nex = T)` In uno studio clinico per valutare l'efficacia di un nuovo farmaco, sono stati selezionati `r n1` pazienti con una particolare condizione medica. Tra questi, `r x1` pazienti hanno mostrato un miglioramento utilizzando il nuovo farmaco. Testare usando il $p_\text{value}$ che il farmaco sia maggiormente efficace rispetto al trattamento esistente che una proporzione pari a $\pi_0 = `r p0`$

:::{.sol data-latex=""}
```{r 2023-95,,results='asis'}
ztest_pi(sn = x1,n = n1,p0 = p0,h1 = ">")
```
:::




### Esercizio 6
```{r 2023-217}
set.seed(7)
n <- 50
x <- round(abs(rnorm(n, 0, 6)) + 6) # Anni di studio
y <- round(abs(1.5*x + rnorm(n, 0, 5)) + 15,2) # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di $n=`r n`$ individui, sono state analizzati il livello di istruzione (in anni di studio, $X$) e il reddito annuale (in migliaia di euro, $Y$).
Si osservano le seguenti statistiche, $\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r punti_p(nex = T)` Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r 2023-96,,results='asis'}
cat(calcolo_beta())
cat(residuo(x = x[3],y = y[3]))
```
:::

`r punti_p()` Il modello si adatta bene ai dati?

:::{.sol data-latex=""}
```{r 2023-97,,results='asis'}
R2(percent = F)
```
:::

`r punti_p()` Stimare lo Standard Error di $\hat\beta_0$.

:::{.sol data-latex=""}
```{r 2023-98,,results='asis'}
cat(se_beta0())
```
:::

`r punti_p()` Definire il qq-plot.

`r punti_p()` Se in un modello di regressione $r=0.35$, $\hat\sigma_X=1.2$ e $\hat\sigma_X=0.5$, quanto varrà
$\hat\beta_1$, il coefficiente angolare della retta di regressione in cui $Y$ è spiegata da  $X$?





<div class="button-container"></div>

## Prova di Statistica 2023/07/23-3



### Esercizio 1

```{r 2023-218}
compito <- compito + 1
punti <- punti_list[[compito]]
```
```{r 2023-219}


set.seed(1)                      # per ottenere sempre la stessa simulazione
n <- 200                         # ampiezza campionaria

brk  <- c(0, 100, 300, 600, 1000)   # intervalli (breaks)
nnn  <- c(40, 40, 15, 5)    # aspetto presunto istogramma

nomex <- "Spesa mensile per abbigliamento"
samp <- genera_dati(brk = brk, nnn = nnn, n = n)

ls2e(stat_base(samp,brk))      # crea il data set e la tabella dat3
```

Su un campione di $`r n`$ individui è stata rilevata la spesa mensile in euro per abbigliamento. Di seguito sono riportate la densità percentuali:

```{r 2023-220}
tabl(dat3[,c(1:2,6)])
```

`r punti_p(start=T)` Ricavare il valore approssimato della mediana.

:::{.sol data-latex=""}
```{r 2023-221}
tabl(dat3[,1:7])
histp(axes = T)
h.int(150,1000,density=20)
cat(percentile())
```
:::

`r punti_p()` Qual è il numero di individui che spende più di 150€ al mese?

:::{.sol data-latex=""}
```{r 2023-99,,results='asis'}
cat(F_print(150,verso = ">"))
```
:::

`r punti_p()` Individuare la classe modale, metterla in relazione con la mediana e indicare la loro relazione con la media.

`r punti_p()` Michele ha sostenuto tre esami e ha la media del 26, al quarto esame ha preso 28. Qual è la media calcolata sui 4 esami?

:::{.sol data-latex=""}
\begin{eqnarray*}
  \bar x &=&\frac {26\times 3+28}{3+1}\\
  &=& \frac {`r 26*3+28`}{4}\\
  &=& `r (26*3+28)/4`
\end{eqnarray*}
  
:::



### Esercizio 2

Supponiamo di avere due urne, urna A e urna B, contenenti palline di due colori: rosse e blu.
Nell'urna A, ci sono 10 palline di cui 4 rosse e 6 blu. Nell'urna B, ci sono 20 palline di cui 8 rosse e 12 blu.
Estraiamo con reintroduzione 5 palline da ciascuna urna in modo indipendente.
Definiamo gli eventi: 

- $A=$ "l'estrazione dall'urna A dà al massimo una pallina rossa (1 pallina rossa o meno)".
- $B=$ "L'estrazione dall'urna B dà come risultato almeno 4 palline blu (4 o più palline blu)".

**(Punti 14)** Calcola la probabilità che almeno uno dei due eventi sia vero, ovvero la probabilità di $A \cup B$.

:::{.sol data-latex=""}
```{r 2023-100,,results='asis'}
cat(bin_dis(1,5,1/3))
cat(bin_dis(4,5,2/3,verso = "\\geq",comp = F,vnam = "Y"))
pa <- pbinom(1,5,1/3)
pb <- sum(dbinom(4:5,5,2/3))
```
\begin{eqnarray*}
  P(A\cup B) &=&  P(A)+P(B)-P(A\cap B)\\
  &=& `r pa`+`r pb`-`r pa*pb`\\
  &=& `r pa+pb-pa*pb`
\end{eqnarray*}
:::

`r punti_p(nex = T)` Qual è la probabilità di avere **esattamente** uno solo due eventi sia vera?

:::{.sol data-latex=""}
\begin{eqnarray*}
  P(A) &=&  `r pa`\\
  P(B) &=& `r pb`\\
  P(\text{Solo uno dei due vero}) &=& P(A\cap\bar B)+P(\bar A\cap B)\\
  &=& `r pa`\times (1 - `r pb`)+(1-`r pa`)\times  `r pb`\\
  &=& `r pa*(1-pb)+pb*(1-pa)`
\end{eqnarray*}
:::

`r punti_p()` Siano $X_1\sim N(5,1)$ e $X_2\sim N(5,1)$, $X_1$ e $X_2$ indipendenti. Come si distribuisce
\[
\bar X = \frac 12 (X_1+X_2) ~~~?
\]

`r punti_p()` Siano $A$ e $B$ due eventi tali che $P(A)=0.3$ e $P(B)=0.3$. $A$ e $B$ possono essere incompatibili? (scegliere tra _sempre, mai, dipende_ e motivare la risposta)



### Esercizio 3

`r punti_p(nex = T)` Un'urna contiene le seguenti palline numerate {3,4,5,6,7,12}. Si vine se esce un numero pari. Si estrae con reintroduzione per $n=81$ volte.
Calcolare la probabilità che la **proporzione** di vincite sia minore più di 0.55.

:::{.sol data-latex=""}
\[\pi=\frac 12\]
```{r 2023-101,,results='asis'}
cat(tlc(tipo = "prop",x1 = 0.55,verso = "<",mu = 1/2,n = 81))
```
:::



### Esercizio 4

`r punti_p(nex = T)` Sia $\hat \beta_0$ lo stimatore dei minimi quadrati di $\beta_0$ del modello di regressione lineare.
\begin{eqnarray*}
  \hat\beta_0 &=&\bar y-  \hat\beta_1\bar x\\
\end{eqnarray*}
Dimostrare la consistenza di $\hat\beta_0$.

`r punti_p()` Cosa significa che gli stimatori di massima verosimiglianza sono asintoticamente a massima efficienza?

`r punti_p()` Definire gli errori di primo e secondo tipo.

```{r 2023-222}
tabella <- matrix(c(50, 80, 50, 60, 100, 40, 40, 50, 50), nrow = 3, ncol = 3, byrow = TRUE)
n <- sum(tabella)
pval <- format(chisq.test(tabella)$p.value,digits = 4,nsmall = 4)
```

`r punti_p()` Un sociologo sta conducendo uno studio sull'associazione tra l'orientamento politico e l'atteggiamento nei confronti del cambiamento climatico. Ha somministrato un questionario a `r n` partecipanti, chiedendo loro di indicare il proprio orientamento politico (Conservatore, Progressista, Indipendente) e l'atteggiamento nei confronti del cambiamento climatico (Molto, poco, per nulla) preoccupato. L'obiettivo è determinare se c'è un'associazione significativa tra l'orientamento politico e l'atteggiamento nei confronti del cambiamento climatico.

```{r 2023-223}

# Assegnazione dei nomi alle righe e alle colonne
rownames(tabella) <- c("Conservatore", "Progressista", "Indipendente")
colnames(tabella) <- c("Molto", "Poco", "Per nulla")


 tabl(tabella)  %>%
   kable_styling(full_width = F)  %>%
   kable_paper(full_width = F)  %>%
   pack_rows("Orientamento politico", 1, 3) %>%
   add_header_above(c(" " = 1, "Preoccupato per i cambiamenti climatici" = 3))
```
Eseguito il test del $\chi^2$ per verificare l'indipendenza tra l'orientamento politico e la preoccupazione
sui cambiamenti climatici il sociologo ottiene un $p_\text{value}=`r pval`$. Quali conclusioni può trarne?




### Esercizio 5


```{r 2023-224}
# Dati campionari
# Dati campionari
n1 <- 80
n2 <- 80
x2 <- 40
x1 <- 48
p0 <- 0.5
alpha <- 0.01
```

`r punti_p(nex = T)` In uno studio clinico per valutare l'efficacia di un nuovo farmaco, sono stati selezionati `r n1+n2` pazienti con una particolare condizione medica. Tra questi, `r n1` sono stati trattati con un farmaco sperimentale e `r n2` col placebo. Tra i trattati, `r x1` pazienti hanno mostrato un miglioramento utilizzando il nuovo farmaco, mentre sono `r x2` quelli che hanno assunto il placebo e hanno mostrato miglioramenti. Testare l'ipotesi, usando il il $p_\text{value}$, che il farmaco sia maggiormente efficace rispetto al placebo.

:::{.sol data-latex=""}
```{r 2023-102,,results='asis'}
cat(ztest_2c_pi(s1 = x1,s2 = x2,n1 = n1,n2 = n2,h1 = ">",a = "F",b = "P"))
```
:::





### Esercizio 6
```{r 2023-225}
set.seed(9)
n <- 50
x <- round(abs(rnorm(n, 0, 6)) + 6) # Anni di studio
y <- round(abs(2.1*x + rnorm(n, 0, 5)) + 12) # Reddito annuo in migliaia di euro
ls2e(regr(x, y,semp = T,ax = 0))
```

In uno studio sul reddito, in un campione di $n=`r n`$ individui, sono state analizzati il livello di istruzione (in anni di studio, $X$) e il reddito annuale (in migliaia di euro, $Y$).
Si osservano le seguenti statistiche, $\sum_{i=1}^{`r n`}x_i=`r sumx`$, $\sum_{i=1}^{`r n`}y_i=`r sumy`$,
$\sum_{i=1}^{`r n`}x_i^2=`r sumx2`$, $\sum_{i=1}^{`r n`}y_i^2=`r sumy2`$ e $\sum_{i=1}^{`r n`}x_iy_i=`r sumxy`$.


`r punti_p(nex = T)` Si è osservato $x_3=`r p(x[3])`$ e $y_3=`r p(y[3])`$, stimare il modello di regressione dove $Y$ viene spiegata da $X$ e calcolare il residuo per il punto $i=3$.

:::{.sol data-latex=""}
```{r 2023-103,,results='asis'}
cat(calcolo_beta())
cat(residuo(x = x[3],y = y[3]))
```
:::

`r punti_p()` Scrivere la scomposizione della varianza e calcolarla per i dati in esame.

:::{.sol data-latex=""}
```{r 2023-104,,results='asis'}
cat(TSS())
```
:::

`r punti_p()` Stimare $\sigma^2_\varepsilon$.

:::{.sol data-latex=""}

\begin{eqnarray*}
\hat{\sigma_\varepsilon}^2&=&(1-r^2)\hat\sigma_Y^2\\
&=& (1-`r r^2`)\times`r vy`\\
    &=& `r sh2`\\
    S_\varepsilon^2 &=& \frac{n} {n-2} \hat{\sigma_\varepsilon}^2\\
    &=&  \frac{`r n`} {`r n`-2} \hat{\sigma_\varepsilon}^2 \\
 &=&  \frac{`r n`} {`r n`-2} \times `r sh2` = `r se2` 
\end{eqnarray*}
:::

`r punti_p()` Definire i punti influenti.

`r punti_p()` Se in un modello di regressione $r=0.35$, $\hat\sigma_X=1.2$ e $\hat\beta_1=0.5$, quanto varrà
$\hat\sigma_Y$, la standard deviation di $Y$?



